{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.15", "generated_at": "2025-12-13T18:36:39.246567Z", "invocation_id": "0d2105df-027d-4092-89f3-e4a83097e3be", "invocation_started_at": "2025-12-13T18:36:35.691063Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:38.790741Z", "completed_at": "2025-12-13T18:36:38.812436Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:38.812936Z", "completed_at": "2025-12-13T18:36:38.812955Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02335071563720703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.spotify_analytics.silver_plays", "compiled": true, "compiled_code": "\n\n-- ============================================================================\n-- SILVER LAYER: CLEANED PLAYS DATA\n-- ============================================================================\n-- Purpose: Transform bronze plays data into clean, analytics-ready format\n-- \n-- Transformations:\n--   1. Deduplicate records (DISTINCT on event_id)\n--   2. Cast all data types from VARIANT to proper types\n--   3. Filter invalid records (defensive WHERE clauses)\n--   4. Add processing metadata (processed_at timestamp)\n--\n-- Source: bronze.plays (external table reading from S3 Parquet files)\n-- Target: SILVER.silver_plays (materialized table)\n-- ============================================================================\n\nWITH source_data AS (\n    SELECT \n        VALUE:event_id::VARCHAR AS event_id,\n        VALUE:user_id::VARCHAR AS user_id,\n        VALUE:event_type::VARCHAR AS event_type,\n        VALUE:track_id::VARCHAR AS track_id,\n        VALUE:track_name::VARCHAR AS track_name,\n        VALUE:artist_name::VARCHAR AS artist_name,\n        VALUE:album_name::VARCHAR AS album_name,\n        VALUE:duration_ms::NUMBER AS duration_ms,\n        VALUE:played_at::VARCHAR AS played_at,\n        VALUE:device_type::VARCHAR AS device_type\n    FROM spotify_data.bronze.plays\n),\n\ndeduplicated AS (\n    SELECT DISTINCT\n        event_id,\n        user_id,\n        event_type,\n        track_id,\n        track_name,\n        artist_name,\n        album_name,\n        duration_ms,\n        played_at,\n        device_type\n    FROM source_data\n    WHERE \n        -- Data quality filters\n        user_id IS NOT NULL\n        AND duration_ms > 0\n        AND duration_ms < 600000  -- Less than 10 minutes (catches data errors)\n        AND event_id IS NOT NULL\n)\n\nSELECT \n    -- Identifiers\n    event_id::VARCHAR AS event_id,\n    user_id::VARCHAR AS user_id,\n    event_type::VARCHAR AS event_type,\n    \n    -- Track information\n    track_id::VARCHAR AS track_id,\n    track_name::VARCHAR AS track_name,\n    artist_name::VARCHAR AS artist_name,\n    album_name::VARCHAR AS album_name,\n    \n    -- Metrics\n    duration_ms::NUMBER AS duration_ms,\n    \n    -- Timestamps\n    TRY_CAST(played_at AS TIMESTAMP) AS played_at,\n    \n    -- Device context\n    device_type::VARCHAR AS device_type,\n    \n    -- Metadata\n    CURRENT_TIMESTAMP() AS processed_at\n    \nFROM deduplicated", "relation_name": "spotify_data.silver.silver_plays", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:38.818881Z", "completed_at": "2025-12-13T18:36:38.831909Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:38.832330Z", "completed_at": "2025-12-13T18:36:38.832345Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.017435789108276367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.spotify_analytics.daily_user_stats", "compiled": true, "compiled_code": "\n\n-- ============================================================================\n-- GOLD LAYER: DAILY USER LISTENING STATISTICS\n-- ============================================================================\n-- Purpose: Aggregate user listening behavior by day\n-- \n-- Grain: One row per user per day\n-- Primary Key: (date, user_id)\n--\n-- Metrics:\n--   - Total plays per day\n--   - Total listening time\n--   - Unique tracks/artists played\n--   - Average track duration\n--\n-- Source: SILVER.silver_plays\n-- Target: GOLD.daily_user_stats\n-- ============================================================================\n\nWITH daily_aggregates AS (\n    SELECT \n        -- Date dimension (truncate timestamp to date)\n        DATE(played_at) AS date,\n        \n        -- User identifier\n        user_id,\n        \n        -- Aggregate metrics\n        COUNT(*) AS total_plays,\n        SUM(duration_ms) AS total_listening_time_ms,\n        COUNT(DISTINCT track_id) AS unique_tracks,\n        COUNT(DISTINCT artist_name) AS unique_artists,\n        AVG(duration_ms) AS avg_track_duration_ms\n        \n    FROM spotify_data.silver.silver_plays\n    GROUP BY \n        DATE(played_at),\n        user_id\n)\n\nSELECT \n    -- Dimensions\n    date,\n    user_id,\n    \n    -- Metrics (cast for clarity)\n    total_plays::NUMBER AS total_plays,\n    total_listening_time_ms::NUMBER AS total_listening_time_ms,\n    unique_tracks::NUMBER AS unique_tracks,\n    unique_artists::NUMBER AS unique_artists,\n    ROUND(avg_track_duration_ms, 2)::NUMBER AS avg_track_duration_ms\n    \nFROM daily_aggregates\nORDER BY date DESC, user_id", "relation_name": "spotify_data.gold.daily_user_stats", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:38.833038Z", "completed_at": "2025-12-13T18:36:38.844444Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:38.854214Z", "completed_at": "2025-12-13T18:36:38.854223Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.029078960418701172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.spotify_analytics.top_artists", "compiled": true, "compiled_code": "\n\n-- ============================================================================\n-- GOLD LAYER: TOP ARTISTS BY PLAY COUNT\n-- ============================================================================\n-- Purpose: Aggregate and rank artists by popularity\n-- \n-- Grain: One row per artist (all-time aggregation)\n-- Primary Key: artist_name\n--\n-- Metrics:\n--   - Total plays per artist\n--   - Total listening time\n--   - Number of unique tracks played\n--   - First and last play timestamps\n--   - Popularity rank\n--\n-- Source: SILVER.silver_plays\n-- Target: GOLD.top_artists\n-- ============================================================================\n\nWITH artist_aggregates AS (\n    SELECT \n        -- Artist identifier\n        artist_name,\n        \n        -- Aggregate metrics\n        COUNT(*) AS total_plays,\n        SUM(duration_ms) AS total_listening_time_ms,\n        COUNT(DISTINCT track_id) AS unique_tracks,\n        MIN(played_at) AS first_played_at,\n        MAX(played_at) AS last_played_at\n        \n    FROM spotify_data.silver.silver_plays\n    GROUP BY artist_name\n),\n\nranked_artists AS (\n    SELECT \n        *,\n        -- Add ranking based on play count (1 = most played artist)\n        ROW_NUMBER() OVER (ORDER BY total_plays DESC, total_listening_time_ms DESC) AS rank\n    FROM artist_aggregates\n)\n\nSELECT \n    -- Identifier\n    artist_name::VARCHAR AS artist_name,\n    \n    -- Metrics\n    total_plays::NUMBER AS total_plays,\n    total_listening_time_ms::NUMBER AS total_listening_time_ms,\n    unique_tracks::NUMBER AS unique_tracks,\n    \n    -- Timestamps\n    first_played_at::TIMESTAMP AS first_played_at,\n    last_played_at::TIMESTAMP AS last_played_at,\n    \n    -- Ranking\n    rank::NUMBER AS rank\n    \nFROM ranked_artists\nORDER BY rank", "relation_name": "spotify_data.gold.top_artists", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:38.827063Z", "completed_at": "2025-12-13T18:36:38.845359Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:38.845829Z", "completed_at": "2025-12-13T18:36:38.845842Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.019582748413085938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.spotify_analytics.top_tracks", "compiled": true, "compiled_code": "\n\n-- ============================================================================\n-- GOLD LAYER: TOP TRACKS BY PLAY COUNT\n-- ============================================================================\n-- Purpose: Aggregate and rank tracks by popularity\n-- \n-- Grain: One row per track (all-time aggregation)\n-- Primary Key: track_id\n--\n-- Metrics:\n--   - Total plays per track\n--   - Total listening time\n--   - First and last play timestamps\n--   - Popularity rank\n--\n-- Source: SILVER.silver_plays\n-- Target: GOLD.top_tracks\n-- ============================================================================\n\nWITH track_aggregates AS (\n    SELECT \n        -- Track identifiers and attributes\n        track_id,\n        track_name,\n        artist_name,\n        album_name,\n        \n        -- Aggregate metrics\n        COUNT(*) AS total_plays,\n        SUM(duration_ms) AS total_listening_time_ms,\n        MIN(played_at) AS first_played_at,\n        MAX(played_at) AS last_played_at\n        \n    FROM spotify_data.silver.silver_plays\n    GROUP BY \n        track_id,\n        track_name,\n        artist_name,\n        album_name\n),\n\nranked_tracks AS (\n    SELECT \n        *,\n        -- Add ranking based on play count (1 = most played)\n        ROW_NUMBER() OVER (ORDER BY total_plays DESC, total_listening_time_ms DESC) AS rank\n    FROM track_aggregates\n)\n\nSELECT \n    -- Identifiers\n    track_id::VARCHAR AS track_id,\n    track_name::VARCHAR AS track_name,\n    artist_name::VARCHAR AS artist_name,\n    album_name::VARCHAR AS album_name,\n    \n    -- Metrics\n    total_plays::NUMBER AS total_plays,\n    total_listening_time_ms::NUMBER AS total_listening_time_ms,\n    \n    -- Timestamps\n    first_played_at::TIMESTAMP AS first_played_at,\n    last_played_at::TIMESTAMP AS last_played_at,\n    \n    -- Ranking\n    rank::NUMBER AS rank\n    \nFROM ranked_tracks\nORDER BY rank", "relation_name": "spotify_data.gold.top_tracks", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:38.836970Z", "completed_at": "2025-12-13T18:36:38.853082Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:38.853492Z", "completed_at": "2025-12-13T18:36:38.853527Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.030324220657348633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.spotify_analytics.device_usage", "compiled": true, "compiled_code": "\n\n-- ============================================================================\n-- GOLD LAYER: DEVICE USAGE STATISTICS\n-- ============================================================================\n-- Purpose: Aggregate listening behavior by device type\n-- \n-- Grain: One row per device type (all-time aggregation)\n-- Primary Key: device_type\n--\n-- Metrics:\n--   - Total plays per device\n--   - Total listening time\n--   - Percentage of total plays\n--   - Average track duration\n--\n-- Source: SILVER.silver_plays\n-- Target: GOLD.device_usage\n-- ============================================================================\n\nWITH device_aggregates AS (\n    SELECT \n        -- Device identifier\n        device_type,\n        \n        -- Aggregate metrics\n        COUNT(*) AS total_plays,\n        SUM(duration_ms) AS total_listening_time_ms,\n        AVG(duration_ms) AS avg_track_duration_ms\n        \n    FROM spotify_data.silver.silver_plays\n    GROUP BY device_type\n),\n\ntotal_plays_calc AS (\n    -- Calculate overall total for percentage calculation\n    SELECT SUM(total_plays) AS overall_total_plays\n    FROM device_aggregates\n)\n\nSELECT \n    -- Identifier\n    device_type::VARCHAR AS device_type,\n    \n    -- Metrics\n    total_plays::NUMBER AS total_plays,\n    total_listening_time_ms::NUMBER AS total_listening_time_ms,\n    \n    -- Percentage of total plays\n    ROUND((total_plays::FLOAT / overall_total_plays::FLOAT) * 100, 2)::FLOAT AS play_percentage,\n    \n    -- Average duration\n    ROUND(avg_track_duration_ms, 2)::NUMBER AS avg_track_duration_ms\n    \nFROM device_aggregates\nCROSS JOIN total_plays_calc\nORDER BY total_plays DESC", "relation_name": "spotify_data.gold.device_usage", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:38.846996Z", "completed_at": "2025-12-13T18:36:38.890252Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:38.892992Z", "completed_at": "2025-12-13T18:36:38.893007Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.049254417419433594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from spotify_data.silver.silver_plays\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not duration_ms >= 1\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not duration_ms <= 600000\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:38.865115Z", "completed_at": "2025-12-13T18:36:38.895383Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:38.897894Z", "completed_at": "2025-12-13T18:36:38.897905Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04285788536071777, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect artist_name\nfrom spotify_data.silver.silver_plays\nwhere artist_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:38.871769Z", "completed_at": "2025-12-13T18:36:38.896027Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:38.896451Z", "completed_at": "2025-12-13T18:36:38.896461Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03994631767272949, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect duration_ms\nfrom spotify_data.silver.silver_plays\nwhere duration_ms is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:38.884140Z", "completed_at": "2025-12-13T18:36:38.899007Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:38.912389Z", "completed_at": "2025-12-13T18:36:38.912399Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.048253774642944336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom spotify_data.silver.silver_plays\nwhere event_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:38.901296Z", "completed_at": "2025-12-13T18:36:38.914276Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:38.914626Z", "completed_at": "2025-12-13T18:36:38.914632Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01411747932434082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect processed_at\nfrom spotify_data.silver.silver_plays\nwhere processed_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:38.907224Z", "completed_at": "2025-12-13T18:36:38.932034Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:38.932402Z", "completed_at": "2025-12-13T18:36:38.932409Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0260312557220459, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_type\nfrom spotify_data.silver.silver_plays\nwhere event_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:38.915620Z", "completed_at": "2025-12-13T18:36:38.933141Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:38.933491Z", "completed_at": "2025-12-13T18:36:38.933506Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.022550344467163086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect played_at\nfrom spotify_data.silver.silver_plays\nwhere played_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:38.920712Z", "completed_at": "2025-12-13T18:36:38.934442Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:38.934784Z", "completed_at": "2025-12-13T18:36:38.934791Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02155137062072754, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect track_id\nfrom spotify_data.silver.silver_plays\nwhere track_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:38.927287Z", "completed_at": "2025-12-13T18:36:38.943928Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:38.944303Z", "completed_at": "2025-12-13T18:36:38.944310Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017789602279663086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect track_name\nfrom spotify_data.silver.silver_plays\nwhere track_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:38.936409Z", "completed_at": "2025-12-13T18:36:38.957907Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:38.958311Z", "completed_at": "2025-12-13T18:36:38.958320Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.022660493850708008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom spotify_data.silver.silver_plays\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:38.944958Z", "completed_at": "2025-12-13T18:36:38.964143Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:38.971025Z", "completed_at": "2025-12-13T18:36:38.971046Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.029882192611694336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom spotify_data.silver.silver_plays\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:38.951855Z", "completed_at": "2025-12-13T18:36:38.970049Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:38.972341Z", "completed_at": "2025-12-13T18:36:38.972351Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.029996633529663086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect avg_track_duration_ms\nfrom spotify_data.gold.daily_user_stats\nwhere avg_track_duration_ms is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:38.960100Z", "completed_at": "2025-12-13T18:36:38.974756Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:38.990093Z", "completed_at": "2025-12-13T18:36:38.990105Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.030834674835205078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date\nfrom spotify_data.gold.daily_user_stats\nwhere date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:38.981225Z", "completed_at": "2025-12-13T18:36:38.993455Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:38.993867Z", "completed_at": "2025-12-13T18:36:38.993875Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.013498783111572266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_plays\nfrom spotify_data.gold.daily_user_stats\nwhere total_plays is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:38.975251Z", "completed_at": "2025-12-13T18:36:38.992225Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:38.992615Z", "completed_at": "2025-12-13T18:36:38.992623Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.026635169982910156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_listening_time_ms\nfrom spotify_data.gold.daily_user_stats\nwhere total_listening_time_ms is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:38.985852Z", "completed_at": "2025-12-13T18:36:39.003274Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:39.003707Z", "completed_at": "2025-12-13T18:36:39.003716Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.030480146408081055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect unique_artists\nfrom spotify_data.gold.daily_user_stats\nwhere unique_artists is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:38.997442Z", "completed_at": "2025-12-13T18:36:39.021189Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:39.021596Z", "completed_at": "2025-12-13T18:36:39.021605Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.024968385696411133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect unique_tracks\nfrom spotify_data.gold.daily_user_stats\nwhere unique_tracks is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:39.005093Z", "completed_at": "2025-12-13T18:36:39.022382Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:39.022739Z", "completed_at": "2025-12-13T18:36:39.022746Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01846599578857422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom spotify_data.gold.daily_user_stats\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:39.016699Z", "completed_at": "2025-12-13T18:36:39.031035Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:39.031406Z", "completed_at": "2025-12-13T18:36:39.031413Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.015500783920288086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_type\nfrom spotify_data.gold.device_usage\nwhere device_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:39.010079Z", "completed_at": "2025-12-13T18:36:39.023462Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:39.023836Z", "completed_at": "2025-12-13T18:36:39.023843Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.028818607330322266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect avg_track_duration_ms\nfrom spotify_data.gold.device_usage\nwhere avg_track_duration_ms is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:39.025660Z", "completed_at": "2025-12-13T18:36:39.043547Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:39.044030Z", "completed_at": "2025-12-13T18:36:39.044041Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01918506622314453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect play_percentage\nfrom spotify_data.gold.device_usage\nwhere play_percentage is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:39.044772Z", "completed_at": "2025-12-13T18:36:39.053482Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:39.054018Z", "completed_at": "2025-12-13T18:36:39.054029Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.017448902130126953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_listening_time_ms\nfrom spotify_data.gold.device_usage\nwhere total_listening_time_ms is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:39.038327Z", "completed_at": "2025-12-13T18:36:39.054800Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:39.060800Z", "completed_at": "2025-12-13T18:36:39.060828Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02855825424194336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_plays\nfrom spotify_data.gold.device_usage\nwhere total_plays is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:39.055247Z", "completed_at": "2025-12-13T18:36:39.074170Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:39.080640Z", "completed_at": "2025-12-13T18:36:39.080650Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04748654365539551, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect artist_name\nfrom spotify_data.gold.top_artists\nwhere artist_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:39.076860Z", "completed_at": "2025-12-13T18:36:39.084715Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:39.085086Z", "completed_at": "2025-12-13T18:36:39.085093Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.009648799896240234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_top_artists_rank.d14513fc96", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rank\nfrom spotify_data.gold.top_artists\nwhere rank is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:39.062831Z", "completed_at": "2025-12-13T18:36:39.076166Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:39.082223Z", "completed_at": "2025-12-13T18:36:39.082232Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.030019044876098633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect first_played_at\nfrom spotify_data.gold.top_artists\nwhere first_played_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:39.068873Z", "completed_at": "2025-12-13T18:36:39.092170Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:39.104917Z", "completed_at": "2025-12-13T18:36:39.104931Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03734779357910156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect last_played_at\nfrom spotify_data.gold.top_artists\nwhere last_played_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:39.088371Z", "completed_at": "2025-12-13T18:36:39.102833Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:39.103207Z", "completed_at": "2025-12-13T18:36:39.103214Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.016080856323242188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_listening_time_ms\nfrom spotify_data.gold.top_artists\nwhere total_listening_time_ms is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:39.094405Z", "completed_at": "2025-12-13T18:36:39.103940Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:39.104298Z", "completed_at": "2025-12-13T18:36:39.104305Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.010704994201660156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_plays\nfrom spotify_data.gold.top_artists\nwhere total_plays is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:39.098161Z", "completed_at": "2025-12-13T18:36:39.118180Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:39.118602Z", "completed_at": "2025-12-13T18:36:39.118611Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03222799301147461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect unique_tracks\nfrom spotify_data.gold.top_artists\nwhere unique_tracks is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:39.106512Z", "completed_at": "2025-12-13T18:36:39.124842Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:39.127966Z", "completed_at": "2025-12-13T18:36:39.127979Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02222132682800293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect artist_name\nfrom spotify_data.gold.top_tracks\nwhere artist_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:39.112234Z", "completed_at": "2025-12-13T18:36:39.129282Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:39.129724Z", "completed_at": "2025-12-13T18:36:39.129734Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.018862009048461914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect first_played_at\nfrom spotify_data.gold.top_tracks\nwhere first_played_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:39.120379Z", "completed_at": "2025-12-13T18:36:39.143100Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:39.143570Z", "completed_at": "2025-12-13T18:36:39.143580Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.024028301239013672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect last_played_at\nfrom spotify_data.gold.top_tracks\nwhere last_played_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:39.131454Z", "completed_at": "2025-12-13T18:36:39.171147Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:39.171539Z", "completed_at": "2025-12-13T18:36:39.171548Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.044593095779418945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rank\nfrom spotify_data.gold.top_tracks\nwhere rank is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:39.147604Z", "completed_at": "2025-12-13T18:36:39.180095Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:39.180487Z", "completed_at": "2025-12-13T18:36:39.180495Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.040709733963012695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_listening_time_ms\nfrom spotify_data.gold.top_tracks\nwhere total_listening_time_ms is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:39.173244Z", "completed_at": "2025-12-13T18:36:39.199245Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:39.199598Z", "completed_at": "2025-12-13T18:36:39.199606Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.05429196357727051, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_plays\nfrom spotify_data.gold.top_tracks\nwhere total_plays is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:39.165716Z", "completed_at": "2025-12-13T18:36:39.198054Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:39.198423Z", "completed_at": "2025-12-13T18:36:39.198432Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.033515214920043945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect track_id\nfrom spotify_data.gold.top_tracks\nwhere track_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:39.190883Z", "completed_at": "2025-12-13T18:36:39.212676Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:39.213059Z", "completed_at": "2025-12-13T18:36:39.213068Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0285491943359375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect track_name\nfrom spotify_data.gold.top_tracks\nwhere track_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:39.200575Z", "completed_at": "2025-12-13T18:36:39.211320Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:39.211749Z", "completed_at": "2025-12-13T18:36:39.211760Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.014431476593017578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.unique_device_usage_device_type.e75362861b", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    device_type as unique_field,\n    count(*) as n_records\n\nfrom spotify_data.gold.device_usage\nwhere device_type is not null\ngroup by device_type\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:39.215041Z", "completed_at": "2025-12-13T18:36:39.226621Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:39.227022Z", "completed_at": "2025-12-13T18:36:39.227032Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.017435550689697266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    artist_name as unique_field,\n    count(*) as n_records\n\nfrom spotify_data.gold.top_artists\nwhere artist_name is not null\ngroup by artist_name\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:39.222069Z", "completed_at": "2025-12-13T18:36:39.233245Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:39.233629Z", "completed_at": "2025-12-13T18:36:39.233637Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01990962028503418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.unique_top_artists_rank.68b5480aed", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    rank as unique_field,\n    count(*) as n_records\n\nfrom spotify_data.gold.top_artists\nwhere rank is not null\ngroup by rank\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:39.228029Z", "completed_at": "2025-12-13T18:36:39.241498Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:39.241997Z", "completed_at": "2025-12-13T18:36:39.242005Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.020503520965576172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.unique_top_tracks_track_id.865b43a659", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    track_id as unique_field,\n    count(*) as n_records\n\nfrom spotify_data.gold.top_tracks\nwhere track_id is not null\ngroup by track_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-13T18:36:39.234678Z", "completed_at": "2025-12-13T18:36:39.242922Z"}, {"name": "execute", "started_at": "2025-12-13T18:36:39.243265Z", "completed_at": "2025-12-13T18:36:39.243272Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010696887969970703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.unique_top_tracks_rank.8fecde1136", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    rank as unique_field,\n    count(*) as n_records\n\nfrom spotify_data.gold.top_tracks\nwhere rank is not null\ngroup by rank\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 1.6447992324829102, "args": {"quiet": false, "use_colors_file": true, "strict_mode": false, "which": "compile", "version_check": true, "defer": false, "profiles_dir": "dbt", "require_explicit_package_overrides_for_builtin_materializations": true, "output": "text", "log_level": "info", "warn_error_options": {"error": [], "warn": [], "silence": []}, "vars": {}, "require_resource_names_without_spaces": true, "write_json": true, "print": true, "require_nested_cumulative_type_params": false, "static_parser": true, "show_resource_report": false, "partial_parse_file_diff": true, "partial_parse": true, "select": [], "empty": false, "inject_ephemeral_ctes": true, "indirect_selection": "eager", "populate_cache": true, "log_level_file": "debug", "skip_nodes_if_on_run_start_fails": false, "macro_debugging": false, "favor_state": false, "printer_width": 80, "log_format": "default", "log_path": "dbt/logs", "invocation_command": "dbt compile --project-dir dbt --profiles-dir dbt", "send_anonymous_usage_stats": true, "source_freshness_run_project_hooks": true, "require_generic_test_arguments_property": true, "log_file_max_bytes": 10485760, "validate_macro_args": false, "cache_selected_only": false, "project_dir": "dbt", "exclude": [], "log_format_file": "debug", "use_fast_test_edges": false, "require_batched_execution_for_custom_microbatch_strategy": false, "state_modified_compare_more_unrendered_values": false, "use_colors": true, "show_all_deprecations": false, "state_modified_compare_vars": false, "require_all_warnings_handled_by_warn_error": false, "introspect": true, "upload_to_artifacts_ingest_api": false, "require_yaml_configuration_for_mf_time_spines": false}}