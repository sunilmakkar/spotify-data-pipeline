{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.15", "generated_at": "2025-11-26T00:47:42.673946Z", "invocation_id": "384a5413-b512-4751-8c7a-e219ad2b54c6", "invocation_started_at": "2025-11-26T00:47:39.771153Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.533045Z", "completed_at": "2025-11-26T00:47:42.543149Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.543634Z", "completed_at": "2025-11-26T00:47:42.543657Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011695146560668945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.spotify_analytics.silver_plays", "compiled": true, "compiled_code": "\n\n-- ============================================================================\n-- SILVER LAYER: CLEANED PLAYS DATA\n-- ============================================================================\n-- Purpose: Transform bronze plays data into clean, analytics-ready format\n-- \n-- Transformations:\n--   1. Deduplicate records (DISTINCT on event_id)\n--   2. Cast all data types from VARIANT to proper types\n--   3. Filter invalid records (defensive WHERE clauses)\n--   4. Add processing metadata (processed_at timestamp)\n--\n-- Source: bronze.plays (external table reading from S3 Parquet files)\n-- Target: SILVER.silver_plays (materialized table)\n-- ============================================================================\n\nWITH source_data AS (\n    SELECT \n        VALUE:event_id::VARCHAR AS event_id,\n        VALUE:user_id::VARCHAR AS user_id,\n        VALUE:event_type::VARCHAR AS event_type,\n        VALUE:track_id::VARCHAR AS track_id,\n        VALUE:track_name::VARCHAR AS track_name,\n        VALUE:artist_name::VARCHAR AS artist_name,\n        VALUE:album_name::VARCHAR AS album_name,\n        VALUE:duration_ms::NUMBER AS duration_ms,\n        VALUE:played_at::VARCHAR AS played_at,\n        VALUE:device_type::VARCHAR AS device_type\n    FROM spotify_data.bronze.plays\n),\n\ndeduplicated AS (\n    SELECT DISTINCT\n        event_id,\n        user_id,\n        event_type,\n        track_id,\n        track_name,\n        artist_name,\n        album_name,\n        duration_ms,\n        played_at,\n        device_type\n    FROM source_data\n    WHERE \n        -- Data quality filters\n        user_id IS NOT NULL\n        AND duration_ms > 0\n        AND duration_ms < 600000  -- Less than 10 minutes (catches data errors)\n        AND event_id IS NOT NULL\n)\n\nSELECT \n    -- Identifiers\n    event_id::VARCHAR AS event_id,\n    user_id::VARCHAR AS user_id,\n    event_type::VARCHAR AS event_type,\n    \n    -- Track information\n    track_id::VARCHAR AS track_id,\n    track_name::VARCHAR AS track_name,\n    artist_name::VARCHAR AS artist_name,\n    album_name::VARCHAR AS album_name,\n    \n    -- Metrics\n    duration_ms::NUMBER AS duration_ms,\n    \n    -- Timestamps\n    TRY_CAST(played_at AS TIMESTAMP) AS played_at,\n    \n    -- Device context\n    device_type::VARCHAR AS device_type,\n    \n    -- Metadata\n    CURRENT_TIMESTAMP() AS processed_at\n    \nFROM deduplicated", "relation_name": "spotify_data.silver.silver_plays", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.547800Z", "completed_at": "2025-11-26T00:47:42.555846Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.556050Z", "completed_at": "2025-11-26T00:47:42.556056Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010598182678222656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.spotify_analytics.daily_user_stats", "compiled": true, "compiled_code": "\n\n-- ============================================================================\n-- GOLD LAYER: DAILY USER LISTENING STATISTICS\n-- ============================================================================\n-- Purpose: Aggregate user listening behavior by day\n-- \n-- Grain: One row per user per day\n-- Primary Key: (date, user_id)\n--\n-- Metrics:\n--   - Total plays per day\n--   - Total listening time\n--   - Unique tracks/artists played\n--   - Average track duration\n--\n-- Source: SILVER.silver_plays\n-- Target: GOLD.daily_user_stats\n-- ============================================================================\n\nWITH daily_aggregates AS (\n    SELECT \n        -- Date dimension (truncate timestamp to date)\n        DATE(played_at) AS date,\n        \n        -- User identifier\n        user_id,\n        \n        -- Aggregate metrics\n        COUNT(*) AS total_plays,\n        SUM(duration_ms) AS total_listening_time_ms,\n        COUNT(DISTINCT track_id) AS unique_tracks,\n        COUNT(DISTINCT artist_name) AS unique_artists,\n        AVG(duration_ms) AS avg_track_duration_ms\n        \n    FROM spotify_data.silver.silver_plays\n    GROUP BY \n        DATE(played_at),\n        user_id\n)\n\nSELECT \n    -- Dimensions\n    date,\n    user_id,\n    \n    -- Metrics (cast for clarity)\n    total_plays::NUMBER AS total_plays,\n    total_listening_time_ms::NUMBER AS total_listening_time_ms,\n    unique_tracks::NUMBER AS unique_tracks,\n    unique_artists::NUMBER AS unique_artists,\n    ROUND(avg_track_duration_ms, 2)::NUMBER AS avg_track_duration_ms\n    \nFROM daily_aggregates\nORDER BY date DESC, user_id", "relation_name": "spotify_data.gold.daily_user_stats", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.554016Z", "completed_at": "2025-11-26T00:47:42.566815Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.572957Z", "completed_at": "2025-11-26T00:47:42.572962Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02577996253967285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.spotify_analytics.device_usage", "compiled": true, "compiled_code": "\n\n-- ============================================================================\n-- GOLD LAYER: DEVICE USAGE STATISTICS\n-- ============================================================================\n-- Purpose: Aggregate listening behavior by device type\n-- \n-- Grain: One row per device type (all-time aggregation)\n-- Primary Key: device_type\n--\n-- Metrics:\n--   - Total plays per device\n--   - Total listening time\n--   - Percentage of total plays\n--   - Average track duration\n--\n-- Source: SILVER.silver_plays\n-- Target: GOLD.device_usage\n-- ============================================================================\n\nWITH device_aggregates AS (\n    SELECT \n        -- Device identifier\n        device_type,\n        \n        -- Aggregate metrics\n        COUNT(*) AS total_plays,\n        SUM(duration_ms) AS total_listening_time_ms,\n        AVG(duration_ms) AS avg_track_duration_ms\n        \n    FROM spotify_data.silver.silver_plays\n    GROUP BY device_type\n),\n\ntotal_plays_calc AS (\n    -- Calculate overall total for percentage calculation\n    SELECT SUM(total_plays) AS overall_total_plays\n    FROM device_aggregates\n)\n\nSELECT \n    -- Identifier\n    device_type::VARCHAR AS device_type,\n    \n    -- Metrics\n    total_plays::NUMBER AS total_plays,\n    total_listening_time_ms::NUMBER AS total_listening_time_ms,\n    \n    -- Percentage of total plays\n    ROUND((total_plays::FLOAT / overall_total_plays::FLOAT) * 100, 2)::FLOAT AS play_percentage,\n    \n    -- Average duration\n    ROUND(avg_track_duration_ms, 2)::NUMBER AS avg_track_duration_ms\n    \nFROM device_aggregates\nCROSS JOIN total_plays_calc\nORDER BY total_plays DESC", "relation_name": "spotify_data.gold.device_usage", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.550175Z", "completed_at": "2025-11-26T00:47:42.567064Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.573365Z", "completed_at": "2025-11-26T00:47:42.573368Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02715587615966797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.spotify_analytics.top_artists", "compiled": true, "compiled_code": "\n\n-- ============================================================================\n-- GOLD LAYER: TOP ARTISTS BY PLAY COUNT\n-- ============================================================================\n-- Purpose: Aggregate and rank artists by popularity\n-- \n-- Grain: One row per artist (all-time aggregation)\n-- Primary Key: artist_name\n--\n-- Metrics:\n--   - Total plays per artist\n--   - Total listening time\n--   - Number of unique tracks played\n--   - First and last play timestamps\n--   - Popularity rank\n--\n-- Source: SILVER.silver_plays\n-- Target: GOLD.top_artists\n-- ============================================================================\n\nWITH artist_aggregates AS (\n    SELECT \n        -- Artist identifier\n        artist_name,\n        \n        -- Aggregate metrics\n        COUNT(*) AS total_plays,\n        SUM(duration_ms) AS total_listening_time_ms,\n        COUNT(DISTINCT track_id) AS unique_tracks,\n        MIN(played_at) AS first_played_at,\n        MAX(played_at) AS last_played_at\n        \n    FROM spotify_data.silver.silver_plays\n    GROUP BY artist_name\n),\n\nranked_artists AS (\n    SELECT \n        *,\n        -- Add ranking based on play count (1 = most played artist)\n        ROW_NUMBER() OVER (ORDER BY total_plays DESC, total_listening_time_ms DESC) AS rank\n    FROM artist_aggregates\n)\n\nSELECT \n    -- Identifier\n    artist_name::VARCHAR AS artist_name,\n    \n    -- Metrics\n    total_plays::NUMBER AS total_plays,\n    total_listening_time_ms::NUMBER AS total_listening_time_ms,\n    unique_tracks::NUMBER AS unique_tracks,\n    \n    -- Timestamps\n    first_played_at::TIMESTAMP AS first_played_at,\n    last_played_at::TIMESTAMP AS last_played_at,\n    \n    -- Ranking\n    rank::NUMBER AS rank\n    \nFROM ranked_artists\nORDER BY rank", "relation_name": "spotify_data.gold.top_artists", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.552378Z", "completed_at": "2025-11-26T00:47:42.573665Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.574387Z", "completed_at": "2025-11-26T00:47:42.574389Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.027780771255493164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.spotify_analytics.top_tracks", "compiled": true, "compiled_code": "\n\n-- ============================================================================\n-- GOLD LAYER: TOP TRACKS BY PLAY COUNT\n-- ============================================================================\n-- Purpose: Aggregate and rank tracks by popularity\n-- \n-- Grain: One row per track (all-time aggregation)\n-- Primary Key: track_id\n--\n-- Metrics:\n--   - Total plays per track\n--   - Total listening time\n--   - First and last play timestamps\n--   - Popularity rank\n--\n-- Source: SILVER.silver_plays\n-- Target: GOLD.top_tracks\n-- ============================================================================\n\nWITH track_aggregates AS (\n    SELECT \n        -- Track identifiers and attributes\n        track_id,\n        track_name,\n        artist_name,\n        album_name,\n        \n        -- Aggregate metrics\n        COUNT(*) AS total_plays,\n        SUM(duration_ms) AS total_listening_time_ms,\n        MIN(played_at) AS first_played_at,\n        MAX(played_at) AS last_played_at\n        \n    FROM spotify_data.silver.silver_plays\n    GROUP BY \n        track_id,\n        track_name,\n        artist_name,\n        album_name\n),\n\nranked_tracks AS (\n    SELECT \n        *,\n        -- Add ranking based on play count (1 = most played)\n        ROW_NUMBER() OVER (ORDER BY total_plays DESC, total_listening_time_ms DESC) AS rank\n    FROM track_aggregates\n)\n\nSELECT \n    -- Identifiers\n    track_id::VARCHAR AS track_id,\n    track_name::VARCHAR AS track_name,\n    artist_name::VARCHAR AS artist_name,\n    album_name::VARCHAR AS album_name,\n    \n    -- Metrics\n    total_plays::NUMBER AS total_plays,\n    total_listening_time_ms::NUMBER AS total_listening_time_ms,\n    \n    -- Timestamps\n    first_played_at::TIMESTAMP AS first_played_at,\n    last_played_at::TIMESTAMP AS last_played_at,\n    \n    -- Ranking\n    rank::NUMBER AS rank\n    \nFROM ranked_tracks\nORDER BY rank", "relation_name": "spotify_data.gold.top_tracks", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.557168Z", "completed_at": "2025-11-26T00:47:42.574961Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.575793Z", "completed_at": "2025-11-26T00:47:42.575797Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.019124984741210938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from spotify_data.silver.silver_plays\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not duration_ms >= 1\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not duration_ms <= 600000\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.580701Z", "completed_at": "2025-11-26T00:47:42.586251Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.586437Z", "completed_at": "2025-11-26T00:47:42.586441Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.011356115341186523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect duration_ms\nfrom spotify_data.silver.silver_plays\nwhere duration_ms is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.576459Z", "completed_at": "2025-11-26T00:47:42.586720Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.587087Z", "completed_at": "2025-11-26T00:47:42.587090Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01246190071105957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect artist_name\nfrom spotify_data.silver.silver_plays\nwhere artist_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.584720Z", "completed_at": "2025-11-26T00:47:42.587335Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.587975Z", "completed_at": "2025-11-26T00:47:42.587978Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005484819412231445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_type\nfrom spotify_data.silver.silver_plays\nwhere event_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.582729Z", "completed_at": "2025-11-26T00:47:42.587481Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.588242Z", "completed_at": "2025-11-26T00:47:42.588245Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012019872665405273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom spotify_data.silver.silver_plays\nwhere event_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.589130Z", "completed_at": "2025-11-26T00:47:42.592861Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.596171Z", "completed_at": "2025-11-26T00:47:42.596174Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.008582115173339844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect played_at\nfrom spotify_data.silver.silver_plays\nwhere played_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.591206Z", "completed_at": "2025-11-26T00:47:42.596409Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.596769Z", "completed_at": "2025-11-26T00:47:42.596772Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008161067962646484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect processed_at\nfrom spotify_data.silver.silver_plays\nwhere processed_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.592991Z", "completed_at": "2025-11-26T00:47:42.597024Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.597571Z", "completed_at": "2025-11-26T00:47:42.597573Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006739377975463867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect track_id\nfrom spotify_data.silver.silver_plays\nwhere track_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.594453Z", "completed_at": "2025-11-26T00:47:42.597299Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.597920Z", "completed_at": "2025-11-26T00:47:42.597922Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006926059722900391, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect track_name\nfrom spotify_data.silver.silver_plays\nwhere track_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.598449Z", "completed_at": "2025-11-26T00:47:42.603025Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.605786Z", "completed_at": "2025-11-26T00:47:42.605788Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.00866389274597168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom spotify_data.silver.silver_plays\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.600388Z", "completed_at": "2025-11-26T00:47:42.605995Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.606322Z", "completed_at": "2025-11-26T00:47:42.606325Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008208036422729492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom spotify_data.silver.silver_plays\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.604425Z", "completed_at": "2025-11-26T00:47:42.606864Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.607381Z", "completed_at": "2025-11-26T00:47:42.607383Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0071697235107421875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date\nfrom spotify_data.gold.daily_user_stats\nwhere date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.603170Z", "completed_at": "2025-11-26T00:47:42.607120Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.608800Z", "completed_at": "2025-11-26T00:47:42.608803Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008759021759033203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect avg_track_duration_ms\nfrom spotify_data.gold.daily_user_stats\nwhere avg_track_duration_ms is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.607609Z", "completed_at": "2025-11-26T00:47:42.611076Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.611497Z", "completed_at": "2025-11-26T00:47:42.611499Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004972934722900391, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_listening_time_ms\nfrom spotify_data.gold.daily_user_stats\nwhere total_listening_time_ms is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.609473Z", "completed_at": "2025-11-26T00:47:42.612989Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.614637Z", "completed_at": "2025-11-26T00:47:42.614639Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0074310302734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_plays\nfrom spotify_data.gold.daily_user_stats\nwhere total_plays is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.613262Z", "completed_at": "2025-11-26T00:47:42.615313Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.616910Z", "completed_at": "2025-11-26T00:47:42.616912Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005741119384765625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect unique_tracks\nfrom spotify_data.gold.daily_user_stats\nwhere unique_tracks is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.611838Z", "completed_at": "2025-11-26T00:47:42.615552Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.617253Z", "completed_at": "2025-11-26T00:47:42.617255Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006346225738525391, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect unique_artists\nfrom spotify_data.gold.daily_user_stats\nwhere unique_artists is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.615681Z", "completed_at": "2025-11-26T00:47:42.619495Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.619897Z", "completed_at": "2025-11-26T00:47:42.619899Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.005070209503173828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom spotify_data.gold.daily_user_stats\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.617625Z", "completed_at": "2025-11-26T00:47:42.620104Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.621718Z", "completed_at": "2025-11-26T00:47:42.621720Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0063250064849853516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect avg_track_duration_ms\nfrom spotify_data.gold.device_usage\nwhere avg_track_duration_ms is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.620350Z", "completed_at": "2025-11-26T00:47:42.623890Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.625452Z", "completed_at": "2025-11-26T00:47:42.625454Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006159067153930664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_type\nfrom spotify_data.gold.device_usage\nwhere device_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.621954Z", "completed_at": "2025-11-26T00:47:42.625325Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.627091Z", "completed_at": "2025-11-26T00:47:42.627093Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007498979568481445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect play_percentage\nfrom spotify_data.gold.device_usage\nwhere play_percentage is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.624023Z", "completed_at": "2025-11-26T00:47:42.627461Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.628019Z", "completed_at": "2025-11-26T00:47:42.628021Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.00475001335144043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_listening_time_ms\nfrom spotify_data.gold.device_usage\nwhere total_listening_time_ms is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.625699Z", "completed_at": "2025-11-26T00:47:42.628380Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.628951Z", "completed_at": "2025-11-26T00:47:42.628953Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0052280426025390625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_plays\nfrom spotify_data.gold.device_usage\nwhere total_plays is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.629165Z", "completed_at": "2025-11-26T00:47:42.637087Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.637395Z", "completed_at": "2025-11-26T00:47:42.637399Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009585857391357422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.unique_device_usage_device_type.e75362861b", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    device_type as unique_field,\n    count(*) as n_records\n\nfrom spotify_data.gold.device_usage\nwhere device_type is not null\ngroup by device_type\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.630694Z", "completed_at": "2025-11-26T00:47:42.637248Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.637655Z", "completed_at": "2025-11-26T00:47:42.637657Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009443044662475586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect artist_name\nfrom spotify_data.gold.top_artists\nwhere artist_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.634358Z", "completed_at": "2025-11-26T00:47:42.637870Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.638436Z", "completed_at": "2025-11-26T00:47:42.638438Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004732847213745117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect last_played_at\nfrom spotify_data.gold.top_artists\nwhere last_played_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.635713Z", "completed_at": "2025-11-26T00:47:42.638133Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.638810Z", "completed_at": "2025-11-26T00:47:42.638812Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.008314847946166992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect first_played_at\nfrom spotify_data.gold.top_artists\nwhere first_played_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.640137Z", "completed_at": "2025-11-26T00:47:42.643148Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.646342Z", "completed_at": "2025-11-26T00:47:42.646347Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007730007171630859, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_top_artists_rank.d14513fc96", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rank\nfrom spotify_data.gold.top_artists\nwhere rank is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.641545Z", "completed_at": "2025-11-26T00:47:42.646181Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.646654Z", "completed_at": "2025-11-26T00:47:42.646657Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007656097412109375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_listening_time_ms\nfrom spotify_data.gold.top_artists\nwhere total_listening_time_ms is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.644937Z", "completed_at": "2025-11-26T00:47:42.647228Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.647778Z", "completed_at": "2025-11-26T00:47:42.647781Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0064239501953125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect unique_tracks\nfrom spotify_data.gold.top_artists\nwhere unique_tracks is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.643322Z", "completed_at": "2025-11-26T00:47:42.647350Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.648019Z", "completed_at": "2025-11-26T00:47:42.648021Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008059263229370117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_plays\nfrom spotify_data.gold.top_artists\nwhere total_plays is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.648818Z", "completed_at": "2025-11-26T00:47:42.653773Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.655478Z", "completed_at": "2025-11-26T00:47:42.655482Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008054971694946289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    artist_name as unique_field,\n    count(*) as n_records\n\nfrom spotify_data.gold.top_artists\nwhere artist_name is not null\ngroup by artist_name\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.650481Z", "completed_at": "2025-11-26T00:47:42.653892Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.655723Z", "completed_at": "2025-11-26T00:47:42.655727Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00814199447631836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.unique_top_artists_rank.68b5480aed", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    rank as unique_field,\n    count(*) as n_records\n\nfrom spotify_data.gold.top_artists\nwhere rank is not null\ngroup by rank\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.652357Z", "completed_at": "2025-11-26T00:47:42.656338Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.656877Z", "completed_at": "2025-11-26T00:47:42.656880Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.005185604095458984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect artist_name\nfrom spotify_data.gold.top_tracks\nwhere artist_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.654021Z", "completed_at": "2025-11-26T00:47:42.656612Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.657229Z", "completed_at": "2025-11-26T00:47:42.657231Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.005383014678955078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect first_played_at\nfrom spotify_data.gold.top_tracks\nwhere first_played_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.657709Z", "completed_at": "2025-11-26T00:47:42.660915Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.662581Z", "completed_at": "2025-11-26T00:47:42.662583Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006142139434814453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect last_played_at\nfrom spotify_data.gold.top_tracks\nwhere last_played_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.659344Z", "completed_at": "2025-11-26T00:47:42.662454Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.664065Z", "completed_at": "2025-11-26T00:47:42.664067Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0073659420013427734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rank\nfrom spotify_data.gold.top_tracks\nwhere rank is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.661187Z", "completed_at": "2025-11-26T00:47:42.664617Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.665154Z", "completed_at": "2025-11-26T00:47:42.665156Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004721164703369141, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_listening_time_ms\nfrom spotify_data.gold.top_tracks\nwhere total_listening_time_ms is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.662801Z", "completed_at": "2025-11-26T00:47:42.665020Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.665641Z", "completed_at": "2025-11-26T00:47:42.665644Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.005059003829956055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_plays\nfrom spotify_data.gold.top_tracks\nwhere total_plays is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.666020Z", "completed_at": "2025-11-26T00:47:42.669018Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.670680Z", "completed_at": "2025-11-26T00:47:42.670682Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0059697628021240234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect track_id\nfrom spotify_data.gold.top_tracks\nwhere track_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.667284Z", "completed_at": "2025-11-26T00:47:42.669136Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.670900Z", "completed_at": "2025-11-26T00:47:42.670903Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006051063537597656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect track_name\nfrom spotify_data.gold.top_tracks\nwhere track_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.669388Z", "completed_at": "2025-11-26T00:47:42.672392Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.672525Z", "completed_at": "2025-11-26T00:47:42.672527Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0040302276611328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.unique_top_tracks_rank.8fecde1136", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    rank as unique_field,\n    count(*) as n_records\n\nfrom spotify_data.gold.top_tracks\nwhere rank is not null\ngroup by rank\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T00:47:42.671129Z", "completed_at": "2025-11-26T00:47:42.672790Z"}, {"name": "execute", "started_at": "2025-11-26T00:47:42.672914Z", "completed_at": "2025-11-26T00:47:42.672915Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0042266845703125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.unique_top_tracks_track_id.865b43a659", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    track_id as unique_field,\n    count(*) as n_records\n\nfrom spotify_data.gold.top_tracks\nwhere track_id is not null\ngroup by track_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 2.1109321117401123, "args": {"state_modified_compare_vars": false, "macro_debugging": false, "require_generic_test_arguments_property": true, "introspect": true, "source_freshness_run_project_hooks": true, "static": false, "strict_mode": false, "use_fast_test_edges": false, "validate_macro_args": false, "show_all_deprecations": false, "use_colors": true, "defer": false, "select": [], "log_format_file": "debug", "populate_cache": true, "require_nested_cumulative_type_params": false, "profiles_dir": "/Users/sunilmakkar/.dbt", "upload_to_artifacts_ingest_api": false, "empty_catalog": false, "quiet": false, "show_resource_report": false, "send_anonymous_usage_stats": true, "log_level_file": "debug", "log_level": "info", "vars": {}, "exclude": [], "version_check": true, "indirect_selection": "eager", "skip_nodes_if_on_run_start_fails": false, "state_modified_compare_more_unrendered_values": false, "favor_state": false, "require_explicit_package_overrides_for_builtin_materializations": true, "log_path": "/Users/sunilmakkar/spotify-data-pipeline/dbt/logs", "warn_error_options": {"error": [], "warn": [], "silence": []}, "cache_selected_only": false, "print": true, "require_all_warnings_handled_by_warn_error": false, "compile": true, "use_colors_file": true, "partial_parse_file_diff": true, "static_parser": true, "invocation_command": "dbt docs generate", "require_batched_execution_for_custom_microbatch_strategy": false, "printer_width": 80, "write_json": true, "require_resource_names_without_spaces": true, "require_yaml_configuration_for_mf_time_spines": false, "log_file_max_bytes": 10485760, "project_dir": "/Users/sunilmakkar/spotify-data-pipeline/dbt", "partial_parse": true, "which": "generate", "log_format": "default"}}