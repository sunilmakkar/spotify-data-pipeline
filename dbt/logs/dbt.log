[0m19:15:24.304600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034d7e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104adb9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104adbb10>]}


============================== 19:15:24.306946 | c8bfa40c-617f-4349-9e38-94319b8c0400 ==============================
[0m19:15:24.306946 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:15:24.307192 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'printer_width': '80', 'empty': 'None', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'write_json': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'debug': 'False', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'use_experimental_parser': 'False', 'log_path': 'logs', 'use_colors': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'version_check': 'True'}
[0m19:15:24.314262 [info ] [MainThread]: dbt version: 1.10.15
[0m19:15:24.314437 [info ] [MainThread]: python version: 3.13.2
[0m19:15:24.314556 [info ] [MainThread]: python path: /Users/sunilmakkar/spotify-data-pipeline/venv/bin/python3.13
[0m19:15:24.314661 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit-Mach-O
[0m19:15:24.858287 [info ] [MainThread]: Using profiles dir at /Users/sunilmakkar/.dbt
[0m19:15:24.858506 [info ] [MainThread]: Using profiles.yml file at /Users/sunilmakkar/.dbt/profiles.yml
[0m19:15:24.858626 [info ] [MainThread]: Using dbt_project.yml file at /Users/sunilmakkar/spotify-data-pipeline/dbt/dbt_project.yml
[0m19:15:24.858759 [error] [MainThread]: Encountered an error:
Internal Error
  Profile should not be None if loading profile completed
[0m19:15:24.860115 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.5839615, "process_in_blocks": "0", "process_kernel_time": 0.155711, "process_mem_max_rss": "197836800", "process_out_blocks": "0", "process_user_time": 0.721194}
[0m19:15:24.860392 [debug] [MainThread]: Command `dbt debug` failed at 19:15:24.860353 after 0.58 seconds
[0m19:15:24.860528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b890050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b85c290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b76fce0>]}
[0m19:15:24.860674 [debug] [MainThread]: Flushing usage events
[0m19:15:25.051395 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:16:51.485484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041fbe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057ff9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057ffb10>]}


============================== 19:16:51.487950 | 54ed15d7-859b-4307-8003-b0b37a03bc9d ==============================
[0m19:16:51.487950 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:16:51.488200 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'debug': 'False', 'printer_width': '80', 'warn_error': 'None', 'target_path': 'None', 'no_print': 'None', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'empty': 'None', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs'}
[0m19:16:51.495194 [info ] [MainThread]: dbt version: 1.10.15
[0m19:16:51.495366 [info ] [MainThread]: python version: 3.13.2
[0m19:16:51.495480 [info ] [MainThread]: python path: /Users/sunilmakkar/spotify-data-pipeline/venv/bin/python3.13
[0m19:16:51.495580 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit-Mach-O
[0m19:16:52.045148 [info ] [MainThread]: Using profiles dir at /Users/sunilmakkar/.dbt
[0m19:16:52.045359 [info ] [MainThread]: Using profiles.yml file at /Users/sunilmakkar/.dbt/profiles.yml
[0m19:16:52.045479 [info ] [MainThread]: Using dbt_project.yml file at /Users/sunilmakkar/spotify-data-pipeline/dbt/dbt_project.yml
[0m19:16:52.045796 [info ] [MainThread]: adapter type: snowflake
[0m19:16:52.045905 [info ] [MainThread]: adapter version: 1.8.3
[0m19:16:52.082023 [info ] [MainThread]: Configuration:
[0m19:16:52.082241 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:16:52.082368 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:16:52.082472 [info ] [MainThread]: Required dependencies:
[0m19:16:52.082627 [debug] [MainThread]: Executing "git --help"
[0m19:16:52.097885 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:16:52.098478 [debug] [MainThread]: STDERR: "b''"
[0m19:16:52.098659 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:16:52.098810 [info ] [MainThread]: Connection:
[0m19:16:52.098938 [info ] [MainThread]:   account: uxojbrg-rm52997
[0m19:16:52.099041 [info ] [MainThread]:   user: sunni
[0m19:16:52.099142 [info ] [MainThread]:   database: spotify_data
[0m19:16:52.099237 [info ] [MainThread]:   warehouse: spotify_wh
[0m19:16:52.099342 [info ] [MainThread]:   role: accountadmin
[0m19:16:52.099435 [info ] [MainThread]:   schema: bronze
[0m19:16:52.099530 [info ] [MainThread]:   authenticator: None
[0m19:16:52.099625 [info ] [MainThread]:   oauth_client_id: None
[0m19:16:52.099717 [info ] [MainThread]:   query_tag: None
[0m19:16:52.099811 [info ] [MainThread]:   client_session_keep_alive: False
[0m19:16:52.099905 [info ] [MainThread]:   host: None
[0m19:16:52.099997 [info ] [MainThread]:   port: None
[0m19:16:52.100086 [info ] [MainThread]:   proxy_host: None
[0m19:16:52.100179 [info ] [MainThread]:   proxy_port: None
[0m19:16:52.100271 [info ] [MainThread]:   protocol: None
[0m19:16:52.100365 [info ] [MainThread]:   connect_retries: 1
[0m19:16:52.100456 [info ] [MainThread]:   connect_timeout: None
[0m19:16:52.100545 [info ] [MainThread]:   retry_on_database_errors: False
[0m19:16:52.100640 [info ] [MainThread]:   retry_all: False
[0m19:16:52.100728 [info ] [MainThread]:   insecure_mode: False
[0m19:16:52.100821 [info ] [MainThread]:   reuse_connections: None
[0m19:16:52.101110 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:16:52.146895 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m19:16:52.147396 [debug] [MainThread]: Using snowflake connection "debug"
[0m19:16:52.147520 [debug] [MainThread]: On debug: select 1 as id
[0m19:16:52.147619 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:16:53.482331 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.335 seconds
[0m19:16:53.483944 [debug] [MainThread]: On debug: Close
[0m19:16:53.694543 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:16:53.695296 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:16:53.698740 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.2405813, "process_in_blocks": "0", "process_kernel_time": 0.214003, "process_mem_max_rss": "218054656", "process_out_blocks": "0", "process_user_time": 0.892279}
[0m19:16:53.699323 [debug] [MainThread]: Command `dbt debug` succeeded at 19:16:53.699210 after 2.24 seconds
[0m19:16:53.699635 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:16:53.699931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c69a650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c66ae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c497f00>]}
[0m19:16:53.700299 [debug] [MainThread]: Flushing usage events
[0m19:16:53.882982 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:24:30.797547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11159be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d5f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d5fb10>]}


============================== 19:24:30.800005 | 7324a936-e3a0-458f-9773-b5b3fe09a954 ==============================
[0m19:24:30.800005 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:24:30.800278 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'target_path': 'None', 'warn_error': 'None', 'use_colors': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'debug': 'False', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'empty': 'False', 'no_print': 'None', 'quiet': 'False', 'partial_parse': 'True', 'log_cache_events': 'False'}
[0m19:24:31.389654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7324a936-e3a0-458f-9773-b5b3fe09a954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cb0b00>]}
[0m19:24:31.411368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7324a936-e3a0-458f-9773-b5b3fe09a954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123200e20>]}
[0m19:24:31.411831 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:24:31.460930 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:24:31.461290 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:24:31.461437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7324a936-e3a0-458f-9773-b5b3fe09a954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1231ad450>]}
[0m19:24:31.779850 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.example
[0m19:24:31.784259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7324a936-e3a0-458f-9773-b5b3fe09a954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112afcf50>]}
[0m19:24:31.804534 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m19:24:31.805826 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m19:24:31.814644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7324a936-e3a0-458f-9773-b5b3fe09a954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12650fbd0>]}
[0m19:24:31.814843 [info ] [MainThread]: Found 1 source, 489 macros
[0m19:24:31.814977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7324a936-e3a0-458f-9773-b5b3fe09a954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126218460>]}
[0m19:24:31.815825 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:24:31.816042 [debug] [MainThread]: Command end result
[0m19:24:31.824246 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m19:24:31.824883 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m19:24:31.826004 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m19:24:31.827556 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.05947, "process_in_blocks": "0", "process_kernel_time": 0.186255, "process_mem_max_rss": "210190336", "process_out_blocks": "0", "process_user_time": 1.133971}
[0m19:24:31.827742 [debug] [MainThread]: Command `dbt compile` succeeded at 19:24:31.827707 after 1.06 seconds
[0m19:24:31.827885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c55250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1265c76a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1265c7540>]}
[0m19:24:31.828011 [debug] [MainThread]: Flushing usage events
[0m19:24:32.164998 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:26:25.757869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10552fe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b33b10>]}


============================== 19:26:25.760286 | 5ad721d0-7a88-47f9-b428-ee4780feabf4 ==============================
[0m19:26:25.760286 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:26:25.760555 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt compile', 'no_print': 'None', 'write_json': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'quiet': 'False', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'indirect_selection': 'eager', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'version_check': 'True', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'printer_width': '80', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None'}
[0m19:26:26.340586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ad721d0-7a88-47f9-b428-ee4780feabf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e84b00>]}
[0m19:26:26.363538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ad721d0-7a88-47f9-b428-ee4780feabf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d828e20>]}
[0m19:26:26.364116 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:26:26.413640 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:26:26.439435 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:26:26.439679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5ad721d0-7a88-47f9-b428-ee4780feabf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d755650>]}
[0m19:26:26.759603 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.spotify_analytics.gold
- models.spotify_analytics.silver
- models.spotify_analytics.bronze
[0m19:26:26.763988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ad721d0-7a88-47f9-b428-ee4780feabf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d72af30>]}
[0m19:26:26.784234 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m19:26:26.785292 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m19:26:26.793896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ad721d0-7a88-47f9-b428-ee4780feabf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddbaa50>]}
[0m19:26:26.794078 [info ] [MainThread]: Found 1 source, 489 macros
[0m19:26:26.794207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ad721d0-7a88-47f9-b428-ee4780feabf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbff6c0>]}
[0m19:26:26.795029 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:26:26.795243 [debug] [MainThread]: Command end result
[0m19:26:26.803094 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m19:26:26.803782 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m19:26:26.804894 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m19:26:26.806204 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.076758, "process_in_blocks": "0", "process_kernel_time": 0.186535, "process_mem_max_rss": "209436672", "process_out_blocks": "0", "process_user_time": 1.16657}
[0m19:26:26.806394 [debug] [MainThread]: Command `dbt compile` succeeded at 19:26:26.806357 after 1.08 seconds
[0m19:26:26.806550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a29190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de0a200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de0a0a0>]}
[0m19:26:26.806689 [debug] [MainThread]: Flushing usage events
[0m19:26:27.134323 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:27:34.636782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bc7e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051bf9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051bfb10>]}


============================== 19:27:34.639186 | f5144faa-6fc9-43df-a1b3-752b7beadd16 ==============================
[0m19:27:34.639186 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:27:34.639442 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'printer_width': '80', 'invocation_command': 'dbt ls --resource-type source', 'fail_fast': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'target_path': 'None', 'no_print': 'None', 'version_check': 'True', 'write_json': 'True', 'empty': 'None', 'log_format': 'default', 'profiles_dir': '/Users/sunilmakkar/.dbt'}
[0m19:27:35.188529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5144faa-6fc9-43df-a1b3-752b7beadd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104510b00>]}
[0m19:27:35.210585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5144faa-6fc9-43df-a1b3-752b7beadd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be1cf30>]}
[0m19:27:35.211068 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:27:35.260714 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:27:35.296261 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:27:35.296423 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:27:35.296669 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.spotify_analytics.gold
- models.spotify_analytics.silver
- models.spotify_analytics.bronze
[0m19:27:35.302525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5144faa-6fc9-43df-a1b3-752b7beadd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bde1f50>]}
[0m19:27:35.324708 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m19:27:35.325693 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m19:27:35.333379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5144faa-6fc9-43df-a1b3-752b7beadd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdb6c60>]}
[0m19:27:35.333569 [info ] [MainThread]: Found 1 source, 489 macros
[0m19:27:35.333697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5144faa-6fc9-43df-a1b3-752b7beadd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0a3e70>]}
[0m19:27:35.334251 [info ] [MainThread]: source:spotify_analytics.bronze.plays
[0m19:27:35.335746 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.72563094, "process_in_blocks": "0", "process_kernel_time": 0.182889, "process_mem_max_rss": "205586432", "process_out_blocks": "0", "process_user_time": 0.879532}
[0m19:27:35.337354 [debug] [MainThread]: Command `dbt ls` succeeded at 19:27:35.335971 after 0.73 seconds
[0m19:27:35.337589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c37bd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050b5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c34b050>]}
[0m19:27:35.337710 [debug] [MainThread]: Flushing usage events
[0m19:27:35.626456 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:00:25.989163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aa7e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070ab9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070abb10>]}


============================== 15:00:25.991855 | 60e0ffc5-1b1f-4ac7-9933-e6d2947418a8 ==============================
[0m15:00:25.991855 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:00:25.992141 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'no_print': 'None', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'use_colors': 'True', 'partial_parse': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'empty': 'False', 'write_json': 'True', 'printer_width': '80', 'version_check': 'True', 'invocation_command': 'dbt compile --models silver_plays'}
[0m15:00:25.992356 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m15:00:25.992501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '60e0ffc5-1b1f-4ac7-9933-e6d2947418a8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070fd0f0>]}
[0m15:00:26.768123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60e0ffc5-1b1f-4ac7-9933-e6d2947418a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd9ce20>]}
[0m15:00:26.789456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60e0ffc5-1b1f-4ac7-9933-e6d2947418a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dccd050>]}
[0m15:00:26.789934 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:00:26.840006 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:00:26.877751 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:00:26.877983 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/silver/silver_plays.sql
[0m15:00:26.969145 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.spotify_analytics.gold
- models.spotify_analytics.bronze
[0m15:00:26.974705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60e0ffc5-1b1f-4ac7-9933-e6d2947418a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1467b0>]}
[0m15:00:27.002913 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m15:00:27.004288 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m15:00:27.012863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60e0ffc5-1b1f-4ac7-9933-e6d2947418a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10defe970>]}
[0m15:00:27.013046 [info ] [MainThread]: Found 1 model, 1 source, 489 macros
[0m15:00:27.013173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60e0ffc5-1b1f-4ac7-9933-e6d2947418a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e487ad0>]}
[0m15:00:27.013802 [info ] [MainThread]: 
[0m15:00:27.013942 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:00:27.014044 [info ] [MainThread]: 
[0m15:00:27.014234 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:00:27.014794 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_bronze'
[0m15:00:27.020459 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_bronze"
[0m15:00:27.020593 [debug] [ThreadPool]: On list_spotify_data_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_bronze"} */
show objects in spotify_data.bronze limit 10000
[0m15:00:27.020699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:28.648496 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.628 seconds
[0m15:00:28.651780 [debug] [ThreadPool]: On list_spotify_data_bronze: Close
[0m15:00:28.893079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60e0ffc5-1b1f-4ac7-9933-e6d2947418a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e461790>]}
[0m15:00:28.899990 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m15:00:28.900572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_bronze, now model.spotify_analytics.silver_plays)
[0m15:00:28.900957 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m15:00:28.909876 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m15:00:28.911001 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m15:00:28.911643 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m15:00:28.912544 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:00:28.912852 [debug] [MainThread]: Connection 'model.spotify_analytics.silver_plays' was properly closed.
[0m15:00:28.913401 [debug] [MainThread]: Command end result
[0m15:00:28.934736 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m15:00:28.936442 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m15:00:28.939923 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m15:00:28.940157 [info ] [MainThread]: Compiled node 'silver_plays' is:


-- ============================================================================
-- SILVER LAYER: CLEANED PLAYS DATA
-- ============================================================================
-- Purpose: Transform bronze plays data into clean, analytics-ready format
-- 
-- Transformations:
--   1. Deduplicate records (DISTINCT on event_id)
--   2. Cast all data types from VARIANT to proper types
--   3. Filter invalid records (defensive WHERE clauses)
--   4. Add processing metadata (processed_at timestamp)
--
-- Source: bronze.plays (external table reading from S3 Parquet files)
-- Target: SILVER.silver_plays (materialized table)
-- ============================================================================

WITH source_data AS (
    SELECT 
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM spotify_data.bronze.plays
),

deduplicated AS (
    SELECT DISTINCT
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM source_data
    WHERE 
        -- Data quality filters
        user_id IS NOT NULL
        AND duration_ms > 0
        AND duration_ms < 600000  -- Less than 10 minutes (catches data errors)
        AND event_id IS NOT NULL
)

SELECT 
    -- Identifiers
    event_id::VARCHAR AS event_id,
    user_id::VARCHAR AS user_id,
    event_type::VARCHAR AS event_type,
    
    -- Track information
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    duration_ms::NUMBER AS duration_ms,
    
    -- Timestamps
    TRY_CAST(played_at AS TIMESTAMP) AS played_at,
    
    -- Device context
    device_type::VARCHAR AS device_type,
    
    -- Metadata
    CURRENT_TIMESTAMP() AS processed_at
    
FROM deduplicated
[0m15:00:28.940625 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:00:28.946024 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.9871368, "process_in_blocks": "0", "process_kernel_time": 0.264011, "process_mem_max_rss": "231686144", "process_out_blocks": "0", "process_user_time": 1.135719}
[0m15:00:28.946360 [debug] [MainThread]: Command `dbt compile` succeeded at 15:00:28.946305 after 2.99 seconds
[0m15:00:28.946577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e582a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e42f1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e42d950>]}
[0m15:00:28.946775 [debug] [MainThread]: Flushing usage events
[0m15:00:29.276339 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:09:19.119013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d6be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10936f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10936fb10>]}


============================== 15:09:19.121590 | d1467bee-cc46-4e88-9ffd-6374f351f3be ==============================
[0m15:09:19.121590 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:09:19.121864 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --model silver_plays', 'empty': 'False', 'debug': 'False', 'write_json': 'True', 'introspect': 'True', 'version_check': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'printer_width': '80', 'use_colors': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'quiet': 'False', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs'}
[0m15:09:19.122070 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m15:09:19.122215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd1467bee-cc46-4e88-9ffd-6374f351f3be', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093c10f0>]}
[0m15:09:19.707366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1467bee-cc46-4e88-9ffd-6374f351f3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110060e20>]}
[0m15:09:19.729476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1467bee-cc46-4e88-9ffd-6374f351f3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff91050>]}
[0m15:09:19.730055 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:09:19.780417 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:09:19.829342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:09:19.829574 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:09:19.831724 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.spotify_analytics.gold
- models.spotify_analytics.bronze
[0m15:09:19.843434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1467bee-cc46-4e88-9ffd-6374f351f3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110409a90>]}
[0m15:09:19.873385 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m15:09:19.874823 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m15:09:19.886327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1467bee-cc46-4e88-9ffd-6374f351f3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110634bb0>]}
[0m15:09:19.886581 [info ] [MainThread]: Found 1 model, 1 source, 489 macros
[0m15:09:19.886720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1467bee-cc46-4e88-9ffd-6374f351f3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105e0a10>]}
[0m15:09:19.887368 [info ] [MainThread]: 
[0m15:09:19.887507 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:09:19.887616 [info ] [MainThread]: 
[0m15:09:19.887826 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:09:19.888194 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m15:09:19.893917 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m15:09:19.894071 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m15:09:19.894191 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:21.353852 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.459 seconds
[0m15:09:21.356578 [debug] [ThreadPool]: On list_spotify_data: Close
[0m15:09:21.624349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_bronze)
[0m15:09:21.634058 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_bronze"
[0m15:09:21.634463 [debug] [ThreadPool]: On list_spotify_data_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_bronze"} */
show objects in spotify_data.bronze limit 10000
[0m15:09:21.634717 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:22.533348 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.899 seconds
[0m15:09:22.534692 [debug] [ThreadPool]: On list_spotify_data_bronze: Close
[0m15:09:22.713754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1467bee-cc46-4e88-9ffd-6374f351f3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105cd3d0>]}
[0m15:09:22.718428 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m15:09:22.719127 [info ] [Thread-1 (]: 1 of 1 START sql table model bronze.silver_plays ............................... [RUN]
[0m15:09:22.719675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_bronze, now model.spotify_analytics.silver_plays)
[0m15:09:22.720079 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m15:09:22.730418 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m15:09:22.731525 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m15:09:22.752486 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.silver_plays"
[0m15:09:22.753906 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.silver_plays"
[0m15:09:22.754191 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.silver_plays"} */
create or replace transient table spotify_data.bronze.silver_plays
         as
        (

-- ============================================================================
-- SILVER LAYER: CLEANED PLAYS DATA
-- ============================================================================
-- Purpose: Transform bronze plays data into clean, analytics-ready format
-- 
-- Transformations:
--   1. Deduplicate records (DISTINCT on event_id)
--   2. Cast all data types from VARIANT to proper types
--   3. Filter invalid records (defensive WHERE clauses)
--   4. Add processing metadata (processed_at timestamp)
--
-- Source: bronze.plays (external table reading from S3 Parquet files)
-- Target: SILVER.silver_plays (materialized table)
-- ============================================================================

WITH source_data AS (
    SELECT 
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM spotify_data.bronze.plays
),

deduplicated AS (
    SELECT DISTINCT
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM source_data
    WHERE 
        -- Data quality filters
        user_id IS NOT NULL
        AND duration_ms > 0
        AND duration_ms < 600000  -- Less than 10 minutes (catches data errors)
        AND event_id IS NOT NULL
)

SELECT 
    -- Identifiers
    event_id::VARCHAR AS event_id,
    user_id::VARCHAR AS user_id,
    event_type::VARCHAR AS event_type,
    
    -- Track information
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    duration_ms::NUMBER AS duration_ms,
    
    -- Timestamps
    TRY_CAST(played_at AS TIMESTAMP) AS played_at,
    
    -- Device context
    device_type::VARCHAR AS device_type,
    
    -- Metadata
    CURRENT_TIMESTAMP() AS processed_at
    
FROM deduplicated
        );
[0m15:09:22.754450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:23.909998 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c0a21d-0003-f808-0000-000a68a2e1f9
[0m15:09:23.910664 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 22 at position 8
invalid identifier 'EVENT_ID'
[0m15:09:23.911289 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: Close
[0m15:09:24.076487 [debug] [Thread-1 (]: Database Error in model silver_plays (models/silver/silver_plays.sql)
  000904 (42000): SQL compilation error: error line 22 at position 8
  invalid identifier 'EVENT_ID'
  compiled code at target/run/spotify_analytics/models/silver/silver_plays.sql
[0m15:09:24.078877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1467bee-cc46-4e88-9ffd-6374f351f3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111182d00>]}
[0m15:09:24.079712 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bronze.silver_plays ...................... [[31mERROR[0m in 1.36s]
[0m15:09:24.080306 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m15:09:24.080823 [debug] [Thread-7 (]: Marking all children of 'model.spotify_analytics.silver_plays' to be skipped because of status 'error'.  Reason: Database Error in model silver_plays (models/silver/silver_plays.sql)
  000904 (42000): SQL compilation error: error line 22 at position 8
  invalid identifier 'EVENT_ID'
  compiled code at target/run/spotify_analytics/models/silver/silver_plays.sql.
[0m15:09:24.082947 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:09:24.083402 [debug] [MainThread]: Connection 'model.spotify_analytics.silver_plays' was properly closed.
[0m15:09:24.083733 [info ] [MainThread]: 
[0m15:09:24.084065 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.20 seconds (4.20s).
[0m15:09:24.084653 [debug] [MainThread]: Command end result
[0m15:09:24.101763 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m15:09:24.102863 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m15:09:24.106335 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m15:09:24.106526 [info ] [MainThread]: 
[0m15:09:24.106737 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:09:24.106906 [info ] [MainThread]: 
[0m15:09:24.107122 [error] [MainThread]: [31mFailure in model silver_plays (models/silver/silver_plays.sql)[0m
[0m15:09:24.107325 [error] [MainThread]:   Database Error in model silver_plays (models/silver/silver_plays.sql)
  000904 (42000): SQL compilation error: error line 22 at position 8
  invalid identifier 'EVENT_ID'
  compiled code at target/run/spotify_analytics/models/silver/silver_plays.sql
[0m15:09:24.107472 [info ] [MainThread]: 
[0m15:09:24.107649 [info ] [MainThread]:   compiled code at target/compiled/spotify_analytics/models/silver/silver_plays.sql
[0m15:09:24.107791 [info ] [MainThread]: 
[0m15:09:24.107949 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:09:24.108216 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:09:24.109933 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.0195, "process_in_blocks": "0", "process_kernel_time": 0.244531, "process_mem_max_rss": "232112128", "process_out_blocks": "0", "process_user_time": 1.298116}
[0m15:09:24.110236 [debug] [MainThread]: Command `dbt run` failed at 15:09:24.110179 after 5.02 seconds
[0m15:09:24.110459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111cf110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111a9eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106601d0>]}
[0m15:09:24.110658 [debug] [MainThread]: Flushing usage events
[0m15:09:24.453471 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:10:17.367095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10732be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a5f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a5fb10>]}


============================== 15:10:17.369500 | dd79577e-8ec9-4bc9-886a-59c3dfa6c62f ==============================
[0m15:10:17.369500 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:10:17.369748 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'cache_selected_only': 'False', 'empty': 'False', 'printer_width': '80', 'introspect': 'True', 'log_format': 'default', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'quiet': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'warn_error': 'None', 'debug': 'False', 'invocation_command': 'dbt run --model silver_plays', 'no_print': 'None'}
[0m15:10:17.369955 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m15:10:17.370102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dd79577e-8ec9-4bc9-886a-59c3dfa6c62f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ab10f0>]}
[0m15:10:17.948629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd79577e-8ec9-4bc9-886a-59c3dfa6c62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121500e20>]}
[0m15:10:17.970248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd79577e-8ec9-4bc9-886a-59c3dfa6c62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1214ad050>]}
[0m15:10:17.970748 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:10:18.020446 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:10:18.066068 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:10:18.066321 [debug] [MainThread]: Partial parsing: updated file: spotify_analytics://models/silver/silver_plays.sql
[0m15:10:18.149906 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.spotify_analytics.gold
- models.spotify_analytics.bronze
[0m15:10:18.155379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd79577e-8ec9-4bc9-886a-59c3dfa6c62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1218af980>]}
[0m15:10:18.183282 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m15:10:18.184370 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m15:10:18.194216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd79577e-8ec9-4bc9-886a-59c3dfa6c62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219f6970>]}
[0m15:10:18.194415 [info ] [MainThread]: Found 1 model, 1 source, 489 macros
[0m15:10:18.194547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd79577e-8ec9-4bc9-886a-59c3dfa6c62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121b86820>]}
[0m15:10:18.195138 [info ] [MainThread]: 
[0m15:10:18.195269 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:10:18.195372 [info ] [MainThread]: 
[0m15:10:18.195567 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:10:18.195889 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m15:10:18.200602 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m15:10:18.200721 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m15:10:18.200852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:19.326182 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.125 seconds
[0m15:10:19.330039 [debug] [ThreadPool]: On list_spotify_data: Close
[0m15:10:19.485682 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_bronze)
[0m15:10:19.496210 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_bronze"
[0m15:10:19.496599 [debug] [ThreadPool]: On list_spotify_data_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_bronze"} */
show objects in spotify_data.bronze limit 10000
[0m15:10:19.496853 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:10:20.209969 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.713 seconds
[0m15:10:20.214065 [debug] [ThreadPool]: On list_spotify_data_bronze: Close
[0m15:10:20.411208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd79577e-8ec9-4bc9-886a-59c3dfa6c62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121bc34d0>]}
[0m15:10:20.415470 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m15:10:20.416206 [info ] [Thread-1 (]: 1 of 1 START sql table model bronze.silver_plays ............................... [RUN]
[0m15:10:20.416715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_bronze, now model.spotify_analytics.silver_plays)
[0m15:10:20.417084 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m15:10:20.425003 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m15:10:20.425929 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m15:10:20.445781 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.silver_plays"
[0m15:10:20.446970 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.silver_plays"
[0m15:10:20.447244 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.silver_plays"} */
create or replace transient table spotify_data.bronze.silver_plays
         as
        (

-- ============================================================================
-- SILVER LAYER: CLEANED PLAYS DATA
-- ============================================================================
-- Purpose: Transform bronze plays data into clean, analytics-ready format
-- 
-- Transformations:
--   1. Deduplicate records (DISTINCT on event_id)
--   2. Cast all data types from VARIANT to proper types
--   3. Filter invalid records (defensive WHERE clauses)
--   4. Add processing metadata (processed_at timestamp)
--
-- Source: bronze.plays (external table reading from S3 Parquet files)
-- Target: SILVER.silver_plays (materialized table)
-- ============================================================================

WITH source_data AS (
    SELECT 
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM spotify_data.bronze.plays
),

deduplicated AS (
    SELECT DISTINCT
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM source_data
    WHERE 
        -- Data quality filters
        user_id IS NOT NULL
        AND duration_ms > 0
        AND duration_ms < 600000  -- Less than 10 minutes (catches data errors)
        AND event_id IS NOT NULL
)

SELECT 
    -- Identifiers
    event_id::VARCHAR AS event_id,
    user_id::VARCHAR AS user_id,
    event_type::VARCHAR AS event_type,
    
    -- Track information
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    duration_ms::NUMBER AS duration_ms,
    
    -- Timestamps
    TRY_CAST(played_at AS TIMESTAMP) AS played_at,
    
    -- Device context
    device_type::VARCHAR AS device_type,
    
    -- Metadata
    CURRENT_TIMESTAMP() AS processed_at
    
FROM deduplicated;
[0m15:10:20.447500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:21.305752 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c0a21e-0003-f25b-0000-000a68a24a0d
[0m15:10:21.306324 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 80 at position 17 unexpected ';'.
[0m15:10:21.306805 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: Close
[0m15:10:21.509742 [debug] [Thread-1 (]: Database Error in model silver_plays (models/silver/silver_plays.sql)
  001003 (42000): SQL compilation error:
  syntax error line 80 at position 17 unexpected ';'.
  compiled code at target/run/spotify_analytics/models/silver/silver_plays.sql
[0m15:10:21.512369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd79577e-8ec9-4bc9-886a-59c3dfa6c62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12465b750>]}
[0m15:10:21.513333 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bronze.silver_plays ...................... [[31mERROR[0m in 1.09s]
[0m15:10:21.513937 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m15:10:21.514509 [debug] [Thread-7 (]: Marking all children of 'model.spotify_analytics.silver_plays' to be skipped because of status 'error'.  Reason: Database Error in model silver_plays (models/silver/silver_plays.sql)
  001003 (42000): SQL compilation error:
  syntax error line 80 at position 17 unexpected ';'.
  compiled code at target/run/spotify_analytics/models/silver/silver_plays.sql.
[0m15:10:21.516622 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:10:21.516964 [debug] [MainThread]: Connection 'model.spotify_analytics.silver_plays' was properly closed.
[0m15:10:21.517258 [info ] [MainThread]: 
[0m15:10:21.517578 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.32 seconds (3.32s).
[0m15:10:21.518252 [debug] [MainThread]: Command end result
[0m15:10:21.535231 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m15:10:21.536698 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m15:10:21.540514 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m15:10:21.540713 [info ] [MainThread]: 
[0m15:10:21.540932 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:10:21.541106 [info ] [MainThread]: 
[0m15:10:21.541322 [error] [MainThread]: [31mFailure in model silver_plays (models/silver/silver_plays.sql)[0m
[0m15:10:21.541526 [error] [MainThread]:   Database Error in model silver_plays (models/silver/silver_plays.sql)
  001003 (42000): SQL compilation error:
  syntax error line 80 at position 17 unexpected ';'.
  compiled code at target/run/spotify_analytics/models/silver/silver_plays.sql
[0m15:10:21.541678 [info ] [MainThread]: 
[0m15:10:21.541856 [info ] [MainThread]:   compiled code at target/compiled/spotify_analytics/models/silver/silver_plays.sql
[0m15:10:21.542007 [info ] [MainThread]: 
[0m15:10:21.542176 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:10:21.542465 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:10:21.544134 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.204743, "process_in_blocks": "0", "process_kernel_time": 0.244269, "process_mem_max_rss": "229720064", "process_out_blocks": "0", "process_user_time": 1.371367}
[0m15:10:21.544398 [debug] [MainThread]: Command `dbt run` failed at 15:10:21.544349 after 4.21 seconds
[0m15:10:21.544600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124611a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12469b530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121a66ed0>]}
[0m15:10:21.544787 [debug] [MainThread]: Flushing usage events
[0m15:10:21.775944 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:14:35.809204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11953be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ac5f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ac5fb10>]}


============================== 15:14:35.811568 | 328dfda1-d7fb-4b30-baf1-bc3229ae8d4c ==============================
[0m15:14:35.811568 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:14:35.811809 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --model silver_plays', 'warn_error': 'None', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'introspect': 'True', 'printer_width': '80', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'log_format': 'default', 'no_print': 'None', 'empty': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'write_json': 'True', 'target_path': 'None', 'version_check': 'True'}
[0m15:14:35.811997 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m15:14:35.812138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '328dfda1-d7fb-4b30-baf1-bc3229ae8d4c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11acb10f0>]}
[0m15:14:36.390988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '328dfda1-d7fb-4b30-baf1-bc3229ae8d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bd00e20>]}
[0m15:14:36.412072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '328dfda1-d7fb-4b30-baf1-bc3229ae8d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bcad050>]}
[0m15:14:36.412529 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:14:36.461564 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:14:36.507119 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:14:36.507371 [debug] [MainThread]: Partial parsing: updated file: spotify_analytics://models/silver/silver_plays.sql
[0m15:14:36.594606 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.spotify_analytics.bronze
- models.spotify_analytics.gold
[0m15:14:36.600215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '328dfda1-d7fb-4b30-baf1-bc3229ae8d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c2af980>]}
[0m15:14:36.628295 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m15:14:36.629405 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m15:14:36.638845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '328dfda1-d7fb-4b30-baf1-bc3229ae8d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c3fa970>]}
[0m15:14:36.639030 [info ] [MainThread]: Found 1 model, 1 source, 489 macros
[0m15:14:36.639155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '328dfda1-d7fb-4b30-baf1-bc3229ae8d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c586820>]}
[0m15:14:36.639747 [info ] [MainThread]: 
[0m15:14:36.639876 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:14:36.639983 [info ] [MainThread]: 
[0m15:14:36.640176 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:14:36.640493 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m15:14:36.645282 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m15:14:36.645427 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m15:14:36.645540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:38.082919 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.437 seconds
[0m15:14:38.086644 [debug] [ThreadPool]: On list_spotify_data: Close
[0m15:14:38.289404 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_bronze)
[0m15:14:38.301487 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_bronze"
[0m15:14:38.302010 [debug] [ThreadPool]: On list_spotify_data_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_bronze"} */
show objects in spotify_data.bronze limit 10000
[0m15:14:38.302312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:39.457507 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.155 seconds
[0m15:14:39.461009 [debug] [ThreadPool]: On list_spotify_data_bronze: Close
[0m15:14:39.658761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '328dfda1-d7fb-4b30-baf1-bc3229ae8d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c5c3290>]}
[0m15:14:39.666424 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m15:14:39.667399 [info ] [Thread-1 (]: 1 of 1 START sql table model bronze.silver_plays ............................... [RUN]
[0m15:14:39.668098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_bronze, now model.spotify_analytics.silver_plays)
[0m15:14:39.668530 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m15:14:39.677557 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m15:14:39.679027 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m15:14:39.699272 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.silver_plays"
[0m15:14:39.700593 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.silver_plays"
[0m15:14:39.700915 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.silver_plays"} */
create or replace transient table spotify_data.bronze.silver_plays
         as
        (

-- ============================================================================
-- SILVER LAYER: CLEANED PLAYS DATA
-- ============================================================================
-- Purpose: Transform bronze plays data into clean, analytics-ready format
-- 
-- Transformations:
--   1. Deduplicate records (DISTINCT on event_id)
--   2. Cast all data types from VARIANT to proper types
--   3. Filter invalid records (defensive WHERE clauses)
--   4. Add processing metadata (processed_at timestamp)
--
-- Source: bronze.plays (external table reading from S3 Parquet files)
-- Target: SILVER.silver_plays (materialized table)
-- ============================================================================

WITH source_data AS (
    SELECT 
        VALUE:event_id::VARCHAR AS event_id,
        VALUE:user_id::VARCHAR AS user_id,
        VALUE:event_type::VARCHAR AS event_type,
        VALUE:track_id::VARCHAR AS track_id,
        VALUE:track_name::VARCHAR AS track_name,
        VALUE:artist_name::VARCHAR AS artist_name,
        VALUE:album_name::VARCHAR AS album_name,
        VALUE:duration_ms::NUMBER AS duration_ms,
        VALUE:played_at::VARCHAR AS played_at,
        VALUE:device_type::VARCHAR AS device_type
    FROM spotify_data.bronze.plays
),

deduplicated AS (
    SELECT DISTINCT
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM source_data
    WHERE 
        -- Data quality filters
        user_id IS NOT NULL
        AND duration_ms > 0
        AND duration_ms < 600000  -- Less than 10 minutes (catches data errors)
        AND event_id IS NOT NULL
)

SELECT 
    -- Identifiers
    event_id::VARCHAR AS event_id,
    user_id::VARCHAR AS user_id,
    event_type::VARCHAR AS event_type,
    
    -- Track information
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    duration_ms::NUMBER AS duration_ms,
    
    -- Timestamps
    TRY_CAST(played_at AS TIMESTAMP) AS played_at,
    
    -- Device context
    device_type::VARCHAR AS device_type,
    
    -- Metadata
    CURRENT_TIMESTAMP() AS processed_at
    
FROM deduplicated
        );
[0m15:14:39.701178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:41.871474 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.170 seconds
[0m15:14:41.897488 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: Close
[0m15:14:42.087947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '328dfda1-d7fb-4b30-baf1-bc3229ae8d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13685b750>]}
[0m15:14:42.089111 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bronze.silver_plays .......................... [[32mSUCCESS 1[0m in 2.42s]
[0m15:14:42.089805 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m15:14:42.091522 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:42.091854 [debug] [MainThread]: Connection 'model.spotify_analytics.silver_plays' was properly closed.
[0m15:14:42.092181 [info ] [MainThread]: 
[0m15:14:42.092539 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.45 seconds (5.45s).
[0m15:14:42.093235 [debug] [MainThread]: Command end result
[0m15:14:42.114556 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m15:14:42.115805 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m15:14:42.119777 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m15:14:42.119968 [info ] [MainThread]: 
[0m15:14:42.120187 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:14:42.120347 [info ] [MainThread]: 
[0m15:14:42.120529 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:14:42.120822 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:14:42.122585 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.341585, "process_in_blocks": "0", "process_kernel_time": 0.245109, "process_mem_max_rss": "235831296", "process_out_blocks": "0", "process_user_time": 1.354246}
[0m15:14:42.122856 [debug] [MainThread]: Command `dbt run` succeeded at 15:14:42.122805 after 6.34 seconds
[0m15:14:42.123066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136811b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13689acc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c466ed0>]}
[0m15:14:42.123260 [debug] [MainThread]: Flushing usage events
[0m15:14:42.610233 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:27:06.761750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12062be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123d5f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123d5fb10>]}


============================== 15:27:06.764338 | 7aaded93-23e5-4f60-9f11-d02097ad310f ==============================
[0m15:27:06.764338 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:27:06.764599 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'write_json': 'True', 'log_format': 'default', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select silver_plays --full-refresh', 'debug': 'False', 'cache_selected_only': 'False', 'quiet': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'printer_width': '80', 'partial_parse': 'True', 'use_colors': 'True', 'empty': 'False'}
[0m15:27:07.626664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7aaded93-23e5-4f60-9f11-d02097ad310f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1211b0b00>]}
[0m15:27:07.652692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7aaded93-23e5-4f60-9f11-d02097ad310f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134904e20>]}
[0m15:27:07.653243 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:27:07.711239 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:27:07.744273 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:27:07.744515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7aaded93-23e5-4f60-9f11-d02097ad310f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1348ae350>]}
[0m15:27:08.147132 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.spotify_analytics.bronze
- models.spotify_analytics.gold
[0m15:27:08.152401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7aaded93-23e5-4f60-9f11-d02097ad310f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134882f30>]}
[0m15:27:08.179593 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m15:27:08.180791 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m15:27:08.191590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7aaded93-23e5-4f60-9f11-d02097ad310f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13baa5710>]}
[0m15:27:08.191807 [info ] [MainThread]: Found 1 model, 1 source, 489 macros
[0m15:27:08.191940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7aaded93-23e5-4f60-9f11-d02097ad310f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b84bad0>]}
[0m15:27:08.192542 [info ] [MainThread]: 
[0m15:27:08.192678 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:27:08.192781 [info ] [MainThread]: 
[0m15:27:08.192987 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:27:08.193347 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m15:27:08.198979 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m15:27:08.199162 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m15:27:08.199272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:27:10.168761 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.969 seconds
[0m15:27:10.171452 [debug] [ThreadPool]: On list_spotify_data: Close
[0m15:27:10.420362 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now create_spotify_data_bronze_silver)
[0m15:27:10.420899 [debug] [ThreadPool]: Creating schema "database: "spotify_data"
schema: "bronze_silver"
"
[0m15:27:10.426819 [debug] [ThreadPool]: Using snowflake connection "create_spotify_data_bronze_silver"
[0m15:27:10.427218 [debug] [ThreadPool]: On create_spotify_data_bronze_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "create_spotify_data_bronze_silver"} */
create schema if not exists spotify_data.bronze_silver
[0m15:27:10.427451 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:27:11.406118 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.978 seconds
[0m15:27:11.408164 [debug] [ThreadPool]: On create_spotify_data_bronze_silver: Close
[0m15:27:11.746885 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_spotify_data_bronze_silver, now list_spotify_data_bronze_silver)
[0m15:27:11.757563 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_bronze_silver"
[0m15:27:11.758071 [debug] [ThreadPool]: On list_spotify_data_bronze_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_bronze_silver"} */
show objects in spotify_data.bronze_silver limit 10000
[0m15:27:11.758338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:27:12.971266 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.213 seconds
[0m15:27:12.974198 [debug] [ThreadPool]: On list_spotify_data_bronze_silver: Close
[0m15:27:13.175965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7aaded93-23e5-4f60-9f11-d02097ad310f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13babe090>]}
[0m15:27:13.181013 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m15:27:13.181775 [info ] [Thread-1 (]: 1 of 1 START sql table model bronze_silver.silver_plays ........................ [RUN]
[0m15:27:13.182290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_bronze_silver, now model.spotify_analytics.silver_plays)
[0m15:27:13.182701 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m15:27:13.191298 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m15:27:13.192162 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m15:27:13.212768 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.silver_plays"
[0m15:27:13.214444 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.silver_plays"
[0m15:27:13.214754 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.silver_plays"} */
create or replace transient table spotify_data.bronze_silver.silver_plays
         as
        (

-- ============================================================================
-- SILVER LAYER: CLEANED PLAYS DATA
-- ============================================================================
-- Purpose: Transform bronze plays data into clean, analytics-ready format
-- 
-- Transformations:
--   1. Deduplicate records (DISTINCT on event_id)
--   2. Cast all data types from VARIANT to proper types
--   3. Filter invalid records (defensive WHERE clauses)
--   4. Add processing metadata (processed_at timestamp)
--
-- Source: bronze.plays (external table reading from S3 Parquet files)
-- Target: SILVER.silver_plays (materialized table)
-- ============================================================================

WITH source_data AS (
    SELECT 
        VALUE:event_id::VARCHAR AS event_id,
        VALUE:user_id::VARCHAR AS user_id,
        VALUE:event_type::VARCHAR AS event_type,
        VALUE:track_id::VARCHAR AS track_id,
        VALUE:track_name::VARCHAR AS track_name,
        VALUE:artist_name::VARCHAR AS artist_name,
        VALUE:album_name::VARCHAR AS album_name,
        VALUE:duration_ms::NUMBER AS duration_ms,
        VALUE:played_at::VARCHAR AS played_at,
        VALUE:device_type::VARCHAR AS device_type
    FROM spotify_data.bronze.plays
),

deduplicated AS (
    SELECT DISTINCT
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM source_data
    WHERE 
        -- Data quality filters
        user_id IS NOT NULL
        AND duration_ms > 0
        AND duration_ms < 600000  -- Less than 10 minutes (catches data errors)
        AND event_id IS NOT NULL
)

SELECT 
    -- Identifiers
    event_id::VARCHAR AS event_id,
    user_id::VARCHAR AS user_id,
    event_type::VARCHAR AS event_type,
    
    -- Track information
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    duration_ms::NUMBER AS duration_ms,
    
    -- Timestamps
    TRY_CAST(played_at AS TIMESTAMP) AS played_at,
    
    -- Device context
    device_type::VARCHAR AS device_type,
    
    -- Metadata
    CURRENT_TIMESTAMP() AS processed_at
    
FROM deduplicated
        );
[0m15:27:13.215018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:18.467946 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.253 seconds
[0m15:27:18.493604 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: Close
[0m15:27:18.640492 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7aaded93-23e5-4f60-9f11-d02097ad310f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c815650>]}
[0m15:27:18.641690 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bronze_silver.silver_plays ................... [[32mSUCCESS 1[0m in 5.46s]
[0m15:27:18.642375 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m15:27:18.644165 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:27:18.644566 [debug] [MainThread]: Connection 'model.spotify_analytics.silver_plays' was properly closed.
[0m15:27:18.644925 [info ] [MainThread]: 
[0m15:27:18.645308 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.45 seconds (10.45s).
[0m15:27:18.646024 [debug] [MainThread]: Command end result
[0m15:27:18.664591 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m15:27:18.665951 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m15:27:18.669855 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m15:27:18.670070 [info ] [MainThread]: 
[0m15:27:18.670331 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:27:18.670505 [info ] [MainThread]: 
[0m15:27:18.670697 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:27:18.678931 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.946632, "process_in_blocks": "0", "process_kernel_time": 0.316527, "process_mem_max_rss": "232931328", "process_out_blocks": "0", "process_user_time": 1.823138}
[0m15:27:18.679324 [debug] [MainThread]: Command `dbt run` succeeded at 15:27:18.679259 after 11.95 seconds
[0m15:27:18.679578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e4b6ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bd784d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bda3c50>]}
[0m15:27:18.679821 [debug] [MainThread]: Flushing usage events
[0m15:27:18.970407 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:32:14.922057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10778fe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d939d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d93b10>]}


============================== 15:32:14.924803 | b9765a52-897c-4967-a05a-34df80d59785 ==============================
[0m15:32:14.924803 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:32:14.925072 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'invocation_command': 'dbt run --select silver_plays --full-refresh', 'warn_error': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'static_parser': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'partial_parse': 'True', 'fail_fast': 'False', 'write_json': 'True', 'printer_width': '80', 'version_check': 'True', 'no_print': 'None', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'target_path': 'None', 'debug': 'False'}
[0m15:32:15.503430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9765a52-897c-4967-a05a-34df80d59785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080e4b00>]}
[0m15:32:15.526086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9765a52-897c-4967-a05a-34df80d59785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa84e20>]}
[0m15:32:15.526681 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:32:15.576901 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:32:15.626444 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:32:15.626695 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://macros/get_custom_schema.sql
[0m15:32:15.627575 [info ] [MainThread]: Unable to do partial parsing because change detected to override macro. Starting full parse.
[0m15:32:15.998547 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.spotify_analytics.gold
- models.spotify_analytics.bronze
[0m15:32:16.003254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9765a52-897c-4967-a05a-34df80d59785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff2a850>]}
[0m15:32:16.029950 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m15:32:16.031860 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m15:32:16.042392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9765a52-897c-4967-a05a-34df80d59785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10862ed50>]}
[0m15:32:16.042596 [info ] [MainThread]: Found 1 model, 1 source, 490 macros
[0m15:32:16.042727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9765a52-897c-4967-a05a-34df80d59785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11009bbd0>]}
[0m15:32:16.043334 [info ] [MainThread]: 
[0m15:32:16.043469 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:32:16.043570 [info ] [MainThread]: 
[0m15:32:16.043765 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:32:16.044090 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m15:32:16.048809 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m15:32:16.048936 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m15:32:16.049041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:32:17.669698 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.620 seconds
[0m15:32:17.673287 [debug] [ThreadPool]: On list_spotify_data: Close
[0m15:32:17.878819 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_silver)
[0m15:32:17.891520 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m15:32:17.892055 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m15:32:17.892324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:32:18.864232 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.972 seconds
[0m15:32:18.867286 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m15:32:19.065711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9765a52-897c-4967-a05a-34df80d59785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe417e0>]}
[0m15:32:19.073219 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m15:32:19.074236 [info ] [Thread-1 (]: 1 of 1 START sql table model silver.silver_plays ............................... [RUN]
[0m15:32:19.075302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.silver_plays)
[0m15:32:19.075803 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m15:32:19.084829 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m15:32:19.085952 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m15:32:19.105133 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.silver_plays"
[0m15:32:19.106689 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.silver_plays"
[0m15:32:19.107004 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.silver_plays"} */
create or replace transient table spotify_data.silver.silver_plays
         as
        (

-- ============================================================================
-- SILVER LAYER: CLEANED PLAYS DATA
-- ============================================================================
-- Purpose: Transform bronze plays data into clean, analytics-ready format
-- 
-- Transformations:
--   1. Deduplicate records (DISTINCT on event_id)
--   2. Cast all data types from VARIANT to proper types
--   3. Filter invalid records (defensive WHERE clauses)
--   4. Add processing metadata (processed_at timestamp)
--
-- Source: bronze.plays (external table reading from S3 Parquet files)
-- Target: SILVER.silver_plays (materialized table)
-- ============================================================================

WITH source_data AS (
    SELECT 
        VALUE:event_id::VARCHAR AS event_id,
        VALUE:user_id::VARCHAR AS user_id,
        VALUE:event_type::VARCHAR AS event_type,
        VALUE:track_id::VARCHAR AS track_id,
        VALUE:track_name::VARCHAR AS track_name,
        VALUE:artist_name::VARCHAR AS artist_name,
        VALUE:album_name::VARCHAR AS album_name,
        VALUE:duration_ms::NUMBER AS duration_ms,
        VALUE:played_at::VARCHAR AS played_at,
        VALUE:device_type::VARCHAR AS device_type
    FROM spotify_data.bronze.plays
),

deduplicated AS (
    SELECT DISTINCT
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM source_data
    WHERE 
        -- Data quality filters
        user_id IS NOT NULL
        AND duration_ms > 0
        AND duration_ms < 600000  -- Less than 10 minutes (catches data errors)
        AND event_id IS NOT NULL
)

SELECT 
    -- Identifiers
    event_id::VARCHAR AS event_id,
    user_id::VARCHAR AS user_id,
    event_type::VARCHAR AS event_type,
    
    -- Track information
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    duration_ms::NUMBER AS duration_ms,
    
    -- Timestamps
    TRY_CAST(played_at AS TIMESTAMP) AS played_at,
    
    -- Device context
    device_type::VARCHAR AS device_type,
    
    -- Metadata
    CURRENT_TIMESTAMP() AS processed_at
    
FROM deduplicated
        );
[0m15:32:19.107260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:21.646482 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.539 seconds
[0m15:32:21.673357 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: Close
[0m15:32:21.872351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9765a52-897c-4967-a05a-34df80d59785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c02810>]}
[0m15:32:21.873552 [info ] [Thread-1 (]: 1 of 1 OK created sql table model silver.silver_plays .......................... [[32mSUCCESS 1[0m in 2.79s]
[0m15:32:21.874402 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m15:32:21.876298 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:32:21.876663 [debug] [MainThread]: Connection 'model.spotify_analytics.silver_plays' was properly closed.
[0m15:32:21.877016 [info ] [MainThread]: 
[0m15:32:21.877369 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.83 seconds (5.83s).
[0m15:32:21.878115 [debug] [MainThread]: Command end result
[0m15:32:21.904955 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m15:32:21.906050 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m15:32:21.909438 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m15:32:21.909641 [info ] [MainThread]: 
[0m15:32:21.909861 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:32:21.910018 [info ] [MainThread]: 
[0m15:32:21.910190 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:32:21.911980 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.025306, "process_in_blocks": "0", "process_kernel_time": 0.245611, "process_mem_max_rss": "234029056", "process_out_blocks": "0", "process_user_time": 1.682296}
[0m15:32:21.912260 [debug] [MainThread]: Command `dbt run` succeeded at 15:32:21.912211 after 7.03 seconds
[0m15:32:21.912470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe876a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cbf750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cbf4d0>]}
[0m15:32:21.912659 [debug] [MainThread]: Flushing usage events
[0m15:32:22.230175 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:46:38.910085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a3be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10615f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10615fb10>]}


============================== 15:46:38.912496 | ecc14b3f-5aee-495a-a434-ac763793b202 ==============================
[0m15:46:38.912496 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:46:38.912770 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt deps', 'warn_error': 'None', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'empty': 'None', 'no_print': 'None', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'target_path': 'None', 'quiet': 'False', 'write_json': 'True', 'log_format': 'default', 'printer_width': '80', 'debug': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'fail_fast': 'False', 'version_check': 'True', 'static_parser': 'True'}
[0m15:46:38.965659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecc14b3f-5aee-495a-a434-ac763793b202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051b0b00>]}
[0m15:46:38.975964 [debug] [MainThread]: Set downloads directory='/var/folders/vr/_xk0ypp143s2xjdd73dqc2zh0000gn/T/dbt-downloads-5c34n665'
[0m15:46:38.976183 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:46:39.166575 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:46:39.168155 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:46:39.280734 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:46:39.295930 [info ] [MainThread]: Updating lock file in file path: /Users/sunilmakkar/spotify-data-pipeline/dbt/package-lock.yml
[0m15:46:39.298291 [debug] [MainThread]: Set downloads directory='/var/folders/vr/_xk0ypp143s2xjdd73dqc2zh0000gn/T/dbt-downloads-f4geusuv'
[0m15:46:39.301171 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:46:39.686759 [info ] [MainThread]: Installed from version 1.1.1
[0m15:46:39.687034 [info ] [MainThread]: Updated version available: 1.3.2
[0m15:46:39.687235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ecc14b3f-5aee-495a-a434-ac763793b202', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10600abe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10600a250>]}
[0m15:46:39.687444 [info ] [MainThread]: 
[0m15:46:39.687596 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m15:46:39.689133 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.80638987, "process_in_blocks": "0", "process_kernel_time": 0.129146, "process_mem_max_rss": "114966528", "process_out_blocks": "0", "process_user_time": 0.607985}
[0m15:46:39.689393 [debug] [MainThread]: Command `dbt deps` succeeded at 15:46:39.689338 after 0.81 seconds
[0m15:46:39.689576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106352650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106000f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106001220>]}
[0m15:46:39.689744 [debug] [MainThread]: Flushing usage events
[0m15:46:40.013257 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:47:39.799417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107297e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10888f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10888fb10>]}


============================== 15:47:39.801998 | 550c5d4d-da30-4f11-b1ae-99643a14b8c2 ==============================
[0m15:47:39.801998 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:47:39.802261 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'no_print': 'None', 'version_check': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'warn_error': 'None', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'quiet': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'invocation_command': 'dbt test --select silver_plays', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'static_parser': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'debug': 'False'}
[0m15:47:40.504472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '550c5d4d-da30-4f11-b1ae-99643a14b8c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be0b00>]}
[0m15:47:40.528467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '550c5d4d-da30-4f11-b1ae-99643a14b8c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f584e20>]}
[0m15:47:40.529104 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:47:40.585952 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:47:40.621413 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m15:47:40.621689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '550c5d4d-da30-4f11-b1ae-99643a14b8c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4b6650>]}
[0m15:47:41.115065 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.accepted_range`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m15:47:41.115369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '550c5d4d-da30-4f11-b1ae-99643a14b8c2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f91f4d0>]}
[0m15:47:41.172425 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.spotify_analytics.gold
- models.spotify_analytics.bronze
[0m15:47:41.176418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '550c5d4d-da30-4f11-b1ae-99643a14b8c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc52f90>]}
[0m15:47:41.213909 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m15:47:41.215292 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m15:47:41.231054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '550c5d4d-da30-4f11-b1ae-99643a14b8c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10febf860>]}
[0m15:47:41.231322 [info ] [MainThread]: Found 1 model, 11 data tests, 1 source, 604 macros
[0m15:47:41.231464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '550c5d4d-da30-4f11-b1ae-99643a14b8c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe40e90>]}
[0m15:47:41.232338 [info ] [MainThread]: 
[0m15:47:41.232481 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:47:41.232583 [info ] [MainThread]: 
[0m15:47:41.232785 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:47:41.233179 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m15:47:41.239953 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m15:47:41.240159 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m15:47:41.240275 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:42.603766 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.363 seconds
[0m15:47:42.606191 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m15:47:42.889073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '550c5d4d-da30-4f11-b1ae-99643a14b8c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe8cb50>]}
[0m15:47:42.892135 [debug] [Thread-1 (]: Began running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m15:47:42.892505 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m15:47:42.892790 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m15:47:42.893076 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m15:47:42.893443 [info ] [Thread-1 (]: 1 of 11 START test dbt_utils_accepted_range_silver_plays_duration_ms__600000__1  [RUN]
[0m15:47:42.893795 [info ] [Thread-4 (]: 4 of 11 START test not_null_silver_plays_event_id .............................. [RUN]
[0m15:47:42.894118 [info ] [Thread-3 (]: 3 of 11 START test not_null_silver_plays_duration_ms ........................... [RUN]
[0m15:47:42.894426 [info ] [Thread-2 (]: 2 of 11 START test not_null_silver_plays_artist_name ........................... [RUN]
[0m15:47:42.894859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39)
[0m15:47:42.895253 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd'
[0m15:47:42.895621 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076'
[0m15:47:42.896012 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad'
[0m15:47:42.896528 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m15:47:42.897104 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m15:47:42.897487 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m15:47:42.897687 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m15:47:42.906451 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m15:47:42.912582 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m15:47:42.915233 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m15:47:42.917105 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m15:47:42.917915 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m15:47:42.918166 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m15:47:42.918363 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m15:47:42.924858 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m15:47:42.933376 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m15:47:42.934736 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m15:47:42.936404 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m15:47:42.937442 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m15:47:42.938659 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m15:47:42.939007 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m15:47:42.939322 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m15:47:42.939664 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m15:47:42.939915 [debug] [Thread-1 (]: On test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from spotify_data.silver.silver_plays
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not duration_ms >= 1
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not duration_ms <= 600000
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m15:47:42.940192 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from spotify_data.silver.silver_plays
where event_id is null



  
  
      
    ) dbt_internal_test
[0m15:47:42.940411 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select duration_ms
from spotify_data.silver.silver_plays
where duration_ms is null



  
  
      
    ) dbt_internal_test
[0m15:47:42.940634 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select artist_name
from spotify_data.silver.silver_plays
where artist_name is null



  
  
      
    ) dbt_internal_test
[0m15:47:42.940820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:42.940985 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:47:42.941148 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:47:42.941299 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:47:44.173227 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.231 seconds
[0m15:47:44.186722 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd: Close
[0m15:47:44.188466 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.248 seconds
[0m15:47:44.191211 [debug] [Thread-1 (]: On test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39: Close
[0m15:47:44.192658 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.251 seconds
[0m15:47:44.194138 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076: Close
[0m15:47:44.384050 [info ] [Thread-1 (]: 1 of 11 PASS dbt_utils_accepted_range_silver_plays_duration_ms__600000__1 ...... [[32mPASS[0m in 1.49s]
[0m15:47:44.384748 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m15:47:44.385127 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m15:47:44.385527 [info ] [Thread-1 (]: 5 of 11 START test not_null_silver_plays_event_type ............................ [RUN]
[0m15:47:44.385938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39, now test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa)
[0m15:47:44.386257 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m15:47:44.391794 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m15:47:44.393056 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m15:47:44.400365 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m15:47:44.402356 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m15:47:44.402576 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_type
from spotify_data.silver.silver_plays
where event_type is null



  
  
      
    ) dbt_internal_test
[0m15:47:44.402755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:44.403203 [info ] [Thread-3 (]: 3 of 11 PASS not_null_silver_plays_duration_ms ................................. [[32mPASS[0m in 1.51s]
[0m15:47:44.404087 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m15:47:44.404505 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m15:47:44.405014 [info ] [Thread-3 (]: 6 of 11 START test not_null_silver_plays_played_at ............................. [RUN]
[0m15:47:44.405563 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076, now test.spotify_analytics.not_null_silver_plays_played_at.8281565f95)
[0m15:47:44.405851 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m15:47:44.409655 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m15:47:44.410673 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m15:47:44.412393 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m15:47:44.416661 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m15:47:44.418204 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_played_at.8281565f95: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select played_at
from spotify_data.silver.silver_plays
where played_at is null



  
  
      
    ) dbt_internal_test
[0m15:47:44.418500 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:47:44.424311 [info ] [Thread-4 (]: 4 of 11 PASS not_null_silver_plays_event_id .................................... [[32mPASS[0m in 1.53s]
[0m15:47:44.425468 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m15:47:44.425766 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m15:47:44.426044 [info ] [Thread-4 (]: 7 of 11 START test not_null_silver_plays_processed_at .......................... [RUN]
[0m15:47:44.426419 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd, now test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed)
[0m15:47:44.426640 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m15:47:44.429623 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m15:47:44.436580 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m15:47:44.440668 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m15:47:44.531599 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m15:47:44.532051 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select processed_at
from spotify_data.silver.silver_plays
where processed_at is null



  
  
      
    ) dbt_internal_test
[0m15:47:44.532441 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:47:45.231015 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.812 seconds
[0m15:47:45.234259 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_played_at.8281565f95: Close
[0m15:47:45.286636 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.884 seconds
[0m15:47:45.289704 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa: Close
[0m15:47:45.305386 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.773 seconds
[0m15:47:45.308550 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed: Close
[0m15:47:45.367430 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.426 seconds
[0m15:47:45.370166 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad: Close
[0m15:47:45.386899 [info ] [Thread-3 (]: 6 of 11 PASS not_null_silver_plays_played_at ................................... [[32mPASS[0m in 0.98s]
[0m15:47:45.387870 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m15:47:45.388421 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m15:47:45.388848 [info ] [Thread-3 (]: 8 of 11 START test not_null_silver_plays_track_id .............................. [RUN]
[0m15:47:45.389330 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_played_at.8281565f95, now test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9)
[0m15:47:45.389680 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m15:47:45.395142 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m15:47:45.396348 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m15:47:45.399375 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m15:47:45.400365 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m15:47:45.400707 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_id
from spotify_data.silver.silver_plays
where track_id is null



  
  
      
    ) dbt_internal_test
[0m15:47:45.401067 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:47:45.445497 [info ] [Thread-1 (]: 5 of 11 PASS not_null_silver_plays_event_type .................................. [[32mPASS[0m in 1.06s]
[0m15:47:45.446089 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m15:47:45.446395 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m15:47:45.446657 [info ] [Thread-1 (]: 9 of 11 START test not_null_silver_plays_track_name ............................ [RUN]
[0m15:47:45.446947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa, now test.spotify_analytics.not_null_silver_plays_track_name.c6334add30)
[0m15:47:45.447189 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m15:47:45.450065 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m15:47:45.450598 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m15:47:45.452076 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m15:47:45.453240 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m15:47:45.453596 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_silver_plays_track_name.c6334add30: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_name
from spotify_data.silver.silver_plays
where track_name is null



  
  
      
    ) dbt_internal_test
[0m15:47:45.453863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:45.457273 [info ] [Thread-4 (]: 7 of 11 PASS not_null_silver_plays_processed_at ................................ [[32mPASS[0m in 1.03s]
[0m15:47:45.459140 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m15:47:45.459371 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m15:47:45.459654 [info ] [Thread-4 (]: 10 of 11 START test not_null_silver_plays_user_id .............................. [RUN]
[0m15:47:45.460388 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed, now test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4)
[0m15:47:45.461356 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m15:47:45.464709 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m15:47:45.466880 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m15:47:45.469451 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m15:47:45.472869 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m15:47:45.473184 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from spotify_data.silver.silver_plays
where user_id is null



  
  
      
    ) dbt_internal_test
[0m15:47:45.473424 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:47:45.551042 [info ] [Thread-2 (]: 2 of 11 PASS not_null_silver_plays_artist_name ................................. [[32mPASS[0m in 2.66s]
[0m15:47:45.551457 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m15:47:45.551665 [debug] [Thread-2 (]: Began running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m15:47:45.551895 [info ] [Thread-2 (]: 11 of 11 START test unique_silver_plays_event_id ............................... [RUN]
[0m15:47:45.552172 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad, now test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf)
[0m15:47:45.552364 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m15:47:45.555637 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m15:47:45.556054 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m15:47:45.557120 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m15:47:45.558134 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m15:47:45.558329 [debug] [Thread-2 (]: On test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from spotify_data.silver.silver_plays
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:47:45.558497 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:47:46.138885 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.738 seconds
[0m15:47:46.141817 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9: Close
[0m15:47:46.268716 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.814 seconds
[0m15:47:46.271448 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_silver_plays_track_name.c6334add30: Close
[0m15:47:46.328050 [info ] [Thread-3 (]: 8 of 11 PASS not_null_silver_plays_track_id .................................... [[32mPASS[0m in 0.94s]
[0m15:47:46.329069 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m15:47:46.417791 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.859 seconds
[0m15:47:46.420978 [debug] [Thread-2 (]: On test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf: Close
[0m15:47:46.426854 [info ] [Thread-1 (]: 9 of 11 PASS not_null_silver_plays_track_name .................................. [[32mPASS[0m in 0.98s]
[0m15:47:46.427999 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m15:47:46.495521 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.022 seconds
[0m15:47:46.498109 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4: Close
[0m15:47:46.636251 [info ] [Thread-2 (]: 11 of 11 PASS unique_silver_plays_event_id ..................................... [[32mPASS[0m in 1.08s]
[0m15:47:46.637348 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m15:47:46.664714 [info ] [Thread-4 (]: 10 of 11 PASS not_null_silver_plays_user_id .................................... [[32mPASS[0m in 1.20s]
[0m15:47:46.665455 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m15:47:46.666838 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:47:46.667169 [debug] [MainThread]: Connection 'test.spotify_analytics.not_null_silver_plays_track_name.c6334add30' was properly closed.
[0m15:47:46.667402 [debug] [MainThread]: Connection 'test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4' was properly closed.
[0m15:47:46.667934 [debug] [MainThread]: Connection 'test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9' was properly closed.
[0m15:47:46.668302 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf' was properly closed.
[0m15:47:46.668645 [info ] [MainThread]: 
[0m15:47:46.668990 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 5.44 seconds (5.44s).
[0m15:47:46.670821 [debug] [MainThread]: Command end result
[0m15:47:46.692975 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m15:47:46.694433 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m15:47:46.698497 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m15:47:46.698726 [info ] [MainThread]: 
[0m15:47:46.698924 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:47:46.699061 [info ] [MainThread]: 
[0m15:47:46.699212 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m15:47:46.699487 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:47:46.701278 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.932843, "process_in_blocks": "0", "process_kernel_time": 0.33095, "process_mem_max_rss": "237060096", "process_out_blocks": "0", "process_user_time": 2.681077}
[0m15:47:46.701505 [debug] [MainThread]: Command `dbt test` succeeded at 15:47:46.701464 after 6.93 seconds
[0m15:47:46.701692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fba4370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9ccd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c7a6d0>]}
[0m15:47:46.701876 [debug] [MainThread]: Flushing usage events
[0m15:47:46.870516 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:05:10.279811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035ebe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bef9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104befb10>]}


============================== 20:05:10.282436 | 839f1074-4154-4c0e-abbe-cceac3cddb29 ==============================
[0m20:05:10.282436 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:05:10.282706 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'fail_fast': 'False', 'target_path': 'None', 'debug': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'invocation_command': 'dbt compile --select daily_user_stats.sql', 'empty': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'quiet': 'False', 'printer_width': '80', 'introspect': 'True', 'warn_error': 'None', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'log_cache_events': 'False', 'use_experimental_parser': 'False'}
[0m20:05:11.098708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '839f1074-4154-4c0e-abbe-cceac3cddb29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f40b00>]}
[0m20:05:11.121017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '839f1074-4154-4c0e-abbe-cceac3cddb29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8e0e20>]}
[0m20:05:11.121540 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:05:11.178924 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:05:11.237257 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:05:11.237505 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/daily_user_stats.sql
[0m20:05:11.327190 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m20:05:11.332191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '839f1074-4154-4c0e-abbe-cceac3cddb29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdbdd50>]}
[0m20:05:11.366486 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:05:11.367873 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:05:11.378728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '839f1074-4154-4c0e-abbe-cceac3cddb29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcb28a0>]}
[0m20:05:11.378932 [info ] [MainThread]: Found 2 models, 11 data tests, 1 source, 604 macros
[0m20:05:11.379067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '839f1074-4154-4c0e-abbe-cceac3cddb29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdb02f0>]}
[0m20:05:11.379810 [info ] [MainThread]: 
[0m20:05:11.379942 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:05:11.380059 [info ] [MainThread]: 
[0m20:05:11.380309 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:05:11.380662 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m20:05:11.386302 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m20:05:11.386613 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m20:05:11.387617 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m20:05:11.387783 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m20:05:11.387919 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m20:05:11.388049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:11.388193 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:14.882967 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 3.495 seconds
[0m20:05:14.883925 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 3.496 seconds
[0m20:05:14.886463 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m20:05:14.887508 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m20:05:15.107537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '839f1074-4154-4c0e-abbe-cceac3cddb29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2761a0>]}
[0m20:05:15.112393 [debug] [Thread-1 (]: Began running node model.spotify_analytics.daily_user_stats
[0m20:05:15.112913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.daily_user_stats)
[0m20:05:15.113284 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.daily_user_stats
[0m20:05:15.120544 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.daily_user_stats"
[0m20:05:15.121253 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.daily_user_stats
[0m20:05:15.121722 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.daily_user_stats
[0m20:05:15.122480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:05:15.122819 [debug] [MainThread]: Connection 'model.spotify_analytics.daily_user_stats' was properly closed.
[0m20:05:15.123069 [debug] [MainThread]: Connection 'list_spotify_data_silver' was properly closed.
[0m20:05:15.123643 [debug] [MainThread]: Command end result
[0m20:05:15.148459 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:05:15.149419 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:05:15.153325 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m20:05:15.153559 [info ] [MainThread]: Compiled node 'daily_user_stats' is:


-- ============================================================================
-- GOLD LAYER: DAILY USER LISTENING STATISTICS
-- ============================================================================
-- Purpose: Aggregate user listening behavior by day
-- 
-- Grain: One row per user per day
-- Primary Key: (date, user_id)
--
-- Metrics:
--   - Total plays per day
--   - Total listening time
--   - Unique tracks/artists played
--   - Average track duration
--
-- Source: SILVER.silver_plays
-- Target: GOLD.daily_user_stats
-- ============================================================================

WITH daily_aggregates AS (
    SELECT 
        -- Date dimension (truncate timestamp to date)
        DATE(played_at) AS date,
        
        -- User identifier
        user_id,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        COUNT(DISTINCT track_id) AS unique_tracks,
        COUNT(DISTINCT artist_name) AS unique_artists,
        AVG(duration_ms) AS avg_track_duration_ms
        
    FROM spotify_data.silver.silver_plays
    GROUP BY 
        DATE(played_at),
        user_id
)

SELECT 
    -- Dimensions
    date,
    user_id,
    
    -- Metrics (cast for clarity)
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    unique_tracks::NUMBER AS unique_tracks,
    unique_artists::NUMBER AS unique_artists,
    ROUND(avg_track_duration_ms, 2)::NUMBER AS avg_track_duration_ms
    
FROM daily_aggregates
ORDER BY date DESC, user_id
[0m20:05:15.159735 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 4.9147763, "process_in_blocks": "0", "process_kernel_time": 0.438988, "process_mem_max_rss": "245628928", "process_out_blocks": "0", "process_user_time": 1.467642}
[0m20:05:15.159994 [debug] [MainThread]: Command `dbt compile` succeeded at 20:05:15.159946 after 4.92 seconds
[0m20:05:15.160190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ae5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ae0260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ae0310>]}
[0m20:05:15.160472 [debug] [MainThread]: Flushing usage events
[0m20:05:15.467510 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:05:26.597179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d9fe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a3b10>]}


============================== 20:05:26.599388 | 29c01c44-db92-4388-bc9d-249366def773 ==============================
[0m20:05:26.599388 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:05:26.599636 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'invocation_command': 'dbt run --select daily_user_stats', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'quiet': 'False', 'printer_width': '80', 'version_check': 'True', 'static_parser': 'True', 'warn_error': 'None', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'debug': 'False', 'introspect': 'True', 'use_colors': 'True', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m20:05:27.202353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29c01c44-db92-4388-bc9d-249366def773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066f4b00>]}
[0m20:05:27.226004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29c01c44-db92-4388-bc9d-249366def773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e098e20>]}
[0m20:05:27.226647 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:05:27.282709 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:05:27.338591 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:05:27.338803 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:05:27.341166 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m20:05:27.357891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29c01c44-db92-4388-bc9d-249366def773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfc5350>]}
[0m20:05:27.394322 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:05:27.395813 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:05:27.407290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29c01c44-db92-4388-bc9d-249366def773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df9ad50>]}
[0m20:05:27.407563 [info ] [MainThread]: Found 2 models, 11 data tests, 1 source, 604 macros
[0m20:05:27.407708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29c01c44-db92-4388-bc9d-249366def773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e691fd0>]}
[0m20:05:27.408410 [info ] [MainThread]: 
[0m20:05:27.408548 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:05:27.408651 [info ] [MainThread]: 
[0m20:05:27.408855 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:05:27.409218 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m20:05:27.416303 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m20:05:27.416502 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m20:05:27.416609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:28.936884 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.520 seconds
[0m20:05:28.939767 [debug] [ThreadPool]: On list_spotify_data: Close
[0m20:05:29.180507 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_silver)
[0m20:05:29.187644 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m20:05:29.191584 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m20:05:29.194024 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m20:05:29.194321 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m20:05:29.194644 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m20:05:29.194937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:29.195206 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:30.476965 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.282 seconds
[0m20:05:30.479137 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m20:05:30.496803 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.302 seconds
[0m20:05:30.498689 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m20:05:30.681308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29c01c44-db92-4388-bc9d-249366def773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e74cd50>]}
[0m20:05:30.686815 [debug] [Thread-1 (]: Began running node model.spotify_analytics.daily_user_stats
[0m20:05:30.687548 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.daily_user_stats ............................. [RUN]
[0m20:05:30.688052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.daily_user_stats)
[0m20:05:30.688418 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.daily_user_stats
[0m20:05:30.698137 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.daily_user_stats"
[0m20:05:30.699115 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.daily_user_stats
[0m20:05:30.726279 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.daily_user_stats"
[0m20:05:30.727348 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.daily_user_stats"
[0m20:05:30.727585 [debug] [Thread-1 (]: On model.spotify_analytics.daily_user_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.daily_user_stats"} */
create or replace transient table spotify_data.gold.daily_user_stats
         as
        (

-- ============================================================================
-- GOLD LAYER: DAILY USER LISTENING STATISTICS
-- ============================================================================
-- Purpose: Aggregate user listening behavior by day
-- 
-- Grain: One row per user per day
-- Primary Key: (date, user_id)
--
-- Metrics:
--   - Total plays per day
--   - Total listening time
--   - Unique tracks/artists played
--   - Average track duration
--
-- Source: SILVER.silver_plays
-- Target: GOLD.daily_user_stats
-- ============================================================================

WITH daily_aggregates AS (
    SELECT 
        -- Date dimension (truncate timestamp to date)
        DATE(played_at) AS date,
        
        -- User identifier
        user_id,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        COUNT(DISTINCT track_id) AS unique_tracks,
        COUNT(DISTINCT artist_name) AS unique_artists,
        AVG(duration_ms) AS avg_track_duration_ms
        
    FROM spotify_data.silver.silver_plays
    GROUP BY 
        DATE(played_at),
        user_id
)

SELECT 
    -- Dimensions
    date,
    user_id,
    
    -- Metrics (cast for clarity)
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    unique_tracks::NUMBER AS unique_tracks,
    unique_artists::NUMBER AS unique_artists,
    ROUND(avg_track_duration_ms, 2)::NUMBER AS avg_track_duration_ms
    
FROM daily_aggregates
ORDER BY date DESC, user_id
        );
[0m20:05:30.727797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:33.439900 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.712 seconds
[0m20:05:33.462332 [debug] [Thread-1 (]: On model.spotify_analytics.daily_user_stats: Close
[0m20:05:33.618487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29c01c44-db92-4388-bc9d-249366def773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1159eaed0>]}
[0m20:05:33.618954 [info ] [Thread-1 (]: 1 of 1 OK created sql table model gold.daily_user_stats ........................ [[32mSUCCESS 1[0m in 2.93s]
[0m20:05:33.619273 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.daily_user_stats
[0m20:05:33.620000 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:05:33.620152 [debug] [MainThread]: Connection 'model.spotify_analytics.daily_user_stats' was properly closed.
[0m20:05:33.620333 [debug] [MainThread]: Connection 'list_spotify_data_gold' was properly closed.
[0m20:05:33.620490 [info ] [MainThread]: 
[0m20:05:33.620635 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.21 seconds (6.21s).
[0m20:05:33.620938 [debug] [MainThread]: Command end result
[0m20:05:33.635009 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:05:33.635951 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:05:33.638775 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m20:05:33.638923 [info ] [MainThread]: 
[0m20:05:33.639092 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:05:33.639207 [info ] [MainThread]: 
[0m20:05:33.639342 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:05:33.641025 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.070223, "process_in_blocks": "0", "process_kernel_time": 0.242375, "process_mem_max_rss": "229703680", "process_out_blocks": "0", "process_user_time": 1.425056}
[0m20:05:33.641223 [debug] [MainThread]: Command `dbt run` succeeded at 20:05:33.641185 after 7.07 seconds
[0m20:05:33.641380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e701b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b9f6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b9c2d0>]}
[0m20:05:33.641527 [debug] [MainThread]: Flushing usage events
[0m20:05:33.810798 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:10:23.208070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105833e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e37b10>]}


============================== 20:10:23.210650 | 3235b794-e37f-45a1-8aee-4d83deb9b53e ==============================
[0m20:10:23.210650 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:10:23.210910 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/sunilmakkar/.dbt', 'write_json': 'True', 'version_check': 'True', 'partial_parse': 'True', 'no_print': 'None', 'invocation_command': 'dbt run --select top_tracks', 'target_path': 'None', 'static_parser': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_format': 'default', 'introspect': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'fail_fast': 'False', 'empty': 'False'}
[0m20:10:23.874646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3235b794-e37f-45a1-8aee-4d83deb9b53e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106188b00>]}
[0m20:10:23.897350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3235b794-e37f-45a1-8aee-4d83deb9b53e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a304e20>]}
[0m20:10:23.897905 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:10:23.950923 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:10:24.014522 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:10:24.014810 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/top_tracks.sql
[0m20:10:24.106587 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m20:10:24.111560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3235b794-e37f-45a1-8aee-4d83deb9b53e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a8f8d50>]}
[0m20:10:24.145716 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:10:24.147177 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:10:24.158151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3235b794-e37f-45a1-8aee-4d83deb9b53e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a7d2b70>]}
[0m20:10:24.158369 [info ] [MainThread]: Found 3 models, 11 data tests, 1 source, 604 macros
[0m20:10:24.158521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3235b794-e37f-45a1-8aee-4d83deb9b53e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d594ad0>]}
[0m20:10:24.159205 [info ] [MainThread]: 
[0m20:10:24.159347 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:10:24.159452 [info ] [MainThread]: 
[0m20:10:24.159650 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:10:24.159977 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m20:10:24.165023 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m20:10:24.165177 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m20:10:24.165287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:25.568420 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.403 seconds
[0m20:10:25.573550 [debug] [ThreadPool]: On list_spotify_data: Close
[0m20:10:25.771712 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_silver)
[0m20:10:25.778891 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m20:10:25.784997 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m20:10:25.787344 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m20:10:25.787606 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m20:10:25.787811 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m20:10:25.787942 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:25.788058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:10:26.693893 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.906 seconds
[0m20:10:26.696748 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m20:10:26.886040 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.098 seconds
[0m20:10:26.888695 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m20:10:27.062911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3235b794-e37f-45a1-8aee-4d83deb9b53e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d7b9300>]}
[0m20:10:27.068848 [debug] [Thread-1 (]: Began running node model.spotify_analytics.top_tracks
[0m20:10:27.069537 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.top_tracks ................................... [RUN]
[0m20:10:27.070055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.top_tracks)
[0m20:10:27.070458 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.top_tracks
[0m20:10:27.078683 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.top_tracks"
[0m20:10:27.079650 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.top_tracks
[0m20:10:27.097997 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.top_tracks"
[0m20:10:27.099128 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.top_tracks"
[0m20:10:27.099414 [debug] [Thread-1 (]: On model.spotify_analytics.top_tracks: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.top_tracks"} */
create or replace transient table spotify_data.gold.top_tracks
         as
        (

-- ============================================================================
-- GOLD LAYER: TOP TRACKS BY PLAY COUNT
-- ============================================================================
-- Purpose: Aggregate and rank tracks by popularity
-- 
-- Grain: One row per track (all-time aggregation)
-- Primary Key: track_id
--
-- Metrics:
--   - Total plays per track
--   - Total listening time
--   - First and last play timestamps
--   - Popularity rank
--
-- Source: SILVER.silver_plays
-- Target: GOLD.top_tracks
-- ============================================================================

WITH track_aggregates AS (
    SELECT 
        -- Track identifiers and attributes
        track_id,
        track_name,
        artist_name,
        album_name,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        MIN(played_at) AS first_played_at,
        MAX(played_at) AS last_played_at
        
    FROM spotify_data.silver.silver_plays
    GROUP BY 
        track_id,
        track_name,
        artist_name,
        album_name
),

ranked_tracks AS (
    SELECT 
        *,
        -- Add ranking based on play count (1 = most played)
        ROW_NUMBER() OVER (ORDER BY total_plays DESC, total_listening_time_ms DESC) AS rank
    FROM track_aggregates
)

SELECT 
    -- Identifiers
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    
    -- Timestamps
    first_played_at::TIMESTAMP AS first_played_at,
    last_played_at::TIMESTAMP AS last_played_at,
    
    -- Ranking
    rank::NUMBER AS rank
    
FROM ranked_tracks
ORDER BY rank
        );
[0m20:10:27.099672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:29.009338 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.908 seconds
[0m20:10:29.042686 [debug] [Thread-1 (]: On model.spotify_analytics.top_tracks: Close
[0m20:10:29.204154 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3235b794-e37f-45a1-8aee-4d83deb9b53e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d81b1d0>]}
[0m20:10:29.205929 [info ] [Thread-1 (]: 1 of 1 OK created sql table model gold.top_tracks .............................. [[32mSUCCESS 1[0m in 2.13s]
[0m20:10:29.206934 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.top_tracks
[0m20:10:29.211972 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:10:29.212168 [debug] [MainThread]: Connection 'model.spotify_analytics.top_tracks' was properly closed.
[0m20:10:29.212288 [debug] [MainThread]: Connection 'list_spotify_data_gold' was properly closed.
[0m20:10:29.212589 [info ] [MainThread]: 
[0m20:10:29.212947 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.05 seconds (5.05s).
[0m20:10:29.214397 [debug] [MainThread]: Command end result
[0m20:10:29.247615 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:10:29.250179 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:10:29.255538 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m20:10:29.255791 [info ] [MainThread]: 
[0m20:10:29.256058 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:10:29.256210 [info ] [MainThread]: 
[0m20:10:29.256393 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:10:29.258359 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.081735, "process_in_blocks": "0", "process_kernel_time": 0.298932, "process_mem_max_rss": "218480640", "process_out_blocks": "0", "process_user_time": 1.518102}
[0m20:10:29.258669 [debug] [MainThread]: Command `dbt run` succeeded at 20:10:29.258617 after 6.08 seconds
[0m20:10:29.258957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d5aef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d7225d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d723f70>]}
[0m20:10:29.259154 [debug] [MainThread]: Flushing usage events
[0m20:10:29.590898 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:12:17.887335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f3fe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075439d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107543b10>]}


============================== 20:12:17.889806 | 4856ca76-3326-4db3-a96f-5c4ca96e79ea ==============================
[0m20:12:17.889806 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:12:17.890072 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'log_format': 'default', 'target_path': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'introspect': 'True', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'use_experimental_parser': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'cache_selected_only': 'False', 'printer_width': '80', 'static_parser': 'True', 'empty': 'False', 'invocation_command': 'dbt run --select top_artists', 'quiet': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'version_check': 'True'}
[0m20:12:18.511769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4856ca76-3326-4db3-a96f-5c4ca96e79ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106894b00>]}
[0m20:12:18.535364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4856ca76-3326-4db3-a96f-5c4ca96e79ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e238e20>]}
[0m20:12:18.535921 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:12:18.591707 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:12:18.653109 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:12:18.653379 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/top_artists.sql
[0m20:12:18.744537 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m20:12:18.749513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4856ca76-3326-4db3-a96f-5c4ca96e79ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e724d50>]}
[0m20:12:18.783813 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:12:18.786766 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:12:18.799365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4856ca76-3326-4db3-a96f-5c4ca96e79ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e606b70>]}
[0m20:12:18.799579 [info ] [MainThread]: Found 4 models, 11 data tests, 1 source, 604 macros
[0m20:12:18.799714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4856ca76-3326-4db3-a96f-5c4ca96e79ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea14c90>]}
[0m20:12:18.800393 [info ] [MainThread]: 
[0m20:12:18.800527 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:12:18.800631 [info ] [MainThread]: 
[0m20:12:18.800824 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:12:18.801149 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m20:12:18.806149 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m20:12:18.806306 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m20:12:18.806429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:20.215766 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.409 seconds
[0m20:12:20.218413 [debug] [ThreadPool]: On list_spotify_data: Close
[0m20:12:20.397060 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_gold)
[0m20:12:20.407445 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m20:12:20.407915 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m20:12:20.408280 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m20:12:20.410310 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m20:12:20.410506 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:12:20.410772 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m20:12:20.411574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:21.372366 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.961 seconds
[0m20:12:21.375337 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m20:12:21.511878 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.101 seconds
[0m20:12:21.514651 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m20:12:21.697590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4856ca76-3326-4db3-a96f-5c4ca96e79ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eaece20>]}
[0m20:12:21.702766 [debug] [Thread-1 (]: Began running node model.spotify_analytics.top_artists
[0m20:12:21.703519 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.top_artists .................................. [RUN]
[0m20:12:21.704027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.top_artists)
[0m20:12:21.704379 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.top_artists
[0m20:12:21.712197 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.top_artists"
[0m20:12:21.712973 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.top_artists
[0m20:12:21.731507 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.top_artists"
[0m20:12:21.732659 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.top_artists"
[0m20:12:21.732915 [debug] [Thread-1 (]: On model.spotify_analytics.top_artists: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.top_artists"} */
create or replace transient table spotify_data.gold.top_artists
         as
        (

-- ============================================================================
-- GOLD LAYER: TOP ARTISTS BY PLAY COUNT
-- ============================================================================
-- Purpose: Aggregate and rank artists by popularity
-- 
-- Grain: One row per artist (all-time aggregation)
-- Primary Key: artist_name
--
-- Metrics:
--   - Total plays per artist
--   - Total listening time
--   - Number of unique tracks played
--   - First and last play timestamps
--   - Popularity rank
--
-- Source: SILVER.silver_plays
-- Target: GOLD.top_artists
-- ============================================================================

WITH artist_aggregates AS (
    SELECT 
        -- Artist identifier
        artist_name,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        COUNT(DISTINCT track_id) AS unique_tracks,
        MIN(played_at) AS first_played_at,
        MAX(played_at) AS last_played_at
        
    FROM spotify_data.silver.silver_plays
    GROUP BY artist_name
),

ranked_artists AS (
    SELECT 
        *,
        -- Add ranking based on play count (1 = most played artist)
        ROW_NUMBER() OVER (ORDER BY total_plays DESC, total_listening_time_ms DESC) AS rank
    FROM artist_aggregates
)

SELECT 
    -- Identifier
    artist_name::VARCHAR AS artist_name,
    
    -- Metrics
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    unique_tracks::NUMBER AS unique_tracks,
    
    -- Timestamps
    first_played_at::TIMESTAMP AS first_played_at,
    last_played_at::TIMESTAMP AS last_played_at,
    
    -- Ranking
    rank::NUMBER AS rank
    
FROM ranked_artists
ORDER BY rank
        );
[0m20:12:21.733122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:23.938404 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.205 seconds
[0m20:12:23.959332 [debug] [Thread-1 (]: On model.spotify_analytics.top_artists: Close
[0m20:12:24.117943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4856ca76-3326-4db3-a96f-5c4ca96e79ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb5f890>]}
[0m20:12:24.119134 [info ] [Thread-1 (]: 1 of 1 OK created sql table model gold.top_artists ............................. [[32mSUCCESS 1[0m in 2.41s]
[0m20:12:24.119680 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.top_artists
[0m20:12:24.121341 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:12:24.121759 [debug] [MainThread]: Connection 'model.spotify_analytics.top_artists' was properly closed.
[0m20:12:24.121994 [debug] [MainThread]: Connection 'list_spotify_data_silver' was properly closed.
[0m20:12:24.122253 [info ] [MainThread]: 
[0m20:12:24.122530 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.32 seconds (5.32s).
[0m20:12:24.123125 [debug] [MainThread]: Command end result
[0m20:12:24.149379 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:12:24.150681 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:12:24.154260 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m20:12:24.154431 [info ] [MainThread]: 
[0m20:12:24.154627 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:12:24.154792 [info ] [MainThread]: 
[0m20:12:24.154968 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:12:24.156633 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.297918, "process_in_blocks": "0", "process_kernel_time": 0.25799, "process_mem_max_rss": "241434624", "process_out_blocks": "0", "process_user_time": 1.484434}
[0m20:12:24.156837 [debug] [MainThread]: Command `dbt run` succeeded at 20:12:24.156796 after 6.30 seconds
[0m20:12:24.157000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9b2e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb64370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb64690>]}
[0m20:12:24.157185 [debug] [MainThread]: Flushing usage events
[0m20:12:24.459632 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:14:30.137381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e43e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094479d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109447b10>]}


============================== 20:14:30.139973 | 037c28a8-81dd-484c-9712-174952ccece0 ==============================
[0m20:14:30.139973 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:14:30.140236 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'target_path': 'None', 'invocation_command': 'dbt compile --select device-usage', 'use_colors': 'True', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'fail_fast': 'False', 'log_cache_events': 'False', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'printer_width': '80', 'cache_selected_only': 'False', 'static_parser': 'True', 'introspect': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'warn_error': 'None', 'write_json': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m20:14:30.766298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '037c28a8-81dd-484c-9712-174952ccece0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108798b00>]}
[0m20:14:30.788938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '037c28a8-81dd-484c-9712-174952ccece0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ae00e20>]}
[0m20:14:30.789492 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:14:30.842440 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:14:30.903231 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:14:30.903489 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/device_usage.py
[0m20:14:30.961397 [error] [MainThread]: Encountered an error:
Parsing Error in model device_usage (models/gold/device_usage.py)
  No jinja in python model code is allowed
[0m20:14:30.963089 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 0.8540277, "process_in_blocks": "0", "process_kernel_time": 0.185754, "process_mem_max_rss": "207831040", "process_out_blocks": "0", "process_user_time": 0.905171}
[0m20:14:30.963377 [debug] [MainThread]: Command `dbt compile` failed at 20:14:30.963334 after 0.85 seconds
[0m20:14:30.963535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12adad450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12adadc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b4063f0>]}
[0m20:14:30.963670 [debug] [MainThread]: Flushing usage events
[0m20:14:31.302492 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:16:14.805102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077ebe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11155f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11155fb10>]}


============================== 20:16:14.807688 | 492c0a78-4148-49e4-baa8-f97d83021c91 ==============================
[0m20:16:14.807688 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:16:14.807935 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'fail_fast': 'False', 'write_json': 'True', 'log_format': 'default', 'printer_width': '80', 'empty': 'False', 'no_print': 'None', 'warn_error': 'None', 'introspect': 'True', 'use_colors': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt run --select device_usage', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'static_parser': 'True', 'quiet': 'False', 'profiles_dir': '/Users/sunilmakkar/.dbt'}
[0m20:16:15.402507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '492c0a78-4148-49e4-baa8-f97d83021c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103b0b00>]}
[0m20:16:15.424617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '492c0a78-4148-49e4-baa8-f97d83021c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122f04e20>]}
[0m20:16:15.425155 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:16:15.479133 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:16:15.538741 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:16:15.538995 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/device_usage.sql
[0m20:16:15.630793 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m20:16:15.635659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '492c0a78-4148-49e4-baa8-f97d83021c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13aef4e50>]}
[0m20:16:15.670171 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:16:15.671540 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:16:15.682232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '492c0a78-4148-49e4-baa8-f97d83021c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13add2b70>]}
[0m20:16:15.682413 [info ] [MainThread]: Found 5 models, 11 data tests, 1 source, 604 macros
[0m20:16:15.682540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '492c0a78-4148-49e4-baa8-f97d83021c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b324c90>]}
[0m20:16:15.683209 [info ] [MainThread]: 
[0m20:16:15.683341 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:16:15.683444 [info ] [MainThread]: 
[0m20:16:15.683678 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:16:15.684000 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m20:16:15.688961 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m20:16:15.689135 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m20:16:15.689271 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:16:17.199983 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.511 seconds
[0m20:16:17.202628 [debug] [ThreadPool]: On list_spotify_data: Close
[0m20:16:17.383418 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_gold)
[0m20:16:17.390335 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m20:16:17.390730 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m20:16:17.392023 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m20:16:17.392269 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m20:16:17.392482 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m20:16:17.392684 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:16:17.392879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:16:18.197810 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.805 seconds
[0m20:16:18.201126 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m20:16:18.374775 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.982 seconds
[0m20:16:18.376821 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m20:16:18.548993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '492c0a78-4148-49e4-baa8-f97d83021c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b34f2b0>]}
[0m20:16:18.553451 [debug] [Thread-1 (]: Began running node model.spotify_analytics.device_usage
[0m20:16:18.554048 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.device_usage ................................. [RUN]
[0m20:16:18.554461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.device_usage)
[0m20:16:18.554791 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.device_usage
[0m20:16:18.563487 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.device_usage"
[0m20:16:18.564034 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.device_usage
[0m20:16:18.584138 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.device_usage"
[0m20:16:18.585198 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.device_usage"
[0m20:16:18.585414 [debug] [Thread-1 (]: On model.spotify_analytics.device_usage: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.device_usage"} */
create or replace transient table spotify_data.gold.device_usage
         as
        (

-- ============================================================================
-- GOLD LAYER: DEVICE USAGE STATISTICS
-- ============================================================================
-- Purpose: Aggregate listening behavior by device type
-- 
-- Grain: One row per device type (all-time aggregation)
-- Primary Key: device_type
--
-- Metrics:
--   - Total plays per device
--   - Total listening time
--   - Percentage of total plays
--   - Average track duration
--
-- Source: SILVER.silver_plays
-- Target: GOLD.device_usage
-- ============================================================================

WITH device_aggregates AS (
    SELECT 
        -- Device identifier
        device_type,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        AVG(duration_ms) AS avg_track_duration_ms
        
    FROM spotify_data.silver.silver_plays
    GROUP BY device_type
),

total_plays_calc AS (
    -- Calculate overall total for percentage calculation
    SELECT SUM(total_plays) AS overall_total_plays
    FROM device_aggregates
)

SELECT 
    -- Identifier
    device_type::VARCHAR AS device_type,
    
    -- Metrics
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    
    -- Percentage of total plays
    ROUND((total_plays::FLOAT / overall_total_plays::FLOAT) * 100, 2)::FLOAT AS play_percentage,
    
    -- Average duration
    ROUND(avg_track_duration_ms, 2)::NUMBER AS avg_track_duration_ms
    
FROM device_aggregates
CROSS JOIN total_plays_calc
ORDER BY total_plays DESC
        );
[0m20:16:18.585601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:20.713864 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.128 seconds
[0m20:16:20.733880 [debug] [Thread-1 (]: On model.spotify_analytics.device_usage: Close
[0m20:16:20.891985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '492c0a78-4148-49e4-baa8-f97d83021c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b529310>]}
[0m20:16:20.892943 [info ] [Thread-1 (]: 1 of 1 OK created sql table model gold.device_usage ............................ [[32mSUCCESS 1[0m in 2.34s]
[0m20:16:20.893749 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.device_usage
[0m20:16:20.895111 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:16:20.895398 [debug] [MainThread]: Connection 'model.spotify_analytics.device_usage' was properly closed.
[0m20:16:20.895598 [debug] [MainThread]: Connection 'list_spotify_data_silver' was properly closed.
[0m20:16:20.895846 [info ] [MainThread]: 
[0m20:16:20.896129 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.21 seconds (5.21s).
[0m20:16:20.896788 [debug] [MainThread]: Command end result
[0m20:16:20.918546 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:16:20.920256 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:16:20.923048 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m20:16:20.923215 [info ] [MainThread]: 
[0m20:16:20.923422 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:16:20.923621 [info ] [MainThread]: 
[0m20:16:20.923856 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:16:20.925899 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.1489396, "process_in_blocks": "0", "process_kernel_time": 0.25137, "process_mem_max_rss": "238911488", "process_out_blocks": "0", "process_user_time": 1.441407}
[0m20:16:20.926306 [debug] [MainThread]: Command `dbt run` succeeded at 20:16:20.926250 after 6.15 seconds
[0m20:16:20.926505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b38ee60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c57b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c57b750>]}
[0m20:16:20.926687 [debug] [MainThread]: Flushing usage events
[0m20:16:21.257822 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:17:40.459202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10709be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11095f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11095fb10>]}


============================== 20:17:40.461664 | f2d4f706-c555-44d5-8321-329bc58e4221 ==============================
[0m20:17:40.461664 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:17:40.461929 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'log_cache_events': 'False', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'no_print': 'None', 'indirect_selection': 'eager', 'use_colors': 'True', 'printer_width': '80', 'version_check': 'True', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'introspect': 'True', 'quiet': 'False', 'partial_parse': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select gold', 'cache_selected_only': 'False', 'debug': 'False', 'log_format': 'default', 'static_parser': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False'}
[0m20:17:41.068278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2d4f706-c555-44d5-8321-329bc58e4221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078b0b00>]}
[0m20:17:41.091023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2d4f706-c555-44d5-8321-329bc58e4221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121500e20>]}
[0m20:17:41.091581 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:17:41.145090 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:17:41.204467 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:17:41.204733 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/schema.yml
[0m20:17:41.239645 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m20:17:41.244838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2d4f706-c555-44d5-8321-329bc58e4221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219fd750>]}
[0m20:17:41.278294 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:17:41.279875 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:17:41.295565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2d4f706-c555-44d5-8321-329bc58e4221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c489b0>]}
[0m20:17:41.295782 [info ] [MainThread]: Found 5 models, 11 data tests, 1 source, 604 macros
[0m20:17:41.295917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2d4f706-c555-44d5-8321-329bc58e4221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121bcaf90>]}
[0m20:17:41.296505 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:17:41.296717 [debug] [MainThread]: Command end result
[0m20:17:41.308128 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:17:41.309204 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:17:41.311189 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m20:17:41.312477 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.88206697, "process_in_blocks": "0", "process_kernel_time": 0.182239, "process_mem_max_rss": "211992576", "process_out_blocks": "0", "process_user_time": 0.942417}
[0m20:17:41.312704 [debug] [MainThread]: Command `dbt test` succeeded at 20:17:41.312668 after 0.88 seconds
[0m20:17:41.312848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ce7ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110855190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121bccad0>]}
[0m20:17:41.312976 [debug] [MainThread]: Flushing usage events
[0m20:17:41.686395 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:18:19.392025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e37e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c5f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c5fb10>]}


============================== 20:18:19.394529 | 07d2bfe4-e9bf-4888-9195-10ba6307eace ==============================
[0m20:18:19.394529 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:18:19.394786 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'warn_error': 'None', 'log_format': 'default', 'quiet': 'False', 'invocation_command': 'dbt test --select gold', 'write_json': 'True', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'use_experimental_parser': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'partial_parse': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'empty': 'None', 'target_path': 'None', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m20:18:19.993078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07d2bfe4-e9bf-4888-9195-10ba6307eace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072b0b00>]}
[0m20:18:20.015937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07d2bfe4-e9bf-4888-9195-10ba6307eace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119304e20>]}
[0m20:18:20.016478 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:18:20.070306 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:18:20.130602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:18:20.130932 [debug] [MainThread]: Partial parsing: updated file: spotify_analytics://models/gold/schema.yml
[0m20:18:20.236087 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m20:18:20.241370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07d2bfe4-e9bf-4888-9195-10ba6307eace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1198fce50>]}
[0m20:18:20.278544 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:18:20.280011 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:18:20.295906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07d2bfe4-e9bf-4888-9195-10ba6307eace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119df32f0>]}
[0m20:18:20.296118 [info ] [MainThread]: Found 5 models, 43 data tests, 1 source, 604 macros
[0m20:18:20.296253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07d2bfe4-e9bf-4888-9195-10ba6307eace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c2bbd0>]}
[0m20:18:20.297399 [info ] [MainThread]: 
[0m20:18:20.297533 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:18:20.297633 [info ] [MainThread]: 
[0m20:18:20.297829 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:18:20.299485 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m20:18:20.299688 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m20:18:20.306118 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m20:18:20.306968 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m20:18:20.307107 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m20:18:20.307239 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m20:18:20.307397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:18:20.307521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:18:21.626452 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.319 seconds
[0m20:18:21.627936 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m20:18:21.643935 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.336 seconds
[0m20:18:21.645051 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m20:18:21.815130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07d2bfe4-e9bf-4888-9195-10ba6307eace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a8e0d0>]}
[0m20:18:21.820793 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:18:21.821336 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:18:21.821717 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:18:21.822071 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:18:21.822479 [info ] [Thread-1 (]: 1 of 32 START test not_null_daily_user_stats_avg_track_duration_ms ............. [RUN]
[0m20:18:21.822895 [info ] [Thread-4 (]: 4 of 32 START test not_null_daily_user_stats_total_plays ....................... [RUN]
[0m20:18:21.823304 [info ] [Thread-3 (]: 3 of 32 START test not_null_daily_user_stats_total_listening_time_ms ........... [RUN]
[0m20:18:21.823530 [info ] [Thread-2 (]: 2 of 32 START test not_null_daily_user_stats_date .............................. [RUN]
[0m20:18:21.823904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155)
[0m20:18:21.824424 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282'
[0m20:18:21.824854 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87'
[0m20:18:21.825215 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9)
[0m20:18:21.825575 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:18:21.825839 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:18:21.826017 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:18:21.826210 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:18:21.841851 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m20:18:21.842956 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m20:18:21.845211 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m20:18:21.847093 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m20:18:21.847697 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:18:21.847943 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:18:21.848159 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:18:21.848336 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:18:21.859911 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m20:18:21.861085 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m20:18:21.862059 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m20:18:21.863089 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m20:18:21.863757 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m20:18:21.864098 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m20:18:21.864301 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.daily_user_stats
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m20:18:21.864610 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m20:18:21.864919 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m20:18:21.865089 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_track_duration_ms
from spotify_data.gold.daily_user_stats
where avg_track_duration_ms is null



  
  
      
    ) dbt_internal_test
[0m20:18:21.865262 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:18:21.865428 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.daily_user_stats
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m20:18:21.865599 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from spotify_data.gold.daily_user_stats
where date is null



  
  
      
    ) dbt_internal_test
[0m20:18:21.865755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:21.866188 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:18:21.866424 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:18:23.274377 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.408 seconds
[0m20:18:23.283691 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282: Close
[0m20:18:23.285174 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.419 seconds
[0m20:18:23.286709 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155: Close
[0m20:18:23.318620 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.452 seconds
[0m20:18:23.319750 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9: Close
[0m20:18:23.477676 [info ] [Thread-4 (]: 4 of 32 PASS not_null_daily_user_stats_total_plays ............................. [[32mPASS[0m in 1.65s]
[0m20:18:23.478505 [info ] [Thread-2 (]: 2 of 32 PASS not_null_daily_user_stats_date .................................... [[32mPASS[0m in 1.65s]
[0m20:18:23.479327 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:18:23.479880 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:18:23.480332 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:18:23.480850 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:18:23.481280 [info ] [Thread-4 (]: 5 of 32 START test not_null_daily_user_stats_unique_artists .................... [RUN]
[0m20:18:23.481718 [info ] [Thread-2 (]: 6 of 32 START test not_null_daily_user_stats_unique_tracks ..................... [RUN]
[0m20:18:23.482187 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282, now test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f)
[0m20:18:23.482532 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9, now test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac)
[0m20:18:23.482880 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:18:23.483193 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:18:23.488420 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m20:18:23.493919 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m20:18:23.495441 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:18:23.495671 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:18:23.497814 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m20:18:23.499938 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m20:18:23.498155 [info ] [Thread-1 (]: 1 of 32 PASS not_null_daily_user_stats_avg_track_duration_ms ................... [[32mPASS[0m in 1.67s]
[0m20:18:23.500553 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:18:23.500750 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:18:23.500954 [info ] [Thread-1 (]: 7 of 32 START test not_null_daily_user_stats_user_id ........................... [RUN]
[0m20:18:23.501190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155, now test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b)
[0m20:18:23.501744 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m20:18:23.502024 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:18:23.502333 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unique_artists
from spotify_data.gold.daily_user_stats
where unique_artists is null



  
  
      
    ) dbt_internal_test
[0m20:18:23.504844 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m20:18:23.505334 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m20:18:23.505555 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:18:23.505831 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unique_tracks
from spotify_data.gold.daily_user_stats
where unique_tracks is null



  
  
      
    ) dbt_internal_test
[0m20:18:23.506271 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:18:23.506553 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:18:23.508336 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m20:18:23.510038 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m20:18:23.510279 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from spotify_data.gold.daily_user_stats
where user_id is null



  
  
      
    ) dbt_internal_test
[0m20:18:23.510476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:24.199884 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.334 seconds
[0m20:18:24.202462 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87: Close
[0m20:18:24.369279 [info ] [Thread-3 (]: 3 of 32 PASS not_null_daily_user_stats_total_listening_time_ms ................. [[32mPASS[0m in 2.54s]
[0m20:18:24.370241 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:18:24.370704 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:18:24.371126 [info ] [Thread-3 (]: 8 of 32 START test not_null_device_usage_avg_track_duration_ms ................. [RUN]
[0m20:18:24.371643 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87, now test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003)
[0m20:18:24.372011 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:18:24.377593 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m20:18:24.378789 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:18:24.383158 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m20:18:24.383934 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m20:18:24.384120 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_track_duration_ms
from spotify_data.gold.device_usage
where avg_track_duration_ms is null



  
  
      
    ) dbt_internal_test
[0m20:18:24.384279 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:18:24.535600 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.025 seconds
[0m20:18:24.538511 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b: Close
[0m20:18:24.711763 [info ] [Thread-1 (]: 7 of 32 PASS not_null_daily_user_stats_user_id ................................. [[32mPASS[0m in 1.21s]
[0m20:18:24.712706 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:18:24.713216 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:18:24.713698 [info ] [Thread-1 (]: 9 of 32 START test not_null_device_usage_device_type ........................... [RUN]
[0m20:18:24.714235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b, now test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c)
[0m20:18:24.714650 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:18:24.719972 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m20:18:24.721168 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:18:24.723942 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m20:18:24.725204 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.220 seconds
[0m20:18:24.727496 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f: Close
[0m20:18:24.729590 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.223 seconds
[0m20:18:24.730145 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m20:18:24.731099 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac: Close
[0m20:18:24.731503 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select device_type
from spotify_data.gold.device_usage
where device_type is null



  
  
      
    ) dbt_internal_test
[0m20:18:24.732788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:24.878111 [info ] [Thread-2 (]: 6 of 32 PASS not_null_daily_user_stats_unique_tracks ........................... [[32mPASS[0m in 1.40s]
[0m20:18:24.878560 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:18:24.878799 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:18:24.879056 [info ] [Thread-2 (]: 10 of 32 START test not_null_device_usage_play_percentage ...................... [RUN]
[0m20:18:24.879274 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac, now test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2)
[0m20:18:24.879426 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:18:24.882086 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m20:18:24.882487 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:18:24.883701 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m20:18:24.884269 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m20:18:24.884615 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select play_percentage
from spotify_data.gold.device_usage
where play_percentage is null



  
  
      
    ) dbt_internal_test
[0m20:18:24.884811 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:18:25.042257 [info ] [Thread-4 (]: 5 of 32 PASS not_null_daily_user_stats_unique_artists .......................... [[32mPASS[0m in 1.56s]
[0m20:18:25.042732 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:18:25.043030 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:18:25.043354 [info ] [Thread-4 (]: 11 of 32 START test not_null_device_usage_total_listening_time_ms .............. [RUN]
[0m20:18:25.043729 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f, now test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2)
[0m20:18:25.044006 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:18:25.046262 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m20:18:25.046826 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:18:25.048704 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m20:18:25.049545 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m20:18:25.049811 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.device_usage
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m20:18:25.049974 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:18:25.390598 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.006 seconds
[0m20:18:25.391777 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003: Close
[0m20:18:25.466256 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.733 seconds
[0m20:18:25.467104 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c: Close
[0m20:18:25.548067 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.663 seconds
[0m20:18:25.551476 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2: Close
[0m20:18:25.556733 [info ] [Thread-3 (]: 8 of 32 PASS not_null_device_usage_avg_track_duration_ms ....................... [[32mPASS[0m in 1.18s]
[0m20:18:25.557518 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:18:25.558006 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:18:25.558488 [info ] [Thread-3 (]: 12 of 32 START test not_null_device_usage_total_plays .......................... [RUN]
[0m20:18:25.558966 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003, now test.spotify_analytics.not_null_device_usage_total_plays.90a295df48)
[0m20:18:25.559341 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:18:25.564556 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m20:18:25.565179 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:18:25.567515 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m20:18:25.568307 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m20:18:25.568667 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_device_usage_total_plays.90a295df48: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.device_usage
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m20:18:25.568975 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:18:25.629643 [info ] [Thread-1 (]: 9 of 32 PASS not_null_device_usage_device_type ................................. [[32mPASS[0m in 0.92s]
[0m20:18:25.630243 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:18:25.630577 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:18:25.630896 [info ] [Thread-1 (]: 13 of 32 START test not_null_top_artists_artist_name ........................... [RUN]
[0m20:18:25.631193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c, now test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e)
[0m20:18:25.631388 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:18:25.633900 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m20:18:25.634275 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:18:25.635488 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m20:18:25.636384 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m20:18:25.636582 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select artist_name
from spotify_data.gold.top_artists
where artist_name is null



  
  
      
    ) dbt_internal_test
[0m20:18:25.636738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:25.703533 [info ] [Thread-2 (]: 10 of 32 PASS not_null_device_usage_play_percentage ............................ [[32mPASS[0m in 0.82s]
[0m20:18:25.703976 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:18:25.704275 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:18:25.704701 [info ] [Thread-2 (]: 14 of 32 START test not_null_top_artists_first_played_at ....................... [RUN]
[0m20:18:25.705045 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2, now test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14)
[0m20:18:25.705325 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:18:25.707839 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m20:18:25.708322 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:18:25.709305 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m20:18:25.709932 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m20:18:25.710214 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_played_at
from spotify_data.gold.top_artists
where first_played_at is null



  
  
      
    ) dbt_internal_test
[0m20:18:25.710465 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:18:25.936853 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.887 seconds
[0m20:18:25.938017 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2: Close
[0m20:18:26.084071 [info ] [Thread-4 (]: 11 of 32 PASS not_null_device_usage_total_listening_time_ms .................... [[32mPASS[0m in 1.04s]
[0m20:18:26.084519 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:18:26.084729 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:18:26.084930 [info ] [Thread-4 (]: 15 of 32 START test not_null_top_artists_last_played_at ........................ [RUN]
[0m20:18:26.085192 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2, now test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca)
[0m20:18:26.085432 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:18:26.087726 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m20:18:26.088102 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:18:26.089306 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m20:18:26.089846 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m20:18:26.090010 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_played_at
from spotify_data.gold.top_artists
where last_played_at is null



  
  
      
    ) dbt_internal_test
[0m20:18:26.090164 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:18:26.474153 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.764 seconds
[0m20:18:26.474843 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.838 seconds
[0m20:18:26.476501 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14: Close
[0m20:18:26.477342 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e: Close
[0m20:18:26.562010 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.993 seconds
[0m20:18:26.562993 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_device_usage_total_plays.90a295df48: Close
[0m20:18:26.654437 [info ] [Thread-1 (]: 13 of 32 PASS not_null_top_artists_artist_name ................................. [[32mPASS[0m in 1.02s]
[0m20:18:26.655274 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:18:26.655720 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:18:26.656138 [info ] [Thread-1 (]: 16 of 32 START test not_null_top_artists_rank .................................. [RUN]
[0m20:18:26.656569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e, now test.spotify_analytics.not_null_top_artists_rank.d14513fc96)
[0m20:18:26.656906 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:18:26.659591 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m20:18:26.660169 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:18:26.661315 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m20:18:26.663192 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m20:18:26.663418 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_rank.d14513fc96: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rank
from spotify_data.gold.top_artists
where rank is null



  
  
      
    ) dbt_internal_test
[0m20:18:26.663597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:26.671601 [info ] [Thread-2 (]: 14 of 32 PASS not_null_top_artists_first_played_at ............................. [[32mPASS[0m in 0.97s]
[0m20:18:26.672137 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:18:26.672438 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:18:26.672759 [info ] [Thread-2 (]: 17 of 32 START test not_null_top_artists_total_listening_time_ms ............... [RUN]
[0m20:18:26.673666 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14, now test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c)
[0m20:18:26.674285 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:18:26.677303 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m20:18:26.679435 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:18:26.683028 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m20:18:26.686354 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m20:18:26.686678 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.top_artists
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m20:18:26.686879 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:18:26.828784 [info ] [Thread-3 (]: 12 of 32 PASS not_null_device_usage_total_plays ................................ [[32mPASS[0m in 1.27s]
[0m20:18:26.829154 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:18:26.829379 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:18:26.829761 [info ] [Thread-3 (]: 18 of 32 START test not_null_top_artists_total_plays ........................... [RUN]
[0m20:18:26.830219 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_plays.90a295df48, now test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11)
[0m20:18:26.830501 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:18:26.832981 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m20:18:26.833561 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:18:26.834618 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m20:18:26.835210 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m20:18:26.835490 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.top_artists
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m20:18:26.835758 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:18:26.922150 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.832 seconds
[0m20:18:26.923566 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca: Close
[0m20:18:27.071813 [info ] [Thread-4 (]: 15 of 32 PASS not_null_top_artists_last_played_at .............................. [[32mPASS[0m in 0.99s]
[0m20:18:27.072257 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:18:27.072532 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:18:27.072841 [info ] [Thread-4 (]: 19 of 32 START test not_null_top_artists_unique_tracks ......................... [RUN]
[0m20:18:27.073207 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca, now test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13)
[0m20:18:27.073477 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:18:27.076075 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m20:18:27.076604 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:18:27.077862 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m20:18:27.078564 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m20:18:27.078820 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unique_tracks
from spotify_data.gold.top_artists
where unique_tracks is null



  
  
      
    ) dbt_internal_test
[0m20:18:27.079044 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:18:27.411010 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.747 seconds
[0m20:18:27.412313 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_rank.d14513fc96: Close
[0m20:18:27.480962 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.794 seconds
[0m20:18:27.482734 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c: Close
[0m20:18:27.492643 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.657 seconds
[0m20:18:27.493580 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11: Close
[0m20:18:27.644387 [info ] [Thread-1 (]: 16 of 32 PASS not_null_top_artists_rank ........................................ [[32mPASS[0m in 0.99s]
[0m20:18:27.644846 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:18:27.645052 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:18:27.645331 [info ] [Thread-1 (]: 20 of 32 START test not_null_top_tracks_artist_name ............................ [RUN]
[0m20:18:27.645762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_rank.d14513fc96, now test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461)
[0m20:18:27.646193 [info ] [Thread-3 (]: 18 of 32 PASS not_null_top_artists_total_plays ................................. [[32mPASS[0m in 0.82s]
[0m20:18:27.646494 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:18:27.646860 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:18:27.649547 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m20:18:27.649834 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:18:27.650041 [info ] [Thread-3 (]: 21 of 32 START test not_null_top_tracks_first_played_at ........................ [RUN]
[0m20:18:27.650228 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11, now test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31)
[0m20:18:27.650451 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:18:27.652803 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m20:18:27.653384 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:18:27.655962 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m20:18:27.656392 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:18:27.657704 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m20:18:27.658347 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m20:18:27.658043 [info ] [Thread-2 (]: 17 of 32 PASS not_null_top_artists_total_listening_time_ms ..................... [[32mPASS[0m in 0.98s]
[0m20:18:27.658608 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select artist_name
from spotify_data.gold.top_tracks
where artist_name is null



  
  
      
    ) dbt_internal_test
[0m20:18:27.658930 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:18:27.659127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:27.659501 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m20:18:27.659718 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:18:27.660193 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_played_at
from spotify_data.gold.top_tracks
where first_played_at is null



  
  
      
    ) dbt_internal_test
[0m20:18:27.660501 [info ] [Thread-2 (]: 22 of 32 START test not_null_top_tracks_last_played_at ......................... [RUN]
[0m20:18:27.660760 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:18:27.661271 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c, now test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532)
[0m20:18:27.661886 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:18:27.664119 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m20:18:27.665068 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:18:27.666163 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m20:18:27.669399 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m20:18:27.669716 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_played_at
from spotify_data.gold.top_tracks
where last_played_at is null



  
  
      
    ) dbt_internal_test
[0m20:18:27.669963 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:18:27.829450 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.750 seconds
[0m20:18:27.831173 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13: Close
[0m20:18:28.248651 [info ] [Thread-4 (]: 19 of 32 PASS not_null_top_artists_unique_tracks ............................... [[32mPASS[0m in 1.18s]
[0m20:18:28.249430 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:18:28.249862 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:18:28.250298 [info ] [Thread-4 (]: 23 of 32 START test not_null_top_tracks_rank ................................... [RUN]
[0m20:18:28.250787 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13, now test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4)
[0m20:18:28.251178 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:18:28.255618 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m20:18:28.256463 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:18:28.342623 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m20:18:28.345000 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m20:18:28.345333 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rank
from spotify_data.gold.top_tracks
where rank is null



  
  
      
    ) dbt_internal_test
[0m20:18:28.345507 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:18:28.538690 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.868 seconds
[0m20:18:28.541050 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532: Close
[0m20:18:28.561385 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.901 seconds
[0m20:18:28.563471 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31: Close
[0m20:18:28.570620 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.911 seconds
[0m20:18:28.572271 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461: Close
[0m20:18:28.745415 [info ] [Thread-3 (]: 21 of 32 PASS not_null_top_tracks_first_played_at .............................. [[32mPASS[0m in 1.10s]
[0m20:18:28.745897 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:18:28.746077 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:18:28.746284 [info ] [Thread-3 (]: 24 of 32 START test not_null_top_tracks_total_listening_time_ms ................ [RUN]
[0m20:18:28.746682 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31, now test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac)
[0m20:18:28.746968 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:18:28.749428 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m20:18:28.750500 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:18:28.751664 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m20:18:28.752070 [info ] [Thread-1 (]: 20 of 32 PASS not_null_top_tracks_artist_name .................................. [[32mPASS[0m in 1.11s]
[0m20:18:28.752837 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:18:28.752412 [info ] [Thread-2 (]: 22 of 32 PASS not_null_top_tracks_last_played_at ............................... [[32mPASS[0m in 1.09s]
[0m20:18:28.753166 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:18:28.753516 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:18:28.753771 [info ] [Thread-1 (]: 25 of 32 START test not_null_top_tracks_total_plays ............................ [RUN]
[0m20:18:28.753979 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:18:28.754316 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m20:18:28.754528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461, now test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893)
[0m20:18:28.754792 [info ] [Thread-2 (]: 26 of 32 START test not_null_top_tracks_track_id ............................... [RUN]
[0m20:18:28.755085 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.top_tracks
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m20:18:28.755328 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:18:28.755628 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532, now test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78)
[0m20:18:28.755841 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:18:28.758812 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m20:18:28.759058 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:18:28.761324 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m20:18:28.761753 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:18:28.763502 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m20:18:28.763747 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:18:28.764757 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m20:18:28.765281 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m20:18:28.765478 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.top_tracks
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m20:18:28.765970 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m20:18:28.766202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:28.766406 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_id
from spotify_data.gold.top_tracks
where track_id is null



  
  
      
    ) dbt_internal_test
[0m20:18:28.769032 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:18:29.042942 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.697 seconds
[0m20:18:29.045862 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4: Close
[0m20:18:29.279031 [info ] [Thread-4 (]: 23 of 32 PASS not_null_top_tracks_rank ......................................... [[32mPASS[0m in 1.03s]
[0m20:18:29.280054 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:18:29.280607 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:18:29.281103 [info ] [Thread-4 (]: 27 of 32 START test not_null_top_tracks_track_name ............................. [RUN]
[0m20:18:29.281722 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4, now test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203)
[0m20:18:29.282182 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:18:29.287766 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m20:18:29.289028 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:18:29.292894 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m20:18:29.294332 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m20:18:29.294773 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_name
from spotify_data.gold.top_tracks
where track_name is null



  
  
      
    ) dbt_internal_test
[0m20:18:29.295119 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:18:29.489787 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.720 seconds
[0m20:18:29.490752 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.735 seconds
[0m20:18:29.493401 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78: Close
[0m20:18:29.494306 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.728 seconds
[0m20:18:29.496202 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac: Close
[0m20:18:29.498988 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893: Close
[0m20:18:29.695154 [info ] [Thread-3 (]: 24 of 32 PASS not_null_top_tracks_total_listening_time_ms ...................... [[32mPASS[0m in 0.95s]
[0m20:18:29.695514 [info ] [Thread-2 (]: 26 of 32 PASS not_null_top_tracks_track_id ..................................... [[32mPASS[0m in 0.94s]
[0m20:18:29.696021 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:18:29.696476 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:18:29.696838 [debug] [Thread-3 (]: Began running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:18:29.697201 [debug] [Thread-2 (]: Began running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:18:29.697570 [info ] [Thread-3 (]: 28 of 32 START test unique_device_usage_device_type ............................ [RUN]
[0m20:18:29.697885 [info ] [Thread-2 (]: 29 of 32 START test unique_top_artists_artist_name ............................. [RUN]
[0m20:18:29.698073 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac, now test.spotify_analytics.unique_device_usage_device_type.e75362861b)
[0m20:18:29.698238 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78, now test.spotify_analytics.unique_top_artists_artist_name.008ffa1533)
[0m20:18:29.698387 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:18:29.698602 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:18:29.703108 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m20:18:29.705686 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m20:18:29.706216 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:18:29.706452 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:18:29.708696 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m20:18:29.709581 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m20:18:29.710249 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m20:18:29.710496 [debug] [Thread-2 (]: On test.spotify_analytics.unique_top_artists_artist_name.008ffa1533: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    artist_name as unique_field,
    count(*) as n_records

from spotify_data.gold.top_artists
where artist_name is not null
group by artist_name
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:18:29.710986 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m20:18:29.711191 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:18:29.711355 [debug] [Thread-3 (]: On test.spotify_analytics.unique_device_usage_device_type.e75362861b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_device_usage_device_type.e75362861b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    device_type as unique_field,
    count(*) as n_records

from spotify_data.gold.device_usage
where device_type is not null
group by device_type
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:18:29.711716 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:18:29.773499 [info ] [Thread-1 (]: 25 of 32 PASS not_null_top_tracks_total_plays .................................. [[32mPASS[0m in 1.02s]
[0m20:18:29.773884 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:18:29.774091 [debug] [Thread-1 (]: Began running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:18:29.774312 [info ] [Thread-1 (]: 30 of 32 START test unique_top_artists_rank .................................... [RUN]
[0m20:18:29.774561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893, now test.spotify_analytics.unique_top_artists_rank.68b5480aed)
[0m20:18:29.774754 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:18:29.776705 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m20:18:29.777082 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:18:29.778079 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m20:18:29.778532 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m20:18:29.778693 [debug] [Thread-1 (]: On test.spotify_analytics.unique_top_artists_rank.68b5480aed: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_artists_rank.68b5480aed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rank as unique_field,
    count(*) as n_records

from spotify_data.gold.top_artists
where rank is not null
group by rank
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:18:29.778847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:30.013265 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.718 seconds
[0m20:18:30.014224 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203: Close
[0m20:18:30.209472 [info ] [Thread-4 (]: 27 of 32 PASS not_null_top_tracks_track_name ................................... [[32mPASS[0m in 0.93s]
[0m20:18:30.209921 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:18:30.210111 [debug] [Thread-4 (]: Began running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:18:30.210306 [info ] [Thread-4 (]: 31 of 32 START test unique_top_tracks_rank ..................................... [RUN]
[0m20:18:30.210553 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203, now test.spotify_analytics.unique_top_tracks_rank.8fecde1136)
[0m20:18:30.210785 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:18:30.213058 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m20:18:30.213519 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:18:30.214700 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m20:18:30.215246 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m20:18:30.215409 [debug] [Thread-4 (]: On test.spotify_analytics.unique_top_tracks_rank.8fecde1136: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rank as unique_field,
    count(*) as n_records

from spotify_data.gold.top_tracks
where rank is not null
group by rank
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:18:30.215556 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:18:30.518453 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.807 seconds
[0m20:18:30.520976 [debug] [Thread-2 (]: On test.spotify_analytics.unique_top_artists_artist_name.008ffa1533: Close
[0m20:18:30.594445 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.816 seconds
[0m20:18:30.596050 [debug] [Thread-1 (]: On test.spotify_analytics.unique_top_artists_rank.68b5480aed: Close
[0m20:18:30.645307 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.933 seconds
[0m20:18:30.647351 [debug] [Thread-3 (]: On test.spotify_analytics.unique_device_usage_device_type.e75362861b: Close
[0m20:18:30.759643 [info ] [Thread-1 (]: 30 of 32 PASS unique_top_artists_rank .......................................... [[32mPASS[0m in 0.98s]
[0m20:18:30.760464 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:18:30.760864 [debug] [Thread-1 (]: Began running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:18:30.761246 [info ] [Thread-1 (]: 32 of 32 START test unique_top_tracks_track_id ................................. [RUN]
[0m20:18:30.761668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_top_artists_rank.68b5480aed, now test.spotify_analytics.unique_top_tracks_track_id.865b43a659)
[0m20:18:30.762059 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:18:30.767352 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m20:18:30.768495 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:18:30.771082 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m20:18:30.772300 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m20:18:30.772595 [debug] [Thread-1 (]: On test.spotify_analytics.unique_top_tracks_track_id.865b43a659: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    track_id as unique_field,
    count(*) as n_records

from spotify_data.gold.top_tracks
where track_id is not null
group by track_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:18:30.772757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:30.791690 [info ] [Thread-3 (]: 28 of 32 PASS unique_device_usage_device_type .................................. [[32mPASS[0m in 1.09s]
[0m20:18:30.792046 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:18:31.058617 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.843 seconds
[0m20:18:31.061763 [debug] [Thread-4 (]: On test.spotify_analytics.unique_top_tracks_rank.8fecde1136: Close
[0m20:18:31.294539 [info ] [Thread-2 (]: 29 of 32 PASS unique_top_artists_artist_name ................................... [[32mPASS[0m in 1.60s]
[0m20:18:31.295540 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:18:31.321454 [info ] [Thread-4 (]: 31 of 32 PASS unique_top_tracks_rank ........................................... [[32mPASS[0m in 1.11s]
[0m20:18:31.322402 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:18:31.802636 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.030 seconds
[0m20:18:31.805898 [debug] [Thread-1 (]: On test.spotify_analytics.unique_top_tracks_track_id.865b43a659: Close
[0m20:18:31.978074 [info ] [Thread-1 (]: 32 of 32 PASS unique_top_tracks_track_id ....................................... [[32mPASS[0m in 1.22s]
[0m20:18:31.978595 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:18:31.979942 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:18:31.980298 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_track_id.865b43a659' was properly closed.
[0m20:18:31.980529 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_artists_artist_name.008ffa1533' was properly closed.
[0m20:18:31.980646 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_rank.8fecde1136' was properly closed.
[0m20:18:31.980752 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_device_usage_device_type.e75362861b' was properly closed.
[0m20:18:31.980901 [info ] [MainThread]: 
[0m20:18:31.981039 [info ] [MainThread]: Finished running 32 data tests in 0 hours 0 minutes and 11.68 seconds (11.68s).
[0m20:18:31.983533 [debug] [MainThread]: Command end result
[0m20:18:32.005087 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:18:32.006490 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:18:32.011127 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m20:18:32.011304 [info ] [MainThread]: 
[0m20:18:32.011486 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:18:32.011634 [info ] [MainThread]: 
[0m20:18:32.011793 [info ] [MainThread]: Done. PASS=32 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=32
[0m20:18:32.013467 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 12.650164, "process_in_blocks": "0", "process_kernel_time": 0.468761, "process_mem_max_rss": "247578624", "process_out_blocks": "0", "process_user_time": 3.936196}
[0m20:18:32.013702 [debug] [MainThread]: Command `dbt test` succeeded at 20:18:32.013656 after 12.65 seconds
[0m20:18:32.013915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b55190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119906a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119907280>]}
[0m20:18:32.014108 [debug] [MainThread]: Flushing usage events
[0m20:18:32.195535 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:19:00.469696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c2be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12495f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12495fb10>]}


============================== 20:19:00.472148 | ea57b8d5-edcf-42f4-b9bd-0fae636c28c3 ==============================
[0m20:19:00.472148 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:19:00.472411 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_format': 'default', 'quiet': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'empty': 'False', 'invocation_command': 'dbt run --models gold', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_colors': 'True', 'no_print': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'debug': 'False', 'printer_width': '80', 'write_json': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs'}
[0m20:19:00.472613 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m20:19:00.472759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ea57b8d5-edcf-42f4-b9bd-0fae636c28c3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1249b10f0>]}
[0m20:19:01.039798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea57b8d5-edcf-42f4-b9bd-0fae636c28c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133e04e20>]}
[0m20:19:01.062622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea57b8d5-edcf-42f4-b9bd-0fae636c28c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133dad250>]}
[0m20:19:01.063148 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:19:01.114671 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:19:01.171891 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:19:01.172079 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:19:01.174417 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m20:19:01.190758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea57b8d5-edcf-42f4-b9bd-0fae636c28c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1343033e0>]}
[0m20:19:01.229236 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:19:01.230790 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:19:01.242730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea57b8d5-edcf-42f4-b9bd-0fae636c28c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13453b310>]}
[0m20:19:01.242923 [info ] [MainThread]: Found 5 models, 43 data tests, 1 source, 604 macros
[0m20:19:01.243057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea57b8d5-edcf-42f4-b9bd-0fae636c28c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134562f70>]}
[0m20:19:01.243985 [info ] [MainThread]: 
[0m20:19:01.244127 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:19:01.244228 [info ] [MainThread]: 
[0m20:19:01.244425 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:19:01.246065 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m20:19:01.251869 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m20:19:01.252029 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m20:19:01.252139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:19:02.451734 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.200 seconds
[0m20:19:02.453074 [debug] [ThreadPool]: On list_spotify_data: Close
[0m20:19:02.607429 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_silver)
[0m20:19:02.614544 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m20:19:02.618470 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m20:19:02.620886 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m20:19:02.621101 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m20:19:02.621234 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m20:19:02.621381 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:19:02.621648 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:19:03.528733 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.907 seconds
[0m20:19:03.532345 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m20:19:03.746816 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.125 seconds
[0m20:19:03.749772 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m20:19:03.922168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea57b8d5-edcf-42f4-b9bd-0fae636c28c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134553650>]}
[0m20:19:03.926488 [debug] [Thread-3 (]: Began running node model.spotify_analytics.top_artists
[0m20:19:03.927049 [debug] [Thread-1 (]: Began running node model.spotify_analytics.daily_user_stats
[0m20:19:03.927455 [debug] [Thread-2 (]: Began running node model.spotify_analytics.device_usage
[0m20:19:03.927638 [debug] [Thread-4 (]: Began running node model.spotify_analytics.top_tracks
[0m20:19:03.927915 [info ] [Thread-3 (]: 3 of 4 START sql table model gold.top_artists .................................. [RUN]
[0m20:19:03.928263 [info ] [Thread-1 (]: 1 of 4 START sql table model gold.daily_user_stats ............................. [RUN]
[0m20:19:03.928697 [info ] [Thread-2 (]: 2 of 4 START sql table model gold.device_usage ................................. [RUN]
[0m20:19:03.929087 [info ] [Thread-4 (]: 4 of 4 START sql table model gold.top_tracks ................................... [RUN]
[0m20:19:03.929581 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.spotify_analytics.top_artists'
[0m20:19:03.929936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.daily_user_stats)
[0m20:19:03.930173 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.device_usage)
[0m20:19:03.930359 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.spotify_analytics.top_tracks'
[0m20:19:03.930519 [debug] [Thread-3 (]: Began compiling node model.spotify_analytics.top_artists
[0m20:19:03.930665 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.daily_user_stats
[0m20:19:03.930839 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.device_usage
[0m20:19:03.931102 [debug] [Thread-4 (]: Began compiling node model.spotify_analytics.top_tracks
[0m20:19:03.936128 [debug] [Thread-3 (]: Writing injected SQL for node "model.spotify_analytics.top_artists"
[0m20:19:03.939006 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.daily_user_stats"
[0m20:19:03.940877 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.device_usage"
[0m20:19:03.942531 [debug] [Thread-4 (]: Writing injected SQL for node "model.spotify_analytics.top_tracks"
[0m20:19:03.943515 [debug] [Thread-3 (]: Began executing node model.spotify_analytics.top_artists
[0m20:19:03.943686 [debug] [Thread-4 (]: Began executing node model.spotify_analytics.top_tracks
[0m20:19:03.943835 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.daily_user_stats
[0m20:19:03.956148 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.device_usage
[0m20:19:03.959581 [debug] [Thread-3 (]: Writing runtime sql for node "model.spotify_analytics.top_artists"
[0m20:19:03.960894 [debug] [Thread-4 (]: Writing runtime sql for node "model.spotify_analytics.top_tracks"
[0m20:19:03.961942 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.daily_user_stats"
[0m20:19:03.962995 [debug] [Thread-2 (]: Writing runtime sql for node "model.spotify_analytics.device_usage"
[0m20:19:03.963918 [debug] [Thread-3 (]: Using snowflake connection "model.spotify_analytics.top_artists"
[0m20:19:03.964628 [debug] [Thread-4 (]: Using snowflake connection "model.spotify_analytics.top_tracks"
[0m20:19:03.964894 [debug] [Thread-3 (]: On model.spotify_analytics.top_artists: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.top_artists"} */
create or replace transient table spotify_data.gold.top_artists
         as
        (

-- ============================================================================
-- GOLD LAYER: TOP ARTISTS BY PLAY COUNT
-- ============================================================================
-- Purpose: Aggregate and rank artists by popularity
-- 
-- Grain: One row per artist (all-time aggregation)
-- Primary Key: artist_name
--
-- Metrics:
--   - Total plays per artist
--   - Total listening time
--   - Number of unique tracks played
--   - First and last play timestamps
--   - Popularity rank
--
-- Source: SILVER.silver_plays
-- Target: GOLD.top_artists
-- ============================================================================

WITH artist_aggregates AS (
    SELECT 
        -- Artist identifier
        artist_name,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        COUNT(DISTINCT track_id) AS unique_tracks,
        MIN(played_at) AS first_played_at,
        MAX(played_at) AS last_played_at
        
    FROM spotify_data.silver.silver_plays
    GROUP BY artist_name
),

ranked_artists AS (
    SELECT 
        *,
        -- Add ranking based on play count (1 = most played artist)
        ROW_NUMBER() OVER (ORDER BY total_plays DESC, total_listening_time_ms DESC) AS rank
    FROM artist_aggregates
)

SELECT 
    -- Identifier
    artist_name::VARCHAR AS artist_name,
    
    -- Metrics
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    unique_tracks::NUMBER AS unique_tracks,
    
    -- Timestamps
    first_played_at::TIMESTAMP AS first_played_at,
    last_played_at::TIMESTAMP AS last_played_at,
    
    -- Ranking
    rank::NUMBER AS rank
    
FROM ranked_artists
ORDER BY rank
        );
[0m20:19:03.965160 [debug] [Thread-4 (]: On model.spotify_analytics.top_tracks: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.top_tracks"} */
create or replace transient table spotify_data.gold.top_tracks
         as
        (

-- ============================================================================
-- GOLD LAYER: TOP TRACKS BY PLAY COUNT
-- ============================================================================
-- Purpose: Aggregate and rank tracks by popularity
-- 
-- Grain: One row per track (all-time aggregation)
-- Primary Key: track_id
--
-- Metrics:
--   - Total plays per track
--   - Total listening time
--   - First and last play timestamps
--   - Popularity rank
--
-- Source: SILVER.silver_plays
-- Target: GOLD.top_tracks
-- ============================================================================

WITH track_aggregates AS (
    SELECT 
        -- Track identifiers and attributes
        track_id,
        track_name,
        artist_name,
        album_name,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        MIN(played_at) AS first_played_at,
        MAX(played_at) AS last_played_at
        
    FROM spotify_data.silver.silver_plays
    GROUP BY 
        track_id,
        track_name,
        artist_name,
        album_name
),

ranked_tracks AS (
    SELECT 
        *,
        -- Add ranking based on play count (1 = most played)
        ROW_NUMBER() OVER (ORDER BY total_plays DESC, total_listening_time_ms DESC) AS rank
    FROM track_aggregates
)

SELECT 
    -- Identifiers
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    
    -- Timestamps
    first_played_at::TIMESTAMP AS first_played_at,
    last_played_at::TIMESTAMP AS last_played_at,
    
    -- Ranking
    rank::NUMBER AS rank
    
FROM ranked_tracks
ORDER BY rank
        );
[0m20:19:03.965796 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.daily_user_stats"
[0m20:19:03.965953 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:19:03.966559 [debug] [Thread-2 (]: Using snowflake connection "model.spotify_analytics.device_usage"
[0m20:19:03.966732 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:19:03.966938 [debug] [Thread-1 (]: On model.spotify_analytics.daily_user_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.daily_user_stats"} */
create or replace transient table spotify_data.gold.daily_user_stats
         as
        (

-- ============================================================================
-- GOLD LAYER: DAILY USER LISTENING STATISTICS
-- ============================================================================
-- Purpose: Aggregate user listening behavior by day
-- 
-- Grain: One row per user per day
-- Primary Key: (date, user_id)
--
-- Metrics:
--   - Total plays per day
--   - Total listening time
--   - Unique tracks/artists played
--   - Average track duration
--
-- Source: SILVER.silver_plays
-- Target: GOLD.daily_user_stats
-- ============================================================================

WITH daily_aggregates AS (
    SELECT 
        -- Date dimension (truncate timestamp to date)
        DATE(played_at) AS date,
        
        -- User identifier
        user_id,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        COUNT(DISTINCT track_id) AS unique_tracks,
        COUNT(DISTINCT artist_name) AS unique_artists,
        AVG(duration_ms) AS avg_track_duration_ms
        
    FROM spotify_data.silver.silver_plays
    GROUP BY 
        DATE(played_at),
        user_id
)

SELECT 
    -- Dimensions
    date,
    user_id,
    
    -- Metrics (cast for clarity)
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    unique_tracks::NUMBER AS unique_tracks,
    unique_artists::NUMBER AS unique_artists,
    ROUND(avg_track_duration_ms, 2)::NUMBER AS avg_track_duration_ms
    
FROM daily_aggregates
ORDER BY date DESC, user_id
        );
[0m20:19:03.967226 [debug] [Thread-2 (]: On model.spotify_analytics.device_usage: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.device_usage"} */
create or replace transient table spotify_data.gold.device_usage
         as
        (

-- ============================================================================
-- GOLD LAYER: DEVICE USAGE STATISTICS
-- ============================================================================
-- Purpose: Aggregate listening behavior by device type
-- 
-- Grain: One row per device type (all-time aggregation)
-- Primary Key: device_type
--
-- Metrics:
--   - Total plays per device
--   - Total listening time
--   - Percentage of total plays
--   - Average track duration
--
-- Source: SILVER.silver_plays
-- Target: GOLD.device_usage
-- ============================================================================

WITH device_aggregates AS (
    SELECT 
        -- Device identifier
        device_type,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        AVG(duration_ms) AS avg_track_duration_ms
        
    FROM spotify_data.silver.silver_plays
    GROUP BY device_type
),

total_plays_calc AS (
    -- Calculate overall total for percentage calculation
    SELECT SUM(total_plays) AS overall_total_plays
    FROM device_aggregates
)

SELECT 
    -- Identifier
    device_type::VARCHAR AS device_type,
    
    -- Metrics
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    
    -- Percentage of total plays
    ROUND((total_plays::FLOAT / overall_total_plays::FLOAT) * 100, 2)::FLOAT AS play_percentage,
    
    -- Average duration
    ROUND(avg_track_duration_ms, 2)::NUMBER AS avg_track_duration_ms
    
FROM device_aggregates
CROSS JOIN total_plays_calc
ORDER BY total_plays DESC
        );
[0m20:19:03.967733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:03.968060 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:19:05.580151 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.612 seconds
[0m20:19:05.581230 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.615 seconds
[0m20:19:05.609171 [debug] [Thread-1 (]: On model.spotify_analytics.daily_user_stats: Close
[0m20:19:05.610168 [debug] [Thread-3 (]: On model.spotify_analytics.top_artists: Close
[0m20:19:05.610550 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.642 seconds
[0m20:19:05.612775 [debug] [Thread-2 (]: On model.spotify_analytics.device_usage: Close
[0m20:19:05.665134 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.698 seconds
[0m20:19:05.666442 [debug] [Thread-4 (]: On model.spotify_analytics.top_tracks: Close
[0m20:19:05.797630 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea57b8d5-edcf-42f4-b9bd-0fae636c28c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123f37490>]}
[0m20:19:05.798112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea57b8d5-edcf-42f4-b9bd-0fae636c28c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122f39c70>]}
[0m20:19:05.798983 [info ] [Thread-2 (]: 2 of 4 OK created sql table model gold.device_usage ............................ [[32mSUCCESS 1[0m in 1.87s]
[0m20:19:05.799535 [info ] [Thread-1 (]: 1 of 4 OK created sql table model gold.daily_user_stats ........................ [[32mSUCCESS 1[0m in 1.87s]
[0m20:19:05.799889 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.device_usage
[0m20:19:05.800259 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.daily_user_stats
[0m20:19:05.812854 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea57b8d5-edcf-42f4-b9bd-0fae636c28c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e293550>]}
[0m20:19:05.813286 [info ] [Thread-4 (]: 4 of 4 OK created sql table model gold.top_tracks .............................. [[32mSUCCESS 1[0m in 1.88s]
[0m20:19:05.813645 [debug] [Thread-4 (]: Finished running node model.spotify_analytics.top_tracks
[0m20:19:05.815732 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea57b8d5-edcf-42f4-b9bd-0fae636c28c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13cf13f50>]}
[0m20:19:05.816021 [info ] [Thread-3 (]: 3 of 4 OK created sql table model gold.top_artists ............................. [[32mSUCCESS 1[0m in 1.89s]
[0m20:19:05.816356 [debug] [Thread-3 (]: Finished running node model.spotify_analytics.top_artists
[0m20:19:05.817624 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:19:05.817852 [debug] [MainThread]: Connection 'model.spotify_analytics.daily_user_stats' was properly closed.
[0m20:19:05.818036 [debug] [MainThread]: Connection 'model.spotify_analytics.device_usage' was properly closed.
[0m20:19:05.818176 [debug] [MainThread]: Connection 'model.spotify_analytics.top_artists' was properly closed.
[0m20:19:05.818281 [debug] [MainThread]: Connection 'model.spotify_analytics.top_tracks' was properly closed.
[0m20:19:05.818429 [info ] [MainThread]: 
[0m20:19:05.818564 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 4.57 seconds (4.57s).
[0m20:19:05.819306 [debug] [MainThread]: Command end result
[0m20:19:05.841309 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:19:05.842869 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:19:05.846287 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m20:19:05.846456 [info ] [MainThread]: 
[0m20:19:05.846634 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:19:05.846771 [info ] [MainThread]: 
[0m20:19:05.846922 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m20:19:05.847182 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:19:05.848741 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.4067097, "process_in_blocks": "0", "process_kernel_time": 0.266243, "process_mem_max_rss": "240500736", "process_out_blocks": "0", "process_user_time": 1.614838}
[0m20:19:05.848970 [debug] [MainThread]: Command `dbt run` succeeded at 20:19:05.848925 after 5.41 seconds
[0m20:19:05.849143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c125d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13cfe9a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13cfe8cb0>]}
[0m20:19:05.849313 [debug] [MainThread]: Flushing usage events
[0m20:19:06.141317 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:19:13.825446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ec7e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094cb9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094cbb10>]}


============================== 20:19:13.827754 | d7755408-29fd-4a6c-b45b-0fa864dcab38 ==============================
[0m20:19:13.827754 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:19:13.828004 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/sunilmakkar/.dbt', 'indirect_selection': 'eager', 'invocation_command': 'dbt test --models gold', 'quiet': 'False', 'introspect': 'True', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'version_check': 'True', 'use_colors': 'True', 'debug': 'False', 'partial_parse': 'True', 'target_path': 'None', 'write_json': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'empty': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False'}
[0m20:19:13.828206 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m20:19:13.828356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd7755408-29fd-4a6c-b45b-0fa864dcab38', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10951d0f0>]}
[0m20:19:14.251598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7755408-29fd-4a6c-b45b-0fa864dcab38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101bce20>]}
[0m20:19:14.275376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7755408-29fd-4a6c-b45b-0fa864dcab38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f1250>]}
[0m20:19:14.275941 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:19:14.329247 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:19:14.388407 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:19:14.388597 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:19:14.390946 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m20:19:14.407685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7755408-29fd-4a6c-b45b-0fa864dcab38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105bf2f0>]}
[0m20:19:14.445055 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:19:14.446162 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:19:14.462045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7755408-29fd-4a6c-b45b-0fa864dcab38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11081fcb0>]}
[0m20:19:14.462248 [info ] [MainThread]: Found 5 models, 43 data tests, 1 source, 604 macros
[0m20:19:14.462385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7755408-29fd-4a6c-b45b-0fa864dcab38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11092d230>]}
[0m20:19:14.463546 [info ] [MainThread]: 
[0m20:19:14.463680 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:19:14.463782 [info ] [MainThread]: 
[0m20:19:14.463976 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:19:14.465660 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m20:19:14.472786 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m20:19:14.472643 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m20:19:14.473641 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m20:19:14.473789 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m20:19:14.473918 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m20:19:14.474036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:19:14.474171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:19:15.589867 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.116 seconds
[0m20:19:15.591629 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m20:19:15.618378 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.144 seconds
[0m20:19:15.619190 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m20:19:15.775970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7755408-29fd-4a6c-b45b-0fa864dcab38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108cc590>]}
[0m20:19:15.780971 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:19:15.781420 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:19:15.781784 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:19:15.782114 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:19:15.782499 [info ] [Thread-3 (]: 3 of 32 START test not_null_daily_user_stats_total_listening_time_ms ........... [RUN]
[0m20:19:15.782931 [info ] [Thread-4 (]: 4 of 32 START test not_null_daily_user_stats_total_plays ....................... [RUN]
[0m20:19:15.783358 [info ] [Thread-1 (]: 1 of 32 START test not_null_daily_user_stats_avg_track_duration_ms ............. [RUN]
[0m20:19:15.783739 [info ] [Thread-2 (]: 2 of 32 START test not_null_daily_user_stats_date .............................. [RUN]
[0m20:19:15.784247 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87'
[0m20:19:15.784658 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282'
[0m20:19:15.784993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155)
[0m20:19:15.785312 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9)
[0m20:19:15.785623 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:19:15.785922 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:19:15.786223 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:19:15.786506 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:19:15.803575 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m20:19:15.804658 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m20:19:15.806964 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m20:19:15.808597 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m20:19:15.809347 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:19:15.809622 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:19:15.815888 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:19:15.816074 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:19:15.821885 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m20:19:15.823157 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m20:19:15.824099 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m20:19:15.825258 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m20:19:15.825836 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m20:19:15.826035 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.daily_user_stats
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m20:19:15.826345 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m20:19:15.826492 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:19:15.826675 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from spotify_data.gold.daily_user_stats
where date is null



  
  
      
    ) dbt_internal_test
[0m20:19:15.826978 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m20:19:15.827298 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m20:19:15.827702 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:19:15.827989 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.daily_user_stats
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m20:19:15.828263 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_track_duration_ms
from spotify_data.gold.daily_user_stats
where avg_track_duration_ms is null



  
  
      
    ) dbt_internal_test
[0m20:19:15.829174 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:19:15.829464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:16.623925 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.794 seconds
[0m20:19:16.625147 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.797 seconds
[0m20:19:16.637561 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155: Close
[0m20:19:16.639639 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9: Close
[0m20:19:16.799560 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.973 seconds
[0m20:19:16.801467 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282: Close
[0m20:19:16.832381 [info ] [Thread-2 (]: 2 of 32 PASS not_null_daily_user_stats_date .................................... [[32mPASS[0m in 1.05s]
[0m20:19:16.833281 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:19:16.833818 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:19:16.834316 [info ] [Thread-2 (]: 5 of 32 START test not_null_daily_user_stats_unique_artists .................... [RUN]
[0m20:19:16.834807 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9, now test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f)
[0m20:19:16.835160 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:19:16.840020 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m20:19:16.842982 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:19:16.846178 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m20:19:16.846881 [info ] [Thread-1 (]: 1 of 32 PASS not_null_daily_user_stats_avg_track_duration_ms ................... [[32mPASS[0m in 1.06s]
[0m20:19:16.847577 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:19:16.847768 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:19:16.847938 [info ] [Thread-1 (]: 6 of 32 START test not_null_daily_user_stats_unique_tracks ..................... [RUN]
[0m20:19:16.848177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155, now test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac)
[0m20:19:16.848829 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m20:19:16.849223 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:19:16.849576 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unique_artists
from spotify_data.gold.daily_user_stats
where unique_artists is null



  
  
      
    ) dbt_internal_test
[0m20:19:16.852680 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m20:19:16.853052 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:19:16.853822 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.025 seconds
[0m20:19:16.855463 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87: Close
[0m20:19:16.856759 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:19:16.858730 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m20:19:16.859825 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m20:19:16.860526 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unique_tracks
from spotify_data.gold.daily_user_stats
where unique_tracks is null



  
  
      
    ) dbt_internal_test
[0m20:19:16.860829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:16.985157 [info ] [Thread-4 (]: 4 of 32 PASS not_null_daily_user_stats_total_plays ............................. [[32mPASS[0m in 1.20s]
[0m20:19:16.985474 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:19:16.985635 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:19:16.985813 [info ] [Thread-4 (]: 7 of 32 START test not_null_daily_user_stats_user_id ........................... [RUN]
[0m20:19:16.986016 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282, now test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b)
[0m20:19:16.986171 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:19:16.987834 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m20:19:16.988185 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:19:16.989426 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m20:19:16.989840 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m20:19:16.989986 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from spotify_data.gold.daily_user_stats
where user_id is null



  
  
      
    ) dbt_internal_test
[0m20:19:16.990117 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:19:17.033938 [info ] [Thread-3 (]: 3 of 32 PASS not_null_daily_user_stats_total_listening_time_ms ................. [[32mPASS[0m in 1.25s]
[0m20:19:17.034262 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:19:17.034428 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:19:17.034589 [info ] [Thread-3 (]: 8 of 32 START test not_null_device_usage_avg_track_duration_ms ................. [RUN]
[0m20:19:17.034754 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87, now test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003)
[0m20:19:17.034895 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:19:17.036534 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m20:19:17.036908 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:19:17.038130 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m20:19:17.038676 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m20:19:17.038825 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_track_duration_ms
from spotify_data.gold.device_usage
where avg_track_duration_ms is null



  
  
      
    ) dbt_internal_test
[0m20:19:17.038961 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:19:17.576021 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.723 seconds
[0m20:19:17.578544 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f: Close
[0m20:19:17.619950 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.759 seconds
[0m20:19:17.622561 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac: Close
[0m20:19:17.734826 [info ] [Thread-2 (]: 5 of 32 PASS not_null_daily_user_stats_unique_artists .......................... [[32mPASS[0m in 0.90s]
[0m20:19:17.735770 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:19:17.736302 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:19:17.736804 [info ] [Thread-2 (]: 9 of 32 START test not_null_device_usage_device_type ........................... [RUN]
[0m20:19:17.737419 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f, now test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c)
[0m20:19:17.737875 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:19:17.743333 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m20:19:17.744614 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:19:17.747408 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m20:19:17.750212 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m20:19:17.750719 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select device_type
from spotify_data.gold.device_usage
where device_type is null



  
  
      
    ) dbt_internal_test
[0m20:19:17.751072 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:19:17.789011 [info ] [Thread-1 (]: 6 of 32 PASS not_null_daily_user_stats_unique_tracks ........................... [[32mPASS[0m in 0.94s]
[0m20:19:17.789338 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:19:17.789547 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:19:17.789868 [info ] [Thread-1 (]: 10 of 32 START test not_null_device_usage_play_percentage ...................... [RUN]
[0m20:19:17.790249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac, now test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2)
[0m20:19:17.790530 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:19:17.792687 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m20:19:17.793031 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:19:17.794364 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m20:19:17.794854 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m20:19:17.795034 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select play_percentage
from spotify_data.gold.device_usage
where play_percentage is null



  
  
      
    ) dbt_internal_test
[0m20:19:17.795309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:17.835411 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.796 seconds
[0m20:19:17.836717 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003: Close
[0m20:19:17.992646 [info ] [Thread-3 (]: 8 of 32 PASS not_null_device_usage_avg_track_duration_ms ....................... [[32mPASS[0m in 0.96s]
[0m20:19:17.993605 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:19:17.994111 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:19:17.994579 [info ] [Thread-3 (]: 11 of 32 START test not_null_device_usage_total_listening_time_ms .............. [RUN]
[0m20:19:17.995137 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003, now test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2)
[0m20:19:17.995547 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:19:18.001031 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m20:19:18.002186 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:19:18.004284 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m20:19:18.005109 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m20:19:18.005292 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.device_usage
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m20:19:18.005457 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:19:18.600631 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.849 seconds
[0m20:19:18.603438 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c: Close
[0m20:19:18.757814 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.752 seconds
[0m20:19:18.761247 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2: Close
[0m20:19:18.764602 [info ] [Thread-2 (]: 9 of 32 PASS not_null_device_usage_device_type ................................. [[32mPASS[0m in 1.03s]
[0m20:19:18.765380 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:19:18.765805 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:19:18.766227 [info ] [Thread-2 (]: 12 of 32 START test not_null_device_usage_total_plays .......................... [RUN]
[0m20:19:18.766817 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c, now test.spotify_analytics.not_null_device_usage_total_plays.90a295df48)
[0m20:19:18.767270 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:19:18.772300 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m20:19:18.773697 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:19:18.775981 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m20:19:18.777178 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m20:19:18.777611 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_device_usage_total_plays.90a295df48: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.device_usage
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m20:19:18.777926 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:19:18.906248 [info ] [Thread-3 (]: 11 of 32 PASS not_null_device_usage_total_listening_time_ms .................... [[32mPASS[0m in 0.91s]
[0m20:19:18.907191 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:19:18.907738 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:19:18.908279 [info ] [Thread-3 (]: 13 of 32 START test not_null_top_artists_artist_name ........................... [RUN]
[0m20:19:18.908865 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2, now test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e)
[0m20:19:18.909182 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:19:18.914369 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m20:19:18.915506 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:19:18.917944 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m20:19:18.919040 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m20:19:18.919436 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select artist_name
from spotify_data.gold.top_artists
where artist_name is null



  
  
      
    ) dbt_internal_test
[0m20:19:18.919649 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:19:18.977074 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.987 seconds
[0m20:19:18.978579 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b: Close
[0m20:19:19.177701 [info ] [Thread-4 (]: 7 of 32 PASS not_null_daily_user_stats_user_id ................................. [[32mPASS[0m in 2.19s]
[0m20:19:19.178258 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:19:19.178437 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:19:19.178631 [info ] [Thread-4 (]: 14 of 32 START test not_null_top_artists_first_played_at ....................... [RUN]
[0m20:19:19.178917 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b, now test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14)
[0m20:19:19.179241 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:19:19.181990 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m20:19:19.182590 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:19:19.183988 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m20:19:19.184514 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m20:19:19.184784 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_played_at
from spotify_data.gold.top_artists
where first_played_at is null



  
  
      
    ) dbt_internal_test
[0m20:19:19.185029 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:19:19.406101 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.611 seconds
[0m20:19:19.408754 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2: Close
[0m20:19:19.502689 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.725 seconds
[0m20:19:19.504253 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_device_usage_total_plays.90a295df48: Close
[0m20:19:19.592998 [info ] [Thread-1 (]: 10 of 32 PASS not_null_device_usage_play_percentage ............................ [[32mPASS[0m in 1.80s]
[0m20:19:19.593840 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:19:19.594231 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:19:19.594431 [info ] [Thread-1 (]: 15 of 32 START test not_null_top_artists_last_played_at ........................ [RUN]
[0m20:19:19.594660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2, now test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca)
[0m20:19:19.594824 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:19:19.597637 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m20:19:19.598033 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:19:19.599720 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m20:19:19.600873 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m20:19:19.601179 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_played_at
from spotify_data.gold.top_artists
where last_played_at is null



  
  
      
    ) dbt_internal_test
[0m20:19:19.601453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:19.655872 [info ] [Thread-2 (]: 12 of 32 PASS not_null_device_usage_total_plays ................................ [[32mPASS[0m in 0.89s]
[0m20:19:19.656299 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:19:19.656628 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:19:19.656895 [info ] [Thread-2 (]: 16 of 32 START test not_null_top_artists_rank .................................. [RUN]
[0m20:19:19.657160 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_plays.90a295df48, now test.spotify_analytics.not_null_top_artists_rank.d14513fc96)
[0m20:19:19.657381 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:19:19.659422 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m20:19:19.659766 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:19:19.660981 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m20:19:19.661376 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m20:19:19.661532 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_rank.d14513fc96: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rank
from spotify_data.gold.top_artists
where rank is null



  
  
      
    ) dbt_internal_test
[0m20:19:19.661677 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:19:19.680630 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.761 seconds
[0m20:19:19.681653 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e: Close
[0m20:19:19.828963 [info ] [Thread-3 (]: 13 of 32 PASS not_null_top_artists_artist_name ................................. [[32mPASS[0m in 0.92s]
[0m20:19:19.829716 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:19:19.830150 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:19:19.830582 [info ] [Thread-3 (]: 17 of 32 START test not_null_top_artists_total_listening_time_ms ............... [RUN]
[0m20:19:19.831222 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e, now test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c)
[0m20:19:19.831592 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:19:19.836423 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m20:19:19.837501 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:19:19.839706 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m20:19:19.840252 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m20:19:19.840588 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.top_artists
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m20:19:19.841227 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:19:19.895138 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.710 seconds
[0m20:19:19.896219 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14: Close
[0m20:19:20.037862 [info ] [Thread-4 (]: 14 of 32 PASS not_null_top_artists_first_played_at ............................. [[32mPASS[0m in 0.86s]
[0m20:19:20.038305 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:19:20.038531 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:19:20.038764 [info ] [Thread-4 (]: 18 of 32 START test not_null_top_artists_total_plays ........................... [RUN]
[0m20:19:20.039022 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14, now test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11)
[0m20:19:20.039217 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:19:20.041332 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m20:19:20.042270 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:19:20.043939 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m20:19:20.044711 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m20:19:20.044955 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.top_artists
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m20:19:20.045128 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:19:20.357624 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.756 seconds
[0m20:19:20.360283 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca: Close
[0m20:19:20.362448 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.701 seconds
[0m20:19:20.364292 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_rank.d14513fc96: Close
[0m20:19:20.520989 [info ] [Thread-1 (]: 15 of 32 PASS not_null_top_artists_last_played_at .............................. [[32mPASS[0m in 0.93s]
[0m20:19:20.521672 [info ] [Thread-2 (]: 16 of 32 PASS not_null_top_artists_rank ........................................ [[32mPASS[0m in 0.86s]
[0m20:19:20.522414 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:19:20.523035 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:19:20.523537 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:19:20.524049 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:19:20.524539 [info ] [Thread-1 (]: 19 of 32 START test not_null_top_artists_unique_tracks ......................... [RUN]
[0m20:19:20.525452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca, now test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13)
[0m20:19:20.525013 [info ] [Thread-2 (]: 20 of 32 START test not_null_top_tracks_artist_name ............................ [RUN]
[0m20:19:20.525903 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:19:20.526281 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_rank.d14513fc96, now test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461)
[0m20:19:20.531387 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m20:19:20.531855 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:19:20.535967 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m20:19:20.537500 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:19:20.537911 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:19:20.540700 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m20:19:20.541702 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m20:19:20.542386 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m20:19:20.542904 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m20:19:20.543187 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unique_tracks
from spotify_data.gold.top_artists
where unique_tracks is null



  
  
      
    ) dbt_internal_test
[0m20:19:20.543475 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select artist_name
from spotify_data.gold.top_tracks
where artist_name is null



  
  
      
    ) dbt_internal_test
[0m20:19:20.543659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:20.543797 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:19:20.560428 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.719 seconds
[0m20:19:20.561521 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c: Close
[0m20:19:20.721290 [info ] [Thread-3 (]: 17 of 32 PASS not_null_top_artists_total_listening_time_ms ..................... [[32mPASS[0m in 0.89s]
[0m20:19:20.721797 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:19:20.722058 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:19:20.722321 [info ] [Thread-3 (]: 21 of 32 START test not_null_top_tracks_first_played_at ........................ [RUN]
[0m20:19:20.722587 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c, now test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31)
[0m20:19:20.722772 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:19:20.725237 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m20:19:20.725638 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:19:20.726927 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m20:19:20.727491 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m20:19:20.727721 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_played_at
from spotify_data.gold.top_tracks
where first_played_at is null



  
  
      
    ) dbt_internal_test
[0m20:19:20.727908 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:19:20.828904 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.784 seconds
[0m20:19:20.829908 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11: Close
[0m20:19:20.993228 [info ] [Thread-4 (]: 18 of 32 PASS not_null_top_artists_total_plays ................................. [[32mPASS[0m in 0.95s]
[0m20:19:20.993748 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:19:20.994048 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:19:20.994313 [info ] [Thread-4 (]: 22 of 32 START test not_null_top_tracks_last_played_at ......................... [RUN]
[0m20:19:20.994550 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11, now test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532)
[0m20:19:20.994725 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:19:20.996904 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m20:19:20.997273 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:19:20.998276 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m20:19:21.000914 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m20:19:21.001239 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_played_at
from spotify_data.gold.top_tracks
where last_played_at is null



  
  
      
    ) dbt_internal_test
[0m20:19:21.001477 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:19:21.275695 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.732 seconds
[0m20:19:21.278909 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13: Close
[0m20:19:21.348727 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.805 seconds
[0m20:19:21.349904 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461: Close
[0m20:19:21.426172 [info ] [Thread-1 (]: 19 of 32 PASS not_null_top_artists_unique_tracks ............................... [[32mPASS[0m in 0.90s]
[0m20:19:21.426591 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:19:21.426790 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:19:21.426987 [info ] [Thread-1 (]: 23 of 32 START test not_null_top_tracks_rank ................................... [RUN]
[0m20:19:21.427437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13, now test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4)
[0m20:19:21.427849 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:19:21.430342 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m20:19:21.431588 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:19:21.432768 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m20:19:21.433753 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m20:19:21.433935 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rank
from spotify_data.gold.top_tracks
where rank is null



  
  
      
    ) dbt_internal_test
[0m20:19:21.434097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:21.475674 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.748 seconds
[0m20:19:21.477161 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31: Close
[0m20:19:21.589305 [info ] [Thread-2 (]: 20 of 32 PASS not_null_top_tracks_artist_name .................................. [[32mPASS[0m in 1.06s]
[0m20:19:21.589701 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:19:21.589982 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:19:21.590288 [info ] [Thread-2 (]: 24 of 32 START test not_null_top_tracks_total_listening_time_ms ................ [RUN]
[0m20:19:21.590652 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461, now test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac)
[0m20:19:21.590918 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:19:21.593082 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m20:19:21.593512 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:19:21.594614 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m20:19:21.595113 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m20:19:21.595326 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.top_tracks
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m20:19:21.595526 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:19:21.630764 [info ] [Thread-3 (]: 21 of 32 PASS not_null_top_tracks_first_played_at .............................. [[32mPASS[0m in 0.91s]
[0m20:19:21.631183 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:19:21.631398 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:19:21.631629 [info ] [Thread-3 (]: 25 of 32 START test not_null_top_tracks_total_plays ............................ [RUN]
[0m20:19:21.631867 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31, now test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893)
[0m20:19:21.632040 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:19:21.634165 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m20:19:21.634555 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:19:21.635599 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m20:19:21.636090 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m20:19:21.636278 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.top_tracks
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m20:19:21.636452 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:19:21.764842 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.763 seconds
[0m20:19:21.765892 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532: Close
[0m20:19:21.929569 [info ] [Thread-4 (]: 22 of 32 PASS not_null_top_tracks_last_played_at ............................... [[32mPASS[0m in 0.93s]
[0m20:19:21.930608 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:19:21.931109 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:19:21.931586 [info ] [Thread-4 (]: 26 of 32 START test not_null_top_tracks_track_id ............................... [RUN]
[0m20:19:21.932151 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532, now test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78)
[0m20:19:21.932561 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:19:21.938371 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m20:19:21.939036 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:19:21.941152 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m20:19:21.941874 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m20:19:21.942430 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_id
from spotify_data.gold.top_tracks
where track_id is null



  
  
      
    ) dbt_internal_test
[0m20:19:21.942990 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:19:22.343869 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.748 seconds
[0m20:19:22.345778 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac: Close
[0m20:19:22.385716 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.749 seconds
[0m20:19:22.388282 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893: Close
[0m20:19:22.498309 [info ] [Thread-2 (]: 24 of 32 PASS not_null_top_tracks_total_listening_time_ms ...................... [[32mPASS[0m in 0.91s]
[0m20:19:22.499221 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:19:22.499696 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:19:22.500155 [info ] [Thread-2 (]: 27 of 32 START test not_null_top_tracks_track_name ............................. [RUN]
[0m20:19:22.500636 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac, now test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203)
[0m20:19:22.501024 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:19:22.505699 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m20:19:22.507484 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:19:22.509874 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m20:19:22.512046 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m20:19:22.512671 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_name
from spotify_data.gold.top_tracks
where track_name is null



  
  
      
    ) dbt_internal_test
[0m20:19:22.513840 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:19:22.514496 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.080 seconds
[0m20:19:22.516149 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4: Close
[0m20:19:22.581372 [info ] [Thread-3 (]: 25 of 32 PASS not_null_top_tracks_total_plays .................................. [[32mPASS[0m in 0.95s]
[0m20:19:22.581870 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:19:22.582164 [debug] [Thread-3 (]: Began running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:19:22.582476 [info ] [Thread-3 (]: 28 of 32 START test unique_device_usage_device_type ............................ [RUN]
[0m20:19:22.582848 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893, now test.spotify_analytics.unique_device_usage_device_type.e75362861b)
[0m20:19:22.583122 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:19:22.586742 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m20:19:22.588104 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:19:22.591647 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m20:19:22.592282 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m20:19:22.592510 [debug] [Thread-3 (]: On test.spotify_analytics.unique_device_usage_device_type.e75362861b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_device_usage_device_type.e75362861b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    device_type as unique_field,
    count(*) as n_records

from spotify_data.gold.device_usage
where device_type is not null
group by device_type
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:19:22.592714 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:19:22.688357 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.745 seconds
[0m20:19:22.689180 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78: Close
[0m20:19:22.689447 [info ] [Thread-1 (]: 23 of 32 PASS not_null_top_tracks_rank ......................................... [[32mPASS[0m in 1.26s]
[0m20:19:22.690031 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:19:22.690321 [debug] [Thread-1 (]: Began running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:19:22.690623 [info ] [Thread-1 (]: 29 of 32 START test unique_top_artists_artist_name ............................. [RUN]
[0m20:19:22.690846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4, now test.spotify_analytics.unique_top_artists_artist_name.008ffa1533)
[0m20:19:22.691024 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:19:22.692564 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m20:19:22.693014 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:19:22.694061 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m20:19:22.694441 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m20:19:22.694576 [debug] [Thread-1 (]: On test.spotify_analytics.unique_top_artists_artist_name.008ffa1533: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    artist_name as unique_field,
    count(*) as n_records

from spotify_data.gold.top_artists
where artist_name is not null
group by artist_name
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:19:22.694702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:22.836729 [info ] [Thread-4 (]: 26 of 32 PASS not_null_top_tracks_track_id ..................................... [[32mPASS[0m in 0.90s]
[0m20:19:22.837105 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:19:22.837286 [debug] [Thread-4 (]: Began running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:19:22.837462 [info ] [Thread-4 (]: 30 of 32 START test unique_top_artists_rank .................................... [RUN]
[0m20:19:22.837653 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78, now test.spotify_analytics.unique_top_artists_rank.68b5480aed)
[0m20:19:22.837826 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:19:22.840001 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m20:19:22.840399 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:19:22.841442 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m20:19:22.842309 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m20:19:22.842483 [debug] [Thread-4 (]: On test.spotify_analytics.unique_top_artists_rank.68b5480aed: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_artists_rank.68b5480aed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rank as unique_field,
    count(*) as n_records

from spotify_data.gold.top_artists
where rank is not null
group by rank
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:19:22.842637 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:19:23.267252 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.753 seconds
[0m20:19:23.269845 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203: Close
[0m20:19:23.442440 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.849 seconds
[0m20:19:23.444852 [debug] [Thread-3 (]: On test.spotify_analytics.unique_device_usage_device_type.e75362861b: Close
[0m20:19:23.454208 [info ] [Thread-2 (]: 27 of 32 PASS not_null_top_tracks_track_name ................................... [[32mPASS[0m in 0.95s]
[0m20:19:23.454846 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:19:23.455216 [debug] [Thread-2 (]: Began running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:19:23.455593 [info ] [Thread-2 (]: 31 of 32 START test unique_top_tracks_rank ..................................... [RUN]
[0m20:19:23.456008 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203, now test.spotify_analytics.unique_top_tracks_rank.8fecde1136)
[0m20:19:23.456338 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:19:23.461295 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m20:19:23.462358 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:19:23.464406 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m20:19:23.466547 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m20:19:23.466751 [debug] [Thread-2 (]: On test.spotify_analytics.unique_top_tracks_rank.8fecde1136: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rank as unique_field,
    count(*) as n_records

from spotify_data.gold.top_tracks
where rank is not null
group by rank
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:19:23.466920 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:19:23.525207 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.830 seconds
[0m20:19:23.526844 [debug] [Thread-1 (]: On test.spotify_analytics.unique_top_artists_artist_name.008ffa1533: Close
[0m20:19:23.536015 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.693 seconds
[0m20:19:23.537162 [debug] [Thread-4 (]: On test.spotify_analytics.unique_top_artists_rank.68b5480aed: Close
[0m20:19:23.614158 [info ] [Thread-3 (]: 28 of 32 PASS unique_device_usage_device_type .................................. [[32mPASS[0m in 1.03s]
[0m20:19:23.614987 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:19:23.615531 [debug] [Thread-3 (]: Began running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:19:23.616030 [info ] [Thread-3 (]: 32 of 32 START test unique_top_tracks_track_id ................................. [RUN]
[0m20:19:23.616612 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_device_usage_device_type.e75362861b, now test.spotify_analytics.unique_top_tracks_track_id.865b43a659)
[0m20:19:23.617052 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:19:23.622334 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m20:19:23.623471 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:19:23.626034 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m20:19:23.627493 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m20:19:23.627957 [debug] [Thread-3 (]: On test.spotify_analytics.unique_top_tracks_track_id.865b43a659: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    track_id as unique_field,
    count(*) as n_records

from spotify_data.gold.top_tracks
where track_id is not null
group by track_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:19:23.628535 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:19:23.685645 [info ] [Thread-4 (]: 30 of 32 PASS unique_top_artists_rank .......................................... [[32mPASS[0m in 0.85s]
[0m20:19:23.686099 [info ] [Thread-1 (]: 29 of 32 PASS unique_top_artists_artist_name ................................... [[32mPASS[0m in 1.00s]
[0m20:19:23.686832 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:19:23.687243 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:19:24.218226 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.751 seconds
[0m20:19:24.220778 [debug] [Thread-2 (]: On test.spotify_analytics.unique_top_tracks_rank.8fecde1136: Close
[0m20:19:24.384483 [info ] [Thread-2 (]: 31 of 32 PASS unique_top_tracks_rank ........................................... [[32mPASS[0m in 0.93s]
[0m20:19:24.385458 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:19:24.401680 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.773 seconds
[0m20:19:24.404472 [debug] [Thread-3 (]: On test.spotify_analytics.unique_top_tracks_track_id.865b43a659: Close
[0m20:19:24.559104 [info ] [Thread-3 (]: 32 of 32 PASS unique_top_tracks_track_id ....................................... [[32mPASS[0m in 0.94s]
[0m20:19:24.560079 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:19:24.562261 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:19:24.562584 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_artists_artist_name.008ffa1533' was properly closed.
[0m20:19:24.562836 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_rank.8fecde1136' was properly closed.
[0m20:19:24.563074 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_track_id.865b43a659' was properly closed.
[0m20:19:24.563307 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_artists_rank.68b5480aed' was properly closed.
[0m20:19:24.563624 [info ] [MainThread]: 
[0m20:19:24.563970 [info ] [MainThread]: Finished running 32 data tests in 0 hours 0 minutes and 10.10 seconds (10.10s).
[0m20:19:24.569270 [debug] [MainThread]: Command end result
[0m20:19:24.599742 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:19:24.600896 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:19:24.605566 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m20:19:24.605747 [info ] [MainThread]: 
[0m20:19:24.605932 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:19:24.606083 [info ] [MainThread]: 
[0m20:19:24.606238 [info ] [MainThread]: Done. PASS=32 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=32
[0m20:19:24.606589 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:19:24.608000 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 10.807893, "process_in_blocks": "0", "process_kernel_time": 0.388612, "process_mem_max_rss": "255000576", "process_out_blocks": "0", "process_user_time": 3.723943}
[0m20:19:24.608206 [debug] [MainThread]: Command `dbt test` succeeded at 20:19:24.608166 after 10.81 seconds
[0m20:19:24.608374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1183c3ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109e9270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109e94f0>]}
[0m20:19:24.608535 [debug] [MainThread]: Flushing usage events
[0m20:19:24.781634 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:33:30.565238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10709be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11085f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11085fb10>]}


============================== 20:33:30.567865 | 96f8c572-d6f6-40c1-90ec-1658d30e4f88 ==============================
[0m20:33:30.567865 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:33:30.568129 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'no_print': 'None', 'printer_width': '80', 'quiet': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'debug': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'log_format': 'default', 'use_colors': 'True', 'warn_error': 'None', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'indirect_selection': 'eager'}
[0m20:33:31.173669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96f8c572-d6f6-40c1-90ec-1658d30e4f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077acb00>]}
[0m20:33:31.198500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96f8c572-d6f6-40c1-90ec-1658d30e4f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120d04e20>]}
[0m20:33:31.199115 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:33:31.253774 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:33:31.318634 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:33:31.318848 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:33:31.321316 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m20:33:31.339198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96f8c572-d6f6-40c1-90ec-1658d30e4f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120cad350>]}
[0m20:33:31.380957 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:33:31.383226 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:33:31.396214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96f8c572-d6f6-40c1-90ec-1658d30e4f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120c82d50>]}
[0m20:33:31.396457 [info ] [MainThread]: Found 5 models, 43 data tests, 1 source, 604 macros
[0m20:33:31.396635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96f8c572-d6f6-40c1-90ec-1658d30e4f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121d3b690>]}
[0m20:33:31.397824 [info ] [MainThread]: 
[0m20:33:31.397990 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:33:31.398091 [info ] [MainThread]: 
[0m20:33:31.398292 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:33:31.400096 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m20:33:31.400309 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m20:33:31.407048 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m20:33:31.408121 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m20:33:31.408307 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m20:33:31.408431 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m20:33:31.408562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:31.408669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:32.709255 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.300 seconds
[0m20:33:32.710009 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.301 seconds
[0m20:33:32.710903 [debug] [ThreadPool]: On list_spotify_data: Close
[0m20:33:32.711972 [debug] [ThreadPool]: On list_spotify_data: Close
[0m20:33:32.869940 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_gold)
[0m20:33:32.876808 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_silver)
[0m20:33:32.877215 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m20:33:32.878997 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m20:33:32.879276 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m20:33:32.879502 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m20:33:32.879707 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:33:32.879898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:33:33.793241 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.913 seconds
[0m20:33:33.796357 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m20:33:34.059319 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.179 seconds
[0m20:33:34.061866 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m20:33:34.223093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96f8c572-d6f6-40c1-90ec-1658d30e4f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121f74460>]}
[0m20:33:34.229419 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m20:33:34.230268 [info ] [Thread-1 (]: 1 of 5 START sql table model silver.silver_plays ............................... [RUN]
[0m20:33:34.230869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.silver_plays)
[0m20:33:34.231267 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m20:33:34.239095 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m20:33:34.240326 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m20:33:34.259248 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.silver_plays"
[0m20:33:34.260699 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.silver_plays"
[0m20:33:34.260983 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.silver_plays"} */
create or replace transient table spotify_data.silver.silver_plays
         as
        (

-- ============================================================================
-- SILVER LAYER: CLEANED PLAYS DATA
-- ============================================================================
-- Purpose: Transform bronze plays data into clean, analytics-ready format
-- 
-- Transformations:
--   1. Deduplicate records (DISTINCT on event_id)
--   2. Cast all data types from VARIANT to proper types
--   3. Filter invalid records (defensive WHERE clauses)
--   4. Add processing metadata (processed_at timestamp)
--
-- Source: bronze.plays (external table reading from S3 Parquet files)
-- Target: SILVER.silver_plays (materialized table)
-- ============================================================================

WITH source_data AS (
    SELECT 
        VALUE:event_id::VARCHAR AS event_id,
        VALUE:user_id::VARCHAR AS user_id,
        VALUE:event_type::VARCHAR AS event_type,
        VALUE:track_id::VARCHAR AS track_id,
        VALUE:track_name::VARCHAR AS track_name,
        VALUE:artist_name::VARCHAR AS artist_name,
        VALUE:album_name::VARCHAR AS album_name,
        VALUE:duration_ms::NUMBER AS duration_ms,
        VALUE:played_at::VARCHAR AS played_at,
        VALUE:device_type::VARCHAR AS device_type
    FROM spotify_data.bronze.plays
),

deduplicated AS (
    SELECT DISTINCT
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM source_data
    WHERE 
        -- Data quality filters
        user_id IS NOT NULL
        AND duration_ms > 0
        AND duration_ms < 600000  -- Less than 10 minutes (catches data errors)
        AND event_id IS NOT NULL
)

SELECT 
    -- Identifiers
    event_id::VARCHAR AS event_id,
    user_id::VARCHAR AS user_id,
    event_type::VARCHAR AS event_type,
    
    -- Track information
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    duration_ms::NUMBER AS duration_ms,
    
    -- Timestamps
    TRY_CAST(played_at AS TIMESTAMP) AS played_at,
    
    -- Device context
    device_type::VARCHAR AS device_type,
    
    -- Metadata
    CURRENT_TIMESTAMP() AS processed_at
    
FROM deduplicated
        );
[0m20:33:34.261232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:36.639579 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.378 seconds
[0m20:33:36.660731 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: Close
[0m20:33:37.152416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96f8c572-d6f6-40c1-90ec-1658d30e4f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121f87890>]}
[0m20:33:37.153363 [info ] [Thread-1 (]: 1 of 5 OK created sql table model silver.silver_plays .......................... [[32mSUCCESS 1[0m in 2.92s]
[0m20:33:37.153984 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m20:33:37.154992 [debug] [Thread-4 (]: Began running node model.spotify_analytics.top_artists
[0m20:33:37.155379 [debug] [Thread-1 (]: Began running node model.spotify_analytics.top_tracks
[0m20:33:37.156254 [debug] [Thread-3 (]: Began running node model.spotify_analytics.device_usage
[0m20:33:37.156569 [debug] [Thread-2 (]: Began running node model.spotify_analytics.daily_user_stats
[0m20:33:37.155948 [info ] [Thread-4 (]: 4 of 5 START sql table model gold.top_artists .................................. [RUN]
[0m20:33:37.157095 [info ] [Thread-1 (]: 5 of 5 START sql table model gold.top_tracks ................................... [RUN]
[0m20:33:37.157574 [info ] [Thread-3 (]: 3 of 5 START sql table model gold.device_usage ................................. [RUN]
[0m20:33:37.158076 [info ] [Thread-2 (]: 2 of 5 START sql table model gold.daily_user_stats ............................. [RUN]
[0m20:33:37.158643 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.spotify_analytics.top_artists'
[0m20:33:37.159048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.silver_plays, now model.spotify_analytics.top_tracks)
[0m20:33:37.159465 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.spotify_analytics.device_usage'
[0m20:33:37.159854 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.daily_user_stats)
[0m20:33:37.160558 [debug] [Thread-4 (]: Began compiling node model.spotify_analytics.top_artists
[0m20:33:37.160762 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.top_tracks
[0m20:33:37.160918 [debug] [Thread-3 (]: Began compiling node model.spotify_analytics.device_usage
[0m20:33:37.161065 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.daily_user_stats
[0m20:33:37.164117 [debug] [Thread-4 (]: Writing injected SQL for node "model.spotify_analytics.top_artists"
[0m20:33:37.168064 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.top_tracks"
[0m20:33:37.169924 [debug] [Thread-3 (]: Writing injected SQL for node "model.spotify_analytics.device_usage"
[0m20:33:37.171951 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.daily_user_stats"
[0m20:33:37.172731 [debug] [Thread-4 (]: Began executing node model.spotify_analytics.top_artists
[0m20:33:37.174260 [debug] [Thread-4 (]: Writing runtime sql for node "model.spotify_analytics.top_artists"
[0m20:33:37.174524 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.top_tracks
[0m20:33:37.174880 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.daily_user_stats
[0m20:33:37.176645 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.top_tracks"
[0m20:33:37.177668 [debug] [Thread-2 (]: Writing runtime sql for node "model.spotify_analytics.daily_user_stats"
[0m20:33:37.178571 [debug] [Thread-4 (]: Using snowflake connection "model.spotify_analytics.top_artists"
[0m20:33:37.178842 [debug] [Thread-3 (]: Began executing node model.spotify_analytics.device_usage
[0m20:33:37.179198 [debug] [Thread-4 (]: On model.spotify_analytics.top_artists: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.top_artists"} */
create or replace transient table spotify_data.gold.top_artists
         as
        (

-- ============================================================================
-- GOLD LAYER: TOP ARTISTS BY PLAY COUNT
-- ============================================================================
-- Purpose: Aggregate and rank artists by popularity
-- 
-- Grain: One row per artist (all-time aggregation)
-- Primary Key: artist_name
--
-- Metrics:
--   - Total plays per artist
--   - Total listening time
--   - Number of unique tracks played
--   - First and last play timestamps
--   - Popularity rank
--
-- Source: SILVER.silver_plays
-- Target: GOLD.top_artists
-- ============================================================================

WITH artist_aggregates AS (
    SELECT 
        -- Artist identifier
        artist_name,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        COUNT(DISTINCT track_id) AS unique_tracks,
        MIN(played_at) AS first_played_at,
        MAX(played_at) AS last_played_at
        
    FROM spotify_data.silver.silver_plays
    GROUP BY artist_name
),

ranked_artists AS (
    SELECT 
        *,
        -- Add ranking based on play count (1 = most played artist)
        ROW_NUMBER() OVER (ORDER BY total_plays DESC, total_listening_time_ms DESC) AS rank
    FROM artist_aggregates
)

SELECT 
    -- Identifier
    artist_name::VARCHAR AS artist_name,
    
    -- Metrics
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    unique_tracks::NUMBER AS unique_tracks,
    
    -- Timestamps
    first_played_at::TIMESTAMP AS first_played_at,
    last_played_at::TIMESTAMP AS last_played_at,
    
    -- Ranking
    rank::NUMBER AS rank
    
FROM ranked_artists
ORDER BY rank
        );
[0m20:33:37.182428 [debug] [Thread-3 (]: Writing runtime sql for node "model.spotify_analytics.device_usage"
[0m20:33:37.182705 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:33:37.183458 [debug] [Thread-2 (]: Using snowflake connection "model.spotify_analytics.daily_user_stats"
[0m20:33:37.184274 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.top_tracks"
[0m20:33:37.184592 [debug] [Thread-2 (]: On model.spotify_analytics.daily_user_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.daily_user_stats"} */
create or replace transient table spotify_data.gold.daily_user_stats
         as
        (

-- ============================================================================
-- GOLD LAYER: DAILY USER LISTENING STATISTICS
-- ============================================================================
-- Purpose: Aggregate user listening behavior by day
-- 
-- Grain: One row per user per day
-- Primary Key: (date, user_id)
--
-- Metrics:
--   - Total plays per day
--   - Total listening time
--   - Unique tracks/artists played
--   - Average track duration
--
-- Source: SILVER.silver_plays
-- Target: GOLD.daily_user_stats
-- ============================================================================

WITH daily_aggregates AS (
    SELECT 
        -- Date dimension (truncate timestamp to date)
        DATE(played_at) AS date,
        
        -- User identifier
        user_id,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        COUNT(DISTINCT track_id) AS unique_tracks,
        COUNT(DISTINCT artist_name) AS unique_artists,
        AVG(duration_ms) AS avg_track_duration_ms
        
    FROM spotify_data.silver.silver_plays
    GROUP BY 
        DATE(played_at),
        user_id
)

SELECT 
    -- Dimensions
    date,
    user_id,
    
    -- Metrics (cast for clarity)
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    unique_tracks::NUMBER AS unique_tracks,
    unique_artists::NUMBER AS unique_artists,
    ROUND(avg_track_duration_ms, 2)::NUMBER AS avg_track_duration_ms
    
FROM daily_aggregates
ORDER BY date DESC, user_id
        );
[0m20:33:37.185000 [debug] [Thread-1 (]: On model.spotify_analytics.top_tracks: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.top_tracks"} */
create or replace transient table spotify_data.gold.top_tracks
         as
        (

-- ============================================================================
-- GOLD LAYER: TOP TRACKS BY PLAY COUNT
-- ============================================================================
-- Purpose: Aggregate and rank tracks by popularity
-- 
-- Grain: One row per track (all-time aggregation)
-- Primary Key: track_id
--
-- Metrics:
--   - Total plays per track
--   - Total listening time
--   - First and last play timestamps
--   - Popularity rank
--
-- Source: SILVER.silver_plays
-- Target: GOLD.top_tracks
-- ============================================================================

WITH track_aggregates AS (
    SELECT 
        -- Track identifiers and attributes
        track_id,
        track_name,
        artist_name,
        album_name,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        MIN(played_at) AS first_played_at,
        MAX(played_at) AS last_played_at
        
    FROM spotify_data.silver.silver_plays
    GROUP BY 
        track_id,
        track_name,
        artist_name,
        album_name
),

ranked_tracks AS (
    SELECT 
        *,
        -- Add ranking based on play count (1 = most played)
        ROW_NUMBER() OVER (ORDER BY total_plays DESC, total_listening_time_ms DESC) AS rank
    FROM track_aggregates
)

SELECT 
    -- Identifiers
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    
    -- Timestamps
    first_played_at::TIMESTAMP AS first_played_at,
    last_played_at::TIMESTAMP AS last_played_at,
    
    -- Ranking
    rank::NUMBER AS rank
    
FROM ranked_tracks
ORDER BY rank
        );
[0m20:33:37.185306 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:33:37.186078 [debug] [Thread-3 (]: Using snowflake connection "model.spotify_analytics.device_usage"
[0m20:33:37.186350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:37.187335 [debug] [Thread-3 (]: On model.spotify_analytics.device_usage: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.device_usage"} */
create or replace transient table spotify_data.gold.device_usage
         as
        (

-- ============================================================================
-- GOLD LAYER: DEVICE USAGE STATISTICS
-- ============================================================================
-- Purpose: Aggregate listening behavior by device type
-- 
-- Grain: One row per device type (all-time aggregation)
-- Primary Key: device_type
--
-- Metrics:
--   - Total plays per device
--   - Total listening time
--   - Percentage of total plays
--   - Average track duration
--
-- Source: SILVER.silver_plays
-- Target: GOLD.device_usage
-- ============================================================================

WITH device_aggregates AS (
    SELECT 
        -- Device identifier
        device_type,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        AVG(duration_ms) AS avg_track_duration_ms
        
    FROM spotify_data.silver.silver_plays
    GROUP BY device_type
),

total_plays_calc AS (
    -- Calculate overall total for percentage calculation
    SELECT SUM(total_plays) AS overall_total_plays
    FROM device_aggregates
)

SELECT 
    -- Identifier
    device_type::VARCHAR AS device_type,
    
    -- Metrics
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    
    -- Percentage of total plays
    ROUND((total_plays::FLOAT / overall_total_plays::FLOAT) * 100, 2)::FLOAT AS play_percentage,
    
    -- Average duration
    ROUND(avg_track_duration_ms, 2)::NUMBER AS avg_track_duration_ms
    
FROM device_aggregates
CROSS JOIN total_plays_calc
ORDER BY total_plays DESC
        );
[0m20:33:37.188115 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:33:38.526437 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.344 seconds
[0m20:33:38.527221 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.339 seconds
[0m20:33:38.528861 [debug] [Thread-4 (]: On model.spotify_analytics.top_artists: Close
[0m20:33:38.529956 [debug] [Thread-3 (]: On model.spotify_analytics.device_usage: Close
[0m20:33:38.575333 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.390 seconds
[0m20:33:38.577254 [debug] [Thread-2 (]: On model.spotify_analytics.daily_user_stats: Close
[0m20:33:38.579766 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.393 seconds
[0m20:33:38.581568 [debug] [Thread-1 (]: On model.spotify_analytics.top_tracks: Close
[0m20:33:38.703017 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96f8c572-d6f6-40c1-90ec-1658d30e4f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1235de6d0>]}
[0m20:33:38.704341 [info ] [Thread-4 (]: 4 of 5 OK created sql table model gold.top_artists ............................. [[32mSUCCESS 1[0m in 1.54s]
[0m20:33:38.705141 [debug] [Thread-4 (]: Finished running node model.spotify_analytics.top_artists
[0m20:33:38.706644 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96f8c572-d6f6-40c1-90ec-1658d30e4f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123644ff0>]}
[0m20:33:38.707386 [info ] [Thread-3 (]: 3 of 5 OK created sql table model gold.device_usage ............................ [[32mSUCCESS 1[0m in 1.55s]
[0m20:33:38.708058 [debug] [Thread-3 (]: Finished running node model.spotify_analytics.device_usage
[0m20:33:38.726396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96f8c572-d6f6-40c1-90ec-1658d30e4f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120ce1350>]}
[0m20:33:38.727158 [info ] [Thread-1 (]: 5 of 5 OK created sql table model gold.top_tracks .............................. [[32mSUCCESS 1[0m in 1.57s]
[0m20:33:38.727751 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.top_tracks
[0m20:33:38.777709 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96f8c572-d6f6-40c1-90ec-1658d30e4f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f10600>]}
[0m20:33:38.778730 [info ] [Thread-2 (]: 2 of 5 OK created sql table model gold.daily_user_stats ........................ [[32mSUCCESS 1[0m in 1.62s]
[0m20:33:38.779249 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.daily_user_stats
[0m20:33:38.780579 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:33:38.780847 [debug] [MainThread]: Connection 'model.spotify_analytics.top_tracks' was properly closed.
[0m20:33:38.781045 [debug] [MainThread]: Connection 'model.spotify_analytics.daily_user_stats' was properly closed.
[0m20:33:38.781238 [debug] [MainThread]: Connection 'model.spotify_analytics.top_artists' was properly closed.
[0m20:33:38.781611 [debug] [MainThread]: Connection 'model.spotify_analytics.device_usage' was properly closed.
[0m20:33:38.781999 [info ] [MainThread]: 
[0m20:33:38.782174 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 7.38 seconds (7.38s).
[0m20:33:38.782736 [debug] [MainThread]: Command end result
[0m20:33:38.806223 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:33:38.807296 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:33:38.811592 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m20:33:38.811774 [info ] [MainThread]: 
[0m20:33:38.811965 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:33:38.812126 [info ] [MainThread]: 
[0m20:33:38.812300 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m20:33:38.813897 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.282935, "process_in_blocks": "0", "process_kernel_time": 0.326091, "process_mem_max_rss": "242368512", "process_out_blocks": "0", "process_user_time": 1.850125}
[0m20:33:38.814115 [debug] [MainThread]: Command `dbt run` succeeded at 20:33:38.814074 after 8.28 seconds
[0m20:33:38.814286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd85f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122e60530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122e607d0>]}
[0m20:33:38.814454 [debug] [MainThread]: Flushing usage events
[0m20:33:39.181272 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:33:42.437614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a2be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11015f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11015fb10>]}


============================== 20:33:42.439862 | 3403231f-7aa7-4074-a032-332a3f3b391e ==============================
[0m20:33:42.439862 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:33:42.440110 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'log_format': 'default', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'write_json': 'True', 'invocation_command': 'dbt test', 'version_check': 'True', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'static_parser': 'True', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'debug': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'no_print': 'None', 'use_colors': 'True', 'warn_error': 'None', 'target_path': 'None', 'printer_width': '80', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager'}
[0m20:33:42.856286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3403231f-7aa7-4074-a032-332a3f3b391e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070b0b00>]}
[0m20:33:42.880104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3403231f-7aa7-4074-a032-332a3f3b391e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12157ce20>]}
[0m20:33:42.881345 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:33:42.939561 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:33:42.997269 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:33:42.997461 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:33:42.999679 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m20:33:43.016649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3403231f-7aa7-4074-a032-332a3f3b391e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1214b1a50>]}
[0m20:33:43.055271 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:33:43.056189 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:33:43.071948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3403231f-7aa7-4074-a032-332a3f3b391e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12292cd70>]}
[0m20:33:43.072166 [info ] [MainThread]: Found 5 models, 43 data tests, 1 source, 604 macros
[0m20:33:43.072307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3403231f-7aa7-4074-a032-332a3f3b391e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121b375b0>]}
[0m20:33:43.073664 [info ] [MainThread]: 
[0m20:33:43.073815 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:33:43.073925 [info ] [MainThread]: 
[0m20:33:43.074128 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:33:43.075869 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m20:33:43.076718 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m20:33:43.083258 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m20:33:43.084068 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m20:33:43.084210 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m20:33:43.084352 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m20:33:43.084499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:43.084611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:44.093246 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.009 seconds
[0m20:33:44.096344 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m20:33:44.287939 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.203 seconds
[0m20:33:44.290670 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m20:33:44.458346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3403231f-7aa7-4074-a032-332a3f3b391e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120d920d0>]}
[0m20:33:44.464003 [debug] [Thread-1 (]: Began running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m20:33:44.464493 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:33:44.464870 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:33:44.465207 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:33:44.465602 [info ] [Thread-1 (]: 1 of 43 START test dbt_utils_accepted_range_silver_plays_duration_ms__600000__1  [RUN]
[0m20:33:44.466005 [info ] [Thread-3 (]: 3 of 43 START test not_null_daily_user_stats_date .............................. [RUN]
[0m20:33:44.466436 [info ] [Thread-4 (]: 4 of 43 START test not_null_daily_user_stats_total_listening_time_ms ........... [RUN]
[0m20:33:44.466883 [info ] [Thread-2 (]: 2 of 43 START test not_null_daily_user_stats_avg_track_duration_ms ............. [RUN]
[0m20:33:44.467412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39)
[0m20:33:44.467911 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9'
[0m20:33:44.468358 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87'
[0m20:33:44.468825 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155)
[0m20:33:44.469250 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m20:33:44.469851 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:33:44.470109 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:33:44.470332 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:33:44.488127 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m20:33:44.489023 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m20:33:44.491149 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m20:33:44.492749 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m20:33:44.493539 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:33:44.493798 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:33:44.493964 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m20:33:44.494102 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:33:44.505771 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m20:33:44.507358 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m20:33:44.508435 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m20:33:44.509527 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m20:33:44.510396 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m20:33:44.510737 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m20:33:44.511028 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m20:33:44.511317 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m20:33:44.511495 [debug] [Thread-1 (]: On test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from spotify_data.silver.silver_plays
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not duration_ms >= 1
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not duration_ms <= 600000
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:33:44.511716 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_track_duration_ms
from spotify_data.gold.daily_user_stats
where avg_track_duration_ms is null



  
  
      
    ) dbt_internal_test
[0m20:33:44.511938 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from spotify_data.gold.daily_user_stats
where date is null



  
  
      
    ) dbt_internal_test
[0m20:33:44.512124 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.daily_user_stats
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m20:33:44.512307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:44.512483 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:33:44.512638 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:33:44.512783 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:33:45.336217 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.823 seconds
[0m20:33:45.350971 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9: Close
[0m20:33:45.353153 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.841 seconds
[0m20:33:45.354840 [debug] [Thread-1 (]: On test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39: Close
[0m20:33:45.355387 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.843 seconds
[0m20:33:45.358088 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155: Close
[0m20:33:45.374675 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.862 seconds
[0m20:33:45.375766 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87: Close
[0m20:33:45.537993 [info ] [Thread-3 (]: 3 of 43 PASS not_null_daily_user_stats_date .................................... [[32mPASS[0m in 1.07s]
[0m20:33:45.538863 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:33:45.539340 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:33:45.539892 [info ] [Thread-3 (]: 5 of 43 START test not_null_daily_user_stats_total_plays ....................... [RUN]
[0m20:33:45.540481 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9, now test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282)
[0m20:33:45.540923 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:33:45.546536 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m20:33:45.548770 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:33:45.552991 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m20:33:45.553743 [info ] [Thread-2 (]: 2 of 43 PASS not_null_daily_user_stats_avg_track_duration_ms ................... [[32mPASS[0m in 1.08s]
[0m20:33:45.554917 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:33:45.554294 [info ] [Thread-1 (]: 1 of 43 PASS dbt_utils_accepted_range_silver_plays_duration_ms__600000__1 ...... [[32mPASS[0m in 1.09s]
[0m20:33:45.555292 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:33:45.555597 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m20:33:45.555846 [info ] [Thread-2 (]: 6 of 43 START test not_null_daily_user_stats_unique_artists .................... [RUN]
[0m20:33:45.556207 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:33:45.556839 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m20:33:45.557515 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155, now test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f)
[0m20:33:45.557843 [info ] [Thread-1 (]: 7 of 43 START test not_null_daily_user_stats_unique_tracks ..................... [RUN]
[0m20:33:45.558067 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.daily_user_stats
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m20:33:45.558252 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:33:45.558434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39, now test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac)
[0m20:33:45.558664 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:33:45.561473 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m20:33:45.561767 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:33:45.564979 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m20:33:45.566410 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:33:45.569284 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m20:33:45.571276 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:33:45.572748 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m20:33:45.573482 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m20:33:45.574212 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unique_artists
from spotify_data.gold.daily_user_stats
where unique_artists is null



  
  
      
    ) dbt_internal_test
[0m20:33:45.574896 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:33:45.576006 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m20:33:45.576265 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unique_tracks
from spotify_data.gold.daily_user_stats
where unique_tracks is null



  
  
      
    ) dbt_internal_test
[0m20:33:45.578635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:45.591873 [info ] [Thread-4 (]: 4 of 43 PASS not_null_daily_user_stats_total_listening_time_ms ................. [[32mPASS[0m in 1.12s]
[0m20:33:45.594511 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:33:45.596623 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:33:45.596825 [info ] [Thread-4 (]: 8 of 43 START test not_null_daily_user_stats_user_id ........................... [RUN]
[0m20:33:45.597303 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87, now test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b)
[0m20:33:45.597679 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:33:45.599853 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m20:33:45.602640 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:33:45.604169 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m20:33:45.608487 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m20:33:45.608812 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from spotify_data.gold.daily_user_stats
where user_id is null



  
  
      
    ) dbt_internal_test
[0m20:33:45.609606 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:33:46.298477 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.723 seconds
[0m20:33:46.301070 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f: Close
[0m20:33:46.308243 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.699 seconds
[0m20:33:46.310247 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b: Close
[0m20:33:46.361806 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.783 seconds
[0m20:33:46.364566 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac: Close
[0m20:33:46.376304 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.818 seconds
[0m20:33:46.378507 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282: Close
[0m20:33:46.449520 [info ] [Thread-2 (]: 6 of 43 PASS not_null_daily_user_stats_unique_artists .......................... [[32mPASS[0m in 0.89s]
[0m20:33:46.450433 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:33:46.450976 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:33:46.451497 [info ] [Thread-2 (]: 9 of 43 START test not_null_device_usage_avg_track_duration_ms ................. [RUN]
[0m20:33:46.452112 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f, now test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003)
[0m20:33:46.452687 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:33:46.458047 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m20:33:46.461310 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:33:46.464814 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m20:33:46.465828 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m20:33:46.466192 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_track_duration_ms
from spotify_data.gold.device_usage
where avg_track_duration_ms is null



  
  
      
    ) dbt_internal_test
[0m20:33:46.466512 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:33:46.558636 [info ] [Thread-1 (]: 7 of 43 PASS not_null_daily_user_stats_unique_tracks ........................... [[32mPASS[0m in 1.00s]
[0m20:33:46.559173 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:33:46.559489 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:33:46.559828 [info ] [Thread-1 (]: 10 of 43 START test not_null_device_usage_device_type .......................... [RUN]
[0m20:33:46.560230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac, now test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c)
[0m20:33:46.560571 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:33:46.563143 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m20:33:46.563699 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:33:46.565444 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m20:33:46.566022 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m20:33:46.566196 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select device_type
from spotify_data.gold.device_usage
where device_type is null



  
  
      
    ) dbt_internal_test
[0m20:33:46.566354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:46.723654 [info ] [Thread-3 (]: 5 of 43 PASS not_null_daily_user_stats_total_plays ............................. [[32mPASS[0m in 1.18s]
[0m20:33:46.724916 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:33:46.725408 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:33:46.725989 [info ] [Thread-3 (]: 11 of 43 START test not_null_device_usage_play_percentage ...................... [RUN]
[0m20:33:46.726437 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282, now test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2)
[0m20:33:46.727042 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:33:46.730472 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m20:33:46.731219 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:33:46.732257 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m20:33:46.732872 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m20:33:46.733201 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select play_percentage
from spotify_data.gold.device_usage
where play_percentage is null



  
  
      
    ) dbt_internal_test
[0m20:33:46.733498 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:33:46.803032 [info ] [Thread-4 (]: 8 of 43 PASS not_null_daily_user_stats_user_id ................................. [[32mPASS[0m in 1.21s]
[0m20:33:46.803390 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:33:46.803572 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:33:46.803780 [info ] [Thread-4 (]: 12 of 43 START test not_null_device_usage_total_listening_time_ms .............. [RUN]
[0m20:33:46.804038 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b, now test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2)
[0m20:33:46.804219 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:33:46.806159 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m20:33:46.806573 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:33:46.807568 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m20:33:46.809620 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m20:33:46.809869 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.device_usage
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m20:33:46.810048 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:33:47.286977 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.820 seconds
[0m20:33:47.288150 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.722 seconds
[0m20:33:47.290748 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003: Close
[0m20:33:47.292249 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c: Close
[0m20:33:47.459672 [info ] [Thread-2 (]: 9 of 43 PASS not_null_device_usage_avg_track_duration_ms ....................... [[32mPASS[0m in 1.01s]
[0m20:33:47.460638 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:33:47.461174 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:33:47.461653 [info ] [Thread-2 (]: 13 of 43 START test not_null_device_usage_total_plays .......................... [RUN]
[0m20:33:47.462169 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003, now test.spotify_analytics.not_null_device_usage_total_plays.90a295df48)
[0m20:33:47.462527 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:33:47.467656 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m20:33:47.469639 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:33:47.472008 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m20:33:47.472646 [info ] [Thread-1 (]: 10 of 43 PASS not_null_device_usage_device_type ................................ [[32mPASS[0m in 0.91s]
[0m20:33:47.472992 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:33:47.473517 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m20:33:47.474169 [info ] [Thread-1 (]: 14 of 43 START test not_null_silver_plays_artist_name .......................... [RUN]
[0m20:33:47.474753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c, now test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad)
[0m20:33:47.475298 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m20:33:47.475470 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m20:33:47.475672 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_device_usage_total_plays.90a295df48: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.device_usage
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m20:33:47.479203 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m20:33:47.479546 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:33:47.480495 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m20:33:47.481758 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m20:33:47.482929 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m20:33:47.483194 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select artist_name
from spotify_data.silver.silver_plays
where artist_name is null



  
  
      
    ) dbt_internal_test
[0m20:33:47.483384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:47.528800 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.795 seconds
[0m20:33:47.529860 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2: Close
[0m20:33:47.566062 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.756 seconds
[0m20:33:47.566965 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2: Close
[0m20:33:47.699242 [info ] [Thread-3 (]: 11 of 43 PASS not_null_device_usage_play_percentage ............................ [[32mPASS[0m in 0.97s]
[0m20:33:47.699599 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:33:47.699794 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m20:33:47.700049 [info ] [Thread-3 (]: 15 of 43 START test not_null_silver_plays_duration_ms .......................... [RUN]
[0m20:33:47.700354 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2, now test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076)
[0m20:33:47.700574 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m20:33:47.702720 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m20:33:47.703158 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m20:33:47.704315 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m20:33:47.704853 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m20:33:47.705025 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select duration_ms
from spotify_data.silver.silver_plays
where duration_ms is null



  
  
      
    ) dbt_internal_test
[0m20:33:47.705179 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:33:47.745971 [info ] [Thread-4 (]: 12 of 43 PASS not_null_device_usage_total_listening_time_ms .................... [[32mPASS[0m in 0.94s]
[0m20:33:47.746346 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:33:47.746535 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m20:33:47.746738 [info ] [Thread-4 (]: 16 of 43 START test not_null_silver_plays_event_id ............................. [RUN]
[0m20:33:47.746972 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2, now test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd)
[0m20:33:47.747149 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m20:33:47.749087 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m20:33:47.749450 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m20:33:47.750433 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m20:33:47.750861 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m20:33:47.752887 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from spotify_data.silver.silver_plays
where event_id is null



  
  
      
    ) dbt_internal_test
[0m20:33:47.753083 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:33:48.248661 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.765 seconds
[0m20:33:48.251874 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad: Close
[0m20:33:48.252633 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.773 seconds
[0m20:33:48.255024 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_device_usage_total_plays.90a295df48: Close
[0m20:33:48.405949 [info ] [Thread-1 (]: 14 of 43 PASS not_null_silver_plays_artist_name ................................ [[32mPASS[0m in 0.93s]
[0m20:33:48.406965 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m20:33:48.407449 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m20:33:48.407951 [info ] [Thread-1 (]: 17 of 43 START test not_null_silver_plays_event_type ........................... [RUN]
[0m20:33:48.408494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad, now test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa)
[0m20:33:48.408913 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m20:33:48.414212 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m20:33:48.415049 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m20:33:48.417326 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m20:33:48.418650 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m20:33:48.420063 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_type
from spotify_data.silver.silver_plays
where event_type is null



  
  
      
    ) dbt_internal_test
[0m20:33:48.420580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:48.441036 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.688 seconds
[0m20:33:48.442266 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd: Close
[0m20:33:48.446900 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.742 seconds
[0m20:33:48.448068 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076: Close
[0m20:33:48.451898 [info ] [Thread-2 (]: 13 of 43 PASS not_null_device_usage_total_plays ................................ [[32mPASS[0m in 0.99s]
[0m20:33:48.452283 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:33:48.452532 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m20:33:48.452802 [info ] [Thread-2 (]: 18 of 43 START test not_null_silver_plays_played_at ............................ [RUN]
[0m20:33:48.453097 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_plays.90a295df48, now test.spotify_analytics.not_null_silver_plays_played_at.8281565f95)
[0m20:33:48.453328 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m20:33:48.455362 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m20:33:48.455776 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m20:33:48.456906 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m20:33:48.457336 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m20:33:48.457543 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_played_at.8281565f95: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select played_at
from spotify_data.silver.silver_plays
where played_at is null



  
  
      
    ) dbt_internal_test
[0m20:33:48.457732 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:33:48.615237 [info ] [Thread-3 (]: 15 of 43 PASS not_null_silver_plays_duration_ms ................................ [[32mPASS[0m in 0.91s]
[0m20:33:48.616177 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m20:33:48.616662 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m20:33:48.617082 [info ] [Thread-3 (]: 19 of 43 START test not_null_silver_plays_processed_at ......................... [RUN]
[0m20:33:48.617523 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076, now test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed)
[0m20:33:48.617915 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m20:33:48.622131 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m20:33:48.622758 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m20:33:48.624759 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m20:33:48.625395 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m20:33:48.625722 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select processed_at
from spotify_data.silver.silver_plays
where processed_at is null



  
  
      
    ) dbt_internal_test
[0m20:33:48.626019 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:33:48.635430 [info ] [Thread-4 (]: 16 of 43 PASS not_null_silver_plays_event_id ................................... [[32mPASS[0m in 0.89s]
[0m20:33:48.635924 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m20:33:48.636392 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m20:33:48.636985 [info ] [Thread-4 (]: 20 of 43 START test not_null_silver_plays_track_id ............................. [RUN]
[0m20:33:48.637454 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd, now test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9)
[0m20:33:48.637705 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m20:33:48.641003 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m20:33:48.645737 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m20:33:48.647151 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m20:33:48.647811 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m20:33:48.648018 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_id
from spotify_data.silver.silver_plays
where track_id is null



  
  
      
    ) dbt_internal_test
[0m20:33:48.648199 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:33:49.110201 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.689 seconds
[0m20:33:49.112608 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa: Close
[0m20:33:49.137478 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.680 seconds
[0m20:33:49.138919 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_played_at.8281565f95: Close
[0m20:33:49.265569 [info ] [Thread-1 (]: 17 of 43 PASS not_null_silver_plays_event_type ................................. [[32mPASS[0m in 0.86s]
[0m20:33:49.266520 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m20:33:49.267085 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m20:33:49.267512 [info ] [Thread-1 (]: 21 of 43 START test not_null_silver_plays_track_name ........................... [RUN]
[0m20:33:49.268022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa, now test.spotify_analytics.not_null_silver_plays_track_name.c6334add30)
[0m20:33:49.268384 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m20:33:49.273515 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m20:33:49.274697 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m20:33:49.278542 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m20:33:49.280142 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m20:33:49.280640 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_silver_plays_track_name.c6334add30: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_name
from spotify_data.silver.silver_plays
where track_name is null



  
  
      
    ) dbt_internal_test
[0m20:33:49.280849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:49.289620 [info ] [Thread-2 (]: 18 of 43 PASS not_null_silver_plays_played_at .................................. [[32mPASS[0m in 0.84s]
[0m20:33:49.291187 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m20:33:49.291514 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m20:33:49.291871 [info ] [Thread-2 (]: 22 of 43 START test not_null_silver_plays_user_id .............................. [RUN]
[0m20:33:49.292997 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_played_at.8281565f95, now test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4)
[0m20:33:49.293329 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m20:33:49.295717 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m20:33:49.299880 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m20:33:49.301412 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m20:33:49.302550 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m20:33:49.302781 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from spotify_data.silver.silver_plays
where user_id is null



  
  
      
    ) dbt_internal_test
[0m20:33:49.302980 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:33:49.312520 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.687 seconds
[0m20:33:49.314027 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed: Close
[0m20:33:49.356664 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.708 seconds
[0m20:33:49.357762 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9: Close
[0m20:33:49.455581 [info ] [Thread-3 (]: 19 of 43 PASS not_null_silver_plays_processed_at ............................... [[32mPASS[0m in 0.84s]
[0m20:33:49.456252 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m20:33:49.456566 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:33:49.456767 [info ] [Thread-3 (]: 23 of 43 START test not_null_top_artists_artist_name ........................... [RUN]
[0m20:33:49.457002 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed, now test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e)
[0m20:33:49.457172 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:33:49.459865 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m20:33:49.460231 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:33:49.461838 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m20:33:49.462328 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m20:33:49.462525 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select artist_name
from spotify_data.gold.top_artists
where artist_name is null



  
  
      
    ) dbt_internal_test
[0m20:33:49.462692 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:33:49.497210 [info ] [Thread-4 (]: 20 of 43 PASS not_null_silver_plays_track_id ................................... [[32mPASS[0m in 0.86s]
[0m20:33:49.497659 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m20:33:49.497913 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:33:49.498192 [info ] [Thread-4 (]: 24 of 43 START test not_null_top_artists_first_played_at ....................... [RUN]
[0m20:33:49.498494 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9, now test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14)
[0m20:33:49.498726 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:33:49.500770 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m20:33:49.501202 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:33:49.502269 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m20:33:49.502753 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m20:33:49.502962 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_played_at
from spotify_data.gold.top_artists
where first_played_at is null



  
  
      
    ) dbt_internal_test
[0m20:33:49.503162 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:33:49.988174 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.685 seconds
[0m20:33:49.990841 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4: Close
[0m20:33:50.021875 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.741 seconds
[0m20:33:50.025378 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_silver_plays_track_name.c6334add30: Close
[0m20:33:50.140764 [info ] [Thread-2 (]: 22 of 43 PASS not_null_silver_plays_user_id .................................... [[32mPASS[0m in 0.85s]
[0m20:33:50.141790 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m20:33:50.142337 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:33:50.142842 [info ] [Thread-2 (]: 25 of 43 START test not_null_top_artists_last_played_at ........................ [RUN]
[0m20:33:50.143523 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4, now test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca)
[0m20:33:50.144028 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:33:50.149484 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m20:33:50.152235 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:33:50.153854 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m20:33:50.155591 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m20:33:50.157069 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_played_at
from spotify_data.gold.top_artists
where last_played_at is null



  
  
      
    ) dbt_internal_test
[0m20:33:50.157464 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:33:50.240708 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.738 seconds
[0m20:33:50.241961 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14: Close
[0m20:33:50.251624 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.789 seconds
[0m20:33:50.252649 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e: Close
[0m20:33:50.256686 [info ] [Thread-1 (]: 21 of 43 PASS not_null_silver_plays_track_name ................................. [[32mPASS[0m in 0.99s]
[0m20:33:50.256965 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m20:33:50.257151 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:33:50.257461 [info ] [Thread-1 (]: 26 of 43 START test not_null_top_artists_rank .................................. [RUN]
[0m20:33:50.257812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_track_name.c6334add30, now test.spotify_analytics.not_null_top_artists_rank.d14513fc96)
[0m20:33:50.258084 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:33:50.260658 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m20:33:50.261231 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:33:50.262404 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m20:33:50.263066 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m20:33:50.263380 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_rank.d14513fc96: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rank
from spotify_data.gold.top_artists
where rank is null



  
  
      
    ) dbt_internal_test
[0m20:33:50.263630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:50.386503 [info ] [Thread-4 (]: 24 of 43 PASS not_null_top_artists_first_played_at ............................. [[32mPASS[0m in 0.89s]
[0m20:33:50.387463 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:33:50.388006 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:33:50.388519 [info ] [Thread-4 (]: 27 of 43 START test not_null_top_artists_total_listening_time_ms ............... [RUN]
[0m20:33:50.388988 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14, now test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c)
[0m20:33:50.389361 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:33:50.392334 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m20:33:50.392975 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:33:50.394359 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m20:33:50.395180 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m20:33:50.395350 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.top_artists
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m20:33:50.395504 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:33:50.435701 [info ] [Thread-3 (]: 23 of 43 PASS not_null_top_artists_artist_name ................................. [[32mPASS[0m in 0.98s]
[0m20:33:50.436089 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:33:50.436343 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:33:50.436637 [info ] [Thread-3 (]: 28 of 43 START test not_null_top_artists_total_plays ........................... [RUN]
[0m20:33:50.436985 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e, now test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11)
[0m20:33:50.437240 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:33:50.439522 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m20:33:50.440374 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:33:50.441714 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m20:33:50.442975 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m20:33:50.443207 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.top_artists
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m20:33:50.443374 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:33:50.943795 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.786 seconds
[0m20:33:50.946356 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca: Close
[0m20:33:51.102312 [info ] [Thread-2 (]: 25 of 43 PASS not_null_top_artists_last_played_at .............................. [[32mPASS[0m in 0.96s]
[0m20:33:51.103303 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:33:51.103908 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:33:51.104398 [info ] [Thread-2 (]: 29 of 43 START test not_null_top_artists_unique_tracks ......................... [RUN]
[0m20:33:51.104939 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca, now test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13)
[0m20:33:51.105360 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:33:51.110574 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m20:33:51.113039 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:33:51.217699 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m20:33:51.218556 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.955 seconds
[0m20:33:51.218933 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.823 seconds
[0m20:33:51.219775 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_rank.d14513fc96: Close
[0m20:33:51.220413 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c: Close
[0m20:33:51.221069 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m20:33:51.221666 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unique_tracks
from spotify_data.gold.top_artists
where unique_tracks is null



  
  
      
    ) dbt_internal_test
[0m20:33:51.221987 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:33:51.231876 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.788 seconds
[0m20:33:51.232640 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11: Close
[0m20:33:51.411696 [info ] [Thread-1 (]: 26 of 43 PASS not_null_top_artists_rank ........................................ [[32mPASS[0m in 1.15s]
[0m20:33:51.412284 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:33:51.412644 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:33:51.413039 [info ] [Thread-1 (]: 30 of 43 START test not_null_top_tracks_artist_name ............................ [RUN]
[0m20:33:51.413504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_rank.d14513fc96, now test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461)
[0m20:33:51.413829 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:33:51.416811 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m20:33:51.417616 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:33:51.420022 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m20:33:51.420518 [info ] [Thread-3 (]: 28 of 43 PASS not_null_top_artists_total_plays ................................. [[32mPASS[0m in 0.98s]
[0m20:33:51.421054 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:33:51.421433 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:33:51.421761 [info ] [Thread-3 (]: 31 of 43 START test not_null_top_tracks_first_played_at ........................ [RUN]
[0m20:33:51.421955 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11, now test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31)
[0m20:33:51.422109 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:33:51.422501 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m20:33:51.425035 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m20:33:51.425307 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select artist_name
from spotify_data.gold.top_tracks
where artist_name is null



  
  
      
    ) dbt_internal_test
[0m20:33:51.425613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:51.426237 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:33:51.427911 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m20:33:51.429597 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m20:33:51.430139 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_played_at
from spotify_data.gold.top_tracks
where first_played_at is null



  
  
      
    ) dbt_internal_test
[0m20:33:51.429968 [info ] [Thread-4 (]: 27 of 43 PASS not_null_top_artists_total_listening_time_ms ..................... [[32mPASS[0m in 1.04s]
[0m20:33:51.430371 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:33:51.430701 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:33:51.431078 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:33:51.431590 [info ] [Thread-4 (]: 32 of 43 START test not_null_top_tracks_last_played_at ......................... [RUN]
[0m20:33:51.433856 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c, now test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532)
[0m20:33:51.435281 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:33:51.437538 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m20:33:51.439821 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:33:51.441989 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m20:33:51.445171 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m20:33:51.446795 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_played_at
from spotify_data.gold.top_tracks
where last_played_at is null



  
  
      
    ) dbt_internal_test
[0m20:33:51.447610 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:33:51.948322 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.726 seconds
[0m20:33:51.950764 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13: Close
[0m20:33:52.112764 [info ] [Thread-2 (]: 29 of 43 PASS not_null_top_artists_unique_tracks ............................... [[32mPASS[0m in 1.01s]
[0m20:33:52.113838 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:33:52.114373 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:33:52.114859 [info ] [Thread-2 (]: 33 of 43 START test not_null_top_tracks_rank ................................... [RUN]
[0m20:33:52.115419 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13, now test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4)
[0m20:33:52.115769 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:33:52.120784 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m20:33:52.122259 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:33:52.126328 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m20:33:52.127126 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m20:33:52.127698 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rank
from spotify_data.gold.top_tracks
where rank is null



  
  
      
    ) dbt_internal_test
[0m20:33:52.128399 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:33:52.186327 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.756 seconds
[0m20:33:52.187685 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31: Close
[0m20:33:52.201100 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.775 seconds
[0m20:33:52.201889 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.754 seconds
[0m20:33:52.203321 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461: Close
[0m20:33:52.204024 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532: Close
[0m20:33:52.342549 [info ] [Thread-1 (]: 30 of 43 PASS not_null_top_tracks_artist_name .................................. [[32mPASS[0m in 0.93s]
[0m20:33:52.343597 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:33:52.344279 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:33:52.344804 [info ] [Thread-1 (]: 34 of 43 START test not_null_top_tracks_total_listening_time_ms ................ [RUN]
[0m20:33:52.345422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461, now test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac)
[0m20:33:52.345888 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:33:52.352095 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m20:33:52.353361 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:33:52.356247 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m20:33:52.358922 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m20:33:52.359418 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.top_tracks
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m20:33:52.359806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:52.367002 [info ] [Thread-4 (]: 32 of 43 PASS not_null_top_tracks_last_played_at ............................... [[32mPASS[0m in 0.93s]
[0m20:33:52.368909 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:33:52.369758 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:33:52.371178 [info ] [Thread-4 (]: 35 of 43 START test not_null_top_tracks_total_plays ............................ [RUN]
[0m20:33:52.371410 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532, now test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893)
[0m20:33:52.372281 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:33:52.375921 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m20:33:52.377967 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:33:52.381713 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m20:33:52.384446 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m20:33:52.384729 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.top_tracks
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m20:33:52.384923 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:33:52.391103 [info ] [Thread-3 (]: 31 of 43 PASS not_null_top_tracks_first_played_at .............................. [[32mPASS[0m in 0.97s]
[0m20:33:52.392355 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:33:52.393047 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:33:52.393273 [info ] [Thread-3 (]: 36 of 43 START test not_null_top_tracks_track_id ............................... [RUN]
[0m20:33:52.393594 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31, now test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78)
[0m20:33:52.393803 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:33:52.397661 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m20:33:52.399460 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:33:52.401265 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m20:33:52.403959 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m20:33:52.404172 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_id
from spotify_data.gold.top_tracks
where track_id is null



  
  
      
    ) dbt_internal_test
[0m20:33:52.404340 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:33:52.951422 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.823 seconds
[0m20:33:52.954077 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4: Close
[0m20:33:53.088128 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.728 seconds
[0m20:33:53.091207 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac: Close
[0m20:33:53.108380 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.723 seconds
[0m20:33:53.110966 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893: Close
[0m20:33:53.111619 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.707 seconds
[0m20:33:53.113765 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78: Close
[0m20:33:53.119052 [info ] [Thread-2 (]: 33 of 43 PASS not_null_top_tracks_rank ......................................... [[32mPASS[0m in 1.00s]
[0m20:33:53.119682 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:33:53.120059 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:33:53.120434 [info ] [Thread-2 (]: 37 of 43 START test not_null_top_tracks_track_name ............................. [RUN]
[0m20:33:53.120837 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4, now test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203)
[0m20:33:53.121209 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:33:53.126029 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m20:33:53.126648 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:33:53.128483 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m20:33:53.128945 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m20:33:53.130736 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_name
from spotify_data.gold.top_tracks
where track_name is null



  
  
      
    ) dbt_internal_test
[0m20:33:53.131145 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:33:53.252838 [info ] [Thread-1 (]: 34 of 43 PASS not_null_top_tracks_total_listening_time_ms ...................... [[32mPASS[0m in 0.91s]
[0m20:33:53.253677 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:33:53.254077 [debug] [Thread-1 (]: Began running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:33:53.254557 [info ] [Thread-1 (]: 38 of 43 START test unique_device_usage_device_type ............................ [RUN]
[0m20:33:53.255180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac, now test.spotify_analytics.unique_device_usage_device_type.e75362861b)
[0m20:33:53.255594 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:33:53.259875 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m20:33:53.261073 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:33:53.262803 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m20:33:53.263535 [info ] [Thread-4 (]: 35 of 43 PASS not_null_top_tracks_total_plays .................................. [[32mPASS[0m in 0.89s]
[0m20:33:53.264130 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:33:53.264476 [debug] [Thread-4 (]: Began running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m20:33:53.265034 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m20:33:53.264690 [info ] [Thread-4 (]: 39 of 43 START test unique_silver_plays_event_id ............................... [RUN]
[0m20:33:53.265370 [debug] [Thread-1 (]: On test.spotify_analytics.unique_device_usage_device_type.e75362861b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_device_usage_device_type.e75362861b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    device_type as unique_field,
    count(*) as n_records

from spotify_data.gold.device_usage
where device_type is not null
group by device_type
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:33:53.265736 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893, now test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf)
[0m20:33:53.266025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:53.266294 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m20:33:53.269373 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m20:33:53.270983 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m20:33:53.272364 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m20:33:53.272720 [info ] [Thread-3 (]: 36 of 43 PASS not_null_top_tracks_track_id ..................................... [[32mPASS[0m in 0.88s]
[0m20:33:53.273067 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:33:53.273269 [debug] [Thread-3 (]: Began running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:33:53.273574 [info ] [Thread-3 (]: 40 of 43 START test unique_top_artists_artist_name ............................. [RUN]
[0m20:33:53.274117 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m20:33:53.274425 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78, now test.spotify_analytics.unique_top_artists_artist_name.008ffa1533)
[0m20:33:53.274725 [debug] [Thread-4 (]: On test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from spotify_data.silver.silver_plays
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:33:53.275019 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:33:53.275278 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:33:53.277667 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m20:33:53.281843 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:33:53.283158 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m20:33:53.285495 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m20:33:53.285853 [debug] [Thread-3 (]: On test.spotify_analytics.unique_top_artists_artist_name.008ffa1533: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    artist_name as unique_field,
    count(*) as n_records

from spotify_data.gold.top_artists
where artist_name is not null
group by artist_name
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:33:53.286110 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:33:53.820409 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.689 seconds
[0m20:33:53.822880 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203: Close
[0m20:33:53.970868 [info ] [Thread-2 (]: 37 of 43 PASS not_null_top_tracks_track_name ................................... [[32mPASS[0m in 0.85s]
[0m20:33:53.971822 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:33:53.972305 [debug] [Thread-2 (]: Began running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:33:53.972758 [info ] [Thread-2 (]: 41 of 43 START test unique_top_artists_rank .................................... [RUN]
[0m20:33:53.973245 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203, now test.spotify_analytics.unique_top_artists_rank.68b5480aed)
[0m20:33:53.973614 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:33:53.978141 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m20:33:53.979096 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:33:53.981997 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m20:33:53.982922 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m20:33:53.983233 [debug] [Thread-2 (]: On test.spotify_analytics.unique_top_artists_rank.68b5480aed: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_artists_rank.68b5480aed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rank as unique_field,
    count(*) as n_records

from spotify_data.gold.top_artists
where rank is not null
group by rank
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:33:53.983507 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:33:54.060851 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.785 seconds
[0m20:33:54.062388 [debug] [Thread-4 (]: On test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf: Close
[0m20:33:54.062963 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.777 seconds
[0m20:33:54.064775 [debug] [Thread-3 (]: On test.spotify_analytics.unique_top_artists_artist_name.008ffa1533: Close
[0m20:33:54.098042 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.832 seconds
[0m20:33:54.099344 [debug] [Thread-1 (]: On test.spotify_analytics.unique_device_usage_device_type.e75362861b: Close
[0m20:33:54.211967 [info ] [Thread-4 (]: 39 of 43 PASS unique_silver_plays_event_id ..................................... [[32mPASS[0m in 0.95s]
[0m20:33:54.212858 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m20:33:54.213545 [debug] [Thread-4 (]: Began running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:33:54.214135 [info ] [Thread-4 (]: 42 of 43 START test unique_top_tracks_rank ..................................... [RUN]
[0m20:33:54.214717 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf, now test.spotify_analytics.unique_top_tracks_rank.8fecde1136)
[0m20:33:54.215091 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:33:54.220325 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m20:33:54.221447 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:33:54.224192 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m20:33:54.228555 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m20:33:54.229020 [debug] [Thread-4 (]: On test.spotify_analytics.unique_top_tracks_rank.8fecde1136: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rank as unique_field,
    count(*) as n_records

from spotify_data.gold.top_tracks
where rank is not null
group by rank
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:33:54.229438 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:33:54.232896 [info ] [Thread-3 (]: 40 of 43 PASS unique_top_artists_artist_name ................................... [[32mPASS[0m in 0.96s]
[0m20:33:54.233510 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:33:54.235175 [debug] [Thread-3 (]: Began running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:33:54.235974 [info ] [Thread-3 (]: 43 of 43 START test unique_top_tracks_track_id ................................. [RUN]
[0m20:33:54.237601 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_top_artists_artist_name.008ffa1533, now test.spotify_analytics.unique_top_tracks_track_id.865b43a659)
[0m20:33:54.238298 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:33:54.241930 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m20:33:54.246126 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:33:54.247578 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m20:33:54.247956 [info ] [Thread-1 (]: 38 of 43 PASS unique_device_usage_device_type .................................. [[32mPASS[0m in 0.99s]
[0m20:33:54.248762 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:33:54.251834 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m20:33:54.253441 [debug] [Thread-3 (]: On test.spotify_analytics.unique_top_tracks_track_id.865b43a659: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    track_id as unique_field,
    count(*) as n_records

from spotify_data.gold.top_tracks
where track_id is not null
group by track_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:33:54.254080 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:33:54.738262 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.755 seconds
[0m20:33:54.741270 [debug] [Thread-2 (]: On test.spotify_analytics.unique_top_artists_rank.68b5480aed: Close
[0m20:33:54.914454 [info ] [Thread-2 (]: 41 of 43 PASS unique_top_artists_rank .......................................... [[32mPASS[0m in 0.94s]
[0m20:33:54.915293 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:33:55.020843 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.766 seconds
[0m20:33:55.024667 [debug] [Thread-3 (]: On test.spotify_analytics.unique_top_tracks_track_id.865b43a659: Close
[0m20:33:55.025470 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.796 seconds
[0m20:33:55.028274 [debug] [Thread-4 (]: On test.spotify_analytics.unique_top_tracks_rank.8fecde1136: Close
[0m20:33:55.185091 [info ] [Thread-4 (]: 42 of 43 PASS unique_top_tracks_rank ........................................... [[32mPASS[0m in 0.97s]
[0m20:33:55.185896 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:33:55.191530 [info ] [Thread-3 (]: 43 of 43 PASS unique_top_tracks_track_id ....................................... [[32mPASS[0m in 0.95s]
[0m20:33:55.192405 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:33:55.194328 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:33:55.194940 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_device_usage_device_type.e75362861b' was properly closed.
[0m20:33:55.195250 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_artists_rank.68b5480aed' was properly closed.
[0m20:33:55.195497 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_track_id.865b43a659' was properly closed.
[0m20:33:55.195804 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_rank.8fecde1136' was properly closed.
[0m20:33:55.196815 [info ] [MainThread]: 
[0m20:33:55.197348 [info ] [MainThread]: Finished running 43 data tests in 0 hours 0 minutes and 12.12 seconds (12.12s).
[0m20:33:55.203857 [debug] [MainThread]: Command end result
[0m20:33:55.228938 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:33:55.230278 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:33:55.235178 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m20:33:55.235342 [info ] [MainThread]: 
[0m20:33:55.235518 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:33:55.235658 [info ] [MainThread]: 
[0m20:33:55.235808 [info ] [MainThread]: Done. PASS=43 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=43
[0m20:33:55.237515 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 12.826208, "process_in_blocks": "0", "process_kernel_time": 0.455443, "process_mem_max_rss": "241254400", "process_out_blocks": "0", "process_user_time": 4.526909}
[0m20:33:55.237742 [debug] [MainThread]: Command `dbt test` succeeded at 20:33:55.237695 after 12.83 seconds
[0m20:33:55.237908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110055250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121d58520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b41ba10>]}
[0m20:33:55.238066 [debug] [MainThread]: Flushing usage events
[0m20:33:55.414753 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:41:33.915008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ebe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068ef9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068efb10>]}


============================== 20:41:33.917592 | 6bfbbf47-bee0-4e27-a500-e074eafb40c7 ==============================
[0m20:41:33.917592 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:41:33.917840 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'write_json': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'target_path': 'None', 'warn_error': 'None', 'empty': 'False', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'debug': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run', 'version_check': 'True', 'introspect': 'True', 'no_print': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'static_parser': 'True'}
[0m20:41:34.622284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bfbbf47-bee0-4e27-a500-e074eafb40c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c40b00>]}
[0m20:41:34.645713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6bfbbf47-bee0-4e27-a500-e074eafb40c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5e0e20>]}
[0m20:41:34.646270 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:41:34.702492 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:41:34.765236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:41:34.765420 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:41:34.767738 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m20:41:34.785356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bfbbf47-bee0-4e27-a500-e074eafb40c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d511350>]}
[0m20:41:34.824624 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:41:34.825822 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:41:34.837442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bfbbf47-bee0-4e27-a500-e074eafb40c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4e6d50>]}
[0m20:41:34.837638 [info ] [MainThread]: Found 5 models, 43 data tests, 1 source, 604 macros
[0m20:41:34.837768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bfbbf47-bee0-4e27-a500-e074eafb40c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc1b690>]}
[0m20:41:34.838739 [info ] [MainThread]: 
[0m20:41:34.838879 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:41:34.838982 [info ] [MainThread]: 
[0m20:41:34.839187 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:41:34.840852 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m20:41:34.841063 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m20:41:34.846876 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m20:41:34.847785 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m20:41:34.847921 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m20:41:34.848038 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m20:41:34.848151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:34.848247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:36.178331 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.330 seconds
[0m20:41:36.179830 [debug] [ThreadPool]: On list_spotify_data: Close
[0m20:41:36.280339 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.432 seconds
[0m20:41:36.281299 [debug] [ThreadPool]: On list_spotify_data: Close
[0m20:41:36.469470 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_gold)
[0m20:41:36.476560 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_silver)
[0m20:41:36.480508 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m20:41:36.482002 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m20:41:36.482345 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m20:41:36.482656 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m20:41:36.482948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:41:36.483214 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:41:37.514420 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.031 seconds
[0m20:41:37.515520 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.033 seconds
[0m20:41:37.518127 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m20:41:37.520049 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m20:41:37.738890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bfbbf47-bee0-4e27-a500-e074eafb40c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de65160>]}
[0m20:41:37.744372 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m20:41:37.745136 [info ] [Thread-1 (]: 1 of 5 START sql table model silver.silver_plays ............................... [RUN]
[0m20:41:37.745666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.silver_plays)
[0m20:41:37.746146 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m20:41:37.755516 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m20:41:37.756445 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m20:41:37.774911 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.silver_plays"
[0m20:41:37.776190 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.silver_plays"
[0m20:41:37.776473 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.silver_plays"} */
create or replace transient table spotify_data.silver.silver_plays
         as
        (

-- ============================================================================
-- SILVER LAYER: CLEANED PLAYS DATA
-- ============================================================================
-- Purpose: Transform bronze plays data into clean, analytics-ready format
-- 
-- Transformations:
--   1. Deduplicate records (DISTINCT on event_id)
--   2. Cast all data types from VARIANT to proper types
--   3. Filter invalid records (defensive WHERE clauses)
--   4. Add processing metadata (processed_at timestamp)
--
-- Source: bronze.plays (external table reading from S3 Parquet files)
-- Target: SILVER.silver_plays (materialized table)
-- ============================================================================

WITH source_data AS (
    SELECT 
        VALUE:event_id::VARCHAR AS event_id,
        VALUE:user_id::VARCHAR AS user_id,
        VALUE:event_type::VARCHAR AS event_type,
        VALUE:track_id::VARCHAR AS track_id,
        VALUE:track_name::VARCHAR AS track_name,
        VALUE:artist_name::VARCHAR AS artist_name,
        VALUE:album_name::VARCHAR AS album_name,
        VALUE:duration_ms::NUMBER AS duration_ms,
        VALUE:played_at::VARCHAR AS played_at,
        VALUE:device_type::VARCHAR AS device_type
    FROM spotify_data.bronze.plays
),

deduplicated AS (
    SELECT DISTINCT
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM source_data
    WHERE 
        -- Data quality filters
        user_id IS NOT NULL
        AND duration_ms > 0
        AND duration_ms < 600000  -- Less than 10 minutes (catches data errors)
        AND event_id IS NOT NULL
)

SELECT 
    -- Identifiers
    event_id::VARCHAR AS event_id,
    user_id::VARCHAR AS user_id,
    event_type::VARCHAR AS event_type,
    
    -- Track information
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    duration_ms::NUMBER AS duration_ms,
    
    -- Timestamps
    TRY_CAST(played_at AS TIMESTAMP) AS played_at,
    
    -- Device context
    device_type::VARCHAR AS device_type,
    
    -- Metadata
    CURRENT_TIMESTAMP() AS processed_at
    
FROM deduplicated
        );
[0m20:41:37.776730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:39.856664 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.080 seconds
[0m20:41:39.879052 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: Close
[0m20:41:40.077028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bfbbf47-bee0-4e27-a500-e074eafb40c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de4ebd0>]}
[0m20:41:40.078180 [info ] [Thread-1 (]: 1 of 5 OK created sql table model silver.silver_plays .......................... [[32mSUCCESS 1[0m in 2.33s]
[0m20:41:40.078953 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m20:41:40.080188 [debug] [Thread-1 (]: Began running node model.spotify_analytics.top_tracks
[0m20:41:40.080633 [debug] [Thread-3 (]: Began running node model.spotify_analytics.device_usage
[0m20:41:40.080984 [debug] [Thread-4 (]: Began running node model.spotify_analytics.top_artists
[0m20:41:40.081354 [debug] [Thread-2 (]: Began running node model.spotify_analytics.daily_user_stats
[0m20:41:40.081845 [info ] [Thread-1 (]: 5 of 5 START sql table model gold.top_tracks ................................... [RUN]
[0m20:41:40.082361 [info ] [Thread-3 (]: 3 of 5 START sql table model gold.device_usage ................................. [RUN]
[0m20:41:40.082825 [info ] [Thread-4 (]: 4 of 5 START sql table model gold.top_artists .................................. [RUN]
[0m20:41:40.083261 [info ] [Thread-2 (]: 2 of 5 START sql table model gold.daily_user_stats ............................. [RUN]
[0m20:41:40.083795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.silver_plays, now model.spotify_analytics.top_tracks)
[0m20:41:40.084261 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.spotify_analytics.device_usage'
[0m20:41:40.084657 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.spotify_analytics.top_artists'
[0m20:41:40.084962 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.daily_user_stats)
[0m20:41:40.085279 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.top_tracks
[0m20:41:40.085632 [debug] [Thread-3 (]: Began compiling node model.spotify_analytics.device_usage
[0m20:41:40.085993 [debug] [Thread-4 (]: Began compiling node model.spotify_analytics.top_artists
[0m20:41:40.086361 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.daily_user_stats
[0m20:41:40.090638 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.top_tracks"
[0m20:41:40.094691 [debug] [Thread-3 (]: Writing injected SQL for node "model.spotify_analytics.device_usage"
[0m20:41:40.097382 [debug] [Thread-4 (]: Writing injected SQL for node "model.spotify_analytics.top_artists"
[0m20:41:40.099730 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.daily_user_stats"
[0m20:41:40.100448 [debug] [Thread-4 (]: Began executing node model.spotify_analytics.top_artists
[0m20:41:40.100742 [debug] [Thread-3 (]: Began executing node model.spotify_analytics.device_usage
[0m20:41:40.101025 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.top_tracks
[0m20:41:40.102471 [debug] [Thread-4 (]: Writing runtime sql for node "model.spotify_analytics.top_artists"
[0m20:41:40.102693 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.daily_user_stats
[0m20:41:40.104295 [debug] [Thread-3 (]: Writing runtime sql for node "model.spotify_analytics.device_usage"
[0m20:41:40.105476 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.top_tracks"
[0m20:41:40.108998 [debug] [Thread-2 (]: Writing runtime sql for node "model.spotify_analytics.daily_user_stats"
[0m20:41:40.110071 [debug] [Thread-4 (]: Using snowflake connection "model.spotify_analytics.top_artists"
[0m20:41:40.110685 [debug] [Thread-3 (]: Using snowflake connection "model.spotify_analytics.device_usage"
[0m20:41:40.110988 [debug] [Thread-4 (]: On model.spotify_analytics.top_artists: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.top_artists"} */
create or replace transient table spotify_data.gold.top_artists
         as
        (

-- ============================================================================
-- GOLD LAYER: TOP ARTISTS BY PLAY COUNT
-- ============================================================================
-- Purpose: Aggregate and rank artists by popularity
-- 
-- Grain: One row per artist (all-time aggregation)
-- Primary Key: artist_name
--
-- Metrics:
--   - Total plays per artist
--   - Total listening time
--   - Number of unique tracks played
--   - First and last play timestamps
--   - Popularity rank
--
-- Source: SILVER.silver_plays
-- Target: GOLD.top_artists
-- ============================================================================

WITH artist_aggregates AS (
    SELECT 
        -- Artist identifier
        artist_name,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        COUNT(DISTINCT track_id) AS unique_tracks,
        MIN(played_at) AS first_played_at,
        MAX(played_at) AS last_played_at
        
    FROM spotify_data.silver.silver_plays
    GROUP BY artist_name
),

ranked_artists AS (
    SELECT 
        *,
        -- Add ranking based on play count (1 = most played artist)
        ROW_NUMBER() OVER (ORDER BY total_plays DESC, total_listening_time_ms DESC) AS rank
    FROM artist_aggregates
)

SELECT 
    -- Identifier
    artist_name::VARCHAR AS artist_name,
    
    -- Metrics
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    unique_tracks::NUMBER AS unique_tracks,
    
    -- Timestamps
    first_played_at::TIMESTAMP AS first_played_at,
    last_played_at::TIMESTAMP AS last_played_at,
    
    -- Ranking
    rank::NUMBER AS rank
    
FROM ranked_artists
ORDER BY rank
        );
[0m20:41:40.111359 [debug] [Thread-3 (]: On model.spotify_analytics.device_usage: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.device_usage"} */
create or replace transient table spotify_data.gold.device_usage
         as
        (

-- ============================================================================
-- GOLD LAYER: DEVICE USAGE STATISTICS
-- ============================================================================
-- Purpose: Aggregate listening behavior by device type
-- 
-- Grain: One row per device type (all-time aggregation)
-- Primary Key: device_type
--
-- Metrics:
--   - Total plays per device
--   - Total listening time
--   - Percentage of total plays
--   - Average track duration
--
-- Source: SILVER.silver_plays
-- Target: GOLD.device_usage
-- ============================================================================

WITH device_aggregates AS (
    SELECT 
        -- Device identifier
        device_type,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        AVG(duration_ms) AS avg_track_duration_ms
        
    FROM spotify_data.silver.silver_plays
    GROUP BY device_type
),

total_plays_calc AS (
    -- Calculate overall total for percentage calculation
    SELECT SUM(total_plays) AS overall_total_plays
    FROM device_aggregates
)

SELECT 
    -- Identifier
    device_type::VARCHAR AS device_type,
    
    -- Metrics
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    
    -- Percentage of total plays
    ROUND((total_plays::FLOAT / overall_total_plays::FLOAT) * 100, 2)::FLOAT AS play_percentage,
    
    -- Average duration
    ROUND(avg_track_duration_ms, 2)::NUMBER AS avg_track_duration_ms
    
FROM device_aggregates
CROSS JOIN total_plays_calc
ORDER BY total_plays DESC
        );
[0m20:41:40.112134 [debug] [Thread-2 (]: Using snowflake connection "model.spotify_analytics.daily_user_stats"
[0m20:41:40.112343 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:41:40.113109 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.top_tracks"
[0m20:41:40.113306 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:41:40.113577 [debug] [Thread-2 (]: On model.spotify_analytics.daily_user_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.daily_user_stats"} */
create or replace transient table spotify_data.gold.daily_user_stats
         as
        (

-- ============================================================================
-- GOLD LAYER: DAILY USER LISTENING STATISTICS
-- ============================================================================
-- Purpose: Aggregate user listening behavior by day
-- 
-- Grain: One row per user per day
-- Primary Key: (date, user_id)
--
-- Metrics:
--   - Total plays per day
--   - Total listening time
--   - Unique tracks/artists played
--   - Average track duration
--
-- Source: SILVER.silver_plays
-- Target: GOLD.daily_user_stats
-- ============================================================================

WITH daily_aggregates AS (
    SELECT 
        -- Date dimension (truncate timestamp to date)
        DATE(played_at) AS date,
        
        -- User identifier
        user_id,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        COUNT(DISTINCT track_id) AS unique_tracks,
        COUNT(DISTINCT artist_name) AS unique_artists,
        AVG(duration_ms) AS avg_track_duration_ms
        
    FROM spotify_data.silver.silver_plays
    GROUP BY 
        DATE(played_at),
        user_id
)

SELECT 
    -- Dimensions
    date,
    user_id,
    
    -- Metrics (cast for clarity)
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    unique_tracks::NUMBER AS unique_tracks,
    unique_artists::NUMBER AS unique_artists,
    ROUND(avg_track_duration_ms, 2)::NUMBER AS avg_track_duration_ms
    
FROM daily_aggregates
ORDER BY date DESC, user_id
        );
[0m20:41:40.114170 [debug] [Thread-1 (]: On model.spotify_analytics.top_tracks: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.top_tracks"} */
create or replace transient table spotify_data.gold.top_tracks
         as
        (

-- ============================================================================
-- GOLD LAYER: TOP TRACKS BY PLAY COUNT
-- ============================================================================
-- Purpose: Aggregate and rank tracks by popularity
-- 
-- Grain: One row per track (all-time aggregation)
-- Primary Key: track_id
--
-- Metrics:
--   - Total plays per track
--   - Total listening time
--   - First and last play timestamps
--   - Popularity rank
--
-- Source: SILVER.silver_plays
-- Target: GOLD.top_tracks
-- ============================================================================

WITH track_aggregates AS (
    SELECT 
        -- Track identifiers and attributes
        track_id,
        track_name,
        artist_name,
        album_name,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        MIN(played_at) AS first_played_at,
        MAX(played_at) AS last_played_at
        
    FROM spotify_data.silver.silver_plays
    GROUP BY 
        track_id,
        track_name,
        artist_name,
        album_name
),

ranked_tracks AS (
    SELECT 
        *,
        -- Add ranking based on play count (1 = most played)
        ROW_NUMBER() OVER (ORDER BY total_plays DESC, total_listening_time_ms DESC) AS rank
    FROM track_aggregates
)

SELECT 
    -- Identifiers
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    
    -- Timestamps
    first_played_at::TIMESTAMP AS first_played_at,
    last_played_at::TIMESTAMP AS last_played_at,
    
    -- Ranking
    rank::NUMBER AS rank
    
FROM ranked_tracks
ORDER BY rank
        );
[0m20:41:40.114757 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:41:40.115412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:41.717675 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.604 seconds
[0m20:41:41.722498 [debug] [Thread-3 (]: On model.spotify_analytics.device_usage: Close
[0m20:41:41.964679 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.849 seconds
[0m20:41:41.968140 [debug] [Thread-1 (]: On model.spotify_analytics.top_tracks: Close
[0m20:41:42.011915 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.899 seconds
[0m20:41:42.014694 [debug] [Thread-4 (]: On model.spotify_analytics.top_artists: Close
[0m20:41:42.017935 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bfbbf47-bee0-4e27-a500-e074eafb40c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1168e1b20>]}
[0m20:41:42.018957 [info ] [Thread-3 (]: 3 of 5 OK created sql table model gold.device_usage ............................ [[32mSUCCESS 1[0m in 1.93s]
[0m20:41:42.019845 [debug] [Thread-3 (]: Finished running node model.spotify_analytics.device_usage
[0m20:41:42.036088 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.921 seconds
[0m20:41:42.038459 [debug] [Thread-2 (]: On model.spotify_analytics.daily_user_stats: Close
[0m20:41:42.208555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bfbbf47-bee0-4e27-a500-e074eafb40c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11682b110>]}
[0m20:41:42.209295 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bfbbf47-bee0-4e27-a500-e074eafb40c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1169b6c30>]}
[0m20:41:42.209848 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bfbbf47-bee0-4e27-a500-e074eafb40c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de68f50>]}
[0m20:41:42.210654 [info ] [Thread-1 (]: 5 of 5 OK created sql table model gold.top_tracks .............................. [[32mSUCCESS 1[0m in 2.12s]
[0m20:41:42.211459 [info ] [Thread-2 (]: 2 of 5 OK created sql table model gold.daily_user_stats ........................ [[32mSUCCESS 1[0m in 2.12s]
[0m20:41:42.212276 [info ] [Thread-4 (]: 4 of 5 OK created sql table model gold.top_artists ............................. [[32mSUCCESS 1[0m in 2.13s]
[0m20:41:42.212992 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.top_tracks
[0m20:41:42.213675 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.daily_user_stats
[0m20:41:42.214277 [debug] [Thread-4 (]: Finished running node model.spotify_analytics.top_artists
[0m20:41:42.216528 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:41:42.216871 [debug] [MainThread]: Connection 'model.spotify_analytics.top_tracks' was properly closed.
[0m20:41:42.217130 [debug] [MainThread]: Connection 'model.spotify_analytics.daily_user_stats' was properly closed.
[0m20:41:42.217383 [debug] [MainThread]: Connection 'model.spotify_analytics.device_usage' was properly closed.
[0m20:41:42.217696 [debug] [MainThread]: Connection 'model.spotify_analytics.top_artists' was properly closed.
[0m20:41:42.218107 [info ] [MainThread]: 
[0m20:41:42.218625 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 7.38 seconds (7.38s).
[0m20:41:42.220152 [debug] [MainThread]: Command end result
[0m20:41:42.246066 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:41:42.247444 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:41:42.251955 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m20:41:42.252144 [info ] [MainThread]: 
[0m20:41:42.252351 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:41:42.252506 [info ] [MainThread]: 
[0m20:41:42.252677 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m20:41:42.254346 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.370629, "process_in_blocks": "0", "process_kernel_time": 0.345066, "process_mem_max_rss": "234160128", "process_out_blocks": "0", "process_user_time": 1.910867}
[0m20:41:42.254629 [debug] [MainThread]: Command `dbt run` succeeded at 20:41:42.254577 after 8.37 seconds
[0m20:41:42.254832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10677b770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da77a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116b439b0>]}
[0m20:41:42.255025 [debug] [MainThread]: Flushing usage events
[0m20:41:42.686155 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:41:45.247188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10391be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f1f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f1fb10>]}


============================== 20:41:45.249369 | d4e951fb-e2ad-46fe-a273-fe5a27ddabd0 ==============================
[0m20:41:45.249369 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:41:45.249620 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'empty': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'introspect': 'True', 'partial_parse': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'version_check': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'debug': 'False', 'cache_selected_only': 'False', 'no_print': 'None'}
[0m20:41:45.659603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4e951fb-e2ad-46fe-a273-fe5a27ddabd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104270b00>]}
[0m20:41:45.682986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4e951fb-e2ad-46fe-a273-fe5a27ddabd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc14e20>]}
[0m20:41:45.684128 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:41:45.736573 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:41:45.793021 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:41:45.793210 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:41:45.795605 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m20:41:45.812147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4e951fb-e2ad-46fe-a273-fe5a27ddabd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb45a50>]}
[0m20:41:45.851726 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:41:45.853172 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:41:45.869152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4e951fb-e2ad-46fe-a273-fe5a27ddabd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c338d70>]}
[0m20:41:45.869391 [info ] [MainThread]: Found 5 models, 43 data tests, 1 source, 604 macros
[0m20:41:45.869529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4e951fb-e2ad-46fe-a273-fe5a27ddabd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0435b0>]}
[0m20:41:45.870911 [info ] [MainThread]: 
[0m20:41:45.871056 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:41:45.871161 [info ] [MainThread]: 
[0m20:41:45.871376 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:41:45.873112 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m20:41:45.873317 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m20:41:45.880400 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m20:41:45.881768 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m20:41:45.881990 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m20:41:45.882127 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m20:41:45.882254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:45.882363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:46.801155 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.919 seconds
[0m20:41:46.804442 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m20:41:46.812152 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.930 seconds
[0m20:41:46.813923 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m20:41:47.027580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4e951fb-e2ad-46fe-a273-fe5a27ddabd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6220d0>]}
[0m20:41:47.032984 [debug] [Thread-1 (]: Began running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m20:41:47.033429 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:41:47.033813 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:41:47.034157 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:41:47.034582 [info ] [Thread-1 (]: 1 of 43 START test dbt_utils_accepted_range_silver_plays_duration_ms__600000__1  [RUN]
[0m20:41:47.035004 [info ] [Thread-2 (]: 2 of 43 START test not_null_daily_user_stats_avg_track_duration_ms ............. [RUN]
[0m20:41:47.035426 [info ] [Thread-4 (]: 4 of 43 START test not_null_daily_user_stats_total_listening_time_ms ........... [RUN]
[0m20:41:47.035810 [info ] [Thread-3 (]: 3 of 43 START test not_null_daily_user_stats_date .............................. [RUN]
[0m20:41:47.036289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39)
[0m20:41:47.036749 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155)
[0m20:41:47.037511 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87'
[0m20:41:47.038041 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9'
[0m20:41:47.038265 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m20:41:47.038432 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:41:47.038581 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:41:47.038722 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:41:47.050655 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m20:41:47.055702 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m20:41:47.057585 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m20:41:47.059723 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m20:41:47.060440 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m20:41:47.060680 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:41:47.060879 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:41:47.061091 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:41:47.072839 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m20:41:47.074085 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m20:41:47.075094 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m20:41:47.076126 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m20:41:47.076771 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m20:41:47.077031 [debug] [Thread-1 (]: On test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from spotify_data.silver.silver_plays
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not duration_ms >= 1
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not duration_ms <= 600000
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:41:47.077416 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m20:41:47.077583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:47.077788 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.daily_user_stats
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m20:41:47.078120 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m20:41:47.078413 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m20:41:47.078605 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:41:47.078989 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from spotify_data.gold.daily_user_stats
where date is null



  
  
      
    ) dbt_internal_test
[0m20:41:47.079294 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_track_duration_ms
from spotify_data.gold.daily_user_stats
where avg_track_duration_ms is null



  
  
      
    ) dbt_internal_test
[0m20:41:47.080010 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:41:47.080385 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:41:47.859846 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.782 seconds
[0m20:41:47.867317 [debug] [Thread-1 (]: On test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39: Close
[0m20:41:47.928716 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.848 seconds
[0m20:41:47.929769 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155: Close
[0m20:41:47.931775 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.853 seconds
[0m20:41:47.932579 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.852 seconds
[0m20:41:47.934020 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87: Close
[0m20:41:47.934742 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9: Close
[0m20:41:48.024768 [info ] [Thread-1 (]: 1 of 43 PASS dbt_utils_accepted_range_silver_plays_duration_ms__600000__1 ...... [[32mPASS[0m in 0.99s]
[0m20:41:48.025137 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m20:41:48.025326 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:41:48.025652 [info ] [Thread-1 (]: 5 of 43 START test not_null_daily_user_stats_total_plays ....................... [RUN]
[0m20:41:48.026178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39, now test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282)
[0m20:41:48.026575 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:41:48.029773 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m20:41:48.030238 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:41:48.032682 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m20:41:48.033159 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m20:41:48.033324 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.daily_user_stats
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m20:41:48.033537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:48.112751 [info ] [Thread-3 (]: 3 of 43 PASS not_null_daily_user_stats_date .................................... [[32mPASS[0m in 1.07s]
[0m20:41:48.113076 [info ] [Thread-2 (]: 2 of 43 PASS not_null_daily_user_stats_avg_track_duration_ms ................... [[32mPASS[0m in 1.08s]
[0m20:41:48.113512 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:41:48.113894 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:41:48.114198 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:41:48.114521 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:41:48.114837 [info ] [Thread-3 (]: 6 of 43 START test not_null_daily_user_stats_unique_artists .................... [RUN]
[0m20:41:48.115115 [info ] [Thread-2 (]: 7 of 43 START test not_null_daily_user_stats_unique_tracks ..................... [RUN]
[0m20:41:48.115396 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9, now test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f)
[0m20:41:48.115581 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155, now test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac)
[0m20:41:48.115747 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:41:48.115899 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:41:48.118360 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m20:41:48.121112 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m20:41:48.121813 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:41:48.122050 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:41:48.123688 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m20:41:48.125439 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m20:41:48.126464 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m20:41:48.126861 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m20:41:48.127045 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unique_artists
from spotify_data.gold.daily_user_stats
where unique_artists is null



  
  
      
    ) dbt_internal_test
[0m20:41:48.127604 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unique_tracks
from spotify_data.gold.daily_user_stats
where unique_tracks is null



  
  
      
    ) dbt_internal_test
[0m20:41:48.127409 [info ] [Thread-4 (]: 4 of 43 PASS not_null_daily_user_stats_total_listening_time_ms ................. [[32mPASS[0m in 1.09s]
[0m20:41:48.127880 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:41:48.128074 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:41:48.128370 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:41:48.129059 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:41:48.129366 [info ] [Thread-4 (]: 8 of 43 START test not_null_daily_user_stats_user_id ........................... [RUN]
[0m20:41:48.129750 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87, now test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b)
[0m20:41:48.130362 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:41:48.132922 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m20:41:48.133703 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:41:48.135202 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m20:41:48.138864 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m20:41:48.140004 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from spotify_data.gold.daily_user_stats
where user_id is null



  
  
      
    ) dbt_internal_test
[0m20:41:48.140327 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:41:48.778903 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.745 seconds
[0m20:41:48.781337 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282: Close
[0m20:41:48.844646 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.716 seconds
[0m20:41:48.847708 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac: Close
[0m20:41:48.879890 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.752 seconds
[0m20:41:48.882747 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f: Close
[0m20:41:48.922922 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.782 seconds
[0m20:41:48.926202 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b: Close
[0m20:41:48.990465 [info ] [Thread-1 (]: 5 of 43 PASS not_null_daily_user_stats_total_plays ............................. [[32mPASS[0m in 0.96s]
[0m20:41:48.991687 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:41:48.992101 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:41:48.992709 [info ] [Thread-1 (]: 9 of 43 START test not_null_device_usage_avg_track_duration_ms ................. [RUN]
[0m20:41:48.993240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282, now test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003)
[0m20:41:48.993567 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:41:48.998670 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m20:41:48.999991 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:41:49.003958 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m20:41:49.005909 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m20:41:49.006315 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_track_duration_ms
from spotify_data.gold.device_usage
where avg_track_duration_ms is null



  
  
      
    ) dbt_internal_test
[0m20:41:49.006509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:49.057201 [info ] [Thread-2 (]: 7 of 43 PASS not_null_daily_user_stats_unique_tracks ........................... [[32mPASS[0m in 0.94s]
[0m20:41:49.057683 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:41:49.057978 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:41:49.058289 [info ] [Thread-2 (]: 10 of 43 START test not_null_device_usage_device_type .......................... [RUN]
[0m20:41:49.058656 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac, now test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c)
[0m20:41:49.058927 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:41:49.061035 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m20:41:49.061787 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:41:49.062844 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m20:41:49.063515 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m20:41:49.063856 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select device_type
from spotify_data.gold.device_usage
where device_type is null



  
  
      
    ) dbt_internal_test
[0m20:41:49.064231 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:41:49.071507 [info ] [Thread-3 (]: 6 of 43 PASS not_null_daily_user_stats_unique_artists .......................... [[32mPASS[0m in 0.96s]
[0m20:41:49.072106 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:41:49.072381 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:41:49.073024 [info ] [Thread-3 (]: 11 of 43 START test not_null_device_usage_play_percentage ...................... [RUN]
[0m20:41:49.074288 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f, now test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2)
[0m20:41:49.074637 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:41:49.076747 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m20:41:49.077397 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:41:49.078750 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m20:41:49.080743 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m20:41:49.082203 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select play_percentage
from spotify_data.gold.device_usage
where play_percentage is null



  
  
      
    ) dbt_internal_test
[0m20:41:49.082622 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:41:49.087829 [info ] [Thread-4 (]: 8 of 43 PASS not_null_daily_user_stats_user_id ................................. [[32mPASS[0m in 0.96s]
[0m20:41:49.089404 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:41:49.089647 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:41:49.090026 [info ] [Thread-4 (]: 12 of 43 START test not_null_device_usage_total_listening_time_ms .............. [RUN]
[0m20:41:49.091141 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b, now test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2)
[0m20:41:49.091718 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:41:49.093759 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m20:41:49.095652 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:41:49.097283 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m20:41:49.099201 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m20:41:49.100698 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.device_usage
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m20:41:49.101129 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:41:49.778152 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.771 seconds
[0m20:41:49.780681 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003: Close
[0m20:41:49.820391 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.719 seconds
[0m20:41:49.823403 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2: Close
[0m20:41:49.828587 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.764 seconds
[0m20:41:49.830631 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c: Close
[0m20:41:49.865372 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.783 seconds
[0m20:41:49.867758 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2: Close
[0m20:41:49.939306 [info ] [Thread-1 (]: 9 of 43 PASS not_null_device_usage_avg_track_duration_ms ....................... [[32mPASS[0m in 0.95s]
[0m20:41:49.940373 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:41:49.940906 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:41:49.941431 [info ] [Thread-1 (]: 13 of 43 START test not_null_device_usage_total_plays .......................... [RUN]
[0m20:41:49.941962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003, now test.spotify_analytics.not_null_device_usage_total_plays.90a295df48)
[0m20:41:49.942306 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:41:49.947808 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m20:41:49.949767 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:41:49.954615 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m20:41:49.955561 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m20:41:49.955744 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_device_usage_total_plays.90a295df48: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.device_usage
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m20:41:49.955905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:49.977882 [info ] [Thread-2 (]: 10 of 43 PASS not_null_device_usage_device_type ................................ [[32mPASS[0m in 0.92s]
[0m20:41:49.978332 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:41:49.978587 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m20:41:49.978868 [info ] [Thread-2 (]: 14 of 43 START test not_null_silver_plays_artist_name .......................... [RUN]
[0m20:41:49.979202 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c, now test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad)
[0m20:41:49.979420 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m20:41:49.981546 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m20:41:49.981976 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m20:41:49.982983 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m20:41:49.983507 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m20:41:49.983712 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select artist_name
from spotify_data.silver.silver_plays
where artist_name is null



  
  
      
    ) dbt_internal_test
[0m20:41:49.983905 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:41:50.028946 [info ] [Thread-3 (]: 11 of 43 PASS not_null_device_usage_play_percentage ............................ [[32mPASS[0m in 0.95s]
[0m20:41:50.029343 [info ] [Thread-4 (]: 12 of 43 PASS not_null_device_usage_total_listening_time_ms .................... [[32mPASS[0m in 0.94s]
[0m20:41:50.029829 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:41:50.030134 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:41:50.030317 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m20:41:50.030516 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m20:41:50.030750 [info ] [Thread-3 (]: 15 of 43 START test not_null_silver_plays_duration_ms .......................... [RUN]
[0m20:41:50.030979 [info ] [Thread-4 (]: 16 of 43 START test not_null_silver_plays_event_id ............................. [RUN]
[0m20:41:50.031213 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2, now test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076)
[0m20:41:50.031431 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2, now test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd)
[0m20:41:50.031630 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m20:41:50.031818 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m20:41:50.034313 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m20:41:50.036347 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m20:41:50.036835 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m20:41:50.037028 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m20:41:50.038637 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m20:41:50.039726 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m20:41:50.040295 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m20:41:50.040632 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m20:41:50.040798 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select duration_ms
from spotify_data.silver.silver_plays
where duration_ms is null



  
  
      
    ) dbt_internal_test
[0m20:41:50.040972 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from spotify_data.silver.silver_plays
where event_id is null



  
  
      
    ) dbt_internal_test
[0m20:41:50.041132 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:41:50.041324 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:41:50.684100 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.700 seconds
[0m20:41:50.687519 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad: Close
[0m20:41:50.712033 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.756 seconds
[0m20:41:50.714654 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_device_usage_total_plays.90a295df48: Close
[0m20:41:50.736359 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.695 seconds
[0m20:41:50.738516 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd: Close
[0m20:41:50.790615 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.749 seconds
[0m20:41:50.793851 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076: Close
[0m20:41:50.871979 [info ] [Thread-2 (]: 14 of 43 PASS not_null_silver_plays_artist_name ................................ [[32mPASS[0m in 0.89s]
[0m20:41:50.872971 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m20:41:50.873454 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m20:41:50.873930 [info ] [Thread-2 (]: 17 of 43 START test not_null_silver_plays_event_type ........................... [RUN]
[0m20:41:50.874458 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad, now test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa)
[0m20:41:50.874843 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m20:41:50.880654 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m20:41:50.882227 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m20:41:50.884487 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m20:41:50.886814 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m20:41:50.887213 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_type
from spotify_data.silver.silver_plays
where event_type is null



  
  
      
    ) dbt_internal_test
[0m20:41:50.887532 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:41:50.890298 [info ] [Thread-1 (]: 13 of 43 PASS not_null_device_usage_total_plays ................................ [[32mPASS[0m in 0.95s]
[0m20:41:50.892897 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:41:50.894258 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m20:41:50.894503 [info ] [Thread-1 (]: 18 of 43 START test not_null_silver_plays_played_at ............................ [RUN]
[0m20:41:50.896127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_plays.90a295df48, now test.spotify_analytics.not_null_silver_plays_played_at.8281565f95)
[0m20:41:50.896992 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m20:41:50.899483 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m20:41:50.901632 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m20:41:50.903187 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m20:41:50.904156 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m20:41:50.904525 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_silver_plays_played_at.8281565f95: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select played_at
from spotify_data.silver.silver_plays
where played_at is null



  
  
      
    ) dbt_internal_test
[0m20:41:50.904846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:50.918062 [info ] [Thread-4 (]: 16 of 43 PASS not_null_silver_plays_event_id ................................... [[32mPASS[0m in 0.89s]
[0m20:41:50.919001 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m20:41:50.919240 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m20:41:50.919485 [info ] [Thread-4 (]: 19 of 43 START test not_null_silver_plays_processed_at ......................... [RUN]
[0m20:41:50.919886 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd, now test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed)
[0m20:41:50.920145 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m20:41:50.922517 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m20:41:50.926661 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m20:41:50.928096 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m20:41:50.929338 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m20:41:50.929522 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select processed_at
from spotify_data.silver.silver_plays
where processed_at is null



  
  
      
    ) dbt_internal_test
[0m20:41:50.929679 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:41:50.976304 [info ] [Thread-3 (]: 15 of 43 PASS not_null_silver_plays_duration_ms ................................ [[32mPASS[0m in 0.95s]
[0m20:41:50.976691 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m20:41:50.976896 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m20:41:50.977080 [info ] [Thread-3 (]: 20 of 43 START test not_null_silver_plays_track_id ............................. [RUN]
[0m20:41:50.977280 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076, now test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9)
[0m20:41:50.977441 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m20:41:50.979771 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m20:41:50.980161 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m20:41:50.981156 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m20:41:50.981587 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m20:41:50.981747 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_id
from spotify_data.silver.silver_plays
where track_id is null



  
  
      
    ) dbt_internal_test
[0m20:41:50.981898 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:41:51.597306 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.667 seconds
[0m20:41:51.600878 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed: Close
[0m20:41:51.612127 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.725 seconds
[0m20:41:51.613963 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa: Close
[0m20:41:51.638039 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.733 seconds
[0m20:41:51.639879 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_silver_plays_played_at.8281565f95: Close
[0m20:41:51.741738 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.760 seconds
[0m20:41:51.744991 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9: Close
[0m20:41:51.767357 [info ] [Thread-4 (]: 19 of 43 PASS not_null_silver_plays_processed_at ............................... [[32mPASS[0m in 0.85s]
[0m20:41:51.768812 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m20:41:51.769406 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m20:41:51.769988 [info ] [Thread-4 (]: 21 of 43 START test not_null_silver_plays_track_name ........................... [RUN]
[0m20:41:51.770677 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed, now test.spotify_analytics.not_null_silver_plays_track_name.c6334add30)
[0m20:41:51.771112 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m20:41:51.776279 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m20:41:51.776983 [info ] [Thread-2 (]: 17 of 43 PASS not_null_silver_plays_event_type ................................. [[32mPASS[0m in 0.90s]
[0m20:41:51.777771 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m20:41:51.778271 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m20:41:51.778693 [info ] [Thread-2 (]: 22 of 43 START test not_null_silver_plays_user_id .............................. [RUN]
[0m20:41:51.779342 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa, now test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4)
[0m20:41:51.779704 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m20:41:51.779902 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m20:41:51.782599 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m20:41:51.786475 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m20:41:51.787504 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m20:41:51.787715 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m20:41:51.787919 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_track_name.c6334add30: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_name
from spotify_data.silver.silver_plays
where track_name is null



  
  
      
    ) dbt_internal_test
[0m20:41:51.789568 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m20:41:51.789848 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:41:51.791137 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m20:41:51.791474 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from spotify_data.silver.silver_plays
where user_id is null



  
  
      
    ) dbt_internal_test
[0m20:41:51.791760 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:41:51.829906 [info ] [Thread-1 (]: 18 of 43 PASS not_null_silver_plays_played_at .................................. [[32mPASS[0m in 0.93s]
[0m20:41:51.830241 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m20:41:51.830413 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:41:51.830621 [info ] [Thread-1 (]: 23 of 43 START test not_null_top_artists_artist_name ........................... [RUN]
[0m20:41:51.830874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_played_at.8281565f95, now test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e)
[0m20:41:51.831059 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:41:51.833393 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m20:41:51.833927 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:41:51.835048 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m20:41:51.835578 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m20:41:51.835749 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select artist_name
from spotify_data.gold.top_artists
where artist_name is null



  
  
      
    ) dbt_internal_test
[0m20:41:51.835902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:51.917594 [info ] [Thread-3 (]: 20 of 43 PASS not_null_silver_plays_track_id ................................... [[32mPASS[0m in 0.94s]
[0m20:41:51.917974 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m20:41:51.918154 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:41:51.918367 [info ] [Thread-3 (]: 24 of 43 START test not_null_top_artists_first_played_at ....................... [RUN]
[0m20:41:51.918613 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9, now test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14)
[0m20:41:51.918781 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:41:51.921171 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m20:41:51.921543 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:41:51.922524 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m20:41:51.922967 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m20:41:51.923138 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_played_at
from spotify_data.gold.top_artists
where first_played_at is null



  
  
      
    ) dbt_internal_test
[0m20:41:51.923297 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:41:52.502461 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.712 seconds
[0m20:41:52.504957 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_track_name.c6334add30: Close
[0m20:41:52.547021 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.755 seconds
[0m20:41:52.550944 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4: Close
[0m20:41:52.604323 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.768 seconds
[0m20:41:52.607393 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e: Close
[0m20:41:52.669169 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.746 seconds
[0m20:41:52.671408 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14: Close
[0m20:41:52.703843 [info ] [Thread-4 (]: 21 of 43 PASS not_null_silver_plays_track_name ................................. [[32mPASS[0m in 0.93s]
[0m20:41:52.704599 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m20:41:52.705106 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:41:52.705603 [info ] [Thread-4 (]: 25 of 43 START test not_null_top_artists_last_played_at ........................ [RUN]
[0m20:41:52.706196 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_track_name.c6334add30, now test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca)
[0m20:41:52.706634 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:41:52.712423 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m20:41:52.715709 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:41:52.718567 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m20:41:52.719280 [info ] [Thread-2 (]: 22 of 43 PASS not_null_silver_plays_user_id .................................... [[32mPASS[0m in 0.94s]
[0m20:41:52.720052 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m20:41:52.720453 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:41:52.720786 [info ] [Thread-2 (]: 26 of 43 START test not_null_top_artists_rank .................................. [RUN]
[0m20:41:52.721028 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4, now test.spotify_analytics.not_null_top_artists_rank.d14513fc96)
[0m20:41:52.721411 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m20:41:52.721705 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:41:52.722062 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_played_at
from spotify_data.gold.top_artists
where last_played_at is null



  
  
      
    ) dbt_internal_test
[0m20:41:52.726669 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m20:41:52.726955 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:41:52.727833 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:41:52.729148 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m20:41:52.730456 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m20:41:52.730767 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_rank.d14513fc96: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rank
from spotify_data.gold.top_artists
where rank is null



  
  
      
    ) dbt_internal_test
[0m20:41:52.731044 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:41:52.776043 [info ] [Thread-1 (]: 23 of 43 PASS not_null_top_artists_artist_name ................................. [[32mPASS[0m in 0.95s]
[0m20:41:52.776431 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:41:52.776641 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:41:52.776838 [info ] [Thread-1 (]: 27 of 43 START test not_null_top_artists_total_listening_time_ms ............... [RUN]
[0m20:41:52.777068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e, now test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c)
[0m20:41:52.777236 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:41:52.779409 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m20:41:52.779936 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:41:52.781129 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m20:41:52.781625 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m20:41:52.781810 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.top_artists
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m20:41:52.781983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:52.851467 [info ] [Thread-3 (]: 24 of 43 PASS not_null_top_artists_first_played_at ............................. [[32mPASS[0m in 0.93s]
[0m20:41:52.851835 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:41:52.852036 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:41:52.852255 [info ] [Thread-3 (]: 28 of 43 START test not_null_top_artists_total_plays ........................... [RUN]
[0m20:41:52.852497 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14, now test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11)
[0m20:41:52.852677 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:41:52.854738 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m20:41:52.855113 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:41:52.856123 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m20:41:52.858877 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m20:41:52.859186 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.top_artists
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m20:41:52.859373 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:41:53.417314 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.686 seconds
[0m20:41:53.419713 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_rank.d14513fc96: Close
[0m20:41:53.553174 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.771 seconds
[0m20:41:53.555657 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c: Close
[0m20:41:53.589423 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.862 seconds
[0m20:41:53.591918 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca: Close
[0m20:41:53.628682 [info ] [Thread-2 (]: 26 of 43 PASS not_null_top_artists_rank ........................................ [[32mPASS[0m in 0.91s]
[0m20:41:53.629533 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:41:53.630529 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:41:53.630945 [info ] [Thread-2 (]: 29 of 43 START test not_null_top_artists_unique_tracks ......................... [RUN]
[0m20:41:53.631755 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_rank.d14513fc96, now test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13)
[0m20:41:53.632252 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:41:53.637101 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m20:41:53.638585 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:41:53.642549 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m20:41:53.643644 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m20:41:53.643852 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unique_tracks
from spotify_data.gold.top_artists
where unique_tracks is null



  
  
      
    ) dbt_internal_test
[0m20:41:53.644020 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:41:53.707626 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.848 seconds
[0m20:41:53.709129 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11: Close
[0m20:41:53.722523 [info ] [Thread-1 (]: 27 of 43 PASS not_null_top_artists_total_listening_time_ms ..................... [[32mPASS[0m in 0.95s]
[0m20:41:53.723010 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:41:53.723296 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:41:53.723484 [info ] [Thread-1 (]: 30 of 43 START test not_null_top_tracks_artist_name ............................ [RUN]
[0m20:41:53.723691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c, now test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461)
[0m20:41:53.723848 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:41:53.726443 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m20:41:53.726902 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:41:53.728218 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m20:41:53.729454 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m20:41:53.729705 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select artist_name
from spotify_data.gold.top_tracks
where artist_name is null



  
  
      
    ) dbt_internal_test
[0m20:41:53.729924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:53.751443 [info ] [Thread-4 (]: 25 of 43 PASS not_null_top_artists_last_played_at .............................. [[32mPASS[0m in 1.05s]
[0m20:41:53.751813 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:41:53.752023 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:41:53.752244 [info ] [Thread-4 (]: 31 of 43 START test not_null_top_tracks_first_played_at ........................ [RUN]
[0m20:41:53.752482 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca, now test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31)
[0m20:41:53.752664 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:41:53.754663 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m20:41:53.755051 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:41:53.756032 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m20:41:53.756841 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m20:41:53.757023 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_played_at
from spotify_data.gold.top_tracks
where first_played_at is null



  
  
      
    ) dbt_internal_test
[0m20:41:53.757190 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:41:53.885714 [info ] [Thread-3 (]: 28 of 43 PASS not_null_top_artists_total_plays ................................. [[32mPASS[0m in 1.03s]
[0m20:41:53.886117 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:41:53.886287 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:41:53.886483 [info ] [Thread-3 (]: 32 of 43 START test not_null_top_tracks_last_played_at ......................... [RUN]
[0m20:41:53.886706 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11, now test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532)
[0m20:41:53.886931 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:41:53.889385 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m20:41:53.889753 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:41:53.891144 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m20:41:53.891983 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m20:41:53.892150 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_played_at
from spotify_data.gold.top_tracks
where last_played_at is null



  
  
      
    ) dbt_internal_test
[0m20:41:53.892302 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:41:54.297039 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.653 seconds
[0m20:41:54.298538 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13: Close
[0m20:41:54.475282 [info ] [Thread-2 (]: 29 of 43 PASS not_null_top_artists_unique_tracks ............................... [[32mPASS[0m in 0.84s]
[0m20:41:54.476102 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:41:54.476492 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:41:54.476976 [info ] [Thread-2 (]: 33 of 43 START test not_null_top_tracks_rank ................................... [RUN]
[0m20:41:54.477518 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13, now test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4)
[0m20:41:54.477933 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:41:54.483076 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m20:41:54.484978 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.755 seconds
[0m20:41:54.487140 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461: Close
[0m20:41:54.487636 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:41:54.490762 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m20:41:54.492939 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m20:41:54.493394 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rank
from spotify_data.gold.top_tracks
where rank is null



  
  
      
    ) dbt_internal_test
[0m20:41:54.494018 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:41:54.558144 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.801 seconds
[0m20:41:54.559307 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31: Close
[0m20:41:54.641282 [info ] [Thread-1 (]: 30 of 43 PASS not_null_top_tracks_artist_name .................................. [[32mPASS[0m in 0.92s]
[0m20:41:54.642327 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:41:54.642839 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:41:54.643294 [info ] [Thread-1 (]: 34 of 43 START test not_null_top_tracks_total_listening_time_ms ................ [RUN]
[0m20:41:54.643743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461, now test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac)
[0m20:41:54.644086 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:41:54.648916 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m20:41:54.651056 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:41:54.652334 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m20:41:54.653783 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m20:41:54.654099 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.top_tracks
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m20:41:54.654297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:54.759994 [info ] [Thread-4 (]: 31 of 43 PASS not_null_top_tracks_first_played_at .............................. [[32mPASS[0m in 1.01s]
[0m20:41:54.761806 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:41:54.762298 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:41:54.762719 [info ] [Thread-4 (]: 35 of 43 START test not_null_top_tracks_total_plays ............................ [RUN]
[0m20:41:54.763119 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31, now test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893)
[0m20:41:54.763400 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:41:54.766327 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m20:41:54.767782 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:41:54.769101 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m20:41:54.769912 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m20:41:54.770242 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.top_tracks
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m20:41:54.770563 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:41:54.793371 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.901 seconds
[0m20:41:54.794838 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532: Close
[0m20:41:54.985848 [info ] [Thread-3 (]: 32 of 43 PASS not_null_top_tracks_last_played_at ............................... [[32mPASS[0m in 1.10s]
[0m20:41:54.986299 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:41:54.986558 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:41:54.986835 [info ] [Thread-3 (]: 36 of 43 START test not_null_top_tracks_track_id ............................... [RUN]
[0m20:41:54.987145 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532, now test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78)
[0m20:41:54.987349 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:41:54.989193 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m20:41:54.989546 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:41:54.990575 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m20:41:54.991044 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m20:41:54.991248 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_id
from spotify_data.gold.top_tracks
where track_id is null



  
  
      
    ) dbt_internal_test
[0m20:41:54.991440 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:41:55.206170 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.712 seconds
[0m20:41:55.207461 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4: Close
[0m20:41:55.352359 [info ] [Thread-2 (]: 33 of 43 PASS not_null_top_tracks_rank ......................................... [[32mPASS[0m in 0.87s]
[0m20:41:55.352866 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:41:55.353075 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:41:55.353297 [info ] [Thread-2 (]: 37 of 43 START test not_null_top_tracks_track_name ............................. [RUN]
[0m20:41:55.353573 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4, now test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203)
[0m20:41:55.353796 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:41:55.356356 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m20:41:55.356881 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:41:55.358112 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m20:41:55.359647 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m20:41:55.359877 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_name
from spotify_data.gold.top_tracks
where track_name is null



  
  
      
    ) dbt_internal_test
[0m20:41:55.360093 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:41:55.472472 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.818 seconds
[0m20:41:55.473702 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac: Close
[0m20:41:55.475206 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.705 seconds
[0m20:41:55.476208 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893: Close
[0m20:41:55.618841 [info ] [Thread-4 (]: 35 of 43 PASS not_null_top_tracks_total_plays .................................. [[32mPASS[0m in 0.86s]
[0m20:41:55.619490 [info ] [Thread-1 (]: 34 of 43 PASS not_null_top_tracks_total_listening_time_ms ...................... [[32mPASS[0m in 0.98s]
[0m20:41:55.620212 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:41:55.620708 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:41:55.621108 [debug] [Thread-4 (]: Began running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:41:55.621474 [debug] [Thread-1 (]: Began running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m20:41:55.621815 [info ] [Thread-4 (]: 38 of 43 START test unique_device_usage_device_type ............................ [RUN]
[0m20:41:55.622195 [info ] [Thread-1 (]: 39 of 43 START test unique_silver_plays_event_id ............................... [RUN]
[0m20:41:55.622690 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893, now test.spotify_analytics.unique_device_usage_device_type.e75362861b)
[0m20:41:55.623209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac, now test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf)
[0m20:41:55.623712 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:41:55.624126 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m20:41:55.632274 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m20:41:55.636283 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m20:41:55.637114 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m20:41:55.637460 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:41:55.640075 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m20:41:55.641236 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m20:41:55.642279 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m20:41:55.642579 [debug] [Thread-1 (]: On test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from spotify_data.silver.silver_plays
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:41:55.642857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:55.643369 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m20:41:55.643581 [debug] [Thread-4 (]: On test.spotify_analytics.unique_device_usage_device_type.e75362861b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_device_usage_device_type.e75362861b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    device_type as unique_field,
    count(*) as n_records

from spotify_data.gold.device_usage
where device_type is not null
group by device_type
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:41:55.643740 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:41:55.713908 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.722 seconds
[0m20:41:55.715211 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78: Close
[0m20:41:55.871160 [info ] [Thread-3 (]: 36 of 43 PASS not_null_top_tracks_track_id ..................................... [[32mPASS[0m in 0.88s]
[0m20:41:55.872029 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:41:55.872446 [debug] [Thread-3 (]: Began running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:41:55.872829 [info ] [Thread-3 (]: 40 of 43 START test unique_top_artists_artist_name ............................. [RUN]
[0m20:41:55.873282 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78, now test.spotify_analytics.unique_top_artists_artist_name.008ffa1533)
[0m20:41:55.873848 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:41:55.876570 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m20:41:55.877045 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:41:55.878759 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m20:41:55.880634 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m20:41:55.880847 [debug] [Thread-3 (]: On test.spotify_analytics.unique_top_artists_artist_name.008ffa1533: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    artist_name as unique_field,
    count(*) as n_records

from spotify_data.gold.top_artists
where artist_name is not null
group by artist_name
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:41:55.881120 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:41:56.153413 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.793 seconds
[0m20:41:56.156489 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203: Close
[0m20:41:56.307907 [info ] [Thread-2 (]: 37 of 43 PASS not_null_top_tracks_track_name ................................... [[32mPASS[0m in 0.95s]
[0m20:41:56.308878 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:41:56.309284 [debug] [Thread-2 (]: Began running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:41:56.309685 [info ] [Thread-2 (]: 41 of 43 START test unique_top_artists_rank .................................... [RUN]
[0m20:41:56.310112 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203, now test.spotify_analytics.unique_top_artists_rank.68b5480aed)
[0m20:41:56.310440 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:41:56.315001 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m20:41:56.315870 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:41:56.317726 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m20:41:56.318539 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m20:41:56.321618 [debug] [Thread-2 (]: On test.spotify_analytics.unique_top_artists_rank.68b5480aed: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_artists_rank.68b5480aed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rank as unique_field,
    count(*) as n_records

from spotify_data.gold.top_artists
where rank is not null
group by rank
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:41:56.322045 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:41:56.396630 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.754 seconds
[0m20:41:56.398000 [debug] [Thread-1 (]: On test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf: Close
[0m20:41:56.399297 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.756 seconds
[0m20:41:56.400487 [debug] [Thread-4 (]: On test.spotify_analytics.unique_device_usage_device_type.e75362861b: Close
[0m20:41:56.554189 [info ] [Thread-1 (]: 39 of 43 PASS unique_silver_plays_event_id ..................................... [[32mPASS[0m in 0.93s]
[0m20:41:56.555649 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m20:41:56.556154 [debug] [Thread-1 (]: Began running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:41:56.556650 [info ] [Thread-1 (]: 42 of 43 START test unique_top_tracks_rank ..................................... [RUN]
[0m20:41:56.557206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf, now test.spotify_analytics.unique_top_tracks_rank.8fecde1136)
[0m20:41:56.557615 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:41:56.562890 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m20:41:56.563694 [info ] [Thread-4 (]: 38 of 43 PASS unique_device_usage_device_type .................................. [[32mPASS[0m in 0.94s]
[0m20:41:56.565965 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:41:56.568121 [debug] [Thread-4 (]: Began running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:41:56.568783 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:41:56.568534 [info ] [Thread-4 (]: 43 of 43 START test unique_top_tracks_track_id ................................. [RUN]
[0m20:41:56.570711 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m20:41:56.571167 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_device_usage_device_type.e75362861b, now test.spotify_analytics.unique_top_tracks_track_id.865b43a659)
[0m20:41:56.571496 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:41:56.574041 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m20:41:56.575220 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m20:41:56.575776 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:41:56.576065 [debug] [Thread-1 (]: On test.spotify_analytics.unique_top_tracks_rank.8fecde1136: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rank as unique_field,
    count(*) as n_records

from spotify_data.gold.top_tracks
where rank is not null
group by rank
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:41:56.578776 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m20:41:56.579193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:56.580082 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m20:41:56.580456 [debug] [Thread-4 (]: On test.spotify_analytics.unique_top_tracks_track_id.865b43a659: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    track_id as unique_field,
    count(*) as n_records

from spotify_data.gold.top_tracks
where track_id is not null
group by track_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:41:56.580757 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:41:56.626743 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.746 seconds
[0m20:41:56.627822 [debug] [Thread-3 (]: On test.spotify_analytics.unique_top_artists_artist_name.008ffa1533: Close
[0m20:41:56.805185 [info ] [Thread-3 (]: 40 of 43 PASS unique_top_artists_artist_name ................................... [[32mPASS[0m in 0.93s]
[0m20:41:56.805897 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:41:57.106458 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.784 seconds
[0m20:41:57.109275 [debug] [Thread-2 (]: On test.spotify_analytics.unique_top_artists_rank.68b5480aed: Close
[0m20:41:57.329552 [info ] [Thread-2 (]: 41 of 43 PASS unique_top_artists_rank .......................................... [[32mPASS[0m in 1.02s]
[0m20:41:57.330591 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:41:57.393705 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.814 seconds
[0m20:41:57.396270 [debug] [Thread-1 (]: On test.spotify_analytics.unique_top_tracks_rank.8fecde1136: Close
[0m20:41:57.403835 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.823 seconds
[0m20:41:57.405894 [debug] [Thread-4 (]: On test.spotify_analytics.unique_top_tracks_track_id.865b43a659: Close
[0m20:41:57.557247 [info ] [Thread-4 (]: 43 of 43 PASS unique_top_tracks_track_id ....................................... [[32mPASS[0m in 0.99s]
[0m20:41:57.558062 [info ] [Thread-1 (]: 42 of 43 PASS unique_top_tracks_rank ........................................... [[32mPASS[0m in 1.00s]
[0m20:41:57.558974 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:41:57.559605 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:41:57.561681 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:41:57.561992 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_rank.8fecde1136' was properly closed.
[0m20:41:57.562235 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_artists_rank.68b5480aed' was properly closed.
[0m20:41:57.562462 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_track_id.865b43a659' was properly closed.
[0m20:41:57.562681 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_artists_artist_name.008ffa1533' was properly closed.
[0m20:41:57.563012 [info ] [MainThread]: 
[0m20:41:57.563383 [info ] [MainThread]: Finished running 43 data tests in 0 hours 0 minutes and 11.69 seconds (11.69s).
[0m20:41:57.569372 [debug] [MainThread]: Command end result
[0m20:41:57.594333 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:41:57.595652 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:41:57.600263 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m20:41:57.600445 [info ] [MainThread]: 
[0m20:41:57.600635 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:41:57.600770 [info ] [MainThread]: 
[0m20:41:57.600903 [info ] [MainThread]: Done. PASS=43 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=43
[0m20:41:57.602316 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 12.381963, "process_in_blocks": "0", "process_kernel_time": 0.448073, "process_mem_max_rss": "238223360", "process_out_blocks": "0", "process_user_time": 4.528323}
[0m20:41:57.602550 [debug] [MainThread]: Command `dbt test` succeeded at 20:41:57.602503 after 12.38 seconds
[0m20:41:57.602735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e15250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11411ee60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11411e200>]}
[0m20:41:57.602920 [debug] [MainThread]: Flushing usage events
[0m20:41:57.776054 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:47:39.785359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e93e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109497890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109497b10>]}


============================== 20:47:39.787985 | 384a5413-b512-4751-8c7a-e219ad2b54c6 ==============================
[0m20:47:39.787985 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:47:39.788266 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'partial_parse': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'version_check': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'log_format': 'default', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'empty': 'None', 'static_parser': 'True', 'no_print': 'None', 'invocation_command': 'dbt docs generate', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'quiet': 'False'}
[0m20:47:40.391683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '384a5413-b512-4751-8c7a-e219ad2b54c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087e8b00>]}
[0m20:47:40.415494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '384a5413-b512-4751-8c7a-e219ad2b54c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110104e20>]}
[0m20:47:40.416049 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:47:40.468420 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:47:40.530426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:47:40.530605 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:47:40.532770 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m20:47:40.548982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '384a5413-b512-4751-8c7a-e219ad2b54c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100bda50>]}
[0m20:47:40.561150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '384a5413-b512-4751-8c7a-e219ad2b54c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110644aa0>]}
[0m20:47:40.561347 [info ] [MainThread]: Found 5 models, 43 data tests, 1 source, 604 macros
[0m20:47:40.561481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '384a5413-b512-4751-8c7a-e219ad2b54c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11059b230>]}
[0m20:47:40.562624 [info ] [MainThread]: 
[0m20:47:40.562763 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:47:40.562919 [info ] [MainThread]: 
[0m20:47:40.563111 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:47:40.564785 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m20:47:40.564969 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m20:47:40.573793 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m20:47:40.574827 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m20:47:40.574977 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m20:47:40.575102 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m20:47:40.575211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:40.575311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:42.110566 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.535 seconds
[0m20:47:42.113994 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m20:47:42.347457 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.772 seconds
[0m20:47:42.350507 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m20:47:42.526293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '384a5413-b512-4751-8c7a-e219ad2b54c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb9e0d0>]}
[0m20:47:42.531746 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m20:47:42.532310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.silver_plays)
[0m20:47:42.532758 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m20:47:42.541879 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m20:47:42.543310 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m20:47:42.544116 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m20:47:42.544944 [debug] [Thread-2 (]: Began running node model.spotify_analytics.daily_user_stats
[0m20:47:42.545132 [debug] [Thread-4 (]: Began running node model.spotify_analytics.top_artists
[0m20:47:42.545337 [debug] [Thread-1 (]: Began running node model.spotify_analytics.top_tracks
[0m20:47:42.545686 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.daily_user_stats)
[0m20:47:42.545999 [debug] [Thread-3 (]: Began running node model.spotify_analytics.device_usage
[0m20:47:42.546429 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.spotify_analytics.top_artists'
[0m20:47:42.546739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.silver_plays, now model.spotify_analytics.top_tracks)
[0m20:47:42.547049 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.daily_user_stats
[0m20:47:42.547371 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.spotify_analytics.device_usage'
[0m20:47:42.547550 [debug] [Thread-4 (]: Began compiling node model.spotify_analytics.top_artists
[0m20:47:42.547698 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.top_tracks
[0m20:47:42.549737 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.daily_user_stats"
[0m20:47:42.550021 [debug] [Thread-3 (]: Began compiling node model.spotify_analytics.device_usage
[0m20:47:42.552180 [debug] [Thread-4 (]: Writing injected SQL for node "model.spotify_analytics.top_artists"
[0m20:47:42.553792 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.top_tracks"
[0m20:47:42.555610 [debug] [Thread-3 (]: Writing injected SQL for node "model.spotify_analytics.device_usage"
[0m20:47:42.555899 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.daily_user_stats
[0m20:47:42.556304 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.daily_user_stats
[0m20:47:42.556549 [debug] [Thread-2 (]: Began running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m20:47:42.556793 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.daily_user_stats, now test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39)
[0m20:47:42.557021 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m20:47:42.566893 [debug] [Thread-3 (]: Began executing node model.spotify_analytics.device_usage
[0m20:47:42.567114 [debug] [Thread-4 (]: Began executing node model.spotify_analytics.top_artists
[0m20:47:42.572800 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m20:47:42.573176 [debug] [Thread-3 (]: Finished running node model.spotify_analytics.device_usage
[0m20:47:42.573540 [debug] [Thread-4 (]: Finished running node model.spotify_analytics.top_artists
[0m20:47:42.573748 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.top_tracks
[0m20:47:42.574016 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m20:47:42.574237 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m20:47:42.574538 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.top_tracks
[0m20:47:42.574745 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.device_usage, now test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad)
[0m20:47:42.575015 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m20:47:42.575192 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.top_artists, now test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076)
[0m20:47:42.575392 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m20:47:42.575602 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m20:47:42.575976 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m20:47:42.576145 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m20:47:42.576323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.top_tracks, now test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd)
[0m20:47:42.580369 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m20:47:42.580576 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m20:47:42.582243 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m20:47:42.582393 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m20:47:42.582585 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39, now test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa)
[0m20:47:42.584376 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m20:47:42.584530 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m20:47:42.586113 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m20:47:42.586308 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m20:47:42.586612 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m20:47:42.586770 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m20:47:42.586956 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m20:47:42.587235 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m20:47:42.587383 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m20:47:42.587527 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m20:47:42.587685 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076, now test.spotify_analytics.not_null_silver_plays_played_at.8281565f95)
[0m20:47:42.587855 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m20:47:42.588132 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m20:47:42.588397 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m20:47:42.588544 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m20:47:42.588698 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad, now test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed)
[0m20:47:42.588864 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m20:47:42.589026 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m20:47:42.590618 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m20:47:42.590765 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m20:47:42.590919 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa, now test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9)
[0m20:47:42.591077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd, now test.spotify_analytics.not_null_silver_plays_track_name.c6334add30)
[0m20:47:42.592452 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m20:47:42.592598 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m20:47:42.592741 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m20:47:42.592900 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m20:47:42.594323 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m20:47:42.596051 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m20:47:42.596313 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m20:47:42.596452 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m20:47:42.596643 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m20:47:42.596919 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m20:47:42.597062 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m20:47:42.597201 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_played_at.8281565f95, now test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4)
[0m20:47:42.597338 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m20:47:42.597470 [debug] [Thread-3 (]: Began running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m20:47:42.597700 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m20:47:42.597828 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m20:47:42.598059 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m20:47:42.598197 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed, now test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf)
[0m20:47:42.598345 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:47:42.599681 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m20:47:42.599838 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:47:42.599980 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m20:47:42.600124 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9, now test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155)
[0m20:47:42.600288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_track_name.c6334add30, now test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9)
[0m20:47:42.602656 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m20:47:42.602800 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:47:42.602934 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:47:42.603065 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m20:47:42.604323 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m20:47:42.605690 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m20:47:42.605910 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m20:47:42.606034 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m20:47:42.606205 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:47:42.606461 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m20:47:42.606597 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4, now test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87)
[0m20:47:42.606767 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:47:42.606905 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:47:42.607034 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:47:42.607157 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:47:42.607285 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf, now test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282)
[0m20:47:42.607519 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:47:42.608703 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m20:47:42.608933 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:47:42.609063 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:47:42.609211 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:47:42.609375 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:47:42.610830 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m20:47:42.610981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9, now test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f)
[0m20:47:42.611116 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:47:42.611248 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155, now test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac)
[0m20:47:42.611411 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:47:42.611621 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:47:42.611753 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:47:42.612899 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m20:47:42.613030 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:47:42.613164 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:47:42.614520 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m20:47:42.614767 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:47:42.614901 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87, now test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b)
[0m20:47:42.615066 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:47:42.615225 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:47:42.615350 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:47:42.615469 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282, now test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003)
[0m20:47:42.615592 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:47:42.616813 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m20:47:42.617039 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:47:42.617166 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:47:42.617374 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:47:42.617529 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:47:42.618900 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m20:47:42.619060 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:47:42.619372 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac, now test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c)
[0m20:47:42.619538 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:47:42.619666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f, now test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2)
[0m20:47:42.619801 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:47:42.620020 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:47:42.620142 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:47:42.620264 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:47:42.621468 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m20:47:42.621616 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:47:42.621858 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:47:42.623188 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m20:47:42.623347 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b, now test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2)
[0m20:47:42.623495 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:47:42.623664 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:47:42.623795 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003, now test.spotify_analytics.not_null_device_usage_total_plays.90a295df48)
[0m20:47:42.623928 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:47:42.625104 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m20:47:42.625236 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:47:42.625363 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:47:42.625585 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:47:42.626975 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m20:47:42.627231 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:47:42.627379 [debug] [Thread-2 (]: Began running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:47:42.627530 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:47:42.627738 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:47:42.627907 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c, now test.spotify_analytics.unique_device_usage_device_type.e75362861b)
[0m20:47:42.628149 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:47:42.628286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2, now test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e)
[0m20:47:42.628418 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:47:42.628541 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:47:42.628684 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:47:42.628842 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:47:42.629075 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:47:42.633651 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:47:42.630422 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m20:47:42.633473 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m20:47:42.633817 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_plays.90a295df48, now test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca)
[0m20:47:42.630580 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2, now test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14)
[0m20:47:42.634114 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:47:42.634255 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:47:42.635606 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m20:47:42.636918 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m20:47:42.637137 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:47:42.637289 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:47:42.637542 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:47:42.637783 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:47:42.637912 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:47:42.638047 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:47:42.638176 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:47:42.638331 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:47:42.638574 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:47:42.638712 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_device_usage_device_type.e75362861b, now test.spotify_analytics.not_null_top_artists_rank.d14513fc96)
[0m20:47:42.638943 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:47:42.639082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e, now test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c)
[0m20:47:42.639492 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:47:42.639630 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:47:42.639765 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:47:42.639903 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:47:42.640040 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca, now test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11)
[0m20:47:42.641295 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m20:47:42.641440 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14, now test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13)
[0m20:47:42.642706 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m20:47:42.642844 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:47:42.643001 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:47:42.643191 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:47:42.644808 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m20:47:42.646087 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m20:47:42.646230 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:47:42.646506 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:47:42.646794 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:47:42.646964 [debug] [Thread-2 (]: Began running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:47:42.647118 [debug] [Thread-1 (]: Began running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:47:42.647265 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:47:42.647383 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:47:42.647515 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_rank.d14513fc96, now test.spotify_analytics.unique_top_artists_artist_name.008ffa1533)
[0m20:47:42.647674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c, now test.spotify_analytics.unique_top_artists_rank.68b5480aed)
[0m20:47:42.647924 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:47:42.648155 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:47:42.648289 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:47:42.648418 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:47:42.648561 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:47:42.648713 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:47:42.650381 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m20:47:42.651632 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m20:47:42.651776 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13, now test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461)
[0m20:47:42.651924 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11, now test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31)
[0m20:47:42.652111 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:47:42.652246 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:47:42.653669 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m20:47:42.653814 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:47:42.653933 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:47:42.655346 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m20:47:42.655624 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:47:42.655877 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:47:42.656069 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:47:42.656217 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:47:42.656378 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:47:42.656519 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_top_artists_artist_name.008ffa1533, now test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532)
[0m20:47:42.656649 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:47:42.656778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_top_artists_rank.68b5480aed, now test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4)
[0m20:47:42.657011 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:47:42.657138 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:47:42.657357 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:47:42.657480 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:47:42.657615 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:47:42.659102 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m20:47:42.659246 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:47:42.660380 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m20:47:42.660507 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461, now test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac)
[0m20:47:42.660662 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31, now test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893)
[0m20:47:42.660826 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:47:42.660954 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:47:42.661090 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:47:42.662368 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m20:47:42.662493 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:47:42.662710 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:47:42.663946 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m20:47:42.664195 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:47:42.664343 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:47:42.664506 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:47:42.664659 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:47:42.664788 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532, now test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78)
[0m20:47:42.664927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4, now test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203)
[0m20:47:42.665063 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:47:42.665288 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:47:42.665416 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:47:42.665547 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:47:42.665777 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:47:42.665921 [debug] [Thread-4 (]: Began running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:47:42.667195 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m20:47:42.668299 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m20:47:42.668434 [debug] [Thread-3 (]: Began running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:47:42.668574 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac, now test.spotify_analytics.unique_top_tracks_rank.8fecde1136)
[0m20:47:42.668766 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893, now test.spotify_analytics.unique_top_tracks_track_id.865b43a659)
[0m20:47:42.668929 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:47:42.669054 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:47:42.669174 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:47:42.669295 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:47:42.670594 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m20:47:42.670811 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:47:42.671031 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:47:42.672204 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m20:47:42.672432 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:47:42.672655 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:47:42.672828 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:47:42.673038 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:47:42.673472 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:47:42.673589 [debug] [MainThread]: Connection 'test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203' was properly closed.
[0m20:47:42.673689 [debug] [MainThread]: Connection 'test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78' was properly closed.
[0m20:47:42.673779 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_rank.8fecde1136' was properly closed.
[0m20:47:42.673863 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_track_id.865b43a659' was properly closed.
[0m20:47:42.675916 [debug] [MainThread]: Command end result
[0m20:47:42.714132 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:47:42.715289 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:47:42.718870 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m20:47:42.720620 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m20:47:42.720723 [info ] [MainThread]: Building catalog
[0m20:47:42.724351 [debug] [ThreadPool]: Acquiring new snowflake connection 'spotify_data.information_schema'
[0m20:47:42.730627 [debug] [ThreadPool]: Using snowflake connection "spotify_data.information_schema"
[0m20:47:42.730993 [debug] [ThreadPool]: On spotify_data.information_schema: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "spotify_data.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from spotify_data.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'gold' and upper("table_schema") = upper('gold')

                    and 
    "table_name" ilike 'daily_user_stats' and upper("table_name") = upper('daily_user_stats')

                )
             or 
                (
                    
    "table_schema" ilike 'bronze' and upper("table_schema") = upper('bronze')

                    and 
    "table_name" ilike 'plays' and upper("table_name") = upper('plays')

                )
             or 
                (
                    
    "table_schema" ilike 'gold' and upper("table_schema") = upper('gold')

                    and 
    "table_name" ilike 'top_tracks' and upper("table_name") = upper('top_tracks')

                )
             or 
                (
                    
    "table_schema" ilike 'gold' and upper("table_schema") = upper('gold')

                    and 
    "table_name" ilike 'device_usage' and upper("table_name") = upper('device_usage')

                )
             or 
                (
                    
    "table_schema" ilike 'silver' and upper("table_schema") = upper('silver')

                    and 
    "table_name" ilike 'silver_plays' and upper("table_name") = upper('silver_plays')

                )
             or 
                (
                    
    "table_schema" ilike 'gold' and upper("table_schema") = upper('gold')

                    and 
    "table_name" ilike 'top_artists' and upper("table_name") = upper('top_artists')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from spotify_data.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'gold' and upper("table_schema") = upper('gold')

                    and 
    "table_name" ilike 'daily_user_stats' and upper("table_name") = upper('daily_user_stats')

                )
             or 
                (
                    
    "table_schema" ilike 'bronze' and upper("table_schema") = upper('bronze')

                    and 
    "table_name" ilike 'plays' and upper("table_name") = upper('plays')

                )
             or 
                (
                    
    "table_schema" ilike 'gold' and upper("table_schema") = upper('gold')

                    and 
    "table_name" ilike 'top_tracks' and upper("table_name") = upper('top_tracks')

                )
             or 
                (
                    
    "table_schema" ilike 'gold' and upper("table_schema") = upper('gold')

                    and 
    "table_name" ilike 'device_usage' and upper("table_name") = upper('device_usage')

                )
             or 
                (
                    
    "table_schema" ilike 'silver' and upper("table_schema") = upper('silver')

                    and 
    "table_name" ilike 'silver_plays' and upper("table_name") = upper('silver_plays')

                )
             or 
                (
                    
    "table_schema" ilike 'gold' and upper("table_schema") = upper('gold')

                    and 
    "table_name" ilike 'top_artists' and upper("table_name") = upper('top_artists')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m20:47:42.731228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:48.415589 [debug] [ThreadPool]: SQL status: SUCCESS 40 in 5.684 seconds
[0m20:47:48.423358 [debug] [ThreadPool]: On spotify_data.information_schema: Close
[0m20:47:48.618071 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/catalog.json
[0m20:47:48.638586 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:47:48.640478 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:47:48.640844 [info ] [MainThread]: Catalog written to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/catalog.json
[0m20:47:48.643327 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 8.891017, "process_in_blocks": "0", "process_kernel_time": 0.27802, "process_mem_max_rss": "243449856", "process_out_blocks": "0", "process_user_time": 1.410344}
[0m20:47:48.643819 [debug] [MainThread]: Command `dbt docs generate` succeeded at 20:47:48.643755 after 8.89 seconds
[0m20:47:48.644017 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m20:47:48.644150 [debug] [MainThread]: Connection 'spotify_data.information_schema' was properly closed.
[0m20:47:48.644315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10938d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11847fd80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11847fcd0>]}
[0m20:47:48.644548 [debug] [MainThread]: Flushing usage events
[0m20:47:48.962210 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:48:32.681391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ef7e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054fb890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054fbb10>]}


============================== 20:48:32.683921 | 1e0d6719-cce9-4f92-8643-825b5646f4c2 ==============================
[0m20:48:32.683921 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:48:32.684170 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'use_colors': 'True', 'debug': 'False', 'invocation_command': 'dbt docs serve', 'empty': 'None', 'no_print': 'None', 'partial_parse': 'True', 'warn_error': 'None', 'printer_width': '80', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'static_parser': 'True', 'write_json': 'True', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'quiet': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False'}
[0m20:48:33.279599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e0d6719-cce9-4f92-8643-825b5646f4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10484cb00>]}
[0m20:48:33.303018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e0d6719-cce9-4f92-8643-825b5646f4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c158f30>]}
[0m20:48:33.600087 [error] [MainThread]: Encountered an error:
[Errno 48] Address already in use
[0m20:48:33.603669 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/sunilmakkar/spotify-data-pipeline/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/sunilmakkar/spotify-data-pipeline/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/Users/sunilmakkar/spotify-data-pipeline/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
  File "/Users/sunilmakkar/spotify-data-pipeline/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "/Users/sunilmakkar/spotify-data-pipeline/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
  File "/Users/sunilmakkar/spotify-data-pipeline/venv/lib/python3.13/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
  File "/Users/sunilmakkar/spotify-data-pipeline/venv/lib/python3.13/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 457, in __init__
    self.server_bind()
    ~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 478, in server_bind
    self.socket.bind(self.server_address)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
OSError: [Errno 48] Address already in use

[0m20:48:33.608754 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 0.9552683, "process_in_blocks": "0", "process_kernel_time": 0.162709, "process_mem_max_rss": "202063872", "process_out_blocks": "0", "process_user_time": 0.810262}
[0m20:48:33.613564 [debug] [MainThread]: Command `dbt docs serve` failed at 20:48:33.613303 after 0.96 seconds
[0m20:48:33.614173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3f4550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3f4650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c38a300>]}
[0m20:48:33.614450 [debug] [MainThread]: Flushing usage events
[0m20:48:33.862670 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:50:01.333547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe7e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075eb890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075ebb10>]}


============================== 20:50:01.336103 | f6ca52c5-eab8-44e6-b54c-a5ffd9e62131 ==============================
[0m20:50:01.336103 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:50:01.336385 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'write_json': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'target_path': 'None', 'warn_error': 'None', 'empty': 'None', 'printer_width': '80', 'no_print': 'None', 'quiet': 'False', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt docs serve --port 8081', 'partial_parse': 'True'}
[0m20:50:01.945076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6ca52c5-eab8-44e6-b54c-a5ffd9e62131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10693cb00>]}
[0m20:50:01.969196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6ca52c5-eab8-44e6-b54c-a5ffd9e62131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e248f30>]}
[0m20:52:39.155368 [error] [MainThread]: Encountered an error:

[0m20:52:39.169001 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/sunilmakkar/spotify-data-pipeline/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/sunilmakkar/spotify-data-pipeline/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/Users/sunilmakkar/spotify-data-pipeline/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
  File "/Users/sunilmakkar/spotify-data-pipeline/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "/Users/sunilmakkar/spotify-data-pipeline/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
  File "/Users/sunilmakkar/spotify-data-pipeline/venv/lib/python3.13/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
  File "/Users/sunilmakkar/spotify-data-pipeline/venv/lib/python3.13/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
  File "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/selectors.py", line 398, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m20:52:39.193090 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 157.88785, "process_in_blocks": "0", "process_kernel_time": 0.189418, "process_mem_max_rss": "202833920", "process_out_blocks": "0", "process_user_time": 0.828865}
[0m20:52:39.195030 [debug] [MainThread]: Command `dbt docs serve` failed at 20:52:39.194917 after 157.89 seconds
[0m20:52:39.195564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4e4650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4e4550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e47a300>]}
[0m20:52:39.196071 [debug] [MainThread]: Flushing usage events
[0m20:52:39.608986 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:13:45.895995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7c7f32d1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7c7f62a310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7c7f32cf90>]}


============================== 19:13:45.903602 | 1b5f2fd2-f28a-449b-b696-e00c5332087e ==============================
[0m19:13:45.903602 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:13:45.905086 [debug] [MainThread]: running dbt with arguments {'log_path': '/opt/airflow/dbt/logs', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'partial_parse': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'empty': 'False', 'invocation_command': 'dbt compile', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'introspect': 'True', 'write_json': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'no_print': 'None', 'use_experimental_parser': 'False'}
[0m19:13:47.162230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b5f2fd2-f28a-449b-b696-e00c5332087e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7c81c54c10>]}
[0m19:13:47.236810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b5f2fd2-f28a-449b-b696-e00c5332087e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7c80409750>]}
[0m19:13:47.238837 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:13:47.509734 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:13:47.880769 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:13:47.881308 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:13:47.888744 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m19:13:47.942915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b5f2fd2-f28a-449b-b696-e00c5332087e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7c69ef5e90>]}
[0m19:13:48.033971 [error] [MainThread]: Encountered an error:
[Errno 13] Permission denied: '/opt/airflow/dbt/target/manifest.json'
[0m19:13:48.045277 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 389, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 416, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 2130, in parse_manifest
    write_manifest(manifest, runtime_config.project_target_path)
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 2105, in write_manifest
    manifest.write(path)
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/contracts/graph/manifest.py", line 1232, in write
    writable.write(path)
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/artifacts/schemas/base.py", line 36, in write
    write_json(path, self.to_dict(omit_none=False, context={"artifact": True}))  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt_common/clients/system.py", line 310, in write_json
    with open(path, "w", encoding="utf-8") as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/opt/airflow/dbt/target/manifest.json'

[0m19:13:48.048300 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 2.221341, "process_in_blocks": "19784", "process_kernel_time": 0.457769, "process_mem_max_rss": "224868", "process_out_blocks": "24", "process_user_time": 3.109988}
[0m19:13:48.050405 [debug] [MainThread]: Command `dbt compile` failed at 19:13:48.050244 after 2.22 seconds
[0m19:13:48.051932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7c7f2f4d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7c7f2f4ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7c7f343d50>]}
[0m19:13:48.054026 [debug] [MainThread]: Flushing usage events
[0m19:13:48.146331 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:19:11.944141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb489ffa410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb48a32e6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb489ffb9d0>]}


============================== 19:19:11.951981 | 44d982ff-ef9e-4174-b703-01e3f6c03404 ==============================
[0m19:19:11.951981 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:19:11.952577 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt compile', 'profiles_dir': '/opt/airflow/dbt', 'static_parser': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'debug': 'False', 'quiet': 'False', 'warn_error': 'None', 'printer_width': '80', 'introspect': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'indirect_selection': 'eager', 'log_format': 'default', 'empty': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'target_path': 'None', 'no_print': 'None'}
[0m19:19:13.039146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44d982ff-ef9e-4174-b703-01e3f6c03404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb48afca3d0>]}
[0m19:19:13.121403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44d982ff-ef9e-4174-b703-01e3f6c03404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb48b0d9850>]}
[0m19:19:13.124485 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:19:13.376781 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:19:13.741580 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:19:13.742129 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:19:13.751756 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m19:19:13.806314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44d982ff-ef9e-4174-b703-01e3f6c03404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb478b74e50>]}
[0m19:19:13.899973 [error] [MainThread]: Encountered an error:
[Errno 13] Permission denied: '/opt/airflow/dbt/target/manifest.json'
[0m19:19:13.907438 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 389, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 416, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 2130, in parse_manifest
    write_manifest(manifest, runtime_config.project_target_path)
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 2105, in write_manifest
    manifest.write(path)
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/contracts/graph/manifest.py", line 1232, in write
    writable.write(path)
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/artifacts/schemas/base.py", line 36, in write
    write_json(path, self.to_dict(omit_none=False, context={"artifact": True}))  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt_common/clients/system.py", line 310, in write_json
    with open(path, "w", encoding="utf-8") as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/opt/airflow/dbt/target/manifest.json'

[0m19:19:13.910371 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 2.03498, "process_in_blocks": "6960", "process_kernel_time": 0.421251, "process_mem_max_rss": "224740", "process_out_blocks": "16", "process_user_time": 3.148795}
[0m19:19:13.912258 [debug] [MainThread]: Command `dbt compile` failed at 19:19:13.912131 after 2.04 seconds
[0m19:19:13.912715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb489ff9f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb489ff9250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb478b9c590>]}
[0m19:19:13.914227 [debug] [MainThread]: Flushing usage events
[0m19:19:14.012452 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:22:05.805438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c04a3de5950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c04a411e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c04a3de5290>]}


============================== 19:22:05.836683 | a01ca2b8-b4fd-46bb-9c8a-7f68b10adac1 ==============================
[0m19:22:05.836683 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:22:05.842271 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt compile', 'debug': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'version_check': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'introspect': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'log_format': 'default', 'warn_error': 'None', 'static_parser': 'True', 'empty': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'log_path': '/opt/airflow/dbt/logs', 'log_cache_events': 'False'}
[0m19:22:08.860488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a01ca2b8-b4fd-46bb-9c8a-7f68b10adac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c04a4dba390>]}
[0m19:22:09.052041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a01ca2b8-b4fd-46bb-9c8a-7f68b10adac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c04a4ec97d0>]}
[0m19:22:09.054993 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:22:09.423678 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:22:09.574480 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:22:09.575069 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:22:09.582567 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m19:22:09.636543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a01ca2b8-b4fd-46bb-9c8a-7f68b10adac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c048ebd0dd0>]}
[0m19:22:09.731520 [error] [MainThread]: Encountered an error:
[Errno 13] Permission denied: '/opt/airflow/dbt/target/manifest.json'
[0m19:22:09.734443 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 389, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 416, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 2130, in parse_manifest
    write_manifest(manifest, runtime_config.project_target_path)
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 2105, in write_manifest
    manifest.write(path)
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/contracts/graph/manifest.py", line 1232, in write
    writable.write(path)
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/artifacts/schemas/base.py", line 36, in write
    write_json(path, self.to_dict(omit_none=False, context={"artifact": True}))  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt_common/clients/system.py", line 310, in write_json
    with open(path, "w", encoding="utf-8") as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/opt/airflow/dbt/target/manifest.json'

[0m19:22:09.737175 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 4.4294014, "process_in_blocks": "0", "process_kernel_time": 0.413863, "process_mem_max_rss": "225100", "process_out_blocks": "24", "process_user_time": 3.443441}
[0m19:22:09.739361 [debug] [MainThread]: Command `dbt compile` failed at 19:22:09.737844 after 4.43 seconds
[0m19:22:09.739882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c04a8499150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c04a3df1010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c04a3df3550>]}
[0m19:22:09.740354 [debug] [MainThread]: Flushing usage events
[0m19:22:09.831014 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:27:03.008237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f4215d5590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f4215d4d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f4215d5190>]}


============================== 19:27:03.017289 | 7a70deb5-e16e-4d01-9371-c498d14793f2 ==============================
[0m19:27:03.017289 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:27:03.018466 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'no_print': 'None', 'printer_width': '80', 'empty': 'False', 'fail_fast': 'False', 'write_json': 'True', 'log_path': '/opt/airflow/dbt/logs', 'log_format': 'default', 'target_path': 'None', 'debug': 'False', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'use_colors': 'True'}
[0m19:27:04.129092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a70deb5-e16e-4d01-9371-c498d14793f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f412f26690>]}
[0m19:27:04.209722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a70deb5-e16e-4d01-9371-c498d14793f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f411be7710>]}
[0m19:27:04.211422 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:27:04.434586 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:27:04.640464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:27:04.640977 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:27:04.649217 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m19:27:04.706109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a70deb5-e16e-4d01-9371-c498d14793f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f40be96e90>]}
[0m19:27:04.824212 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:27:04.826884 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:27:04.881448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a70deb5-e16e-4d01-9371-c498d14793f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f41038b490>]}
[0m19:27:04.882525 [info ] [MainThread]: Found 5 models, 43 data tests, 1 source, 604 macros
[0m19:27:04.883187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a70deb5-e16e-4d01-9371-c498d14793f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f4101dd1d0>]}
[0m19:27:04.887106 [info ] [MainThread]: 
[0m19:27:04.888247 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:27:04.888835 [info ] [MainThread]: 
[0m19:27:04.889634 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:27:04.894915 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m19:27:04.895701 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m19:27:04.934272 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m19:27:04.929790 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m19:27:04.936416 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m19:27:04.936782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:27:04.935887 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m19:27:04.938484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:27:06.394396 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.456 seconds
[0m19:27:06.396340 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m19:27:06.401167 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.464 seconds
[0m19:27:06.403267 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m19:27:06.479691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a70deb5-e16e-4d01-9371-c498d14793f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f41038b790>]}
[0m19:27:06.487456 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m19:27:06.488054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.silver_plays)
[0m19:27:06.488756 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m19:27:06.497682 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m19:27:06.499291 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m19:27:06.500189 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m19:27:06.501604 [debug] [Thread-3 (]: Began running node model.spotify_analytics.daily_user_stats
[0m19:27:06.502152 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.spotify_analytics.daily_user_stats'
[0m19:27:06.502516 [debug] [Thread-3 (]: Began compiling node model.spotify_analytics.daily_user_stats
[0m19:27:06.507067 [debug] [Thread-3 (]: Writing injected SQL for node "model.spotify_analytics.daily_user_stats"
[0m19:27:06.507463 [debug] [Thread-1 (]: Began running node model.spotify_analytics.device_usage
[0m19:27:06.508224 [debug] [Thread-4 (]: Began running node model.spotify_analytics.top_tracks
[0m19:27:06.509212 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.spotify_analytics.top_tracks'
[0m19:27:06.509562 [debug] [Thread-4 (]: Began compiling node model.spotify_analytics.top_tracks
[0m19:27:06.507871 [debug] [Thread-2 (]: Began running node model.spotify_analytics.top_artists
[0m19:27:06.516213 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.top_artists)
[0m19:27:06.508695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.silver_plays, now model.spotify_analytics.device_usage)
[0m19:27:06.518183 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.device_usage
[0m19:27:06.516615 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.top_artists
[0m19:27:06.517770 [debug] [Thread-4 (]: Writing injected SQL for node "model.spotify_analytics.top_tracks"
[0m19:27:06.529083 [debug] [Thread-3 (]: Began executing node model.spotify_analytics.daily_user_stats
[0m19:27:06.542884 [debug] [Thread-3 (]: Finished running node model.spotify_analytics.daily_user_stats
[0m19:27:06.542046 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.top_artists"
[0m19:27:06.540743 [debug] [Thread-4 (]: Began executing node model.spotify_analytics.top_tracks
[0m19:27:06.544935 [debug] [Thread-4 (]: Finished running node model.spotify_analytics.top_tracks
[0m19:27:06.543420 [debug] [Thread-3 (]: Began running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m19:27:06.546243 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.daily_user_stats, now test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39)
[0m19:27:06.539584 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.device_usage"
[0m19:27:06.547274 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.device_usage
[0m19:27:06.546639 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m19:27:06.545803 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m19:27:06.556480 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.top_tracks, now test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad)
[0m19:27:06.556919 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m19:27:06.547954 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.device_usage
[0m19:27:06.548558 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.top_artists
[0m19:27:06.565207 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.top_artists
[0m19:27:06.564477 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m19:27:06.578584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.device_usage, now test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076)
[0m19:27:06.571677 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m19:27:06.579678 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m19:27:06.565606 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m19:27:06.581157 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.top_artists, now test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd)
[0m19:27:06.581565 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m19:27:06.579073 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m19:27:06.577746 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m19:27:06.591807 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m19:27:06.580703 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m19:27:06.593162 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m19:27:06.590810 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m19:27:06.594301 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m19:27:06.586667 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m19:27:06.593684 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39, now test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa)
[0m19:27:06.596443 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m19:27:06.592667 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m19:27:06.595499 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m19:27:06.614542 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m19:27:06.594993 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m19:27:06.619547 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m19:27:06.620063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076, now test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9)
[0m19:27:06.620478 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m19:27:06.612552 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m19:27:06.617598 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m19:27:06.626965 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m19:27:06.618736 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m19:27:06.628278 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd, now test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed)
[0m19:27:06.626217 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad, now test.spotify_analytics.not_null_silver_plays_played_at.8281565f95)
[0m19:27:06.629045 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m19:27:06.628668 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m19:27:06.634201 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m19:27:06.641431 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m19:27:06.627689 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m19:27:06.642592 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m19:27:06.643486 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa, now test.spotify_analytics.not_null_silver_plays_track_name.c6334add30)
[0m19:27:06.625910 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m19:27:06.644474 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m19:27:06.645083 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m19:27:06.640507 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m19:27:06.646037 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m19:27:06.642116 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m19:27:06.647535 [debug] [Thread-4 (]: Began running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m19:27:06.645490 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m19:27:06.648922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9, now test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4)
[0m19:27:06.649302 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m19:27:06.647061 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m19:27:06.648465 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_played_at.8281565f95, now test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf)
[0m19:27:06.655340 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m19:27:06.643908 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m19:27:06.654843 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m19:27:06.667038 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed, now test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155)
[0m19:27:06.667459 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m19:27:06.654366 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m19:27:06.673013 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m19:27:06.666505 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m19:27:06.661769 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m19:27:06.675707 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m19:27:06.673671 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m19:27:06.676900 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m19:27:06.677322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4, now test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9)
[0m19:27:06.676378 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m19:27:06.678215 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m19:27:06.678601 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf, now test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87)
[0m19:27:06.674258 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m19:27:06.682752 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m19:27:06.677707 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m19:27:06.672221 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m19:27:06.690647 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m19:27:06.683311 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m19:27:06.681904 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m19:27:06.691746 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m19:27:06.699367 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m19:27:06.692269 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_track_name.c6334add30, now test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282)
[0m19:27:06.701380 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m19:27:06.700928 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m19:27:06.698596 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m19:27:06.707505 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m19:27:06.700287 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155, now test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f)
[0m19:27:06.708674 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m19:27:06.706699 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m19:27:06.715559 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m19:27:06.708205 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m19:27:06.717623 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m19:27:06.718043 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87, now test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac)
[0m19:27:06.718460 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m19:27:06.717211 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m19:27:06.725357 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m19:27:06.716287 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m19:27:06.726911 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m19:27:06.727300 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282, now test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461)
[0m19:27:06.714224 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m19:27:06.728655 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m19:27:06.725745 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m19:27:06.729747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9, now test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b)
[0m19:27:06.730144 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m19:27:06.724629 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m19:27:06.735237 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m19:27:06.729296 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m19:27:06.736341 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m19:27:06.736714 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f, now test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31)
[0m19:27:06.737079 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m19:27:06.728144 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m19:27:06.735876 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m19:27:06.746571 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m19:27:06.747415 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac, now test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532)
[0m19:27:06.741773 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m19:27:06.748378 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m19:27:06.734620 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m19:27:06.749546 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m19:27:06.750156 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m19:27:06.748999 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m19:27:06.751443 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m19:27:06.745631 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m19:27:06.752782 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m19:27:06.753396 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m19:27:06.751017 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m19:27:06.747787 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m19:27:06.752286 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31, now test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac)
[0m19:27:06.754302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b, now test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4)
[0m19:27:06.766894 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m19:27:06.758402 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m19:27:06.771865 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m19:27:06.753881 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m19:27:06.773162 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461, now test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893)
[0m19:27:06.773555 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m19:27:06.758877 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m19:27:06.772705 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m19:27:06.782583 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m19:27:06.771073 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m19:27:06.784444 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m19:27:06.777565 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m19:27:06.786114 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m19:27:06.785125 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m19:27:06.787385 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m19:27:06.783101 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532, now test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78)
[0m19:27:06.788321 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m19:27:06.781969 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m19:27:06.794059 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m19:27:06.786800 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m19:27:06.787881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4, now test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203)
[0m19:27:06.796647 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m19:27:06.794724 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m19:27:06.803323 [debug] [Thread-2 (]: Began running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m19:27:06.796170 [debug] [Thread-3 (]: Began running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m19:27:06.804546 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893, now test.spotify_analytics.unique_top_tracks_rank.8fecde1136)
[0m19:27:06.804117 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m19:27:06.806606 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m19:27:06.803762 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac, now test.spotify_analytics.unique_top_tracks_track_id.865b43a659)
[0m19:27:06.807971 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m19:27:06.805988 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m19:27:06.807578 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m19:27:06.813019 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m19:27:06.818784 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m19:27:06.818138 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m19:27:06.820308 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78, now test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003)
[0m19:27:06.811872 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m19:27:06.821227 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m19:27:06.816713 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m19:27:06.822564 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m19:27:06.819898 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m19:27:06.823974 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m19:27:06.824371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203, now test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c)
[0m19:27:06.820689 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m19:27:06.822076 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m19:27:06.830085 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m19:27:06.823558 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m19:27:06.831007 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m19:27:06.824726 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m19:27:06.830532 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_top_tracks_track_id.865b43a659, now test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2)
[0m19:27:06.836915 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m19:27:06.831596 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_top_tracks_rank.8fecde1136, now test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2)
[0m19:27:06.843891 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m19:27:06.829604 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m19:27:06.836409 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m19:27:06.850173 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m19:27:06.851170 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m19:27:06.843358 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m19:27:06.852238 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m19:27:06.851632 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m19:27:06.848720 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m19:27:06.855872 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m19:27:06.853827 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m19:27:06.857340 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m19:27:06.855058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c, now test.spotify_analytics.not_null_device_usage_total_plays.90a295df48)
[0m19:27:06.859250 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m19:27:06.852935 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m19:27:06.856642 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m19:27:06.866183 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m19:27:06.857772 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m19:27:06.867608 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003, now test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e)
[0m19:27:06.867130 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2, now test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca)
[0m19:27:06.868546 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m19:27:06.864656 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m19:27:06.873954 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m19:27:06.874608 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m19:27:06.868026 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m19:27:06.865212 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m19:27:06.882209 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2, now test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14)
[0m19:27:06.875198 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m19:27:06.883154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_plays.90a295df48, now test.spotify_analytics.not_null_top_artists_rank.d14513fc96)
[0m19:27:06.883544 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m19:27:06.873285 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m19:27:06.888987 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m19:27:06.882643 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m19:27:06.889653 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m19:27:06.894992 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m19:27:06.894059 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m19:27:06.896409 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m19:27:06.888345 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m19:27:06.897624 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m19:27:06.897076 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m19:27:06.893610 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m19:27:06.899273 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m19:27:06.898262 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m19:27:06.900694 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m19:27:06.898718 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m19:27:06.901698 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e, now test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11)
[0m19:27:06.902084 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m19:27:06.901106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_rank.d14513fc96, now test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13)
[0m19:27:06.895395 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca, now test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c)
[0m19:27:06.908011 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m19:27:06.899844 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m19:27:06.912841 [debug] [Thread-2 (]: Began running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m19:27:06.907184 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m19:27:06.906677 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m19:27:06.913275 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14, now test.spotify_analytics.unique_device_usage_device_type.e75362861b)
[0m19:27:06.922456 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m19:27:06.917924 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m19:27:06.928443 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m19:27:06.911954 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m19:27:06.930327 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m19:27:06.918696 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m19:27:06.931922 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m19:27:06.929239 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m19:27:06.931229 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m19:27:06.932346 [debug] [Thread-4 (]: Began running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m19:27:06.934402 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11, now test.spotify_analytics.unique_top_artists_artist_name.008ffa1533)
[0m19:27:06.934881 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m19:27:06.927646 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m19:27:06.932781 [debug] [Thread-1 (]: Began running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m19:27:06.942499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13, now test.spotify_analytics.unique_top_artists_rank.68b5480aed)
[0m19:27:06.942967 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m19:27:06.941900 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m19:27:06.949043 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m19:27:06.940676 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m19:27:06.949739 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m19:27:06.948138 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m19:27:06.950407 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m19:27:06.953559 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m19:27:06.955279 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m19:27:06.957781 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:27:06.958171 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_artists_rank.68b5480aed' was properly closed.
[0m19:27:06.958495 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_device_usage_device_type.e75362861b' was properly closed.
[0m19:27:06.958787 [debug] [MainThread]: Connection 'test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c' was properly closed.
[0m19:27:06.960792 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_artists_artist_name.008ffa1533' was properly closed.
[0m19:27:06.975700 [debug] [MainThread]: Command end result
[0m19:27:07.036179 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:27:07.038402 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:27:07.047836 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m19:27:07.049399 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 4.1076107, "process_in_blocks": "920", "process_kernel_time": 0.558917, "process_mem_max_rss": "252532", "process_out_blocks": "3648", "process_user_time": 4.323509}
[0m19:27:07.049985 [debug] [MainThread]: Command `dbt compile` succeeded at 19:27:07.049888 after 4.11 seconds
[0m19:27:07.050812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f42157ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f42157dc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f4218e6710>]}
[0m19:27:07.051289 [debug] [MainThread]: Flushing usage events
[0m19:27:07.152359 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:27:12.035531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cd30cefad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cd30fea850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cd30c999d0>]}


============================== 19:27:12.046072 | 1fe6ffd7-326c-47a6-ab95-3f1bb1e14216 ==============================
[0m19:27:12.046072 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:27:12.047461 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'quiet': 'False', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/opt/airflow/dbt', 'no_print': 'None', 'warn_error': 'None', 'static_parser': 'True', 'empty': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'debug': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --select silver.*'}
[0m19:27:13.124656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fe6ffd7-326c-47a6-ab95-3f1bb1e14216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cd2d554fd0>]}
[0m19:27:13.204327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1fe6ffd7-326c-47a6-ab95-3f1bb1e14216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cd31dc9810>]}
[0m19:27:13.205733 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:27:13.432707 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:27:13.669221 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:27:13.669729 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:27:13.676203 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m19:27:13.731621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1fe6ffd7-326c-47a6-ab95-3f1bb1e14216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cd1b692fd0>]}
[0m19:27:13.845946 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:27:13.847977 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:27:13.874302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1fe6ffd7-326c-47a6-ab95-3f1bb1e14216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cd1b427090>]}
[0m19:27:13.874887 [info ] [MainThread]: Found 5 models, 43 data tests, 1 source, 604 macros
[0m19:27:13.876054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fe6ffd7-326c-47a6-ab95-3f1bb1e14216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cd1b854ad0>]}
[0m19:27:13.883367 [info ] [MainThread]: 
[0m19:27:13.884432 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:27:13.884772 [info ] [MainThread]: 
[0m19:27:13.885835 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:27:13.889176 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m19:27:13.908297 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m19:27:13.908792 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m19:27:13.909160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:27:15.175244 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.266 seconds
[0m19:27:15.178199 [debug] [ThreadPool]: On list_spotify_data: Close
[0m19:27:15.412356 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_silver)
[0m19:27:15.419525 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m19:27:15.429250 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m19:27:15.425587 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m19:27:15.430480 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m19:27:15.429717 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m19:27:15.431199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:27:15.430799 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:27:16.136016 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.705 seconds
[0m19:27:16.139167 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m19:27:16.241462 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.811 seconds
[0m19:27:16.243216 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m19:27:16.301513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fe6ffd7-326c-47a6-ab95-3f1bb1e14216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cd1b857250>]}
[0m19:27:16.306151 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m19:27:16.306770 [info ] [Thread-1 (]: 1 of 1 START sql table model silver.silver_plays ............................... [RUN]
[0m19:27:16.307315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.silver_plays)
[0m19:27:16.307689 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m19:27:16.317816 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m19:27:16.318936 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m19:27:16.350145 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.silver_plays"
[0m19:27:16.352567 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.silver_plays"
[0m19:27:16.353107 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.silver_plays"} */
create or replace transient table spotify_data.silver.silver_plays
         as
        (

-- ============================================================================
-- SILVER LAYER: CLEANED PLAYS DATA
-- ============================================================================
-- Purpose: Transform bronze plays data into clean, analytics-ready format
-- 
-- Transformations:
--   1. Deduplicate records (DISTINCT on event_id)
--   2. Cast all data types from VARIANT to proper types
--   3. Filter invalid records (defensive WHERE clauses)
--   4. Add processing metadata (processed_at timestamp)
--
-- Source: bronze.plays (external table reading from S3 Parquet files)
-- Target: SILVER.silver_plays (materialized table)
-- ============================================================================

WITH source_data AS (
    SELECT 
        VALUE:event_id::VARCHAR AS event_id,
        VALUE:user_id::VARCHAR AS user_id,
        VALUE:event_type::VARCHAR AS event_type,
        VALUE:track_id::VARCHAR AS track_id,
        VALUE:track_name::VARCHAR AS track_name,
        VALUE:artist_name::VARCHAR AS artist_name,
        VALUE:album_name::VARCHAR AS album_name,
        VALUE:duration_ms::NUMBER AS duration_ms,
        VALUE:played_at::VARCHAR AS played_at,
        VALUE:device_type::VARCHAR AS device_type
    FROM spotify_data.bronze.plays
),

deduplicated AS (
    SELECT DISTINCT
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM source_data
    WHERE 
        -- Data quality filters
        user_id IS NOT NULL
        AND duration_ms > 0
        AND duration_ms < 600000  -- Less than 10 minutes (catches data errors)
        AND event_id IS NOT NULL
)

SELECT 
    -- Identifiers
    event_id::VARCHAR AS event_id,
    user_id::VARCHAR AS user_id,
    event_type::VARCHAR AS event_type,
    
    -- Track information
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    duration_ms::NUMBER AS duration_ms,
    
    -- Timestamps
    TRY_CAST(played_at AS TIMESTAMP) AS played_at,
    
    -- Device context
    device_type::VARCHAR AS device_type,
    
    -- Metadata
    CURRENT_TIMESTAMP() AS processed_at
    
FROM deduplicated
        );
[0m19:27:16.353562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:19.030794 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.677 seconds
[0m19:27:19.056119 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: Close
[0m19:27:19.220609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fe6ffd7-326c-47a6-ab95-3f1bb1e14216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cd1b9f6ad0>]}
[0m19:27:19.221935 [info ] [Thread-1 (]: 1 of 1 OK created sql table model silver.silver_plays .......................... [[32mSUCCESS 1[0m in 2.91s]
[0m19:27:19.222914 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m19:27:19.225348 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:27:19.225773 [debug] [MainThread]: Connection 'model.spotify_analytics.silver_plays' was properly closed.
[0m19:27:19.226177 [debug] [MainThread]: Connection 'list_spotify_data_gold' was properly closed.
[0m19:27:19.226507 [info ] [MainThread]: 
[0m19:27:19.227377 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.34 seconds (5.34s).
[0m19:27:19.228052 [debug] [MainThread]: Command end result
[0m19:27:19.273519 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:27:19.275583 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:27:19.282289 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m19:27:19.283165 [info ] [MainThread]: 
[0m19:27:19.284026 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:27:19.284603 [info ] [MainThread]: 
[0m19:27:19.285190 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:27:19.287251 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.3159575, "process_in_blocks": "312", "process_kernel_time": 0.535677, "process_mem_max_rss": "249376", "process_out_blocks": "3088", "process_user_time": 4.133211}
[0m19:27:19.287751 [debug] [MainThread]: Command `dbt run` succeeded at 19:27:19.287666 after 7.32 seconds
[0m19:27:19.288169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cd35398dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cd353981d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cd35399310>]}
[0m19:27:19.289025 [debug] [MainThread]: Flushing usage events
[0m19:27:19.394302 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:27:24.060426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7116dc227550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7116dc1a39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7116dc2265d0>]}


============================== 19:27:24.067981 | 1594ea04-33c5-4655-a5ec-aa730aa21ad5 ==============================
[0m19:27:24.067981 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:27:24.068568 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'log_format': 'default', 'debug': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'use_colors': 'True', 'introspect': 'True', 'partial_parse': 'True', 'write_json': 'True', 'static_parser': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'invocation_command': 'dbt run --select gold.*', 'cache_selected_only': 'False', 'empty': 'False', 'printer_width': '80'}
[0m19:27:25.147068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1594ea04-33c5-4655-a5ec-aa730aa21ad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7116c700e1d0>]}
[0m19:27:25.231748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1594ea04-33c5-4655-a5ec-aa730aa21ad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7116dd335690>]}
[0m19:27:25.232698 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:27:25.455008 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:27:25.613041 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:27:25.614542 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:27:25.621585 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m19:27:25.674284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1594ea04-33c5-4655-a5ec-aa730aa21ad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7116c6c8de10>]}
[0m19:27:25.820807 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:27:25.824132 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:27:25.847776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1594ea04-33c5-4655-a5ec-aa730aa21ad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7116c6c09b10>]}
[0m19:27:25.849328 [info ] [MainThread]: Found 5 models, 43 data tests, 1 source, 604 macros
[0m19:27:25.850136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1594ea04-33c5-4655-a5ec-aa730aa21ad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7116dc433c90>]}
[0m19:27:25.852702 [info ] [MainThread]: 
[0m19:27:25.853121 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:27:25.853433 [info ] [MainThread]: 
[0m19:27:25.855342 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:27:25.860408 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m19:27:25.876376 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m19:27:25.876745 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m19:27:25.877554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:27:26.884955 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.007 seconds
[0m19:27:26.887083 [debug] [ThreadPool]: On list_spotify_data: Close
[0m19:27:26.950840 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m19:27:26.951522 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_silver)
[0m19:27:26.967247 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m19:27:26.969977 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m19:27:26.970326 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:27:26.969578 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m19:27:26.971996 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m19:27:26.972312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:27:27.647086 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.674 seconds
[0m19:27:27.649046 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.679 seconds
[0m19:27:27.651032 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m19:27:27.654111 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m19:27:27.709988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1594ea04-33c5-4655-a5ec-aa730aa21ad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7116deae4b50>]}
[0m19:27:27.714967 [debug] [Thread-1 (]: Began running node model.spotify_analytics.daily_user_stats
[0m19:27:27.716236 [debug] [Thread-2 (]: Began running node model.spotify_analytics.device_usage
[0m19:27:27.717045 [debug] [Thread-3 (]: Began running node model.spotify_analytics.top_artists
[0m19:27:27.717724 [debug] [Thread-4 (]: Began running node model.spotify_analytics.top_tracks
[0m19:27:27.715550 [info ] [Thread-1 (]: 1 of 4 START sql table model gold.daily_user_stats ............................. [RUN]
[0m19:27:27.717467 [info ] [Thread-3 (]: 3 of 4 START sql table model gold.top_artists .................................. [RUN]
[0m19:27:27.724418 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.spotify_analytics.top_artists'
[0m19:27:27.716735 [info ] [Thread-2 (]: 2 of 4 START sql table model gold.device_usage ................................. [RUN]
[0m19:27:27.725291 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.device_usage)
[0m19:27:27.724829 [debug] [Thread-3 (]: Began compiling node model.spotify_analytics.top_artists
[0m19:27:27.718628 [info ] [Thread-4 (]: 4 of 4 START sql table model gold.top_tracks ................................... [RUN]
[0m19:27:27.732690 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.spotify_analytics.top_tracks'
[0m19:27:27.723827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.daily_user_stats)
[0m19:27:27.734152 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.daily_user_stats
[0m19:27:27.725665 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.device_usage
[0m19:27:27.733297 [debug] [Thread-4 (]: Began compiling node model.spotify_analytics.top_tracks
[0m19:27:27.744222 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.daily_user_stats"
[0m19:27:27.748417 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.device_usage"
[0m19:27:27.755383 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.device_usage
[0m19:27:27.740042 [debug] [Thread-3 (]: Writing injected SQL for node "model.spotify_analytics.top_artists"
[0m19:27:27.753431 [debug] [Thread-4 (]: Writing injected SQL for node "model.spotify_analytics.top_tracks"
[0m19:27:27.762436 [debug] [Thread-4 (]: Began executing node model.spotify_analytics.top_tracks
[0m19:27:27.761721 [debug] [Thread-3 (]: Began executing node model.spotify_analytics.top_artists
[0m19:27:27.774185 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.daily_user_stats
[0m19:27:27.849908 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.daily_user_stats"
[0m19:27:27.855706 [debug] [Thread-2 (]: Writing runtime sql for node "model.spotify_analytics.device_usage"
[0m19:27:27.855136 [debug] [Thread-3 (]: Writing runtime sql for node "model.spotify_analytics.top_artists"
[0m19:27:27.861277 [debug] [Thread-4 (]: Writing runtime sql for node "model.spotify_analytics.top_tracks"
[0m19:27:27.863000 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.daily_user_stats"
[0m19:27:27.868927 [debug] [Thread-1 (]: On model.spotify_analytics.daily_user_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.daily_user_stats"} */
create or replace transient table spotify_data.gold.daily_user_stats
         as
        (

-- ============================================================================
-- GOLD LAYER: DAILY USER LISTENING STATISTICS
-- ============================================================================
-- Purpose: Aggregate user listening behavior by day
-- 
-- Grain: One row per user per day
-- Primary Key: (date, user_id)
--
-- Metrics:
--   - Total plays per day
--   - Total listening time
--   - Unique tracks/artists played
--   - Average track duration
--
-- Source: SILVER.silver_plays
-- Target: GOLD.daily_user_stats
-- ============================================================================

WITH daily_aggregates AS (
    SELECT 
        -- Date dimension (truncate timestamp to date)
        DATE(played_at) AS date,
        
        -- User identifier
        user_id,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        COUNT(DISTINCT track_id) AS unique_tracks,
        COUNT(DISTINCT artist_name) AS unique_artists,
        AVG(duration_ms) AS avg_track_duration_ms
        
    FROM spotify_data.silver.silver_plays
    GROUP BY 
        DATE(played_at),
        user_id
)

SELECT 
    -- Dimensions
    date,
    user_id,
    
    -- Metrics (cast for clarity)
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    unique_tracks::NUMBER AS unique_tracks,
    unique_artists::NUMBER AS unique_artists,
    ROUND(avg_track_duration_ms, 2)::NUMBER AS avg_track_duration_ms
    
FROM daily_aggregates
ORDER BY date DESC, user_id
        );
[0m19:27:27.869339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:27.864917 [debug] [Thread-2 (]: Using snowflake connection "model.spotify_analytics.device_usage"
[0m19:27:27.870197 [debug] [Thread-2 (]: On model.spotify_analytics.device_usage: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.device_usage"} */
create or replace transient table spotify_data.gold.device_usage
         as
        (

-- ============================================================================
-- GOLD LAYER: DEVICE USAGE STATISTICS
-- ============================================================================
-- Purpose: Aggregate listening behavior by device type
-- 
-- Grain: One row per device type (all-time aggregation)
-- Primary Key: device_type
--
-- Metrics:
--   - Total plays per device
--   - Total listening time
--   - Percentage of total plays
--   - Average track duration
--
-- Source: SILVER.silver_plays
-- Target: GOLD.device_usage
-- ============================================================================

WITH device_aggregates AS (
    SELECT 
        -- Device identifier
        device_type,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        AVG(duration_ms) AS avg_track_duration_ms
        
    FROM spotify_data.silver.silver_plays
    GROUP BY device_type
),

total_plays_calc AS (
    -- Calculate overall total for percentage calculation
    SELECT SUM(total_plays) AS overall_total_plays
    FROM device_aggregates
)

SELECT 
    -- Identifier
    device_type::VARCHAR AS device_type,
    
    -- Metrics
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    
    -- Percentage of total plays
    ROUND((total_plays::FLOAT / overall_total_plays::FLOAT) * 100, 2)::FLOAT AS play_percentage,
    
    -- Average duration
    ROUND(avg_track_duration_ms, 2)::NUMBER AS avg_track_duration_ms
    
FROM device_aggregates
CROSS JOIN total_plays_calc
ORDER BY total_plays DESC
        );
[0m19:27:27.866833 [debug] [Thread-3 (]: Using snowflake connection "model.spotify_analytics.top_artists"
[0m19:27:27.868458 [debug] [Thread-4 (]: Using snowflake connection "model.spotify_analytics.top_tracks"
[0m19:27:27.872582 [debug] [Thread-4 (]: On model.spotify_analytics.top_tracks: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.top_tracks"} */
create or replace transient table spotify_data.gold.top_tracks
         as
        (

-- ============================================================================
-- GOLD LAYER: TOP TRACKS BY PLAY COUNT
-- ============================================================================
-- Purpose: Aggregate and rank tracks by popularity
-- 
-- Grain: One row per track (all-time aggregation)
-- Primary Key: track_id
--
-- Metrics:
--   - Total plays per track
--   - Total listening time
--   - First and last play timestamps
--   - Popularity rank
--
-- Source: SILVER.silver_plays
-- Target: GOLD.top_tracks
-- ============================================================================

WITH track_aggregates AS (
    SELECT 
        -- Track identifiers and attributes
        track_id,
        track_name,
        artist_name,
        album_name,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        MIN(played_at) AS first_played_at,
        MAX(played_at) AS last_played_at
        
    FROM spotify_data.silver.silver_plays
    GROUP BY 
        track_id,
        track_name,
        artist_name,
        album_name
),

ranked_tracks AS (
    SELECT 
        *,
        -- Add ranking based on play count (1 = most played)
        ROW_NUMBER() OVER (ORDER BY total_plays DESC, total_listening_time_ms DESC) AS rank
    FROM track_aggregates
)

SELECT 
    -- Identifiers
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    
    -- Timestamps
    first_played_at::TIMESTAMP AS first_played_at,
    last_played_at::TIMESTAMP AS last_played_at,
    
    -- Ranking
    rank::NUMBER AS rank
    
FROM ranked_tracks
ORDER BY rank
        );
[0m19:27:27.873004 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:27:27.870631 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:27:27.871080 [debug] [Thread-3 (]: On model.spotify_analytics.top_artists: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.top_artists"} */
create or replace transient table spotify_data.gold.top_artists
         as
        (

-- ============================================================================
-- GOLD LAYER: TOP ARTISTS BY PLAY COUNT
-- ============================================================================
-- Purpose: Aggregate and rank artists by popularity
-- 
-- Grain: One row per artist (all-time aggregation)
-- Primary Key: artist_name
--
-- Metrics:
--   - Total plays per artist
--   - Total listening time
--   - Number of unique tracks played
--   - First and last play timestamps
--   - Popularity rank
--
-- Source: SILVER.silver_plays
-- Target: GOLD.top_artists
-- ============================================================================

WITH artist_aggregates AS (
    SELECT 
        -- Artist identifier
        artist_name,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        COUNT(DISTINCT track_id) AS unique_tracks,
        MIN(played_at) AS first_played_at,
        MAX(played_at) AS last_played_at
        
    FROM spotify_data.silver.silver_plays
    GROUP BY artist_name
),

ranked_artists AS (
    SELECT 
        *,
        -- Add ranking based on play count (1 = most played artist)
        ROW_NUMBER() OVER (ORDER BY total_plays DESC, total_listening_time_ms DESC) AS rank
    FROM artist_aggregates
)

SELECT 
    -- Identifier
    artist_name::VARCHAR AS artist_name,
    
    -- Metrics
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    unique_tracks::NUMBER AS unique_tracks,
    
    -- Timestamps
    first_played_at::TIMESTAMP AS first_played_at,
    last_played_at::TIMESTAMP AS last_played_at,
    
    -- Ranking
    rank::NUMBER AS rank
    
FROM ranked_artists
ORDER BY rank
        );
[0m19:27:27.876000 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:27:29.378020 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.502 seconds
[0m19:27:29.406365 [debug] [Thread-3 (]: On model.spotify_analytics.top_artists: Close
[0m19:27:29.461086 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1594ea04-33c5-4655-a5ec-aa730aa21ad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7116dc207c50>]}
[0m19:27:29.461906 [info ] [Thread-3 (]: 3 of 4 OK created sql table model gold.top_artists ............................. [[32mSUCCESS 1[0m in 1.74s]
[0m19:27:29.463828 [debug] [Thread-3 (]: Finished running node model.spotify_analytics.top_artists
[0m19:27:29.908732 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.036 seconds
[0m19:27:29.910750 [debug] [Thread-4 (]: On model.spotify_analytics.top_tracks: Close
[0m19:27:29.942568 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.073 seconds
[0m19:27:29.944681 [debug] [Thread-1 (]: On model.spotify_analytics.daily_user_stats: Close
[0m19:27:29.979342 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1594ea04-33c5-4655-a5ec-aa730aa21ad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7116c68a60d0>]}
[0m19:27:29.980260 [info ] [Thread-4 (]: 4 of 4 OK created sql table model gold.top_tracks .............................. [[32mSUCCESS 1[0m in 2.25s]
[0m19:27:29.982741 [debug] [Thread-4 (]: Finished running node model.spotify_analytics.top_tracks
[0m19:27:29.982150 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.111 seconds
[0m19:27:29.985586 [debug] [Thread-2 (]: On model.spotify_analytics.device_usage: Close
[0m19:27:29.989106 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1594ea04-33c5-4655-a5ec-aa730aa21ad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7116dd174f10>]}
[0m19:27:29.991240 [info ] [Thread-1 (]: 1 of 4 OK created sql table model gold.daily_user_stats ........................ [[32mSUCCESS 1[0m in 2.26s]
[0m19:27:29.992230 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.daily_user_stats
[0m19:27:30.045387 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1594ea04-33c5-4655-a5ec-aa730aa21ad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7116c6fb2550>]}
[0m19:27:30.046299 [info ] [Thread-2 (]: 2 of 4 OK created sql table model gold.device_usage ............................ [[32mSUCCESS 1[0m in 2.32s]
[0m19:27:30.048216 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.device_usage
[0m19:27:30.050170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:27:30.050585 [debug] [MainThread]: Connection 'model.spotify_analytics.device_usage' was properly closed.
[0m19:27:30.050966 [debug] [MainThread]: Connection 'model.spotify_analytics.daily_user_stats' was properly closed.
[0m19:27:30.051282 [debug] [MainThread]: Connection 'model.spotify_analytics.top_artists' was properly closed.
[0m19:27:30.051578 [debug] [MainThread]: Connection 'model.spotify_analytics.top_tracks' was properly closed.
[0m19:27:30.052728 [info ] [MainThread]: 
[0m19:27:30.053823 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 4.20 seconds (4.20s).
[0m19:27:30.055358 [debug] [MainThread]: Command end result
[0m19:27:30.093444 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:27:30.095548 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:27:30.102512 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m19:27:30.102917 [info ] [MainThread]: 
[0m19:27:30.103773 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:27:30.104399 [info ] [MainThread]: 
[0m19:27:30.105421 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m19:27:30.107009 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.1157265, "process_in_blocks": "0", "process_kernel_time": 0.554889, "process_mem_max_rss": "255012", "process_out_blocks": "3176", "process_user_time": 4.526318}
[0m19:27:30.107524 [debug] [MainThread]: Command `dbt run` succeeded at 19:27:30.107433 after 6.12 seconds
[0m19:27:30.107967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7116dc0b3e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7116dc1a18d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7116dc1a13d0>]}
[0m19:27:30.108371 [debug] [MainThread]: Flushing usage events
[0m19:27:30.211408 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:27:34.986671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714ef9b6ba50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714ef9b77850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714ef9b6b150>]}


============================== 19:27:34.993997 | ec562131-08e3-409c-aaa4-85f5977341a6 ==============================
[0m19:27:34.993997 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:27:34.995048 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'static_parser': 'True', 'write_json': 'True', 'target_path': 'None', 'fail_fast': 'False', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'log_path': '/opt/airflow/dbt/logs', 'cache_selected_only': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'profiles_dir': '/opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test', 'empty': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_format': 'default', 'debug': 'False', 'no_print': 'None'}
[0m19:27:36.084446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec562131-08e3-409c-aaa4-85f5977341a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714eeadf9fd0>]}
[0m19:27:36.164488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec562131-08e3-409c-aaa4-85f5977341a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714efac45690>]}
[0m19:27:36.166208 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:27:36.388669 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:27:36.540497 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:27:36.541490 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:27:36.548645 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m19:27:36.603353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec562131-08e3-409c-aaa4-85f5977341a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714ee856add0>]}
[0m19:27:36.722815 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:27:36.724962 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:27:36.765000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec562131-08e3-409c-aaa4-85f5977341a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714ee8257850>]}
[0m19:27:36.766006 [info ] [MainThread]: Found 5 models, 43 data tests, 1 source, 604 macros
[0m19:27:36.766484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec562131-08e3-409c-aaa4-85f5977341a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714ee8293f90>]}
[0m19:27:36.772430 [info ] [MainThread]: 
[0m19:27:36.773505 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:27:36.774218 [info ] [MainThread]: 
[0m19:27:36.775130 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:27:36.783594 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m19:27:36.784417 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m19:27:36.818654 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m19:27:36.819656 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m19:27:36.820003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:27:36.819264 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m19:27:36.820974 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m19:27:36.822966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:27:37.648517 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.828 seconds
[0m19:27:37.650000 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.827 seconds
[0m19:27:37.652114 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m19:27:37.655231 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m19:27:37.728316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec562131-08e3-409c-aaa4-85f5977341a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714ee824bd50>]}
[0m19:27:37.734826 [debug] [Thread-1 (]: Began running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m19:27:37.737900 [info ] [Thread-1 (]: 1 of 43 START test dbt_utils_accepted_range_silver_plays_duration_ms__600000__1  [RUN]
[0m19:27:37.737388 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m19:27:37.740045 [info ] [Thread-3 (]: 3 of 43 START test not_null_daily_user_stats_date .............................. [RUN]
[0m19:27:37.736860 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m19:27:37.739499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39)
[0m19:27:37.742831 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m19:27:37.741330 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m19:27:37.740614 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9'
[0m19:27:37.750228 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m19:27:37.742240 [info ] [Thread-2 (]: 2 of 43 START test not_null_daily_user_stats_avg_track_duration_ms ............. [RUN]
[0m19:27:37.751037 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155)
[0m19:27:37.751441 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m19:27:37.749866 [info ] [Thread-4 (]: 4 of 43 START test not_null_daily_user_stats_total_listening_time_ms ........... [RUN]
[0m19:27:37.752069 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87'
[0m19:27:37.752437 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m19:27:37.813449 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m19:27:37.814021 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m19:27:37.815938 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m19:27:37.819163 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m19:27:37.820137 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m19:27:37.820791 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m19:27:37.821421 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m19:27:37.822015 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m19:27:37.871007 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m19:27:37.889335 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m19:27:37.888193 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m19:27:37.890987 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m19:27:37.871596 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m19:27:37.892409 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m19:27:37.891483 [debug] [Thread-1 (]: On test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from spotify_data.silver.silver_plays
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not duration_ms >= 1
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not duration_ms <= 600000
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m19:27:37.894027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:37.893584 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m19:27:37.889902 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from spotify_data.gold.daily_user_stats
where date is null



  
  
      
    ) dbt_internal_test
[0m19:27:37.896105 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:27:37.892830 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_track_duration_ms
from spotify_data.gold.daily_user_stats
where avg_track_duration_ms is null



  
  
      
    ) dbt_internal_test
[0m19:27:37.897065 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:27:37.895599 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m19:27:37.898170 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.daily_user_stats
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m19:27:37.898683 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:27:38.544895 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.651 seconds
[0m19:27:38.554798 [debug] [Thread-1 (]: On test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39: Close
[0m19:27:38.617269 [info ] [Thread-1 (]: 1 of 43 PASS dbt_utils_accepted_range_silver_plays_duration_ms__600000__1 ...... [[32mPASS[0m in 0.88s]
[0m19:27:38.619555 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m19:27:38.620370 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m19:27:38.620924 [info ] [Thread-1 (]: 5 of 43 START test not_null_daily_user_stats_total_plays ....................... [RUN]
[0m19:27:38.621827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39, now test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282)
[0m19:27:38.622289 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m19:27:38.628071 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m19:27:38.628734 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m19:27:38.631814 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m19:27:38.632726 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m19:27:38.633150 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.daily_user_stats
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m19:27:38.633584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:38.807538 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.911 seconds
[0m19:27:38.810609 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9: Close
[0m19:27:38.821650 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.925 seconds
[0m19:27:38.826139 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155: Close
[0m19:27:38.843162 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.944 seconds
[0m19:27:38.845514 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87: Close
[0m19:27:38.882946 [info ] [Thread-3 (]: 3 of 43 PASS not_null_daily_user_stats_date .................................... [[32mPASS[0m in 1.14s]
[0m19:27:38.884213 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m19:27:38.884712 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m19:27:38.888807 [info ] [Thread-3 (]: 6 of 43 START test not_null_daily_user_stats_unique_artists .................... [RUN]
[0m19:27:38.889374 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9, now test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f)
[0m19:27:38.889768 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m19:27:38.895896 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m19:27:38.897935 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m19:27:38.901069 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m19:27:38.897294 [info ] [Thread-4 (]: 4 of 43 PASS not_null_daily_user_stats_total_listening_time_ms ................. [[32mPASS[0m in 1.14s]
[0m19:27:38.902279 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m19:27:38.902724 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m19:27:38.903614 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m19:27:38.904691 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unique_artists
from spotify_data.gold.daily_user_stats
where unique_artists is null



  
  
      
    ) dbt_internal_test
[0m19:27:38.904074 [info ] [Thread-4 (]: 7 of 43 START test not_null_daily_user_stats_unique_tracks ..................... [RUN]
[0m19:27:38.905647 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87, now test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac)
[0m19:27:38.906021 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m19:27:38.905241 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:27:38.911136 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m19:27:38.913175 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m19:27:38.917958 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m19:27:38.925058 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m19:27:38.925584 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unique_tracks
from spotify_data.gold.daily_user_stats
where unique_tracks is null



  
  
      
    ) dbt_internal_test
[0m19:27:38.926001 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:27:38.954578 [info ] [Thread-2 (]: 2 of 43 PASS not_null_daily_user_stats_avg_track_duration_ms ................... [[32mPASS[0m in 1.20s]
[0m19:27:38.960548 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m19:27:38.966427 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m19:27:38.966911 [info ] [Thread-2 (]: 8 of 43 START test not_null_daily_user_stats_user_id ........................... [RUN]
[0m19:27:38.969910 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155, now test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b)
[0m19:27:38.970333 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m19:27:38.980577 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m19:27:38.981320 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m19:27:38.984765 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m19:27:39.002503 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m19:27:39.007378 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from spotify_data.gold.daily_user_stats
where user_id is null



  
  
      
    ) dbt_internal_test
[0m19:27:39.014306 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:27:39.196027 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.559 seconds
[0m19:27:39.204431 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282: Close
[0m19:27:39.317690 [info ] [Thread-1 (]: 5 of 43 PASS not_null_daily_user_stats_total_plays ............................. [[32mPASS[0m in 0.70s]
[0m19:27:39.327273 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m19:27:39.328547 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m19:27:39.333205 [info ] [Thread-1 (]: 9 of 43 START test not_null_device_usage_avg_track_duration_ms ................. [RUN]
[0m19:27:39.333840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282, now test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003)
[0m19:27:39.336560 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m19:27:39.341917 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m19:27:39.343227 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m19:27:39.348062 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m19:27:39.349523 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m19:27:39.350189 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_track_duration_ms
from spotify_data.gold.device_usage
where avg_track_duration_ms is null



  
  
      
    ) dbt_internal_test
[0m19:27:39.350577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:39.581437 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.655 seconds
[0m19:27:39.583534 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac: Close
[0m19:27:39.597911 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.584 seconds
[0m19:27:39.600126 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b: Close
[0m19:27:39.640845 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.733 seconds
[0m19:27:39.643569 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f: Close
[0m19:27:39.656810 [info ] [Thread-4 (]: 7 of 43 PASS not_null_daily_user_stats_unique_tracks ........................... [[32mPASS[0m in 0.75s]
[0m19:27:39.658388 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m19:27:39.659183 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m19:27:39.659678 [info ] [Thread-4 (]: 10 of 43 START test not_null_device_usage_device_type .......................... [RUN]
[0m19:27:39.660212 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac, now test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c)
[0m19:27:39.660607 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m19:27:39.667773 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m19:27:39.672085 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m19:27:39.675399 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m19:27:39.677404 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m19:27:39.671295 [info ] [Thread-2 (]: 8 of 43 PASS not_null_daily_user_stats_user_id ................................. [[32mPASS[0m in 0.70s]
[0m19:27:39.678538 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m19:27:39.677824 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select device_type
from spotify_data.gold.device_usage
where device_type is null



  
  
      
    ) dbt_internal_test
[0m19:27:39.679004 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m19:27:39.680263 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:27:39.680720 [info ] [Thread-2 (]: 11 of 43 START test not_null_device_usage_play_percentage ...................... [RUN]
[0m19:27:39.682588 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b, now test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2)
[0m19:27:39.683028 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m19:27:39.687713 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m19:27:39.690395 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m19:27:39.693434 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m19:27:39.698420 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m19:27:39.702706 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select play_percentage
from spotify_data.gold.device_usage
where play_percentage is null



  
  
      
    ) dbt_internal_test
[0m19:27:39.703204 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:27:39.776824 [info ] [Thread-3 (]: 6 of 43 PASS not_null_daily_user_stats_unique_artists .......................... [[32mPASS[0m in 0.89s]
[0m19:27:39.785895 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m19:27:39.790120 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m19:27:39.792349 [info ] [Thread-3 (]: 12 of 43 START test not_null_device_usage_total_listening_time_ms .............. [RUN]
[0m19:27:39.794717 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f, now test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2)
[0m19:27:39.796189 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m19:27:39.816076 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m19:27:39.818002 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m19:27:39.830250 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m19:27:39.836403 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m19:27:39.841301 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.device_usage
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m19:27:39.841710 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:27:39.909755 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.558 seconds
[0m19:27:39.919305 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003: Close
[0m19:27:40.069045 [info ] [Thread-1 (]: 9 of 43 PASS not_null_device_usage_avg_track_duration_ms ....................... [[32mPASS[0m in 0.73s]
[0m19:27:40.071366 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m19:27:40.075607 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m19:27:40.094710 [info ] [Thread-1 (]: 13 of 43 START test not_null_device_usage_total_plays .......................... [RUN]
[0m19:27:40.095528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003, now test.spotify_analytics.not_null_device_usage_total_plays.90a295df48)
[0m19:27:40.099173 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m19:27:40.145183 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m19:27:40.153147 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m19:27:40.165113 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m19:27:40.168125 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m19:27:40.168747 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_device_usage_total_plays.90a295df48: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.device_usage
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m19:27:40.170326 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:40.457179 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.778 seconds
[0m19:27:40.466900 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c: Close
[0m19:27:40.478454 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.772 seconds
[0m19:27:40.482459 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2: Close
[0m19:27:40.571680 [info ] [Thread-4 (]: 10 of 43 PASS not_null_device_usage_device_type ................................ [[32mPASS[0m in 0.91s]
[0m19:27:40.574125 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m19:27:40.577465 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m19:27:40.579867 [info ] [Thread-4 (]: 14 of 43 START test not_null_silver_plays_artist_name .......................... [RUN]
[0m19:27:40.581521 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c, now test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad)
[0m19:27:40.583112 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m19:27:40.595217 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m19:27:40.598289 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m19:27:40.596533 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.755 seconds
[0m19:27:40.609131 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2: Close
[0m19:27:40.617647 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m19:27:40.623976 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m19:27:40.626141 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select artist_name
from spotify_data.silver.silver_plays
where artist_name is null



  
  
      
    ) dbt_internal_test
[0m19:27:40.629627 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:27:40.640322 [info ] [Thread-2 (]: 11 of 43 PASS not_null_device_usage_play_percentage ............................ [[32mPASS[0m in 0.96s]
[0m19:27:40.644573 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m19:27:40.650252 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m19:27:40.652474 [info ] [Thread-2 (]: 15 of 43 START test not_null_silver_plays_duration_ms .......................... [RUN]
[0m19:27:40.662135 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2, now test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076)
[0m19:27:40.672118 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m19:27:40.692272 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m19:27:40.700026 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m19:27:40.705939 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m19:27:40.710716 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m19:27:40.711802 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select duration_ms
from spotify_data.silver.silver_plays
where duration_ms is null



  
  
      
    ) dbt_internal_test
[0m19:27:40.712255 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:27:40.714497 [info ] [Thread-3 (]: 12 of 43 PASS not_null_device_usage_total_listening_time_ms .................... [[32mPASS[0m in 0.92s]
[0m19:27:40.722964 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m19:27:40.723463 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m19:27:40.730617 [info ] [Thread-3 (]: 16 of 43 START test not_null_silver_plays_event_id ............................. [RUN]
[0m19:27:40.743358 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2, now test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd)
[0m19:27:40.743803 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m19:27:40.749379 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m19:27:40.755587 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m19:27:40.762827 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m19:27:40.767134 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m19:27:40.780279 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from spotify_data.silver.silver_plays
where event_id is null



  
  
      
    ) dbt_internal_test
[0m19:27:40.780811 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:27:40.944432 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.774 seconds
[0m19:27:40.952077 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_device_usage_total_plays.90a295df48: Close
[0m19:27:41.043979 [info ] [Thread-1 (]: 13 of 43 PASS not_null_device_usage_total_plays ................................ [[32mPASS[0m in 0.95s]
[0m19:27:41.045308 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m19:27:41.045817 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m19:27:41.046286 [info ] [Thread-1 (]: 17 of 43 START test not_null_silver_plays_event_type ........................... [RUN]
[0m19:27:41.047006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_plays.90a295df48, now test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa)
[0m19:27:41.047404 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m19:27:41.053258 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m19:27:41.055351 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m19:27:41.058490 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m19:27:41.060699 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m19:27:41.062715 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_type
from spotify_data.silver.silver_plays
where event_type is null



  
  
      
    ) dbt_internal_test
[0m19:27:41.067934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:41.310866 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.681 seconds
[0m19:27:41.312763 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad: Close
[0m19:27:41.324308 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.612 seconds
[0m19:27:41.330237 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076: Close
[0m19:27:41.381023 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.598 seconds
[0m19:27:41.388167 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd: Close
[0m19:27:41.433624 [info ] [Thread-4 (]: 14 of 43 PASS not_null_silver_plays_artist_name ................................ [[32mPASS[0m in 0.85s]
[0m19:27:41.436350 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m19:27:41.437998 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m19:27:41.438540 [info ] [Thread-4 (]: 18 of 43 START test not_null_silver_plays_played_at ............................ [RUN]
[0m19:27:41.440373 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad, now test.spotify_analytics.not_null_silver_plays_played_at.8281565f95)
[0m19:27:41.443081 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m19:27:41.460998 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m19:27:41.462159 [info ] [Thread-2 (]: 15 of 43 PASS not_null_silver_plays_duration_ms ................................ [[32mPASS[0m in 0.80s]
[0m19:27:41.464156 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m19:27:41.464594 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m19:27:41.465579 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m19:27:41.469572 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m19:27:41.466005 [info ] [Thread-2 (]: 19 of 43 START test not_null_silver_plays_processed_at ......................... [RUN]
[0m19:27:41.470260 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076, now test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed)
[0m19:27:41.470655 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m19:27:41.471922 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m19:27:41.476616 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m19:27:41.485447 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m19:27:41.478053 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_played_at.8281565f95: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select played_at
from spotify_data.silver.silver_plays
where played_at is null



  
  
      
    ) dbt_internal_test
[0m19:27:41.493118 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:27:41.492515 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.425 seconds
[0m19:27:41.496213 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m19:27:41.505228 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m19:27:41.499274 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa: Close
[0m19:27:41.500590 [info ] [Thread-3 (]: 16 of 43 PASS not_null_silver_plays_event_id ................................... [[32mPASS[0m in 0.76s]
[0m19:27:41.507365 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m19:27:41.507776 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m19:27:41.505691 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select processed_at
from spotify_data.silver.silver_plays
where processed_at is null



  
  
      
    ) dbt_internal_test
[0m19:27:41.511158 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:27:41.508176 [info ] [Thread-3 (]: 20 of 43 START test not_null_silver_plays_track_id ............................. [RUN]
[0m19:27:41.514271 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd, now test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9)
[0m19:27:41.519531 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m19:27:41.736411 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m19:27:41.740135 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m19:27:41.743478 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m19:27:41.750336 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m19:27:41.754395 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_id
from spotify_data.silver.silver_plays
where track_id is null



  
  
      
    ) dbt_internal_test
[0m19:27:41.757601 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:27:41.764167 [info ] [Thread-1 (]: 17 of 43 PASS not_null_silver_plays_event_type ................................. [[32mPASS[0m in 0.72s]
[0m19:27:41.765755 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m19:27:41.766568 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m19:27:41.771947 [info ] [Thread-1 (]: 21 of 43 START test not_null_silver_plays_track_name ........................... [RUN]
[0m19:27:41.772461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa, now test.spotify_analytics.not_null_silver_plays_track_name.c6334add30)
[0m19:27:41.773944 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m19:27:41.798346 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m19:27:41.802384 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m19:27:41.831979 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m19:27:41.845417 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m19:27:41.847080 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_silver_plays_track_name.c6334add30: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_name
from spotify_data.silver.silver_plays
where track_name is null



  
  
      
    ) dbt_internal_test
[0m19:27:41.855438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:42.356286 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.863 seconds
[0m19:27:42.358919 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_played_at.8281565f95: Close
[0m19:27:42.430752 [info ] [Thread-4 (]: 18 of 43 PASS not_null_silver_plays_played_at .................................. [[32mPASS[0m in 0.99s]
[0m19:27:42.432306 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m19:27:42.432766 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m19:27:42.433222 [info ] [Thread-4 (]: 22 of 43 START test not_null_silver_plays_user_id .............................. [RUN]
[0m19:27:42.433912 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_played_at.8281565f95, now test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4)
[0m19:27:42.434288 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m19:27:42.440338 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m19:27:42.441783 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m19:27:42.445286 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m19:27:42.446368 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m19:27:42.446894 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from spotify_data.silver.silver_plays
where user_id is null



  
  
      
    ) dbt_internal_test
[0m19:27:42.447373 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:27:42.539841 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.029 seconds
[0m19:27:42.548064 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed: Close
[0m19:27:42.560432 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.705 seconds
[0m19:27:42.567677 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_silver_plays_track_name.c6334add30: Close
[0m19:27:42.591275 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.833 seconds
[0m19:27:42.595223 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9: Close
[0m19:27:42.622233 [info ] [Thread-2 (]: 19 of 43 PASS not_null_silver_plays_processed_at ............................... [[32mPASS[0m in 1.15s]
[0m19:27:42.624406 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m19:27:42.627393 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m19:27:42.627800 [info ] [Thread-2 (]: 23 of 43 START test not_null_top_artists_artist_name ........................... [RUN]
[0m19:27:42.629687 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed, now test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e)
[0m19:27:42.630139 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m19:27:42.639546 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m19:27:42.640467 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m19:27:42.642902 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m19:27:42.643751 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m19:27:42.644599 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select artist_name
from spotify_data.gold.top_artists
where artist_name is null



  
  
      
    ) dbt_internal_test
[0m19:27:42.644975 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:27:42.718294 [info ] [Thread-3 (]: 20 of 43 PASS not_null_silver_plays_track_id ................................... [[32mPASS[0m in 1.20s]
[0m19:27:42.721243 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m19:27:42.723413 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m19:27:42.723951 [info ] [Thread-3 (]: 24 of 43 START test not_null_top_artists_first_played_at ....................... [RUN]
[0m19:27:42.724461 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9, now test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14)
[0m19:27:42.726639 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m19:27:42.737747 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m19:27:42.742257 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m19:27:42.748770 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m19:27:42.750721 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m19:27:42.753042 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_played_at
from spotify_data.gold.top_artists
where first_played_at is null



  
  
      
    ) dbt_internal_test
[0m19:27:42.753449 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:27:42.808211 [info ] [Thread-1 (]: 21 of 43 PASS not_null_silver_plays_track_name ................................. [[32mPASS[0m in 1.03s]
[0m19:27:42.818142 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m19:27:42.823138 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m19:27:42.823562 [info ] [Thread-1 (]: 25 of 43 START test not_null_top_artists_last_played_at ........................ [RUN]
[0m19:27:42.828481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_track_name.c6334add30, now test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca)
[0m19:27:42.834772 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m19:27:42.869561 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m19:27:42.874471 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m19:27:42.897984 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m19:27:42.901882 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m19:27:42.902360 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_played_at
from spotify_data.gold.top_artists
where last_played_at is null



  
  
      
    ) dbt_internal_test
[0m19:27:42.902743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:43.048089 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.601 seconds
[0m19:27:43.052207 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4: Close
[0m19:27:43.138529 [info ] [Thread-4 (]: 22 of 43 PASS not_null_silver_plays_user_id .................................... [[32mPASS[0m in 0.70s]
[0m19:27:43.139337 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m19:27:43.140157 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m19:27:43.141059 [info ] [Thread-4 (]: 26 of 43 START test not_null_top_artists_rank .................................. [RUN]
[0m19:27:43.142199 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4, now test.spotify_analytics.not_null_top_artists_rank.d14513fc96)
[0m19:27:43.142580 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m19:27:43.148139 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m19:27:43.148741 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m19:27:43.152808 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m19:27:43.153672 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m19:27:43.154115 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_rank.d14513fc96: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rank
from spotify_data.gold.top_artists
where rank is null



  
  
      
    ) dbt_internal_test
[0m19:27:43.154550 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:27:43.215811 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.571 seconds
[0m19:27:43.224091 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e: Close
[0m19:27:43.299184 [info ] [Thread-2 (]: 23 of 43 PASS not_null_top_artists_artist_name ................................. [[32mPASS[0m in 0.67s]
[0m19:27:43.300299 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m19:27:43.300754 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m19:27:43.301301 [info ] [Thread-2 (]: 27 of 43 START test not_null_top_artists_total_listening_time_ms ............... [RUN]
[0m19:27:43.302006 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e, now test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c)
[0m19:27:43.303323 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m19:27:43.308134 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m19:27:43.309722 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m19:27:43.312400 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m19:27:43.314524 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m19:27:43.316125 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.top_artists
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m19:27:43.316528 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:27:43.528881 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.775 seconds
[0m19:27:43.531059 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14: Close
[0m19:27:43.552057 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.649 seconds
[0m19:27:43.553816 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca: Close
[0m19:27:43.557696 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.403 seconds
[0m19:27:43.569015 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_rank.d14513fc96: Close
[0m19:27:43.615326 [info ] [Thread-3 (]: 24 of 43 PASS not_null_top_artists_first_played_at ............................. [[32mPASS[0m in 0.89s]
[0m19:27:43.616699 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m19:27:43.617178 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m19:27:43.618037 [info ] [Thread-3 (]: 28 of 43 START test not_null_top_artists_total_plays ........................... [RUN]
[0m19:27:43.618712 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14, now test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11)
[0m19:27:43.619146 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m19:27:43.624604 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m19:27:43.627404 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m19:27:43.630766 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m19:27:43.632998 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m19:27:43.635244 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.top_artists
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m19:27:43.636076 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:27:43.654408 [info ] [Thread-1 (]: 25 of 43 PASS not_null_top_artists_last_played_at .............................. [[32mPASS[0m in 0.82s]
[0m19:27:43.659653 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m19:27:43.664194 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m19:27:43.665978 [info ] [Thread-1 (]: 29 of 43 START test not_null_top_artists_unique_tracks ......................... [RUN]
[0m19:27:43.670472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca, now test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13)
[0m19:27:43.670906 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m19:27:43.669963 [info ] [Thread-4 (]: 26 of 43 PASS not_null_top_artists_rank ........................................ [[32mPASS[0m in 0.53s]
[0m19:27:43.680598 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m19:27:43.681385 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m19:27:43.685615 [info ] [Thread-4 (]: 30 of 43 START test not_null_top_tracks_artist_name ............................ [RUN]
[0m19:27:43.686118 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_rank.d14513fc96, now test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461)
[0m19:27:43.683041 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m19:27:43.687777 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m19:27:43.686799 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m19:27:43.691165 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m19:27:43.699043 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m19:27:43.697870 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m19:27:43.700952 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m19:27:43.699573 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unique_tracks
from spotify_data.gold.top_artists
where unique_tracks is null



  
  
      
    ) dbt_internal_test
[0m19:27:43.706487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:43.703432 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m19:27:43.708475 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m19:27:43.708905 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select artist_name
from spotify_data.gold.top_tracks
where artist_name is null



  
  
      
    ) dbt_internal_test
[0m19:27:43.712152 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:27:43.840651 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.524 seconds
[0m19:27:43.875692 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c: Close
[0m19:27:43.983216 [info ] [Thread-2 (]: 27 of 43 PASS not_null_top_artists_total_listening_time_ms ..................... [[32mPASS[0m in 0.68s]
[0m19:27:43.984019 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m19:27:43.985745 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m19:27:43.988129 [info ] [Thread-2 (]: 31 of 43 START test not_null_top_tracks_first_played_at ........................ [RUN]
[0m19:27:43.990245 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c, now test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31)
[0m19:27:43.994043 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m19:27:44.018429 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m19:27:44.023107 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m19:27:44.026271 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m19:27:44.029567 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m19:27:44.032066 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_played_at
from spotify_data.gold.top_tracks
where first_played_at is null



  
  
      
    ) dbt_internal_test
[0m19:27:44.032473 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:27:44.291325 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.656 seconds
[0m19:27:44.295910 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11: Close
[0m19:27:44.407036 [info ] [Thread-3 (]: 28 of 43 PASS not_null_top_artists_total_plays ................................. [[32mPASS[0m in 0.79s]
[0m19:27:44.408153 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m19:27:44.408609 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m19:27:44.409093 [info ] [Thread-3 (]: 32 of 43 START test not_null_top_tracks_last_played_at ......................... [RUN]
[0m19:27:44.409752 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11, now test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532)
[0m19:27:44.410609 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m19:27:44.416270 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m19:27:44.416929 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m19:27:44.419620 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m19:27:44.420479 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m19:27:44.421134 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_played_at
from spotify_data.gold.top_tracks
where last_played_at is null



  
  
      
    ) dbt_internal_test
[0m19:27:44.421509 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:27:44.463024 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.755 seconds
[0m19:27:44.475808 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13: Close
[0m19:27:44.544699 [info ] [Thread-1 (]: 29 of 43 PASS not_null_top_artists_unique_tracks ............................... [[32mPASS[0m in 0.87s]
[0m19:27:44.547573 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m19:27:44.550402 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m19:27:44.550844 [info ] [Thread-1 (]: 33 of 43 START test not_null_top_tracks_rank ................................... [RUN]
[0m19:27:44.552267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13, now test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4)
[0m19:27:44.552725 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m19:27:44.559637 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m19:27:44.560571 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m19:27:44.563328 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m19:27:44.564179 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m19:27:44.564776 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rank
from spotify_data.gold.top_tracks
where rank is null



  
  
      
    ) dbt_internal_test
[0m19:27:44.565163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:44.611968 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.579 seconds
[0m19:27:44.614913 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31: Close
[0m19:27:44.624455 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.912 seconds
[0m19:27:44.630072 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461: Close
[0m19:27:44.707594 [info ] [Thread-2 (]: 31 of 43 PASS not_null_top_tracks_first_played_at .............................. [[32mPASS[0m in 0.72s]
[0m19:27:44.708952 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m19:27:44.709411 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m19:27:44.709897 [info ] [Thread-2 (]: 34 of 43 START test not_null_top_tracks_total_listening_time_ms ................ [RUN]
[0m19:27:44.710611 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31, now test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac)
[0m19:27:44.711115 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m19:27:44.716471 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m19:27:44.718067 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m19:27:44.720669 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m19:27:44.725163 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m19:27:44.725604 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.top_tracks
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m19:27:44.723923 [info ] [Thread-4 (]: 30 of 43 PASS not_null_top_tracks_artist_name .................................. [[32mPASS[0m in 1.04s]
[0m19:27:44.727089 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m19:27:44.726512 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:27:44.727510 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m19:27:44.730069 [info ] [Thread-4 (]: 35 of 43 START test not_null_top_tracks_total_plays ............................ [RUN]
[0m19:27:44.730533 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461, now test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893)
[0m19:27:44.731228 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m19:27:44.742443 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m19:27:44.746261 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m19:27:44.749311 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m19:27:44.753026 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m19:27:44.763732 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.top_tracks
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m19:27:44.764204 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:27:44.922837 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.501 seconds
[0m19:27:44.928233 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532: Close
[0m19:27:45.037576 [info ] [Thread-3 (]: 32 of 43 PASS not_null_top_tracks_last_played_at ............................... [[32mPASS[0m in 0.63s]
[0m19:27:45.038895 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m19:27:45.040223 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m19:27:45.040727 [info ] [Thread-3 (]: 36 of 43 START test not_null_top_tracks_track_id ............................... [RUN]
[0m19:27:45.041516 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532, now test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78)
[0m19:27:45.042070 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m19:27:45.047165 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m19:27:45.047777 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m19:27:45.051009 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m19:27:45.052088 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m19:27:45.053229 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_id
from spotify_data.gold.top_tracks
where track_id is null



  
  
      
    ) dbt_internal_test
[0m19:27:45.053623 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:27:45.172126 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.607 seconds
[0m19:27:45.174137 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4: Close
[0m19:27:45.247811 [info ] [Thread-1 (]: 33 of 43 PASS not_null_top_tracks_rank ......................................... [[32mPASS[0m in 0.70s]
[0m19:27:45.249813 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m19:27:45.250391 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m19:27:45.251429 [info ] [Thread-1 (]: 37 of 43 START test not_null_top_tracks_track_name ............................. [RUN]
[0m19:27:45.252402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4, now test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203)
[0m19:27:45.252827 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m19:27:45.259060 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m19:27:45.260230 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m19:27:45.263410 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m19:27:45.265344 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m19:27:45.265775 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_name
from spotify_data.gold.top_tracks
where track_name is null



  
  
      
    ) dbt_internal_test
[0m19:27:45.266164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:45.360236 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.634 seconds
[0m19:27:45.363327 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac: Close
[0m19:27:45.368720 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.604 seconds
[0m19:27:45.371560 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893: Close
[0m19:27:45.425010 [info ] [Thread-2 (]: 34 of 43 PASS not_null_top_tracks_total_listening_time_ms ...................... [[32mPASS[0m in 0.71s]
[0m19:27:45.430205 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m19:27:45.431656 [debug] [Thread-2 (]: Began running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m19:27:45.427209 [info ] [Thread-4 (]: 35 of 43 PASS not_null_top_tracks_total_plays .................................. [[32mPASS[0m in 0.70s]
[0m19:27:45.439009 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m19:27:45.439892 [debug] [Thread-4 (]: Began running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m19:27:45.438464 [info ] [Thread-2 (]: 38 of 43 START test unique_device_usage_device_type ............................ [RUN]
[0m19:27:45.441417 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac, now test.spotify_analytics.unique_device_usage_device_type.e75362861b)
[0m19:27:45.441839 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m19:27:45.441026 [info ] [Thread-4 (]: 39 of 43 START test unique_silver_plays_event_id ............................... [RUN]
[0m19:27:45.447812 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893, now test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf)
[0m19:27:45.448306 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m19:27:45.456698 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m19:27:45.458819 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m19:27:45.460615 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m19:27:45.459505 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m19:27:45.463086 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m19:27:45.465678 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m19:27:45.466614 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m19:27:45.468189 [debug] [Thread-4 (]: On test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from spotify_data.silver.silver_plays
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:27:45.468566 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:27:45.467724 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m19:27:45.469015 [debug] [Thread-2 (]: On test.spotify_analytics.unique_device_usage_device_type.e75362861b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_device_usage_device_type.e75362861b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    device_type as unique_field,
    count(*) as n_records

from spotify_data.gold.device_usage
where device_type is not null
group by device_type
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:27:45.470270 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:27:45.637735 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.584 seconds
[0m19:27:45.651340 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78: Close
[0m19:27:45.727061 [info ] [Thread-3 (]: 36 of 43 PASS not_null_top_tracks_track_id ..................................... [[32mPASS[0m in 0.69s]
[0m19:27:45.728286 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m19:27:45.728782 [debug] [Thread-3 (]: Began running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m19:27:45.730846 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.465 seconds
[0m19:27:45.736360 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203: Close
[0m19:27:45.731433 [info ] [Thread-3 (]: 40 of 43 START test unique_top_artists_artist_name ............................. [RUN]
[0m19:27:45.743200 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78, now test.spotify_analytics.unique_top_artists_artist_name.008ffa1533)
[0m19:27:45.749737 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m19:27:45.754349 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m19:27:45.756803 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m19:27:45.759708 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m19:27:45.761054 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m19:27:45.761506 [debug] [Thread-3 (]: On test.spotify_analytics.unique_top_artists_artist_name.008ffa1533: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    artist_name as unique_field,
    count(*) as n_records

from spotify_data.gold.top_artists
where artist_name is not null
group by artist_name
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:27:45.761900 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:27:45.814651 [info ] [Thread-1 (]: 37 of 43 PASS not_null_top_tracks_track_name ................................... [[32mPASS[0m in 0.56s]
[0m19:27:45.816694 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m19:27:45.819499 [debug] [Thread-1 (]: Began running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m19:27:45.821871 [info ] [Thread-1 (]: 41 of 43 START test unique_top_artists_rank .................................... [RUN]
[0m19:27:45.825293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203, now test.spotify_analytics.unique_top_artists_rank.68b5480aed)
[0m19:27:45.827185 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m19:27:45.836209 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m19:27:45.838546 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m19:27:45.846524 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m19:27:45.849036 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m19:27:45.850374 [debug] [Thread-1 (]: On test.spotify_analytics.unique_top_artists_rank.68b5480aed: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_artists_rank.68b5480aed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rank as unique_field,
    count(*) as n_records

from spotify_data.gold.top_artists
where rank is not null
group by rank
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:27:45.850807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:46.023311 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.554 seconds
[0m19:27:46.025310 [debug] [Thread-2 (]: On test.spotify_analytics.unique_device_usage_device_type.e75362861b: Close
[0m19:27:46.123000 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.654 seconds
[0m19:27:46.126136 [debug] [Thread-4 (]: On test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf: Close
[0m19:27:46.193501 [info ] [Thread-2 (]: 38 of 43 PASS unique_device_usage_device_type .................................. [[32mPASS[0m in 0.75s]
[0m19:27:46.196374 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m19:27:46.196961 [debug] [Thread-2 (]: Began running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m19:27:46.195272 [info ] [Thread-4 (]: 39 of 43 PASS unique_silver_plays_event_id ..................................... [[32mPASS[0m in 0.75s]
[0m19:27:46.198252 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m19:27:46.198865 [debug] [Thread-4 (]: Began running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m19:27:46.197784 [info ] [Thread-2 (]: 42 of 43 START test unique_top_tracks_rank ..................................... [RUN]
[0m19:27:46.203784 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_device_usage_device_type.e75362861b, now test.spotify_analytics.unique_top_tracks_rank.8fecde1136)
[0m19:27:46.204225 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m19:27:46.203350 [info ] [Thread-4 (]: 43 of 43 START test unique_top_tracks_track_id ................................. [RUN]
[0m19:27:46.212809 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf, now test.spotify_analytics.unique_top_tracks_track_id.865b43a659)
[0m19:27:46.211595 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m19:27:46.214307 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m19:27:46.213556 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m19:27:46.217863 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m19:27:46.225024 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m19:27:46.223810 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m19:27:46.226591 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m19:27:46.225994 [debug] [Thread-2 (]: On test.spotify_analytics.unique_top_tracks_rank.8fecde1136: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rank as unique_field,
    count(*) as n_records

from spotify_data.gold.top_tracks
where rank is not null
group by rank
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:27:46.231471 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:27:46.231039 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m19:27:46.233650 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m19:27:46.234128 [debug] [Thread-4 (]: On test.spotify_analytics.unique_top_tracks_track_id.865b43a659: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    track_id as unique_field,
    count(*) as n_records

from spotify_data.gold.top_tracks
where track_id is not null
group by track_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:27:46.234508 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:27:46.419322 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.655 seconds
[0m19:27:46.423665 [debug] [Thread-3 (]: On test.spotify_analytics.unique_top_artists_artist_name.008ffa1533: Close
[0m19:27:46.446204 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.595 seconds
[0m19:27:46.450517 [debug] [Thread-1 (]: On test.spotify_analytics.unique_top_artists_rank.68b5480aed: Close
[0m19:27:46.475927 [info ] [Thread-3 (]: 40 of 43 PASS unique_top_artists_artist_name ................................... [[32mPASS[0m in 0.73s]
[0m19:27:46.481459 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m19:27:46.496878 [info ] [Thread-1 (]: 41 of 43 PASS unique_top_artists_rank .......................................... [[32mPASS[0m in 0.67s]
[0m19:27:46.497549 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m19:27:46.802779 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.568 seconds
[0m19:27:46.805568 [debug] [Thread-4 (]: On test.spotify_analytics.unique_top_tracks_track_id.865b43a659: Close
[0m19:27:46.873670 [info ] [Thread-4 (]: 43 of 43 PASS unique_top_tracks_track_id ....................................... [[32mPASS[0m in 0.66s]
[0m19:27:46.875147 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m19:27:47.005761 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.774 seconds
[0m19:27:47.008182 [debug] [Thread-2 (]: On test.spotify_analytics.unique_top_tracks_rank.8fecde1136: Close
[0m19:27:47.283022 [info ] [Thread-2 (]: 42 of 43 PASS unique_top_tracks_rank ........................................... [[32mPASS[0m in 1.08s]
[0m19:27:47.283719 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m19:27:47.286202 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:27:47.286569 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_rank.8fecde1136' was properly closed.
[0m19:27:47.286902 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_artists_rank.68b5480aed' was properly closed.
[0m19:27:47.287219 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_artists_artist_name.008ffa1533' was properly closed.
[0m19:27:47.288329 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_track_id.865b43a659' was properly closed.
[0m19:27:47.289110 [info ] [MainThread]: 
[0m19:27:47.289731 [info ] [MainThread]: Finished running 43 data tests in 0 hours 0 minutes and 10.51 seconds (10.51s).
[0m19:27:47.296722 [debug] [MainThread]: Command end result
[0m19:27:47.335704 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:27:47.338209 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:27:47.348709 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m19:27:47.349227 [info ] [MainThread]: 
[0m19:27:47.350096 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:27:47.350509 [info ] [MainThread]: 
[0m19:27:47.351181 [info ] [MainThread]: Done. PASS=43 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=43
[0m19:27:47.352905 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 12.4352865, "process_in_blocks": "1432", "process_kernel_time": 0.917713, "process_mem_max_rss": "261812", "process_out_blocks": "4048", "process_user_time": 9.622588}
[0m19:27:47.353402 [debug] [MainThread]: Command `dbt test` succeeded at 19:27:47.353313 after 12.44 seconds
[0m19:27:47.353800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714ef9f9cf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714ef9e66090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714ef9e66710>]}
[0m19:27:47.354273 [debug] [MainThread]: Flushing usage events
[0m19:27:47.442455 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:33:29.116908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7812315c6e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7812315d0ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78123406a150>]}


============================== 19:33:29.126316 | 7c736179-a48c-4cc8-b80e-8cc2c5ec0aed ==============================
[0m19:33:29.126316 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:33:29.127318 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'printer_width': '80', 'no_print': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'log_path': '/opt/airflow/dbt/logs', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt compile', 'target_path': 'None', 'version_check': 'True', 'warn_error': 'None', 'write_json': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'introspect': 'True', 'log_cache_events': 'False', 'fail_fast': 'False'}
[0m19:33:30.197158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c736179-a48c-4cc8-b80e-8cc2c5ec0aed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7812202a1a10>]}
[0m19:33:30.277994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c736179-a48c-4cc8-b80e-8cc2c5ec0aed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78123269d650>]}
[0m19:33:30.294024 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:33:30.524305 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:33:30.700696 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:33:30.701265 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:33:30.708193 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m19:33:30.758899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c736179-a48c-4cc8-b80e-8cc2c5ec0aed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7812213ecd10>]}
[0m19:33:30.910323 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:33:30.912389 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:33:30.948665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c736179-a48c-4cc8-b80e-8cc2c5ec0aed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78121be00110>]}
[0m19:33:30.949330 [info ] [MainThread]: Found 5 models, 43 data tests, 1 source, 604 macros
[0m19:33:30.949732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c736179-a48c-4cc8-b80e-8cc2c5ec0aed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781220364650>]}
[0m19:33:30.953704 [info ] [MainThread]: 
[0m19:33:30.954149 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:33:30.954463 [info ] [MainThread]: 
[0m19:33:30.956105 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:33:30.961902 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m19:33:30.963347 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m19:33:30.996760 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m19:33:30.997696 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m19:33:30.998027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:30.997339 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m19:33:31.010408 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m19:33:31.011593 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:32.015197 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.017 seconds
[0m19:33:32.017359 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m19:33:32.021340 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.010 seconds
[0m19:33:32.023772 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m19:33:32.117906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c736179-a48c-4cc8-b80e-8cc2c5ec0aed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7812202b2c50>]}
[0m19:33:32.128413 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m19:33:32.130809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.silver_plays)
[0m19:33:32.132682 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m19:33:32.143378 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m19:33:32.144571 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m19:33:32.145650 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m19:33:32.148770 [debug] [Thread-3 (]: Began running node model.spotify_analytics.daily_user_stats
[0m19:33:32.149327 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.spotify_analytics.daily_user_stats'
[0m19:33:32.150184 [debug] [Thread-4 (]: Began running node model.spotify_analytics.device_usage
[0m19:33:32.150534 [debug] [Thread-2 (]: Began running node model.spotify_analytics.top_artists
[0m19:33:32.153327 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.top_artists)
[0m19:33:32.151906 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.spotify_analytics.device_usage'
[0m19:33:32.150883 [debug] [Thread-1 (]: Began running node model.spotify_analytics.top_tracks
[0m19:33:32.156397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.silver_plays, now model.spotify_analytics.top_tracks)
[0m19:33:32.151413 [debug] [Thread-3 (]: Began compiling node model.spotify_analytics.daily_user_stats
[0m19:33:32.153967 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.top_artists
[0m19:33:32.154388 [debug] [Thread-4 (]: Began compiling node model.spotify_analytics.device_usage
[0m19:33:32.156778 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.top_tracks
[0m19:33:32.161457 [debug] [Thread-3 (]: Writing injected SQL for node "model.spotify_analytics.daily_user_stats"
[0m19:33:32.171294 [debug] [Thread-4 (]: Writing injected SQL for node "model.spotify_analytics.device_usage"
[0m19:33:32.165589 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.top_artists"
[0m19:33:32.177796 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.top_artists
[0m19:33:32.175802 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.top_tracks"
[0m19:33:32.180755 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.top_tracks
[0m19:33:32.180174 [debug] [Thread-4 (]: Began executing node model.spotify_analytics.device_usage
[0m19:33:32.179044 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.top_artists
[0m19:33:32.182908 [debug] [Thread-2 (]: Began running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m19:33:32.179540 [debug] [Thread-3 (]: Began executing node model.spotify_analytics.daily_user_stats
[0m19:33:32.184082 [debug] [Thread-3 (]: Finished running node model.spotify_analytics.daily_user_stats
[0m19:33:32.181624 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.top_tracks
[0m19:33:32.186430 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m19:33:32.187514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.top_tracks, now test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076)
[0m19:33:32.182295 [debug] [Thread-4 (]: Finished running node model.spotify_analytics.device_usage
[0m19:33:32.188510 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m19:33:32.183347 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.top_artists, now test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39)
[0m19:33:32.189435 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m19:33:32.185336 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m19:33:32.195925 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.daily_user_stats, now test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad)
[0m19:33:32.196379 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m19:33:32.187951 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m19:33:32.188943 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.device_usage, now test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd)
[0m19:33:32.214308 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m19:33:32.235458 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m19:33:32.221923 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m19:33:32.236908 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m19:33:32.238446 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m19:33:32.239327 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m19:33:32.241267 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m19:33:32.244776 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m19:33:32.240603 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m19:33:32.246003 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m19:33:32.239902 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m19:33:32.247382 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m19:33:32.243734 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m19:33:32.248428 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m19:33:32.245239 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m19:33:32.249460 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd, now test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa)
[0m19:33:32.246658 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m19:33:32.250748 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad, now test.spotify_analytics.not_null_silver_plays_played_at.8281565f95)
[0m19:33:32.248842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076, now test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9)
[0m19:33:32.251755 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m19:33:32.248010 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m19:33:32.257636 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39, now test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed)
[0m19:33:32.258045 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m19:33:32.249833 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m19:33:32.251167 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m19:33:32.257046 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m19:33:32.273284 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m19:33:32.262119 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m19:33:32.274624 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m19:33:32.268711 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m19:33:32.276108 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m19:33:32.272543 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m19:33:32.277593 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m19:33:32.273942 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m19:33:32.277093 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m19:33:32.282755 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m19:33:32.278202 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m19:33:32.283763 [debug] [Thread-3 (]: Began running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m19:33:32.284175 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_played_at.8281565f95, now test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf)
[0m19:33:32.283191 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa, now test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4)
[0m19:33:32.285166 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m19:33:32.275508 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m19:33:32.284691 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m19:33:32.290793 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m19:33:32.278786 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m19:33:32.290070 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m19:33:32.306461 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m19:33:32.300025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9, now test.spotify_analytics.not_null_silver_plays_track_name.c6334add30)
[0m19:33:32.312606 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m19:33:32.298792 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed, now test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155)
[0m19:33:32.319710 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m19:33:32.308295 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m19:33:32.327318 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m19:33:32.304671 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m19:33:32.330070 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m19:33:32.327868 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4, now test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9)
[0m19:33:32.339798 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m19:33:32.330717 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m19:33:32.338013 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m19:33:32.349952 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m19:33:32.371809 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m19:33:32.387207 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf, now test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87)
[0m19:33:32.374578 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m19:33:32.395228 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m19:33:32.380357 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m19:33:32.383612 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m19:33:32.398883 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m19:33:32.392428 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m19:33:32.396964 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m19:33:32.413509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_track_name.c6334add30, now test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282)
[0m19:33:32.403104 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m19:33:32.399594 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m19:33:32.427222 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m19:33:32.422156 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m19:33:32.429154 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m19:33:32.422604 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m19:33:32.427677 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155, now test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac)
[0m19:33:32.438112 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m19:33:32.426306 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m19:33:32.429797 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m19:33:32.450536 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m19:33:32.451594 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9, now test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f)
[0m19:33:32.464470 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m19:33:32.453334 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m19:33:32.477418 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87, now test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b)
[0m19:33:32.465973 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m19:33:32.493742 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m19:33:32.482818 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m19:33:32.468081 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m19:33:32.513966 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m19:33:32.502109 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m19:33:32.498736 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m19:33:32.530598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282, now test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003)
[0m19:33:32.536213 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m19:33:32.529564 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m19:33:32.534193 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m19:33:32.518043 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m19:33:32.544704 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m19:33:32.560629 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m19:33:32.561128 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f, now test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2)
[0m19:33:32.561517 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m19:33:32.558424 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m19:33:32.554147 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m19:33:32.578882 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m19:33:32.551596 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m19:33:32.576403 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m19:33:32.581755 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m19:33:32.577125 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac, now test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c)
[0m19:33:32.583046 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m19:33:32.586533 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m19:33:32.590129 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2, now test.spotify_analytics.not_null_device_usage_total_plays.90a295df48)
[0m19:33:32.580678 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m19:33:32.579569 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m19:33:32.584369 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m19:33:32.591239 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m19:33:32.598447 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m19:33:32.625000 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m19:33:32.603560 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b, now test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2)
[0m19:33:32.627871 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m19:33:32.623429 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m19:33:32.636514 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m19:33:32.637264 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m19:33:32.627435 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m19:33:32.640191 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m19:33:32.625490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003, now test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e)
[0m19:33:32.638199 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m19:33:32.642224 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c, now test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14)
[0m19:33:32.640846 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m19:33:32.646405 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m19:33:32.646812 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_plays.90a295df48, now test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca)
[0m19:33:32.647215 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m19:33:32.643060 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m19:33:32.645746 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m19:33:32.660767 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m19:33:32.641783 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m19:33:32.661543 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m19:33:32.676940 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m19:33:32.677506 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2, now test.spotify_analytics.not_null_top_artists_rank.d14513fc96)
[0m19:33:32.678036 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m19:33:32.671254 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m19:33:32.687156 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m19:33:32.675236 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m19:33:32.690363 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m19:33:32.674024 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m19:33:32.699177 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m19:33:32.688614 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m19:33:32.691266 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m19:33:32.706183 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m19:33:32.700505 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m19:33:32.708081 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m19:33:32.708513 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca, now test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13)
[0m19:33:32.702176 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m19:33:32.711191 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14, now test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c)
[0m19:33:32.706725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e, now test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11)
[0m19:33:32.712041 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m19:33:32.702843 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m19:33:32.719284 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m19:33:32.711634 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m19:33:32.708918 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m19:33:32.720179 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m19:33:32.733240 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m19:33:32.738773 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_rank.d14513fc96, now test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461)
[0m19:33:32.739242 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m19:33:32.738239 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m19:33:32.734720 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m19:33:32.747255 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m19:33:32.746208 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m19:33:32.748388 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m19:33:32.732876 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m19:33:32.754921 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m19:33:32.754339 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m19:33:32.752819 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m19:33:32.770320 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m19:33:32.771439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11, now test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532)
[0m19:33:32.750843 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m19:33:32.755547 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m19:33:32.777364 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m19:33:32.757113 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c, now test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31)
[0m19:33:32.772220 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m19:33:32.778137 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13, now test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4)
[0m19:33:32.775156 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m19:33:32.779074 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m19:33:32.786538 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m19:33:32.789011 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m19:33:32.804123 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m19:33:32.806275 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461, now test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac)
[0m19:33:32.806698 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m19:33:32.819113 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m19:33:32.827253 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m19:33:32.821433 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m19:33:32.830558 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m19:33:32.821975 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m19:33:32.833416 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m19:33:32.823665 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m19:33:32.835894 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m19:33:32.836552 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m19:33:32.828359 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m19:33:32.838496 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m19:33:32.831394 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m19:33:32.844180 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m19:33:32.845248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532, now test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203)
[0m19:33:32.834073 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m19:33:32.847574 [debug] [Thread-3 (]: Began running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m19:33:32.838040 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m19:33:32.852171 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31, now test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893)
[0m19:33:32.842631 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4, now test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78)
[0m19:33:32.855224 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m19:33:32.847063 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m19:33:32.852657 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m19:33:32.850126 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac, now test.spotify_analytics.unique_device_usage_device_type.e75362861b)
[0m19:33:32.877117 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m19:33:32.875241 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m19:33:32.886993 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m19:33:32.891780 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m19:33:32.894012 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m19:33:32.898553 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m19:33:32.897017 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m19:33:32.896116 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m19:33:32.902716 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m19:33:32.898047 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m19:33:32.906279 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m19:33:32.899316 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m19:33:32.907534 [debug] [Thread-3 (]: Began running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m19:33:32.907972 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_device_usage_device_type.e75362861b, now test.spotify_analytics.unique_top_tracks_rank.8fecde1136)
[0m19:33:32.908371 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m19:33:32.902077 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m19:33:32.915111 [debug] [Thread-2 (]: Began running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m19:33:32.915572 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893, now test.spotify_analytics.unique_top_tracks_track_id.865b43a659)
[0m19:33:32.903208 [debug] [Thread-1 (]: Began running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m19:33:32.916465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203, now test.spotify_analytics.unique_top_artists_artist_name.008ffa1533)
[0m19:33:32.917332 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m19:33:32.906730 [debug] [Thread-4 (]: Began running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m19:33:32.924313 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78, now test.spotify_analytics.unique_top_artists_rank.68b5480aed)
[0m19:33:32.916057 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m19:33:32.924779 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m19:33:32.931246 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m19:33:32.950306 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m19:33:32.951072 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m19:33:32.934979 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m19:33:32.953591 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m19:33:32.953037 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m19:33:32.958986 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m19:33:32.964645 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m19:33:32.961007 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m19:33:32.966003 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m19:33:32.962597 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m19:33:32.965341 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m19:33:32.967211 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:33:32.969050 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_track_id.865b43a659' was properly closed.
[0m19:33:32.969395 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_artists_artist_name.008ffa1533' was properly closed.
[0m19:33:32.969711 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_rank.8fecde1136' was properly closed.
[0m19:33:32.972100 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_artists_rank.68b5480aed' was properly closed.
[0m19:33:32.986355 [debug] [MainThread]: Command end result
[0m19:33:33.053474 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:33:33.058744 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:33:33.078081 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m19:33:33.082107 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 4.03233, "process_in_blocks": "920", "process_kernel_time": 0.569042, "process_mem_max_rss": "252112", "process_out_blocks": "3648", "process_user_time": 4.299502}
[0m19:33:33.082677 [debug] [MainThread]: Command `dbt compile` succeeded at 19:33:33.082569 after 4.03 seconds
[0m19:33:33.083172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781231557d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781231557fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7812318eea50>]}
[0m19:33:33.083793 [debug] [MainThread]: Flushing usage events
[0m19:33:33.202499 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:33:40.946069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741e5cd39290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741e5cce1110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741e5d14d390>]}


============================== 19:33:40.953480 | a256d076-6ade-4c5d-b02c-c82eeea253c7 ==============================
[0m19:33:40.953480 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:33:40.954512 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'version_check': 'True', 'target_path': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'use_colors': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'cache_selected_only': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'profiles_dir': '/opt/airflow/dbt', 'empty': 'False', 'no_print': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --select silver.*', 'log_format': 'default', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False'}
[0m19:33:42.032178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a256d076-6ade-4c5d-b02c-c82eeea253c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741e4c97d750>]}
[0m19:33:42.126918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a256d076-6ade-4c5d-b02c-c82eeea253c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741e5de09910>]}
[0m19:33:42.128266 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:33:42.394254 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:33:42.635866 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:33:42.636379 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:33:42.643299 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m19:33:42.698911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a256d076-6ade-4c5d-b02c-c82eeea253c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741e4766cd50>]}
[0m19:33:42.814731 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:33:42.816818 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:33:42.843325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a256d076-6ade-4c5d-b02c-c82eeea253c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741e478d0c50>]}
[0m19:33:42.843945 [info ] [MainThread]: Found 5 models, 43 data tests, 1 source, 604 macros
[0m19:33:42.845765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a256d076-6ade-4c5d-b02c-c82eeea253c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741e47ace4d0>]}
[0m19:33:42.848033 [info ] [MainThread]: 
[0m19:33:42.848843 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:33:42.850648 [info ] [MainThread]: 
[0m19:33:42.851652 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:33:42.852744 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m19:33:42.872217 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m19:33:42.872699 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m19:33:42.873042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:43.770905 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.898 seconds
[0m19:33:43.773506 [debug] [ThreadPool]: On list_spotify_data: Close
[0m19:33:43.826073 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_silver)
[0m19:33:43.826825 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m19:33:43.843476 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m19:33:43.846525 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m19:33:43.846889 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:33:43.846113 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m19:33:43.849194 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m19:33:43.849555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:44.287418 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.440 seconds
[0m19:33:44.289368 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m19:33:44.480297 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.631 seconds
[0m19:33:44.482876 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m19:33:44.551695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a256d076-6ade-4c5d-b02c-c82eeea253c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741e47925150>]}
[0m19:33:44.557167 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m19:33:44.557724 [info ] [Thread-1 (]: 1 of 1 START sql table model silver.silver_plays ............................... [RUN]
[0m19:33:44.558610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.silver_plays)
[0m19:33:44.559070 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m19:33:44.568912 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m19:33:44.569553 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m19:33:44.607047 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.silver_plays"
[0m19:33:44.610343 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.silver_plays"
[0m19:33:44.611048 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.silver_plays"} */
create or replace transient table spotify_data.silver.silver_plays
         as
        (

-- ============================================================================
-- SILVER LAYER: CLEANED PLAYS DATA
-- ============================================================================
-- Purpose: Transform bronze plays data into clean, analytics-ready format
-- 
-- Transformations:
--   1. Deduplicate records (DISTINCT on event_id)
--   2. Cast all data types from VARIANT to proper types
--   3. Filter invalid records (defensive WHERE clauses)
--   4. Add processing metadata (processed_at timestamp)
--
-- Source: bronze.plays (external table reading from S3 Parquet files)
-- Target: SILVER.silver_plays (materialized table)
-- ============================================================================

WITH source_data AS (
    SELECT 
        VALUE:event_id::VARCHAR AS event_id,
        VALUE:user_id::VARCHAR AS user_id,
        VALUE:event_type::VARCHAR AS event_type,
        VALUE:track_id::VARCHAR AS track_id,
        VALUE:track_name::VARCHAR AS track_name,
        VALUE:artist_name::VARCHAR AS artist_name,
        VALUE:album_name::VARCHAR AS album_name,
        VALUE:duration_ms::NUMBER AS duration_ms,
        VALUE:played_at::VARCHAR AS played_at,
        VALUE:device_type::VARCHAR AS device_type
    FROM spotify_data.bronze.plays
),

deduplicated AS (
    SELECT DISTINCT
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM source_data
    WHERE 
        -- Data quality filters
        user_id IS NOT NULL
        AND duration_ms > 0
        AND duration_ms < 600000  -- Less than 10 minutes (catches data errors)
        AND event_id IS NOT NULL
)

SELECT 
    -- Identifiers
    event_id::VARCHAR AS event_id,
    user_id::VARCHAR AS user_id,
    event_type::VARCHAR AS event_type,
    
    -- Track information
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    duration_ms::NUMBER AS duration_ms,
    
    -- Timestamps
    TRY_CAST(played_at AS TIMESTAMP) AS played_at,
    
    -- Device context
    device_type::VARCHAR AS device_type,
    
    -- Metadata
    CURRENT_TIMESTAMP() AS processed_at
    
FROM deduplicated
        );
[0m19:33:44.612067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:33:46.593114 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.981 seconds
[0m19:33:46.620441 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: Close
[0m19:33:46.682032 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a256d076-6ade-4c5d-b02c-c82eeea253c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741e475cdb10>]}
[0m19:33:46.683002 [info ] [Thread-1 (]: 1 of 1 OK created sql table model silver.silver_plays .......................... [[32mSUCCESS 1[0m in 2.12s]
[0m19:33:46.691499 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m19:33:46.694354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:33:46.694788 [debug] [MainThread]: Connection 'model.spotify_analytics.silver_plays' was properly closed.
[0m19:33:46.695759 [debug] [MainThread]: Connection 'list_spotify_data_gold' was properly closed.
[0m19:33:46.696906 [info ] [MainThread]: 
[0m19:33:46.698317 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.84 seconds (3.84s).
[0m19:33:46.699516 [debug] [MainThread]: Command end result
[0m19:33:46.737415 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:33:46.739675 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:33:46.747120 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m19:33:46.747504 [info ] [MainThread]: 
[0m19:33:46.749295 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:33:46.749663 [info ] [MainThread]: 
[0m19:33:46.751117 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:33:46.753775 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.8749614, "process_in_blocks": "312", "process_kernel_time": 0.548568, "process_mem_max_rss": "248408", "process_out_blocks": "3088", "process_user_time": 4.142866}
[0m19:33:46.754303 [debug] [MainThread]: Command `dbt run` succeeded at 19:33:46.754212 after 5.88 seconds
[0m19:33:46.754715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741e5ccc7c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741e5ccc7b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741e5d14d690>]}
[0m19:33:46.755152 [debug] [MainThread]: Flushing usage events
[0m19:33:46.838441 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:33:51.078723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7e6831fe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7e682c5a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7e682c5c90>]}


============================== 19:33:51.091465 | 310e18d6-ff20-44dd-a690-5ed6211205cb ==============================
[0m19:33:51.091465 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:33:51.093153 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'profiles_dir': '/opt/airflow/dbt', 'invocation_command': 'dbt run --select gold.*', 'static_parser': 'True', 'printer_width': '80', 'log_format': 'default', 'debug': 'False', 'version_check': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'warn_error': 'None', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_colors': 'True', 'partial_parse': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'cache_selected_only': 'False'}
[0m19:33:52.233508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '310e18d6-ff20-44dd-a690-5ed6211205cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7e59426090>]}
[0m19:33:52.312444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '310e18d6-ff20-44dd-a690-5ed6211205cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7e693ed8d0>]}
[0m19:33:52.313394 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:33:52.540517 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:33:52.743602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:33:52.744476 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:33:52.750708 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m19:33:52.814557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '310e18d6-ff20-44dd-a690-5ed6211205cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7e52e68f90>]}
[0m19:33:52.934084 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:33:52.936480 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:33:52.958893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '310e18d6-ff20-44dd-a690-5ed6211205cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7e52b17910>]}
[0m19:33:52.959511 [info ] [MainThread]: Found 5 models, 43 data tests, 1 source, 604 macros
[0m19:33:52.960490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '310e18d6-ff20-44dd-a690-5ed6211205cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7e689f6550>]}
[0m19:33:52.963232 [info ] [MainThread]: 
[0m19:33:52.963917 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:33:52.964464 [info ] [MainThread]: 
[0m19:33:52.966079 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:33:52.971884 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m19:33:52.987942 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m19:33:52.988323 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m19:33:52.988633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:53.622597 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.634 seconds
[0m19:33:53.624965 [debug] [ThreadPool]: On list_spotify_data: Close
[0m19:33:53.676971 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_gold)
[0m19:33:53.683300 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m19:33:53.688254 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m19:33:53.691287 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m19:33:53.691612 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:33:53.690801 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m19:33:53.693012 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m19:33:53.693830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:54.192906 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.501 seconds
[0m19:33:54.194826 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m19:33:54.485281 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.791 seconds
[0m19:33:54.487545 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m19:33:54.559397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '310e18d6-ff20-44dd-a690-5ed6211205cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7e69f0d210>]}
[0m19:33:54.564543 [debug] [Thread-1 (]: Began running node model.spotify_analytics.daily_user_stats
[0m19:33:54.565016 [debug] [Thread-2 (]: Began running node model.spotify_analytics.device_usage
[0m19:33:54.567233 [info ] [Thread-2 (]: 2 of 4 START sql table model gold.device_usage ................................. [RUN]
[0m19:33:54.565396 [debug] [Thread-3 (]: Began running node model.spotify_analytics.top_artists
[0m19:33:54.566303 [info ] [Thread-1 (]: 1 of 4 START sql table model gold.daily_user_stats ............................. [RUN]
[0m19:33:54.569718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.daily_user_stats)
[0m19:33:54.570110 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.daily_user_stats
[0m19:33:54.565757 [debug] [Thread-4 (]: Began running node model.spotify_analytics.top_tracks
[0m19:33:54.576426 [info ] [Thread-4 (]: 4 of 4 START sql table model gold.top_tracks ................................... [RUN]
[0m19:33:54.576966 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.spotify_analytics.top_tracks'
[0m19:33:54.577332 [debug] [Thread-4 (]: Began compiling node model.spotify_analytics.top_tracks
[0m19:33:54.568422 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.device_usage)
[0m19:33:54.582870 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.device_usage
[0m19:33:54.569362 [info ] [Thread-3 (]: 3 of 4 START sql table model gold.top_artists .................................. [RUN]
[0m19:33:54.587879 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.spotify_analytics.top_artists'
[0m19:33:54.588280 [debug] [Thread-3 (]: Began compiling node model.spotify_analytics.top_artists
[0m19:33:54.582416 [debug] [Thread-4 (]: Writing injected SQL for node "model.spotify_analytics.top_tracks"
[0m19:33:54.592696 [debug] [Thread-4 (]: Began executing node model.spotify_analytics.top_tracks
[0m19:33:54.586875 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.device_usage"
[0m19:33:54.591634 [debug] [Thread-3 (]: Writing injected SQL for node "model.spotify_analytics.top_artists"
[0m19:33:54.622577 [debug] [Thread-3 (]: Began executing node model.spotify_analytics.top_artists
[0m19:33:54.614006 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.daily_user_stats"
[0m19:33:54.628907 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.daily_user_stats
[0m19:33:54.632670 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.device_usage
[0m19:33:54.665104 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.daily_user_stats"
[0m19:33:54.678585 [debug] [Thread-3 (]: Writing runtime sql for node "model.spotify_analytics.top_artists"
[0m19:33:54.677511 [debug] [Thread-4 (]: Writing runtime sql for node "model.spotify_analytics.top_tracks"
[0m19:33:54.683713 [debug] [Thread-2 (]: Writing runtime sql for node "model.spotify_analytics.device_usage"
[0m19:33:54.685504 [debug] [Thread-4 (]: Using snowflake connection "model.spotify_analytics.top_tracks"
[0m19:33:54.689099 [debug] [Thread-4 (]: On model.spotify_analytics.top_tracks: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.top_tracks"} */
create or replace transient table spotify_data.gold.top_tracks
         as
        (

-- ============================================================================
-- GOLD LAYER: TOP TRACKS BY PLAY COUNT
-- ============================================================================
-- Purpose: Aggregate and rank tracks by popularity
-- 
-- Grain: One row per track (all-time aggregation)
-- Primary Key: track_id
--
-- Metrics:
--   - Total plays per track
--   - Total listening time
--   - First and last play timestamps
--   - Popularity rank
--
-- Source: SILVER.silver_plays
-- Target: GOLD.top_tracks
-- ============================================================================

WITH track_aggregates AS (
    SELECT 
        -- Track identifiers and attributes
        track_id,
        track_name,
        artist_name,
        album_name,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        MIN(played_at) AS first_played_at,
        MAX(played_at) AS last_played_at
        
    FROM spotify_data.silver.silver_plays
    GROUP BY 
        track_id,
        track_name,
        artist_name,
        album_name
),

ranked_tracks AS (
    SELECT 
        *,
        -- Add ranking based on play count (1 = most played)
        ROW_NUMBER() OVER (ORDER BY total_plays DESC, total_listening_time_ms DESC) AS rank
    FROM track_aggregates
)

SELECT 
    -- Identifiers
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    
    -- Timestamps
    first_played_at::TIMESTAMP AS first_played_at,
    last_played_at::TIMESTAMP AS last_played_at,
    
    -- Ranking
    rank::NUMBER AS rank
    
FROM ranked_tracks
ORDER BY rank
        );
[0m19:33:54.689534 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:33:54.688604 [debug] [Thread-3 (]: Using snowflake connection "model.spotify_analytics.top_artists"
[0m19:33:54.683081 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.daily_user_stats"
[0m19:33:54.690593 [debug] [Thread-1 (]: On model.spotify_analytics.daily_user_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.daily_user_stats"} */
create or replace transient table spotify_data.gold.daily_user_stats
         as
        (

-- ============================================================================
-- GOLD LAYER: DAILY USER LISTENING STATISTICS
-- ============================================================================
-- Purpose: Aggregate user listening behavior by day
-- 
-- Grain: One row per user per day
-- Primary Key: (date, user_id)
--
-- Metrics:
--   - Total plays per day
--   - Total listening time
--   - Unique tracks/artists played
--   - Average track duration
--
-- Source: SILVER.silver_plays
-- Target: GOLD.daily_user_stats
-- ============================================================================

WITH daily_aggregates AS (
    SELECT 
        -- Date dimension (truncate timestamp to date)
        DATE(played_at) AS date,
        
        -- User identifier
        user_id,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        COUNT(DISTINCT track_id) AS unique_tracks,
        COUNT(DISTINCT artist_name) AS unique_artists,
        AVG(duration_ms) AS avg_track_duration_ms
        
    FROM spotify_data.silver.silver_plays
    GROUP BY 
        DATE(played_at),
        user_id
)

SELECT 
    -- Dimensions
    date,
    user_id,
    
    -- Metrics (cast for clarity)
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    unique_tracks::NUMBER AS unique_tracks,
    unique_artists::NUMBER AS unique_artists,
    ROUND(avg_track_duration_ms, 2)::NUMBER AS avg_track_duration_ms
    
FROM daily_aggregates
ORDER BY date DESC, user_id
        );
[0m19:33:54.691272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:33:54.690095 [debug] [Thread-3 (]: On model.spotify_analytics.top_artists: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.top_artists"} */
create or replace transient table spotify_data.gold.top_artists
         as
        (

-- ============================================================================
-- GOLD LAYER: TOP ARTISTS BY PLAY COUNT
-- ============================================================================
-- Purpose: Aggregate and rank artists by popularity
-- 
-- Grain: One row per artist (all-time aggregation)
-- Primary Key: artist_name
--
-- Metrics:
--   - Total plays per artist
--   - Total listening time
--   - Number of unique tracks played
--   - First and last play timestamps
--   - Popularity rank
--
-- Source: SILVER.silver_plays
-- Target: GOLD.top_artists
-- ============================================================================

WITH artist_aggregates AS (
    SELECT 
        -- Artist identifier
        artist_name,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        COUNT(DISTINCT track_id) AS unique_tracks,
        MIN(played_at) AS first_played_at,
        MAX(played_at) AS last_played_at
        
    FROM spotify_data.silver.silver_plays
    GROUP BY artist_name
),

ranked_artists AS (
    SELECT 
        *,
        -- Add ranking based on play count (1 = most played artist)
        ROW_NUMBER() OVER (ORDER BY total_plays DESC, total_listening_time_ms DESC) AS rank
    FROM artist_aggregates
)

SELECT 
    -- Identifier
    artist_name::VARCHAR AS artist_name,
    
    -- Metrics
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    unique_tracks::NUMBER AS unique_tracks,
    
    -- Timestamps
    first_played_at::TIMESTAMP AS first_played_at,
    last_played_at::TIMESTAMP AS last_played_at,
    
    -- Ranking
    rank::NUMBER AS rank
    
FROM ranked_artists
ORDER BY rank
        );
[0m19:33:54.693103 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:33:54.687087 [debug] [Thread-2 (]: Using snowflake connection "model.spotify_analytics.device_usage"
[0m19:33:54.694155 [debug] [Thread-2 (]: On model.spotify_analytics.device_usage: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.device_usage"} */
create or replace transient table spotify_data.gold.device_usage
         as
        (

-- ============================================================================
-- GOLD LAYER: DEVICE USAGE STATISTICS
-- ============================================================================
-- Purpose: Aggregate listening behavior by device type
-- 
-- Grain: One row per device type (all-time aggregation)
-- Primary Key: device_type
--
-- Metrics:
--   - Total plays per device
--   - Total listening time
--   - Percentage of total plays
--   - Average track duration
--
-- Source: SILVER.silver_plays
-- Target: GOLD.device_usage
-- ============================================================================

WITH device_aggregates AS (
    SELECT 
        -- Device identifier
        device_type,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        AVG(duration_ms) AS avg_track_duration_ms
        
    FROM spotify_data.silver.silver_plays
    GROUP BY device_type
),

total_plays_calc AS (
    -- Calculate overall total for percentage calculation
    SELECT SUM(total_plays) AS overall_total_plays
    FROM device_aggregates
)

SELECT 
    -- Identifier
    device_type::VARCHAR AS device_type,
    
    -- Metrics
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    
    -- Percentage of total plays
    ROUND((total_plays::FLOAT / overall_total_plays::FLOAT) * 100, 2)::FLOAT AS play_percentage,
    
    -- Average duration
    ROUND(avg_track_duration_ms, 2)::NUMBER AS avg_track_duration_ms
    
FROM device_aggregates
CROSS JOIN total_plays_calc
ORDER BY total_plays DESC
        );
[0m19:33:54.697458 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:33:56.071509 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.374 seconds
[0m19:33:56.097056 [debug] [Thread-2 (]: On model.spotify_analytics.device_usage: Close
[0m19:33:56.136303 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.444 seconds
[0m19:33:56.138529 [debug] [Thread-1 (]: On model.spotify_analytics.daily_user_stats: Close
[0m19:33:56.160241 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '310e18d6-ff20-44dd-a690-5ed6211205cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7e51e8ec50>]}
[0m19:33:56.161880 [info ] [Thread-2 (]: 2 of 4 OK created sql table model gold.device_usage ............................ [[32mSUCCESS 1[0m in 1.59s]
[0m19:33:56.162966 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.device_usage
[0m19:33:56.187812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '310e18d6-ff20-44dd-a690-5ed6211205cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7e52f8e810>]}
[0m19:33:56.188545 [info ] [Thread-1 (]: 1 of 4 OK created sql table model gold.daily_user_stats ........................ [[32mSUCCESS 1[0m in 1.62s]
[0m19:33:56.189877 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.daily_user_stats
[0m19:33:56.420468 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.727 seconds
[0m19:33:56.422433 [debug] [Thread-3 (]: On model.spotify_analytics.top_artists: Close
[0m19:33:56.449180 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.760 seconds
[0m19:33:56.451608 [debug] [Thread-4 (]: On model.spotify_analytics.top_tracks: Close
[0m19:33:56.495594 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '310e18d6-ff20-44dd-a690-5ed6211205cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7e6b358310>]}
[0m19:33:56.496669 [info ] [Thread-3 (]: 3 of 4 OK created sql table model gold.top_artists ............................. [[32mSUCCESS 1[0m in 1.91s]
[0m19:33:56.498476 [debug] [Thread-3 (]: Finished running node model.spotify_analytics.top_artists
[0m19:33:56.499954 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '310e18d6-ff20-44dd-a690-5ed6211205cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7e43751550>]}
[0m19:33:56.500655 [info ] [Thread-4 (]: 4 of 4 OK created sql table model gold.top_tracks .............................. [[32mSUCCESS 1[0m in 1.92s]
[0m19:33:56.501453 [debug] [Thread-4 (]: Finished running node model.spotify_analytics.top_tracks
[0m19:33:56.503888 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:33:56.504654 [debug] [MainThread]: Connection 'model.spotify_analytics.device_usage' was properly closed.
[0m19:33:56.505083 [debug] [MainThread]: Connection 'model.spotify_analytics.daily_user_stats' was properly closed.
[0m19:33:56.505402 [debug] [MainThread]: Connection 'model.spotify_analytics.top_tracks' was properly closed.
[0m19:33:56.505683 [debug] [MainThread]: Connection 'model.spotify_analytics.top_artists' was properly closed.
[0m19:33:56.506183 [info ] [MainThread]: 
[0m19:33:56.506532 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 3.54 seconds (3.54s).
[0m19:33:56.508806 [debug] [MainThread]: Command end result
[0m19:33:56.552775 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:33:56.554961 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:33:56.562313 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m19:33:56.562714 [info ] [MainThread]: 
[0m19:33:56.563989 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:33:56.564598 [info ] [MainThread]: 
[0m19:33:56.565191 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m19:33:56.566297 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.5500546, "process_in_blocks": "0", "process_kernel_time": 0.524699, "process_mem_max_rss": "252888", "process_out_blocks": "3176", "process_user_time": 4.485227}
[0m19:33:56.566790 [debug] [MainThread]: Command `dbt run` succeeded at 19:33:56.566702 after 5.55 seconds
[0m19:33:56.567693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7e6863a8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7e68325050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7e68327450>]}
[0m19:33:56.568124 [debug] [MainThread]: Flushing usage events
[0m19:33:56.667613 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:34:01.231620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7891133d1810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7891133d1450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7891133d15d0>]}


============================== 19:34:01.238829 | 48c667dc-d646-4773-ad00-841bdf738ff8 ==============================
[0m19:34:01.238829 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:34:01.242604 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/opt/airflow/dbt', 'cache_selected_only': 'False', 'quiet': 'False', 'introspect': 'True', 'printer_width': '80', 'log_path': '/opt/airflow/dbt/logs', 'no_print': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'write_json': 'True', 'fail_fast': 'False', 'empty': 'None', 'log_format': 'default', 'version_check': 'True', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test', 'log_cache_events': 'False'}
[0m19:34:02.341126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48c667dc-d646-4773-ad00-841bdf738ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7890fe1c0250>]}
[0m19:34:02.417613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48c667dc-d646-4773-ad00-841bdf738ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78910d8d83d0>]}
[0m19:34:02.418597 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:34:02.651547 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:34:02.882212 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:34:02.883179 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:34:02.890250 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m19:34:02.947275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48c667dc-d646-4773-ad00-841bdf738ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7890fe03cad0>]}
[0m19:34:03.065651 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:34:03.067669 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:34:03.122965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48c667dc-d646-4773-ad00-841bdf738ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7890fda7fd10>]}
[0m19:34:03.123580 [info ] [MainThread]: Found 5 models, 43 data tests, 1 source, 604 macros
[0m19:34:03.124473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48c667dc-d646-4773-ad00-841bdf738ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7890fdf95990>]}
[0m19:34:03.129479 [info ] [MainThread]: 
[0m19:34:03.130349 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:34:03.130917 [info ] [MainThread]: 
[0m19:34:03.131806 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:34:03.137435 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m19:34:03.138045 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m19:34:03.178125 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m19:34:03.179996 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m19:34:03.180336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:34:03.179369 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m19:34:03.181352 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m19:34:03.181702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:34:04.018519 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.838 seconds
[0m19:34:04.024108 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m19:34:04.035028 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.853 seconds
[0m19:34:04.041576 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m19:34:04.152015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48c667dc-d646-4773-ad00-841bdf738ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7890fda4bfd0>]}
[0m19:34:04.158392 [debug] [Thread-1 (]: Began running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m19:34:04.159282 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m19:34:04.159957 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m19:34:04.158900 [info ] [Thread-1 (]: 1 of 43 START test dbt_utils_accepted_range_silver_plays_duration_ms__600000__1  [RUN]
[0m19:34:04.162442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39)
[0m19:34:04.162808 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m19:34:04.161493 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m19:34:04.160313 [info ] [Thread-3 (]: 3 of 43 START test not_null_daily_user_stats_date .............................. [RUN]
[0m19:34:04.169702 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9'
[0m19:34:04.170102 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m19:34:04.159670 [info ] [Thread-2 (]: 2 of 43 START test not_null_daily_user_stats_avg_track_duration_ms ............. [RUN]
[0m19:34:04.183976 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155)
[0m19:34:04.190827 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m19:34:04.190353 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m19:34:04.203714 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m19:34:04.169139 [info ] [Thread-4 (]: 4 of 43 START test not_null_daily_user_stats_total_listening_time_ms ........... [RUN]
[0m19:34:04.195837 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m19:34:04.202664 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m19:34:04.223005 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m19:34:04.210692 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87'
[0m19:34:04.228709 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m19:34:04.211652 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m19:34:04.233929 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m19:34:04.248797 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m19:34:04.256695 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m19:34:04.267123 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m19:34:04.266354 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m19:34:04.277871 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m19:34:04.275584 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m19:34:04.276956 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m19:34:04.284237 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_track_duration_ms
from spotify_data.gold.daily_user_stats
where avg_track_duration_ms is null



  
  
      
    ) dbt_internal_test
[0m19:34:04.278267 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.daily_user_stats
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m19:34:04.285560 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:34:04.283616 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m19:34:04.284648 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:34:04.278714 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from spotify_data.gold.daily_user_stats
where date is null



  
  
      
    ) dbt_internal_test
[0m19:34:04.295695 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:34:04.292724 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m19:34:04.298529 [debug] [Thread-1 (]: On test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from spotify_data.silver.silver_plays
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not duration_ms >= 1
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not duration_ms <= 600000
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m19:34:04.306388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:34:04.980233 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.674 seconds
[0m19:34:04.994441 [debug] [Thread-1 (]: On test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39: Close
[0m19:34:05.052035 [info ] [Thread-1 (]: 1 of 43 PASS dbt_utils_accepted_range_silver_plays_duration_ms__600000__1 ...... [[32mPASS[0m in 0.89s]
[0m19:34:05.054888 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m19:34:05.055379 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m19:34:05.056753 [info ] [Thread-1 (]: 5 of 43 START test not_null_daily_user_stats_total_plays ....................... [RUN]
[0m19:34:05.057610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39, now test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282)
[0m19:34:05.058039 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m19:34:05.063321 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m19:34:05.063944 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m19:34:05.067912 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m19:34:05.068777 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m19:34:05.069211 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.daily_user_stats
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m19:34:05.069604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:34:05.249139 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.953 seconds
[0m19:34:05.250526 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.965 seconds
[0m19:34:05.252101 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.967 seconds
[0m19:34:05.254771 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9: Close
[0m19:34:05.257440 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155: Close
[0m19:34:05.260482 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87: Close
[0m19:34:05.310641 [info ] [Thread-3 (]: 3 of 43 PASS not_null_daily_user_stats_date .................................... [[32mPASS[0m in 1.14s]
[0m19:34:05.313310 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m19:34:05.315884 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m19:34:05.315425 [info ] [Thread-4 (]: 4 of 43 PASS not_null_daily_user_stats_total_listening_time_ms ................. [[32mPASS[0m in 1.10s]
[0m19:34:05.318356 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m19:34:05.316290 [info ] [Thread-3 (]: 6 of 43 START test not_null_daily_user_stats_unique_artists .................... [RUN]
[0m19:34:05.318782 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m19:34:05.323063 [info ] [Thread-4 (]: 7 of 43 START test not_null_daily_user_stats_unique_tracks ..................... [RUN]
[0m19:34:05.323554 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87, now test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac)
[0m19:34:05.323971 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m19:34:05.322502 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9, now test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f)
[0m19:34:05.331927 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m19:34:05.340478 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m19:34:05.345083 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m19:34:05.366301 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m19:34:05.355749 [info ] [Thread-2 (]: 2 of 43 PASS not_null_daily_user_stats_avg_track_duration_ms ................... [[32mPASS[0m in 1.17s]
[0m19:34:05.375938 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m19:34:05.363482 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m19:34:05.379204 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m19:34:05.374553 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m19:34:05.377553 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m19:34:05.379647 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unique_tracks
from spotify_data.gold.daily_user_stats
where unique_tracks is null



  
  
      
    ) dbt_internal_test
[0m19:34:05.394765 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:34:05.393592 [info ] [Thread-2 (]: 8 of 43 START test not_null_daily_user_stats_user_id ........................... [RUN]
[0m19:34:05.397095 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155, now test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b)
[0m19:34:05.397508 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m19:34:05.408183 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m19:34:05.406331 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m19:34:05.412575 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m19:34:05.425485 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unique_artists
from spotify_data.gold.daily_user_stats
where unique_artists is null



  
  
      
    ) dbt_internal_test
[0m19:34:05.424595 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m19:34:05.426989 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:34:05.444352 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m19:34:05.457258 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m19:34:05.467086 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from spotify_data.gold.daily_user_stats
where user_id is null



  
  
      
    ) dbt_internal_test
[0m19:34:05.470871 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:34:05.535681 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.466 seconds
[0m19:34:05.547258 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282: Close
[0m19:34:05.632058 [info ] [Thread-1 (]: 5 of 43 PASS not_null_daily_user_stats_total_plays ............................. [[32mPASS[0m in 0.57s]
[0m19:34:05.632795 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m19:34:05.635499 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m19:34:05.646212 [info ] [Thread-1 (]: 9 of 43 START test not_null_device_usage_avg_track_duration_ms ................. [RUN]
[0m19:34:05.652939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282, now test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003)
[0m19:34:05.653626 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m19:34:05.680997 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m19:34:05.686239 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m19:34:05.691503 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m19:34:05.696521 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m19:34:05.699012 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_track_duration_ms
from spotify_data.gold.device_usage
where avg_track_duration_ms is null



  
  
      
    ) dbt_internal_test
[0m19:34:05.700132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:34:06.096696 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.702 seconds
[0m19:34:06.099014 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac: Close
[0m19:34:06.185325 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.759 seconds
[0m19:34:06.192169 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f: Close
[0m19:34:06.205314 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.738 seconds
[0m19:34:06.208979 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b: Close
[0m19:34:06.223604 [info ] [Thread-4 (]: 7 of 43 PASS not_null_daily_user_stats_unique_tracks ........................... [[32mPASS[0m in 0.90s]
[0m19:34:06.225599 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m19:34:06.228160 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m19:34:06.230007 [info ] [Thread-4 (]: 10 of 43 START test not_null_device_usage_device_type .......................... [RUN]
[0m19:34:06.230791 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac, now test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c)
[0m19:34:06.231478 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m19:34:06.237663 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m19:34:06.238289 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m19:34:06.244657 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m19:34:06.245971 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m19:34:06.246419 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select device_type
from spotify_data.gold.device_usage
where device_type is null



  
  
      
    ) dbt_internal_test
[0m19:34:06.247260 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:34:06.307010 [info ] [Thread-3 (]: 6 of 43 PASS not_null_daily_user_stats_unique_artists .......................... [[32mPASS[0m in 0.98s]
[0m19:34:06.307798 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m19:34:06.318234 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m19:34:06.316215 [info ] [Thread-2 (]: 8 of 43 PASS not_null_daily_user_stats_user_id ................................. [[32mPASS[0m in 0.92s]
[0m19:34:06.318636 [info ] [Thread-3 (]: 11 of 43 START test not_null_device_usage_play_percentage ...................... [RUN]
[0m19:34:06.321154 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f, now test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2)
[0m19:34:06.321533 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m19:34:06.320206 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m19:34:06.329077 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m19:34:06.333253 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m19:34:06.329485 [info ] [Thread-2 (]: 12 of 43 START test not_null_device_usage_total_listening_time_ms .............. [RUN]
[0m19:34:06.335258 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b, now test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2)
[0m19:34:06.335653 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m19:34:06.342952 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m19:34:06.344233 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m19:34:06.347552 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m19:34:06.346675 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m19:34:06.354124 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m19:34:06.352059 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m19:34:06.353256 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.653 seconds
[0m19:34:06.355299 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select play_percentage
from spotify_data.gold.device_usage
where play_percentage is null



  
  
      
    ) dbt_internal_test
[0m19:34:06.356759 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m19:34:06.364164 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.device_usage
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m19:34:06.364548 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:34:06.363154 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003: Close
[0m19:34:06.363648 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:34:06.538756 [info ] [Thread-1 (]: 9 of 43 PASS not_null_device_usage_avg_track_duration_ms ....................... [[32mPASS[0m in 0.88s]
[0m19:34:06.541837 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m19:34:06.546108 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m19:34:06.547539 [info ] [Thread-1 (]: 13 of 43 START test not_null_device_usage_total_plays .......................... [RUN]
[0m19:34:06.548111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003, now test.spotify_analytics.not_null_device_usage_total_plays.90a295df48)
[0m19:34:06.550804 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m19:34:06.559561 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m19:34:06.562727 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m19:34:06.565966 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m19:34:06.571198 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m19:34:06.573632 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_device_usage_total_plays.90a295df48: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.device_usage
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m19:34:06.576032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:34:06.779815 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.532 seconds
[0m19:34:06.784111 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c: Close
[0m19:34:06.836084 [info ] [Thread-4 (]: 10 of 43 PASS not_null_device_usage_device_type ................................ [[32mPASS[0m in 0.60s]
[0m19:34:06.837285 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m19:34:06.837741 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m19:34:06.838313 [info ] [Thread-4 (]: 14 of 43 START test not_null_silver_plays_artist_name .......................... [RUN]
[0m19:34:06.844519 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c, now test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad)
[0m19:34:06.845029 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m19:34:06.850531 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m19:34:06.852296 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m19:34:06.857494 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m19:34:06.859337 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m19:34:06.859938 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select artist_name
from spotify_data.silver.silver_plays
where artist_name is null



  
  
      
    ) dbt_internal_test
[0m19:34:06.860340 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:34:06.886223 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.522 seconds
[0m19:34:06.892746 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2: Close
[0m19:34:06.904530 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.541 seconds
[0m19:34:06.914061 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2: Close
[0m19:34:06.987963 [info ] [Thread-3 (]: 11 of 43 PASS not_null_device_usage_play_percentage ............................ [[32mPASS[0m in 0.67s]
[0m19:34:06.989304 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m19:34:06.989798 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m19:34:06.991824 [info ] [Thread-3 (]: 15 of 43 START test not_null_silver_plays_duration_ms .......................... [RUN]
[0m19:34:06.993496 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2, now test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076)
[0m19:34:06.993947 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m19:34:07.017283 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m19:34:07.022083 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m19:34:07.018392 [info ] [Thread-2 (]: 12 of 43 PASS not_null_device_usage_total_listening_time_ms .................... [[32mPASS[0m in 0.68s]
[0m19:34:07.026642 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m19:34:07.020882 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.445 seconds
[0m19:34:07.025993 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m19:34:07.027174 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m19:34:07.031727 [info ] [Thread-2 (]: 16 of 43 START test not_null_silver_plays_event_id ............................. [RUN]
[0m19:34:07.032271 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2, now test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd)
[0m19:34:07.031241 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m19:34:07.033402 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select duration_ms
from spotify_data.silver.silver_plays
where duration_ms is null



  
  
      
    ) dbt_internal_test
[0m19:34:07.033783 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:34:07.029907 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_device_usage_total_plays.90a295df48: Close
[0m19:34:07.032639 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m19:34:07.042199 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m19:34:07.045503 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m19:34:07.048004 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m19:34:07.057657 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m19:34:07.061653 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from spotify_data.silver.silver_plays
where event_id is null



  
  
      
    ) dbt_internal_test
[0m19:34:07.062119 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:34:07.145113 [info ] [Thread-1 (]: 13 of 43 PASS not_null_device_usage_total_plays ................................ [[32mPASS[0m in 0.59s]
[0m19:34:07.154306 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m19:34:07.156010 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m19:34:07.157802 [info ] [Thread-1 (]: 17 of 43 START test not_null_silver_plays_event_type ........................... [RUN]
[0m19:34:07.162271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_plays.90a295df48, now test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa)
[0m19:34:07.162694 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m19:34:07.183867 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m19:34:07.190984 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m19:34:07.200603 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m19:34:07.204378 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m19:34:07.204874 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_type
from spotify_data.silver.silver_plays
where event_type is null



  
  
      
    ) dbt_internal_test
[0m19:34:07.205260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:34:07.294634 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.434 seconds
[0m19:34:07.304813 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad: Close
[0m19:34:07.397958 [info ] [Thread-4 (]: 14 of 43 PASS not_null_silver_plays_artist_name ................................ [[32mPASS[0m in 0.56s]
[0m19:34:07.403700 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m19:34:07.404278 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m19:34:07.404690 [info ] [Thread-4 (]: 18 of 43 START test not_null_silver_plays_played_at ............................ [RUN]
[0m19:34:07.405238 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad, now test.spotify_analytics.not_null_silver_plays_played_at.8281565f95)
[0m19:34:07.405637 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m19:34:07.416671 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m19:34:07.420771 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m19:34:07.426517 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m19:34:07.434096 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m19:34:07.437096 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_played_at.8281565f95: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select played_at
from spotify_data.silver.silver_plays
where played_at is null



  
  
      
    ) dbt_internal_test
[0m19:34:07.437498 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:34:07.649058 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.615 seconds
[0m19:34:07.652177 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076: Close
[0m19:34:07.714925 [info ] [Thread-3 (]: 15 of 43 PASS not_null_silver_plays_duration_ms ................................ [[32mPASS[0m in 0.72s]
[0m19:34:07.716029 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m19:34:07.716479 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m19:34:07.716947 [info ] [Thread-3 (]: 19 of 43 START test not_null_silver_plays_processed_at ......................... [RUN]
[0m19:34:07.717599 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076, now test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed)
[0m19:34:07.718895 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m19:34:07.729311 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.667 seconds
[0m19:34:07.730651 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.525 seconds
[0m19:34:07.733305 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m19:34:07.739652 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m19:34:07.736261 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd: Close
[0m19:34:07.738736 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa: Close
[0m19:34:07.933278 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m19:34:07.935973 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m19:34:07.936843 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select processed_at
from spotify_data.silver.silver_plays
where processed_at is null



  
  
      
    ) dbt_internal_test
[0m19:34:07.937277 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:34:07.987757 [info ] [Thread-1 (]: 17 of 43 PASS not_null_silver_plays_event_type ................................. [[32mPASS[0m in 0.82s]
[0m19:34:07.991980 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m19:34:07.995513 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m19:34:07.998009 [info ] [Thread-1 (]: 20 of 43 START test not_null_silver_plays_track_id ............................. [RUN]
[0m19:34:07.999280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa, now test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9)
[0m19:34:07.999684 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m19:34:08.011950 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m19:34:08.013486 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m19:34:08.018548 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m19:34:08.022030 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m19:34:08.022462 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_id
from spotify_data.silver.silver_plays
where track_id is null



  
  
      
    ) dbt_internal_test
[0m19:34:08.023863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:34:08.046258 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.609 seconds
[0m19:34:08.057468 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_played_at.8281565f95: Close
[0m19:34:08.052826 [info ] [Thread-2 (]: 16 of 43 PASS not_null_silver_plays_event_id ................................... [[32mPASS[0m in 1.02s]
[0m19:34:08.063711 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m19:34:08.064241 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m19:34:08.070986 [info ] [Thread-2 (]: 21 of 43 START test not_null_silver_plays_track_name ........................... [RUN]
[0m19:34:08.071534 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd, now test.spotify_analytics.not_null_silver_plays_track_name.c6334add30)
[0m19:34:08.072283 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m19:34:08.080378 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m19:34:08.085634 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m19:34:08.088108 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m19:34:08.089904 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m19:34:08.097265 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_track_name.c6334add30: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_name
from spotify_data.silver.silver_plays
where track_name is null



  
  
      
    ) dbt_internal_test
[0m19:34:08.097687 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:34:08.136789 [info ] [Thread-4 (]: 18 of 43 PASS not_null_silver_plays_played_at .................................. [[32mPASS[0m in 0.73s]
[0m19:34:08.140369 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m19:34:08.142060 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m19:34:08.157201 [info ] [Thread-4 (]: 22 of 43 START test not_null_silver_plays_user_id .............................. [RUN]
[0m19:34:08.159943 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_played_at.8281565f95, now test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4)
[0m19:34:08.160409 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m19:34:08.175783 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m19:34:08.177546 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m19:34:08.188584 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m19:34:08.192898 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m19:34:08.193308 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from spotify_data.silver.silver_plays
where user_id is null



  
  
      
    ) dbt_internal_test
[0m19:34:08.195639 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:34:08.437043 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.500 seconds
[0m19:34:08.446776 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed: Close
[0m19:34:08.524539 [info ] [Thread-3 (]: 19 of 43 PASS not_null_silver_plays_processed_at ............................... [[32mPASS[0m in 0.81s]
[0m19:34:08.525755 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m19:34:08.526285 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m19:34:08.526755 [info ] [Thread-3 (]: 23 of 43 START test not_null_top_artists_artist_name ........................... [RUN]
[0m19:34:08.527321 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed, now test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e)
[0m19:34:08.529102 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m19:34:08.536228 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m19:34:08.537096 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m19:34:08.540509 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m19:34:08.541991 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m19:34:08.542480 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select artist_name
from spotify_data.gold.top_artists
where artist_name is null



  
  
      
    ) dbt_internal_test
[0m19:34:08.542872 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:34:08.589543 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.567 seconds
[0m19:34:08.593649 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9: Close
[0m19:34:08.650621 [info ] [Thread-1 (]: 20 of 43 PASS not_null_silver_plays_track_id ................................... [[32mPASS[0m in 0.65s]
[0m19:34:08.653164 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m19:34:08.655031 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m19:34:08.655531 [info ] [Thread-1 (]: 24 of 43 START test not_null_top_artists_first_played_at ....................... [RUN]
[0m19:34:08.656240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9, now test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14)
[0m19:34:08.656629 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m19:34:08.666515 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m19:34:08.668169 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m19:34:08.672753 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m19:34:08.675674 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m19:34:08.676111 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_played_at
from spotify_data.gold.top_artists
where first_played_at is null



  
  
      
    ) dbt_internal_test
[0m19:34:08.676470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:34:08.786090 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.591 seconds
[0m19:34:08.788879 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4: Close
[0m19:34:08.873317 [info ] [Thread-4 (]: 22 of 43 PASS not_null_silver_plays_user_id .................................... [[32mPASS[0m in 0.72s]
[0m19:34:08.874824 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m19:34:08.875413 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m19:34:08.876017 [info ] [Thread-4 (]: 25 of 43 START test not_null_top_artists_last_played_at ........................ [RUN]
[0m19:34:08.876881 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4, now test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca)
[0m19:34:08.877283 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m19:34:08.882236 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m19:34:08.883309 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m19:34:08.886026 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m19:34:08.886877 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m19:34:08.887806 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_played_at
from spotify_data.gold.top_artists
where last_played_at is null



  
  
      
    ) dbt_internal_test
[0m19:34:08.888196 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:34:08.896266 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.799 seconds
[0m19:34:08.898391 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_track_name.c6334add30: Close
[0m19:34:08.981980 [info ] [Thread-2 (]: 21 of 43 PASS not_null_silver_plays_track_name ................................. [[32mPASS[0m in 0.91s]
[0m19:34:08.983711 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m19:34:08.984899 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m19:34:08.986443 [info ] [Thread-2 (]: 26 of 43 START test not_null_top_artists_rank .................................. [RUN]
[0m19:34:08.988200 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_track_name.c6334add30, now test.spotify_analytics.not_null_top_artists_rank.d14513fc96)
[0m19:34:08.988601 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m19:34:09.012757 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m19:34:09.014995 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m19:34:09.023951 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m19:34:09.025116 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m19:34:09.025550 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_rank.d14513fc96: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rank
from spotify_data.gold.top_artists
where rank is null



  
  
      
    ) dbt_internal_test
[0m19:34:09.026842 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:34:09.050776 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.508 seconds
[0m19:34:09.056335 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e: Close
[0m19:34:09.097779 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.421 seconds
[0m19:34:09.114708 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14: Close
[0m19:34:09.152378 [info ] [Thread-3 (]: 23 of 43 PASS not_null_top_artists_artist_name ................................. [[32mPASS[0m in 0.62s]
[0m19:34:09.153454 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m19:34:09.155094 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m19:34:09.157319 [info ] [Thread-3 (]: 27 of 43 START test not_null_top_artists_total_listening_time_ms ............... [RUN]
[0m19:34:09.157869 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e, now test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c)
[0m19:34:09.158277 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m19:34:09.175299 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m19:34:09.182766 [info ] [Thread-1 (]: 24 of 43 PASS not_null_top_artists_first_played_at ............................. [[32mPASS[0m in 0.53s]
[0m19:34:09.193273 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m19:34:09.185122 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m19:34:09.193764 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m19:34:09.199617 [info ] [Thread-1 (]: 28 of 43 START test not_null_top_artists_total_plays ........................... [RUN]
[0m19:34:09.198475 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m19:34:09.201228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14, now test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11)
[0m19:34:09.203615 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m19:34:09.202906 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m19:34:09.208612 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.top_artists
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m19:34:09.209042 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:34:09.208173 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m19:34:09.211208 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m19:34:09.215111 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m19:34:09.220521 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m19:34:09.221298 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.top_artists
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m19:34:09.221674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:34:09.470596 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.582 seconds
[0m19:34:09.475572 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca: Close
[0m19:34:09.532975 [info ] [Thread-4 (]: 25 of 43 PASS not_null_top_artists_last_played_at .............................. [[32mPASS[0m in 0.66s]
[0m19:34:09.534197 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m19:34:09.534644 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m19:34:09.535577 [info ] [Thread-4 (]: 29 of 43 START test not_null_top_artists_unique_tracks ......................... [RUN]
[0m19:34:09.536277 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca, now test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13)
[0m19:34:09.536643 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m19:34:09.541644 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m19:34:09.542281 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m19:34:09.545505 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m19:34:09.546826 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m19:34:09.547305 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unique_tracks
from spotify_data.gold.top_artists
where unique_tracks is null



  
  
      
    ) dbt_internal_test
[0m19:34:09.547662 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:34:09.722315 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.695 seconds
[0m19:34:09.724419 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_rank.d14513fc96: Close
[0m19:34:09.777295 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.568 seconds
[0m19:34:09.779281 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c: Close
[0m19:34:09.788179 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.566 seconds
[0m19:34:09.789914 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11: Close
[0m19:34:09.793727 [info ] [Thread-2 (]: 26 of 43 PASS not_null_top_artists_rank ........................................ [[32mPASS[0m in 0.81s]
[0m19:34:09.805512 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m19:34:09.806159 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m19:34:09.806563 [info ] [Thread-2 (]: 30 of 43 START test not_null_top_tracks_artist_name ............................ [RUN]
[0m19:34:09.808594 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_rank.d14513fc96, now test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461)
[0m19:34:09.809377 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m19:34:09.815654 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m19:34:09.817431 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m19:34:09.823487 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m19:34:09.824995 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m19:34:09.825474 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select artist_name
from spotify_data.gold.top_tracks
where artist_name is null



  
  
      
    ) dbt_internal_test
[0m19:34:09.825846 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:34:09.850816 [info ] [Thread-1 (]: 28 of 43 PASS not_null_top_artists_total_plays ................................. [[32mPASS[0m in 0.65s]
[0m19:34:09.856867 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m19:34:09.857719 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m19:34:09.862499 [info ] [Thread-1 (]: 31 of 43 START test not_null_top_tracks_first_played_at ........................ [RUN]
[0m19:34:09.851744 [info ] [Thread-3 (]: 27 of 43 PASS not_null_top_artists_total_listening_time_ms ..................... [[32mPASS[0m in 0.69s]
[0m19:34:09.864106 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m19:34:09.866913 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m19:34:09.863501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11, now test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31)
[0m19:34:09.872749 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m19:34:09.868613 [info ] [Thread-3 (]: 32 of 43 START test not_null_top_tracks_last_played_at ......................... [RUN]
[0m19:34:09.888284 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c, now test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532)
[0m19:34:09.889372 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m19:34:09.901084 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.353 seconds
[0m19:34:09.914402 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m19:34:09.918654 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m19:34:09.918012 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m19:34:09.925184 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m19:34:09.916333 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13: Close
[0m19:34:09.933298 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m19:34:09.934194 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m19:34:09.934592 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_played_at
from spotify_data.gold.top_tracks
where last_played_at is null



  
  
      
    ) dbt_internal_test
[0m19:34:09.939314 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:34:09.929781 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m19:34:09.944031 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m19:34:09.949844 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_played_at
from spotify_data.gold.top_tracks
where first_played_at is null



  
  
      
    ) dbt_internal_test
[0m19:34:09.950298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:34:10.069797 [info ] [Thread-4 (]: 29 of 43 PASS not_null_top_artists_unique_tracks ............................... [[32mPASS[0m in 0.53s]
[0m19:34:10.077147 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m19:34:10.087956 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m19:34:10.088448 [info ] [Thread-4 (]: 33 of 43 START test not_null_top_tracks_rank ................................... [RUN]
[0m19:34:10.095582 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13, now test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4)
[0m19:34:10.096231 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m19:34:10.126141 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m19:34:10.137165 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m19:34:10.158980 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m19:34:10.163588 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m19:34:10.166503 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rank
from spotify_data.gold.top_tracks
where rank is null



  
  
      
    ) dbt_internal_test
[0m19:34:10.166990 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:34:10.539540 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.714 seconds
[0m19:34:10.542576 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461: Close
[0m19:34:10.603597 [info ] [Thread-2 (]: 30 of 43 PASS not_null_top_tracks_artist_name .................................. [[32mPASS[0m in 0.79s]
[0m19:34:10.604754 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m19:34:10.606237 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m19:34:10.606802 [info ] [Thread-2 (]: 34 of 43 START test not_null_top_tracks_total_listening_time_ms ................ [RUN]
[0m19:34:10.607443 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461, now test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac)
[0m19:34:10.608884 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m19:34:10.615549 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m19:34:10.616392 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m19:34:10.620303 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m19:34:10.621440 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m19:34:10.621983 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.top_tracks
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m19:34:10.623069 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:34:10.659634 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.709 seconds
[0m19:34:10.666397 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31: Close
[0m19:34:10.685905 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.745 seconds
[0m19:34:10.690058 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532: Close
[0m19:34:10.710789 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.544 seconds
[0m19:34:10.712759 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4: Close
[0m19:34:10.763158 [info ] [Thread-3 (]: 32 of 43 PASS not_null_top_tracks_last_played_at ............................... [[32mPASS[0m in 0.87s]
[0m19:34:10.765265 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m19:34:10.765722 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m19:34:10.764578 [info ] [Thread-1 (]: 31 of 43 PASS not_null_top_tracks_first_played_at .............................. [[32mPASS[0m in 0.90s]
[0m19:34:10.770994 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m19:34:10.772547 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m19:34:10.769456 [info ] [Thread-3 (]: 35 of 43 START test not_null_top_tracks_total_plays ............................ [RUN]
[0m19:34:10.777730 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532, now test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893)
[0m19:34:10.775079 [info ] [Thread-4 (]: 33 of 43 PASS not_null_top_tracks_rank ......................................... [[32mPASS[0m in 0.68s]
[0m19:34:10.780461 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m19:34:10.781021 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m19:34:10.778843 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m19:34:10.777248 [info ] [Thread-1 (]: 36 of 43 START test not_null_top_tracks_track_id ............................... [RUN]
[0m19:34:10.790883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31, now test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78)
[0m19:34:10.784206 [info ] [Thread-4 (]: 37 of 43 START test not_null_top_tracks_track_name ............................. [RUN]
[0m19:34:10.795846 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4, now test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203)
[0m19:34:10.790254 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m19:34:10.791732 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m19:34:10.796767 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m19:34:10.797877 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m19:34:10.802492 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m19:34:10.808452 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m19:34:10.813259 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m19:34:10.811302 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m19:34:10.812482 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m19:34:10.816011 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m19:34:10.817228 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m19:34:10.821736 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.top_tracks
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m19:34:10.822127 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:34:10.819619 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m19:34:10.824407 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m19:34:10.821296 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m19:34:10.825283 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_name
from spotify_data.gold.top_tracks
where track_name is null



  
  
      
    ) dbt_internal_test
[0m19:34:10.824802 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_id
from spotify_data.gold.top_tracks
where track_id is null



  
  
      
    ) dbt_internal_test
[0m19:34:10.825994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:34:10.825636 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:34:11.053634 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.431 seconds
[0m19:34:11.065540 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac: Close
[0m19:34:11.181004 [info ] [Thread-2 (]: 34 of 43 PASS not_null_top_tracks_total_listening_time_ms ...................... [[32mPASS[0m in 0.57s]
[0m19:34:11.187183 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m19:34:11.188590 [debug] [Thread-2 (]: Began running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m19:34:11.189285 [info ] [Thread-2 (]: 38 of 43 START test unique_device_usage_device_type ............................ [RUN]
[0m19:34:11.190544 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac, now test.spotify_analytics.unique_device_usage_device_type.e75362861b)
[0m19:34:11.191008 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m19:34:11.199312 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m19:34:11.200839 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m19:34:11.203254 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m19:34:11.204181 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m19:34:11.205161 [debug] [Thread-2 (]: On test.spotify_analytics.unique_device_usage_device_type.e75362861b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_device_usage_device_type.e75362861b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    device_type as unique_field,
    count(*) as n_records

from spotify_data.gold.device_usage
where device_type is not null
group by device_type
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:34:11.206023 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:34:11.360540 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.535 seconds
[0m19:34:11.362387 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203: Close
[0m19:34:11.388647 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.566 seconds
[0m19:34:11.391292 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893: Close
[0m19:34:11.435810 [info ] [Thread-4 (]: 37 of 43 PASS not_null_top_tracks_track_name ................................... [[32mPASS[0m in 0.64s]
[0m19:34:11.436796 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m19:34:11.437610 [debug] [Thread-4 (]: Began running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m19:34:11.438079 [info ] [Thread-4 (]: 39 of 43 START test unique_silver_plays_event_id ............................... [RUN]
[0m19:34:11.438776 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203, now test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf)
[0m19:34:11.439230 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m19:34:11.444863 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m19:34:11.445463 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m19:34:11.448114 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m19:34:11.449865 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m19:34:11.450294 [debug] [Thread-4 (]: On test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from spotify_data.silver.silver_plays
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:34:11.451148 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:34:11.473985 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.648 seconds
[0m19:34:11.478578 [info ] [Thread-3 (]: 35 of 43 PASS not_null_top_tracks_total_plays .................................. [[32mPASS[0m in 0.70s]
[0m19:34:11.490073 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m19:34:11.500205 [debug] [Thread-3 (]: Began running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m19:34:11.488640 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78: Close
[0m19:34:11.500753 [info ] [Thread-3 (]: 40 of 43 START test unique_top_artists_artist_name ............................. [RUN]
[0m19:34:11.503456 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893, now test.spotify_analytics.unique_top_artists_artist_name.008ffa1533)
[0m19:34:11.505728 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m19:34:11.519205 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m19:34:11.521218 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m19:34:11.526635 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m19:34:11.534971 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m19:34:11.535414 [debug] [Thread-3 (]: On test.spotify_analytics.unique_top_artists_artist_name.008ffa1533: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    artist_name as unique_field,
    count(*) as n_records

from spotify_data.gold.top_artists
where artist_name is not null
group by artist_name
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:34:11.535787 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:34:11.574630 [info ] [Thread-1 (]: 36 of 43 PASS not_null_top_tracks_track_id ..................................... [[32mPASS[0m in 0.78s]
[0m19:34:11.579811 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m19:34:11.583492 [debug] [Thread-1 (]: Began running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m19:34:11.584911 [info ] [Thread-1 (]: 41 of 43 START test unique_top_artists_rank .................................... [RUN]
[0m19:34:11.585436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78, now test.spotify_analytics.unique_top_artists_rank.68b5480aed)
[0m19:34:11.586354 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m19:34:11.594186 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m19:34:11.598404 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m19:34:11.602529 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m19:34:11.611427 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m19:34:11.611845 [debug] [Thread-1 (]: On test.spotify_analytics.unique_top_artists_rank.68b5480aed: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_artists_rank.68b5480aed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rank as unique_field,
    count(*) as n_records

from spotify_data.gold.top_artists
where rank is not null
group by rank
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:34:11.619636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:34:11.874503 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.669 seconds
[0m19:34:11.876410 [debug] [Thread-2 (]: On test.spotify_analytics.unique_device_usage_device_type.e75362861b: Close
[0m19:34:12.153678 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.618 seconds
[0m19:34:12.155832 [debug] [Thread-3 (]: On test.spotify_analytics.unique_top_artists_artist_name.008ffa1533: Close
[0m19:34:12.212902 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.762 seconds
[0m19:34:12.219627 [debug] [Thread-4 (]: On test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf: Close
[0m19:34:12.225001 [info ] [Thread-3 (]: 40 of 43 PASS unique_top_artists_artist_name ................................... [[32mPASS[0m in 0.72s]
[0m19:34:12.228181 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m19:34:12.229098 [debug] [Thread-3 (]: Began running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m19:34:12.230108 [info ] [Thread-3 (]: 42 of 43 START test unique_top_tracks_rank ..................................... [RUN]
[0m19:34:12.230839 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_top_artists_artist_name.008ffa1533, now test.spotify_analytics.unique_top_tracks_rank.8fecde1136)
[0m19:34:12.231395 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m19:34:12.236794 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m19:34:12.238351 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m19:34:12.241182 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m19:34:12.243858 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m19:34:12.244309 [debug] [Thread-3 (]: On test.spotify_analytics.unique_top_tracks_rank.8fecde1136: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rank as unique_field,
    count(*) as n_records

from spotify_data.gold.top_tracks
where rank is not null
group by rank
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:34:12.244695 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:34:12.307979 [info ] [Thread-4 (]: 39 of 43 PASS unique_silver_plays_event_id ..................................... [[32mPASS[0m in 0.87s]
[0m19:34:12.309122 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m19:34:12.311387 [debug] [Thread-4 (]: Began running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m19:34:12.311815 [info ] [Thread-4 (]: 43 of 43 START test unique_top_tracks_track_id ................................. [RUN]
[0m19:34:12.315717 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf, now test.spotify_analytics.unique_top_tracks_track_id.865b43a659)
[0m19:34:12.316132 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m19:34:12.315210 [info ] [Thread-2 (]: 38 of 43 PASS unique_device_usage_device_type .................................. [[32mPASS[0m in 1.12s]
[0m19:34:12.325806 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m19:34:12.331782 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m19:34:12.333434 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m19:34:12.340248 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m19:34:12.342044 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m19:34:12.342828 [debug] [Thread-4 (]: On test.spotify_analytics.unique_top_tracks_track_id.865b43a659: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    track_id as unique_field,
    count(*) as n_records

from spotify_data.gold.top_tracks
where track_id is not null
group by track_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:34:12.343300 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:34:12.347709 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.728 seconds
[0m19:34:12.352809 [debug] [Thread-1 (]: On test.spotify_analytics.unique_top_artists_rank.68b5480aed: Close
[0m19:34:12.496824 [info ] [Thread-1 (]: 41 of 43 PASS unique_top_artists_rank .......................................... [[32mPASS[0m in 0.91s]
[0m19:34:12.500299 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m19:34:12.828473 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.584 seconds
[0m19:34:12.831234 [debug] [Thread-3 (]: On test.spotify_analytics.unique_top_tracks_rank.8fecde1136: Close
[0m19:34:12.886963 [info ] [Thread-3 (]: 42 of 43 PASS unique_top_tracks_rank ........................................... [[32mPASS[0m in 0.66s]
[0m19:34:12.888320 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m19:34:12.955556 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.612 seconds
[0m19:34:12.961098 [debug] [Thread-4 (]: On test.spotify_analytics.unique_top_tracks_track_id.865b43a659: Close
[0m19:34:13.024327 [info ] [Thread-4 (]: 43 of 43 PASS unique_top_tracks_track_id ....................................... [[32mPASS[0m in 0.71s]
[0m19:34:13.027212 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m19:34:13.029335 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:34:13.030118 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_artists_rank.68b5480aed' was properly closed.
[0m19:34:13.030439 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_device_usage_device_type.e75362861b' was properly closed.
[0m19:34:13.030720 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_rank.8fecde1136' was properly closed.
[0m19:34:13.031154 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_track_id.865b43a659' was properly closed.
[0m19:34:13.031531 [info ] [MainThread]: 
[0m19:34:13.032089 [info ] [MainThread]: Finished running 43 data tests in 0 hours 0 minutes and 9.90 seconds (9.90s).
[0m19:34:13.038794 [debug] [MainThread]: Command end result
[0m19:34:13.076260 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:34:13.078502 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:34:13.091456 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m19:34:13.092025 [info ] [MainThread]: 
[0m19:34:13.092944 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:34:13.094100 [info ] [MainThread]: 
[0m19:34:13.094740 [info ] [MainThread]: Done. PASS=43 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=43
[0m19:34:13.096624 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 11.933076, "process_in_blocks": "1264", "process_kernel_time": 0.939759, "process_mem_max_rss": "261960", "process_out_blocks": "4048", "process_user_time": 9.480554}
[0m19:34:13.097181 [debug] [MainThread]: Command `dbt test` succeeded at 19:34:13.097080 after 11.93 seconds
[0m19:34:13.097617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7891133db390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7891133db290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789117a8d110>]}
[0m19:34:13.098101 [debug] [MainThread]: Flushing usage events
[0m19:34:13.186216 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:05:23.186136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36166693d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3616669890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3616669310>]}


============================== 20:05:23.193365 | 97c089be-8e5d-407a-bb74-1ab6015e6bae ==============================
[0m20:05:23.193365 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:05:23.194435 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'static_parser': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'empty': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_experimental_parser': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'quiet': 'False', 'target_path': 'None', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'printer_width': '80', 'introspect': 'True', 'no_print': 'None'}
[0m20:05:24.309321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97c089be-8e5d-407a-bb74-1ab6015e6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f361762a250>]}
[0m20:05:24.393840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97c089be-8e5d-407a-bb74-1ab6015e6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f361773de50>]}
[0m20:05:24.395128 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:05:24.628589 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:05:24.789735 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:05:24.790268 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:05:24.797722 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m20:05:24.883596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97c089be-8e5d-407a-bb74-1ab6015e6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36010adb10>]}
[0m20:05:24.996459 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:05:24.998680 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:05:25.031533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97c089be-8e5d-407a-bb74-1ab6015e6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36012e31d0>]}
[0m20:05:25.032516 [info ] [MainThread]: Found 5 models, 43 data tests, 1 source, 604 macros
[0m20:05:25.033092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97c089be-8e5d-407a-bb74-1ab6015e6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3601093550>]}
[0m20:05:25.037435 [info ] [MainThread]: 
[0m20:05:25.038111 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:05:25.038902 [info ] [MainThread]: 
[0m20:05:25.039632 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:05:25.045209 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m20:05:25.045967 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m20:05:25.082533 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m20:05:25.083253 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m20:05:25.084050 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m20:05:25.084382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:25.083677 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m20:05:25.086222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:26.022417 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.937 seconds
[0m20:05:26.024426 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m20:05:26.508575 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.424 seconds
[0m20:05:26.510616 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m20:05:26.589019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97c089be-8e5d-407a-bb74-1ab6015e6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3601416d50>]}
[0m20:05:26.594170 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m20:05:26.594675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.silver_plays)
[0m20:05:26.595156 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m20:05:26.606018 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m20:05:26.607972 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m20:05:26.609018 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m20:05:26.610043 [debug] [Thread-3 (]: Began running node model.spotify_analytics.daily_user_stats
[0m20:05:26.610633 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.spotify_analytics.daily_user_stats'
[0m20:05:26.614787 [debug] [Thread-3 (]: Began compiling node model.spotify_analytics.daily_user_stats
[0m20:05:26.612188 [debug] [Thread-4 (]: Began running node model.spotify_analytics.device_usage
[0m20:05:26.621191 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.spotify_analytics.device_usage'
[0m20:05:26.613102 [debug] [Thread-2 (]: Began running node model.spotify_analytics.top_artists
[0m20:05:26.622136 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.top_artists)
[0m20:05:26.622519 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.top_artists
[0m20:05:26.614239 [debug] [Thread-1 (]: Began running node model.spotify_analytics.top_tracks
[0m20:05:26.620375 [debug] [Thread-3 (]: Writing injected SQL for node "model.spotify_analytics.daily_user_stats"
[0m20:05:26.621655 [debug] [Thread-4 (]: Began compiling node model.spotify_analytics.device_usage
[0m20:05:26.627203 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.top_artists"
[0m20:05:26.633703 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.top_artists
[0m20:05:26.634438 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.top_artists
[0m20:05:26.627718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.silver_plays, now model.spotify_analytics.top_tracks)
[0m20:05:26.633166 [debug] [Thread-3 (]: Began executing node model.spotify_analytics.daily_user_stats
[0m20:05:26.636044 [debug] [Thread-3 (]: Finished running node model.spotify_analytics.daily_user_stats
[0m20:05:26.632570 [debug] [Thread-4 (]: Writing injected SQL for node "model.spotify_analytics.device_usage"
[0m20:05:26.638045 [debug] [Thread-4 (]: Began executing node model.spotify_analytics.device_usage
[0m20:05:26.635399 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.top_tracks
[0m20:05:26.634942 [debug] [Thread-2 (]: Began running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m20:05:26.645339 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.top_artists, now test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39)
[0m20:05:26.637328 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m20:05:26.646202 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.daily_user_stats, now test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad)
[0m20:05:26.646573 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m20:05:26.638718 [debug] [Thread-4 (]: Finished running node model.spotify_analytics.device_usage
[0m20:05:26.652538 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m20:05:26.653025 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.device_usage, now test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076)
[0m20:05:26.645739 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m20:05:26.644679 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.top_tracks"
[0m20:05:26.661414 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.top_tracks
[0m20:05:26.653802 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m20:05:26.662115 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.top_tracks
[0m20:05:26.667995 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m20:05:26.673489 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m20:05:26.678312 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m20:05:26.682669 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m20:05:26.678862 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m20:05:26.684867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.top_tracks, now test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd)
[0m20:05:26.685329 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m20:05:26.683365 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m20:05:26.692263 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m20:05:26.692989 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad, now test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa)
[0m20:05:26.695528 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m20:05:26.691363 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m20:05:26.702273 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m20:05:26.693596 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m20:05:26.703870 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m20:05:26.694174 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m20:05:26.704917 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m20:05:26.705556 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m20:05:26.700387 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m20:05:26.706990 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m20:05:26.704308 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m20:05:26.708609 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39, now test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed)
[0m20:05:26.709038 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m20:05:26.702745 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m20:05:26.714644 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076, now test.spotify_analytics.not_null_silver_plays_played_at.8281565f95)
[0m20:05:26.715091 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m20:05:26.707648 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m20:05:26.705974 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m20:05:26.720630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd, now test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9)
[0m20:05:26.721041 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m20:05:26.714192 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m20:05:26.727278 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m20:05:26.720158 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m20:05:26.728822 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa, now test.spotify_analytics.not_null_silver_plays_track_name.c6334add30)
[0m20:05:26.719622 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m20:05:26.730144 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m20:05:26.729203 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m20:05:26.731115 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m20:05:26.735846 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m20:05:26.736470 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m20:05:26.727933 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m20:05:26.730726 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m20:05:26.735277 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m20:05:26.738759 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m20:05:26.737337 [debug] [Thread-2 (]: Began running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m20:05:26.740311 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed, now test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf)
[0m20:05:26.737725 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:05:26.741083 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_played_at.8281565f95, now test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155)
[0m20:05:26.741430 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:05:26.736935 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m20:05:26.746536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9, now test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4)
[0m20:05:26.746943 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m20:05:26.739899 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m20:05:26.752061 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:05:26.740679 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m20:05:26.746084 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m20:05:26.752494 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_track_name.c6334add30, now test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9)
[0m20:05:26.751585 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m20:05:26.768609 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m20:05:26.767168 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m20:05:26.770147 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m20:05:26.767884 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:05:26.771346 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m20:05:26.778170 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:05:26.769454 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m20:05:26.779382 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:05:26.777139 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m20:05:26.782374 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:05:26.778782 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf, now test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87)
[0m20:05:26.783744 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:05:26.779955 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:05:26.789739 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:05:26.781117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4, now test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282)
[0m20:05:26.790582 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:05:26.783343 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:05:26.796286 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:05:26.796724 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9, now test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac)
[0m20:05:26.797156 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:05:26.789024 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m20:05:26.790212 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:05:26.803319 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155, now test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f)
[0m20:05:26.795712 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m20:05:26.803722 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:05:26.802793 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:05:26.804721 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:05:26.812476 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:05:26.801351 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m20:05:26.813494 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:05:26.811392 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:05:26.814901 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:05:26.814486 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m20:05:26.816521 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:05:26.817177 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:05:26.814130 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:05:26.818045 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:05:26.812927 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:05:26.819461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282, now test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b)
[0m20:05:26.819826 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:05:26.815884 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87, now test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e)
[0m20:05:26.825017 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:05:26.817575 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:05:26.829381 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f, now test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14)
[0m20:05:26.830752 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:05:26.818549 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac, now test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca)
[0m20:05:26.835282 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:05:26.823579 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m20:05:26.843625 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:05:26.828938 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m20:05:26.845068 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:05:26.834814 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m20:05:26.845708 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:05:26.849358 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:05:26.844481 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:05:26.850351 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:05:26.846322 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:05:26.850772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b, now test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c)
[0m20:05:26.853220 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:05:26.852641 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:05:26.849795 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e, now test.spotify_analytics.not_null_top_artists_rank.d14513fc96)
[0m20:05:26.860410 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:05:26.848787 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m20:05:26.866706 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:05:26.859645 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:05:26.868282 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14, now test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11)
[0m20:05:26.867530 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:05:26.869093 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:05:26.867866 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m20:05:26.871225 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:05:26.868669 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:05:26.865499 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m20:05:26.877658 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:05:26.871909 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:05:26.878797 [debug] [Thread-1 (]: Began running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:05:26.879258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c, now test.spotify_analytics.unique_top_artists_artist_name.008ffa1533)
[0m20:05:26.869478 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca, now test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13)
[0m20:05:26.880015 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:05:26.878312 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:05:26.885193 [debug] [Thread-2 (]: Began running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:05:26.877084 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m20:05:26.879625 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:05:26.885622 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_rank.d14513fc96, now test.spotify_analytics.unique_top_artists_rank.68b5480aed)
[0m20:05:26.893190 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:05:26.886209 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:05:26.899127 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:05:26.884677 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m20:05:26.900566 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:05:26.898363 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m20:05:26.899589 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:05:26.904442 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11, now test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003)
[0m20:05:26.904882 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:05:26.901225 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:05:26.905282 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:05:26.911216 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:05:26.908987 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m20:05:26.913903 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:05:26.902828 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m20:05:26.916614 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:05:26.910433 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:05:26.914608 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:05:26.924189 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:05:26.917311 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:05:26.927175 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:05:26.911629 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:05:26.928189 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_top_artists_rank.68b5480aed, now test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2)
[0m20:05:26.918723 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13, now test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c)
[0m20:05:26.929577 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:05:26.924915 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003, now test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2)
[0m20:05:26.936401 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:05:26.927695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_top_artists_artist_name.008ffa1533, now test.spotify_analytics.not_null_device_usage_total_plays.90a295df48)
[0m20:05:26.945217 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:05:26.928580 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:05:26.960595 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m20:05:26.974256 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:05:26.965252 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m20:05:26.977888 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:05:26.968476 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m20:05:26.979904 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:05:26.977183 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m20:05:26.981604 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:05:26.978886 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:05:26.982999 [debug] [Thread-4 (]: Began running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:05:26.983416 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2, now test.spotify_analytics.unique_device_usage_device_type.e75362861b)
[0m20:05:26.975655 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:05:26.984247 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:05:26.980504 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:05:26.985093 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:05:26.982507 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:05:26.986735 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:05:26.987172 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2, now test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532)
[0m20:05:26.987548 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:05:26.984653 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c, now test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461)
[0m20:05:26.983773 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:05:26.985464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_plays.90a295df48, now test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31)
[0m20:05:27.000936 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:05:26.993987 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:05:27.000360 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m20:05:27.015791 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:05:27.005752 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m20:05:27.017380 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:05:27.007301 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m20:05:27.018762 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:05:27.018188 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:05:27.016725 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:05:27.021823 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:05:27.022268 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_device_usage_device_type.e75362861b, now test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac)
[0m20:05:27.021342 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:05:27.019482 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:05:27.020353 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m20:05:27.023688 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:05:27.022639 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:05:27.023207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31, now test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4)
[0m20:05:27.031383 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:05:27.030898 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:05:27.025235 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532, now test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893)
[0m20:05:27.037904 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:05:27.030433 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m20:05:27.042948 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:05:27.037075 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:05:27.044105 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:05:27.044501 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461, now test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78)
[0m20:05:27.036315 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m20:05:27.045433 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:05:27.043607 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:05:27.046866 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:05:27.047308 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac, now test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203)
[0m20:05:27.042147 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m20:05:27.046401 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:05:27.049276 [debug] [Thread-1 (]: Began running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:05:27.048222 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:05:27.050345 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:05:27.044922 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:05:27.049679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4, now test.spotify_analytics.unique_top_tracks_rank.8fecde1136)
[0m20:05:27.056130 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:05:27.051173 [debug] [Thread-2 (]: Began running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:05:27.047656 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:05:27.055648 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m20:05:27.059873 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m20:05:27.066885 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:05:27.065147 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:05:27.060320 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893, now test.spotify_analytics.unique_top_tracks_track_id.865b43a659)
[0m20:05:27.068735 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:05:27.067597 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:05:27.064552 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m20:05:27.075302 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:05:27.068374 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:05:27.076598 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m20:05:27.075973 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:05:27.077117 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:05:27.078449 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:05:27.082691 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:05:27.083111 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_track_id.865b43a659' was properly closed.
[0m20:05:27.083437 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_rank.8fecde1136' was properly closed.
[0m20:05:27.083725 [debug] [MainThread]: Connection 'test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78' was properly closed.
[0m20:05:27.084133 [debug] [MainThread]: Connection 'test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203' was properly closed.
[0m20:05:27.089621 [debug] [MainThread]: Command end result
[0m20:05:27.127066 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:05:27.129003 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:05:27.138835 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m20:05:27.139944 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 4.0212893, "process_in_blocks": "3872", "process_kernel_time": 0.550886, "process_mem_max_rss": "252480", "process_out_blocks": "3648", "process_user_time": 4.354791}
[0m20:05:27.140510 [debug] [MainThread]: Command `dbt compile` succeeded at 20:05:27.140415 after 4.02 seconds
[0m20:05:27.140969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3616615fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3616615810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3616614850>]}
[0m20:05:27.141415 [debug] [MainThread]: Flushing usage events
[0m20:05:27.231674 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:05:32.395954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7097051eda50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7097055165d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7097051ed350>]}


============================== 20:05:32.407341 | 3324a26d-81f7-4351-8c63-375d6fd7bfdf ==============================
[0m20:05:32.407341 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:05:32.410274 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'use_colors': 'True', 'log_format': 'default', 'no_print': 'None', 'warn_error': 'None', 'target_path': 'None', 'introspect': 'True', 'log_path': '/opt/airflow/dbt/logs', 'write_json': 'True', 'debug': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'quiet': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'static_parser': 'True', 'invocation_command': 'dbt run --select silver.*', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False'}
[0m20:05:33.648268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3324a26d-81f7-4351-8c63-375d6fd7bfdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7096eff30a50>]}
[0m20:05:33.734350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3324a26d-81f7-4351-8c63-375d6fd7bfdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7096efde6710>]}
[0m20:05:33.735550 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:05:33.975519 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:05:34.159864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:05:34.160404 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:05:34.167860 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m20:05:34.226152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3324a26d-81f7-4351-8c63-375d6fd7bfdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7096efb8ae50>]}
[0m20:05:34.341953 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:05:34.344941 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:05:34.371727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3324a26d-81f7-4351-8c63-375d6fd7bfdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7096ef923c10>]}
[0m20:05:34.372891 [info ] [MainThread]: Found 5 models, 43 data tests, 1 source, 604 macros
[0m20:05:34.374374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3324a26d-81f7-4351-8c63-375d6fd7bfdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7097058e5d50>]}
[0m20:05:34.376894 [info ] [MainThread]: 
[0m20:05:34.378516 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:05:34.378996 [info ] [MainThread]: 
[0m20:05:34.379594 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:05:34.381679 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m20:05:34.398695 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m20:05:34.399156 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m20:05:34.399484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:35.389222 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.990 seconds
[0m20:05:35.391472 [debug] [ThreadPool]: On list_spotify_data: Close
[0m20:05:35.484357 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_gold)
[0m20:05:35.485150 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m20:05:35.501861 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m20:05:35.507130 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m20:05:35.507474 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:35.506583 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m20:05:35.508745 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m20:05:35.509113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:36.064182 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.555 seconds
[0m20:05:36.066003 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m20:05:36.123483 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.616 seconds
[0m20:05:36.126128 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m20:05:36.189010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3324a26d-81f7-4351-8c63-375d6fd7bfdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7096efd53cd0>]}
[0m20:05:36.193635 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m20:05:36.194264 [info ] [Thread-1 (]: 1 of 1 START sql table model silver.silver_plays ............................... [RUN]
[0m20:05:36.195135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.silver_plays)
[0m20:05:36.196047 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m20:05:36.210509 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m20:05:36.211836 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m20:05:36.243941 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.silver_plays"
[0m20:05:36.247807 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.silver_plays"
[0m20:05:36.248350 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.silver_plays"} */
create or replace transient table spotify_data.silver.silver_plays
         as
        (

-- ============================================================================
-- SILVER LAYER: CLEANED PLAYS DATA
-- ============================================================================
-- Purpose: Transform bronze plays data into clean, analytics-ready format
-- 
-- Transformations:
--   1. Deduplicate records (DISTINCT on event_id)
--   2. Cast all data types from VARIANT to proper types
--   3. Filter invalid records (defensive WHERE clauses)
--   4. Add processing metadata (processed_at timestamp)
--
-- Source: bronze.plays (external table reading from S3 Parquet files)
-- Target: SILVER.silver_plays (materialized table)
-- ============================================================================

WITH source_data AS (
    SELECT 
        VALUE:event_id::VARCHAR AS event_id,
        VALUE:user_id::VARCHAR AS user_id,
        VALUE:event_type::VARCHAR AS event_type,
        VALUE:track_id::VARCHAR AS track_id,
        VALUE:track_name::VARCHAR AS track_name,
        VALUE:artist_name::VARCHAR AS artist_name,
        VALUE:album_name::VARCHAR AS album_name,
        VALUE:duration_ms::NUMBER AS duration_ms,
        VALUE:played_at::VARCHAR AS played_at,
        VALUE:device_type::VARCHAR AS device_type
    FROM spotify_data.bronze.plays
),

deduplicated AS (
    SELECT DISTINCT
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM source_data
    WHERE 
        -- Data quality filters
        user_id IS NOT NULL
        AND duration_ms > 0
        AND duration_ms < 600000  -- Less than 10 minutes (catches data errors)
        AND event_id IS NOT NULL
)

SELECT 
    -- Identifiers
    event_id::VARCHAR AS event_id,
    user_id::VARCHAR AS user_id,
    event_type::VARCHAR AS event_type,
    
    -- Track information
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    duration_ms::NUMBER AS duration_ms,
    
    -- Timestamps
    TRY_CAST(played_at AS TIMESTAMP) AS played_at,
    
    -- Device context
    device_type::VARCHAR AS device_type,
    
    -- Metadata
    CURRENT_TIMESTAMP() AS processed_at
    
FROM deduplicated
        );
[0m20:05:36.248817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:38.664264 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.415 seconds
[0m20:05:38.693913 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: Close
[0m20:05:38.755683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3324a26d-81f7-4351-8c63-375d6fd7bfdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70970611b910>]}
[0m20:05:38.756752 [info ] [Thread-1 (]: 1 of 1 OK created sql table model silver.silver_plays .......................... [[32mSUCCESS 1[0m in 2.56s]
[0m20:05:38.757773 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m20:05:38.763354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:05:38.764028 [debug] [MainThread]: Connection 'model.spotify_analytics.silver_plays' was properly closed.
[0m20:05:38.764352 [debug] [MainThread]: Connection 'list_spotify_data_silver' was properly closed.
[0m20:05:38.764722 [info ] [MainThread]: 
[0m20:05:38.765152 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.39 seconds (4.39s).
[0m20:05:38.765834 [debug] [MainThread]: Command end result
[0m20:05:38.808596 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:05:38.811075 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:05:38.818566 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m20:05:38.819109 [info ] [MainThread]: 
[0m20:05:38.819981 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:05:38.820620 [info ] [MainThread]: 
[0m20:05:38.821196 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:05:38.822915 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.500885, "process_in_blocks": "8", "process_kernel_time": 0.545081, "process_mem_max_rss": "249448", "process_out_blocks": "3088", "process_user_time": 4.123427}
[0m20:05:38.823451 [debug] [MainThread]: Command `dbt run` succeeded at 20:05:38.823360 after 6.50 seconds
[0m20:05:38.823845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7097099ba950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7097051fbad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709705605690>]}
[0m20:05:38.824662 [debug] [MainThread]: Flushing usage events
[0m20:05:38.916977 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:05:44.422107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc5ee2a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc6206b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc62f1350>]}


============================== 20:05:44.428878 | 24e9aa3a-4fc8-43c1-8468-d936a4e24a99 ==============================
[0m20:05:44.428878 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:05:44.430812 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'invocation_command': 'dbt run --select gold.*', 'log_format': 'default', 'empty': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'indirect_selection': 'eager', 'no_print': 'None', 'debug': 'False', 'write_json': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None'}
[0m20:05:45.514846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24e9aa3a-4fc8-43c1-8468-d936a4e24a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cb4c41290>]}
[0m20:05:45.595474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24e9aa3a-4fc8-43c1-8468-d936a4e24a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc6fad710>]}
[0m20:05:45.596514 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:05:45.833497 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:05:46.012101 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:05:46.012639 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:05:46.019640 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m20:05:46.074229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24e9aa3a-4fc8-43c1-8468-d936a4e24a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cb4c9fe90>]}
[0m20:05:46.190918 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:05:46.192988 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:05:46.220474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24e9aa3a-4fc8-43c1-8468-d936a4e24a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cb465ead0>]}
[0m20:05:46.221165 [info ] [MainThread]: Found 5 models, 43 data tests, 1 source, 604 macros
[0m20:05:46.223103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24e9aa3a-4fc8-43c1-8468-d936a4e24a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc609bf90>]}
[0m20:05:46.228443 [info ] [MainThread]: 
[0m20:05:46.232029 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:05:46.232435 [info ] [MainThread]: 
[0m20:05:46.235268 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:05:46.245371 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m20:05:46.276711 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m20:05:46.277139 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m20:05:46.277919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:47.130619 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.853 seconds
[0m20:05:47.132350 [debug] [ThreadPool]: On list_spotify_data: Close
[0m20:05:47.245455 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_gold)
[0m20:05:47.246333 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m20:05:47.271710 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m20:05:47.273139 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m20:05:47.273496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:47.272468 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m20:05:47.274293 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m20:05:47.274611 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:47.823183 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.548 seconds
[0m20:05:47.825177 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m20:05:48.173354 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.899 seconds
[0m20:05:48.175600 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m20:05:48.284410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24e9aa3a-4fc8-43c1-8468-d936a4e24a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc89b4c10>]}
[0m20:05:48.290447 [debug] [Thread-2 (]: Began running node model.spotify_analytics.daily_user_stats
[0m20:05:48.291117 [debug] [Thread-1 (]: Began running node model.spotify_analytics.device_usage
[0m20:05:48.291524 [debug] [Thread-3 (]: Began running node model.spotify_analytics.top_artists
[0m20:05:48.291904 [debug] [Thread-4 (]: Began running node model.spotify_analytics.top_tracks
[0m20:05:48.293377 [info ] [Thread-2 (]: 1 of 4 START sql table model gold.daily_user_stats ............................. [RUN]
[0m20:05:48.296930 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.daily_user_stats)
[0m20:05:48.297368 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.daily_user_stats
[0m20:05:48.296346 [info ] [Thread-4 (]: 4 of 4 START sql table model gold.top_tracks ................................... [RUN]
[0m20:05:48.303602 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.spotify_analytics.top_tracks'
[0m20:05:48.310913 [debug] [Thread-4 (]: Began compiling node model.spotify_analytics.top_tracks
[0m20:05:48.293951 [info ] [Thread-1 (]: 2 of 4 START sql table model gold.device_usage ................................. [RUN]
[0m20:05:48.294370 [info ] [Thread-3 (]: 3 of 4 START sql table model gold.top_artists .................................. [RUN]
[0m20:05:48.316600 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.spotify_analytics.top_artists'
[0m20:05:48.317029 [debug] [Thread-3 (]: Began compiling node model.spotify_analytics.top_artists
[0m20:05:48.310412 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.daily_user_stats"
[0m20:05:48.314545 [debug] [Thread-4 (]: Writing injected SQL for node "model.spotify_analytics.top_tracks"
[0m20:05:48.322680 [debug] [Thread-4 (]: Began executing node model.spotify_analytics.top_tracks
[0m20:05:48.315089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.device_usage)
[0m20:05:48.328750 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.device_usage
[0m20:05:48.322079 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.daily_user_stats
[0m20:05:48.320564 [debug] [Thread-3 (]: Writing injected SQL for node "model.spotify_analytics.top_artists"
[0m20:05:48.345277 [debug] [Thread-3 (]: Began executing node model.spotify_analytics.top_artists
[0m20:05:48.332680 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.device_usage"
[0m20:05:48.365788 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.device_usage
[0m20:05:48.407974 [debug] [Thread-2 (]: Writing runtime sql for node "model.spotify_analytics.daily_user_stats"
[0m20:05:48.411430 [debug] [Thread-4 (]: Writing runtime sql for node "model.spotify_analytics.top_tracks"
[0m20:05:48.420402 [debug] [Thread-3 (]: Writing runtime sql for node "model.spotify_analytics.top_artists"
[0m20:05:48.419771 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.device_usage"
[0m20:05:48.423914 [debug] [Thread-4 (]: Using snowflake connection "model.spotify_analytics.top_tracks"
[0m20:05:48.429748 [debug] [Thread-4 (]: On model.spotify_analytics.top_tracks: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.top_tracks"} */
create or replace transient table spotify_data.gold.top_tracks
         as
        (

-- ============================================================================
-- GOLD LAYER: TOP TRACKS BY PLAY COUNT
-- ============================================================================
-- Purpose: Aggregate and rank tracks by popularity
-- 
-- Grain: One row per track (all-time aggregation)
-- Primary Key: track_id
--
-- Metrics:
--   - Total plays per track
--   - Total listening time
--   - First and last play timestamps
--   - Popularity rank
--
-- Source: SILVER.silver_plays
-- Target: GOLD.top_tracks
-- ============================================================================

WITH track_aggregates AS (
    SELECT 
        -- Track identifiers and attributes
        track_id,
        track_name,
        artist_name,
        album_name,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        MIN(played_at) AS first_played_at,
        MAX(played_at) AS last_played_at
        
    FROM spotify_data.silver.silver_plays
    GROUP BY 
        track_id,
        track_name,
        artist_name,
        album_name
),

ranked_tracks AS (
    SELECT 
        *,
        -- Add ranking based on play count (1 = most played)
        ROW_NUMBER() OVER (ORDER BY total_plays DESC, total_listening_time_ms DESC) AS rank
    FROM track_aggregates
)

SELECT 
    -- Identifiers
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    
    -- Timestamps
    first_played_at::TIMESTAMP AS first_played_at,
    last_played_at::TIMESTAMP AS last_played_at,
    
    -- Ranking
    rank::NUMBER AS rank
    
FROM ranked_tracks
ORDER BY rank
        );
[0m20:05:48.430244 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:05:48.425446 [debug] [Thread-3 (]: Using snowflake connection "model.spotify_analytics.top_artists"
[0m20:05:48.431414 [debug] [Thread-3 (]: On model.spotify_analytics.top_artists: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.top_artists"} */
create or replace transient table spotify_data.gold.top_artists
         as
        (

-- ============================================================================
-- GOLD LAYER: TOP ARTISTS BY PLAY COUNT
-- ============================================================================
-- Purpose: Aggregate and rank artists by popularity
-- 
-- Grain: One row per artist (all-time aggregation)
-- Primary Key: artist_name
--
-- Metrics:
--   - Total plays per artist
--   - Total listening time
--   - Number of unique tracks played
--   - First and last play timestamps
--   - Popularity rank
--
-- Source: SILVER.silver_plays
-- Target: GOLD.top_artists
-- ============================================================================

WITH artist_aggregates AS (
    SELECT 
        -- Artist identifier
        artist_name,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        COUNT(DISTINCT track_id) AS unique_tracks,
        MIN(played_at) AS first_played_at,
        MAX(played_at) AS last_played_at
        
    FROM spotify_data.silver.silver_plays
    GROUP BY artist_name
),

ranked_artists AS (
    SELECT 
        *,
        -- Add ranking based on play count (1 = most played artist)
        ROW_NUMBER() OVER (ORDER BY total_plays DESC, total_listening_time_ms DESC) AS rank
    FROM artist_aggregates
)

SELECT 
    -- Identifier
    artist_name::VARCHAR AS artist_name,
    
    -- Metrics
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    unique_tracks::NUMBER AS unique_tracks,
    
    -- Timestamps
    first_played_at::TIMESTAMP AS first_played_at,
    last_played_at::TIMESTAMP AS last_played_at,
    
    -- Ranking
    rank::NUMBER AS rank
    
FROM ranked_artists
ORDER BY rank
        );
[0m20:05:48.427245 [debug] [Thread-2 (]: Using snowflake connection "model.spotify_analytics.daily_user_stats"
[0m20:05:48.432292 [debug] [Thread-2 (]: On model.spotify_analytics.daily_user_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.daily_user_stats"} */
create or replace transient table spotify_data.gold.daily_user_stats
         as
        (

-- ============================================================================
-- GOLD LAYER: DAILY USER LISTENING STATISTICS
-- ============================================================================
-- Purpose: Aggregate user listening behavior by day
-- 
-- Grain: One row per user per day
-- Primary Key: (date, user_id)
--
-- Metrics:
--   - Total plays per day
--   - Total listening time
--   - Unique tracks/artists played
--   - Average track duration
--
-- Source: SILVER.silver_plays
-- Target: GOLD.daily_user_stats
-- ============================================================================

WITH daily_aggregates AS (
    SELECT 
        -- Date dimension (truncate timestamp to date)
        DATE(played_at) AS date,
        
        -- User identifier
        user_id,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        COUNT(DISTINCT track_id) AS unique_tracks,
        COUNT(DISTINCT artist_name) AS unique_artists,
        AVG(duration_ms) AS avg_track_duration_ms
        
    FROM spotify_data.silver.silver_plays
    GROUP BY 
        DATE(played_at),
        user_id
)

SELECT 
    -- Dimensions
    date,
    user_id,
    
    -- Metrics (cast for clarity)
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    unique_tracks::NUMBER AS unique_tracks,
    unique_artists::NUMBER AS unique_artists,
    ROUND(avg_track_duration_ms, 2)::NUMBER AS avg_track_duration_ms
    
FROM daily_aggregates
ORDER BY date DESC, user_id
        );
[0m20:05:48.432701 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:05:48.428575 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.device_usage"
[0m20:05:48.436173 [debug] [Thread-1 (]: On model.spotify_analytics.device_usage: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.device_usage"} */
create or replace transient table spotify_data.gold.device_usage
         as
        (

-- ============================================================================
-- GOLD LAYER: DEVICE USAGE STATISTICS
-- ============================================================================
-- Purpose: Aggregate listening behavior by device type
-- 
-- Grain: One row per device type (all-time aggregation)
-- Primary Key: device_type
--
-- Metrics:
--   - Total plays per device
--   - Total listening time
--   - Percentage of total plays
--   - Average track duration
--
-- Source: SILVER.silver_plays
-- Target: GOLD.device_usage
-- ============================================================================

WITH device_aggregates AS (
    SELECT 
        -- Device identifier
        device_type,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        AVG(duration_ms) AS avg_track_duration_ms
        
    FROM spotify_data.silver.silver_plays
    GROUP BY device_type
),

total_plays_calc AS (
    -- Calculate overall total for percentage calculation
    SELECT SUM(total_plays) AS overall_total_plays
    FROM device_aggregates
)

SELECT 
    -- Identifier
    device_type::VARCHAR AS device_type,
    
    -- Metrics
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    
    -- Percentage of total plays
    ROUND((total_plays::FLOAT / overall_total_plays::FLOAT) * 100, 2)::FLOAT AS play_percentage,
    
    -- Average duration
    ROUND(avg_track_duration_ms, 2)::NUMBER AS avg_track_duration_ms
    
FROM device_aggregates
CROSS JOIN total_plays_calc
ORDER BY total_plays DESC
        );
[0m20:05:48.436610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:48.431843 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:05:49.839973 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.403 seconds
[0m20:05:49.894611 [debug] [Thread-1 (]: On model.spotify_analytics.device_usage: Close
[0m20:05:49.915135 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.485 seconds
[0m20:05:49.917072 [debug] [Thread-4 (]: On model.spotify_analytics.top_tracks: Close
[0m20:05:49.940797 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24e9aa3a-4fc8-43c1-8468-d936a4e24a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc6e1b910>]}
[0m20:05:49.942825 [info ] [Thread-1 (]: 2 of 4 OK created sql table model gold.device_usage ............................ [[32mSUCCESS 1[0m in 1.62s]
[0m20:05:49.944639 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.device_usage
[0m20:05:49.974353 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24e9aa3a-4fc8-43c1-8468-d936a4e24a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc5ed3390>]}
[0m20:05:49.975343 [info ] [Thread-4 (]: 4 of 4 OK created sql table model gold.top_tracks .............................. [[32mSUCCESS 1[0m in 1.67s]
[0m20:05:49.977187 [debug] [Thread-4 (]: Finished running node model.spotify_analytics.top_tracks
[0m20:05:50.265758 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.833 seconds
[0m20:05:50.267743 [debug] [Thread-2 (]: On model.spotify_analytics.daily_user_stats: Close
[0m20:05:50.308143 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.876 seconds
[0m20:05:50.310139 [debug] [Thread-3 (]: On model.spotify_analytics.top_artists: Close
[0m20:05:50.344285 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24e9aa3a-4fc8-43c1-8468-d936a4e24a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc9014a90>]}
[0m20:05:50.345063 [info ] [Thread-2 (]: 1 of 4 OK created sql table model gold.daily_user_stats ........................ [[32mSUCCESS 1[0m in 2.05s]
[0m20:05:50.346048 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.daily_user_stats
[0m20:05:50.373929 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24e9aa3a-4fc8-43c1-8468-d936a4e24a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cb42884d0>]}
[0m20:05:50.375078 [info ] [Thread-3 (]: 3 of 4 OK created sql table model gold.top_artists ............................. [[32mSUCCESS 1[0m in 2.06s]
[0m20:05:50.375729 [debug] [Thread-3 (]: Finished running node model.spotify_analytics.top_artists
[0m20:05:50.379191 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:05:50.379635 [debug] [MainThread]: Connection 'model.spotify_analytics.device_usage' was properly closed.
[0m20:05:50.380149 [debug] [MainThread]: Connection 'model.spotify_analytics.daily_user_stats' was properly closed.
[0m20:05:50.380465 [debug] [MainThread]: Connection 'model.spotify_analytics.top_tracks' was properly closed.
[0m20:05:50.380740 [debug] [MainThread]: Connection 'model.spotify_analytics.top_artists' was properly closed.
[0m20:05:50.382205 [info ] [MainThread]: 
[0m20:05:50.382584 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 4.15 seconds (4.15s).
[0m20:05:50.384605 [debug] [MainThread]: Command end result
[0m20:05:50.420618 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:05:50.423744 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:05:50.430536 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m20:05:50.430927 [info ] [MainThread]: 
[0m20:05:50.431373 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:05:50.431752 [info ] [MainThread]: 
[0m20:05:50.432769 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m20:05:50.435757 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.0783935, "process_in_blocks": "8", "process_kernel_time": 0.553826, "process_mem_max_rss": "254240", "process_out_blocks": "3168", "process_user_time": 4.554643}
[0m20:05:50.436282 [debug] [MainThread]: Command `dbt run` succeeded at 20:05:50.436192 after 6.08 seconds
[0m20:05:50.436695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cca6de910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cb41e5050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc5eec210>]}
[0m20:05:50.437118 [debug] [MainThread]: Flushing usage events
[0m20:05:50.543685 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:05:55.554498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768116936510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76811685c750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76811685c850>]}


============================== 20:05:55.564491 | ad05e149-b21b-412a-a8be-c3d23ee88393 ==============================
[0m20:05:55.564491 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:05:55.565592 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'write_json': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/opt/airflow/dbt', 'introspect': 'True', 'partial_parse': 'True', 'quiet': 'False', 'no_print': 'None', 'debug': 'False', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'empty': 'None', 'use_colors': 'True', 'invocation_command': 'dbt test', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True'}
[0m20:05:56.650247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad05e149-b21b-412a-a8be-c3d23ee88393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768110d3d5d0>]}
[0m20:05:56.731216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad05e149-b21b-412a-a8be-c3d23ee88393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7681179257d0>]}
[0m20:05:56.732171 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:05:56.959695 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:05:57.128684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:05:57.129213 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:05:57.136563 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m20:05:57.199357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad05e149-b21b-412a-a8be-c3d23ee88393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768101265590>]}
[0m20:05:57.313503 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:05:57.316799 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:05:57.357980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad05e149-b21b-412a-a8be-c3d23ee88393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768100f23a90>]}
[0m20:05:57.358598 [info ] [MainThread]: Found 5 models, 43 data tests, 1 source, 604 macros
[0m20:05:57.359476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad05e149-b21b-412a-a8be-c3d23ee88393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768101298390>]}
[0m20:05:57.364742 [info ] [MainThread]: 
[0m20:05:57.369188 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:05:57.369536 [info ] [MainThread]: 
[0m20:05:57.372617 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:05:57.388175 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m20:05:57.391809 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m20:05:57.437375 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m20:05:57.442976 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m20:05:57.443317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:57.442455 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m20:05:57.444244 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m20:05:57.444570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:58.387997 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.942 seconds
[0m20:05:58.394201 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m20:05:58.521453 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.078 seconds
[0m20:05:58.524096 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m20:05:58.580506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad05e149-b21b-412a-a8be-c3d23ee88393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768100eec110>]}
[0m20:05:58.586675 [debug] [Thread-1 (]: Began running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m20:05:58.589333 [info ] [Thread-1 (]: 1 of 43 START test dbt_utils_accepted_range_silver_plays_duration_ms__600000__1  [RUN]
[0m20:05:58.587252 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:05:58.591171 [info ] [Thread-2 (]: 2 of 43 START test not_null_daily_user_stats_avg_track_duration_ms ............. [RUN]
[0m20:05:58.587624 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:05:58.592341 [info ] [Thread-3 (]: 3 of 43 START test not_null_daily_user_stats_date .............................. [RUN]
[0m20:05:58.592838 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9'
[0m20:05:58.593228 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:05:58.587973 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:05:58.601405 [info ] [Thread-4 (]: 4 of 43 START test not_null_daily_user_stats_total_listening_time_ms ........... [RUN]
[0m20:05:58.589829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39)
[0m20:05:58.612462 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m20:05:58.591678 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155)
[0m20:05:58.627266 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:05:58.611844 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87'
[0m20:05:58.644750 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:05:58.639461 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m20:05:58.643180 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m20:05:58.651291 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:05:58.644269 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m20:05:58.657402 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:05:58.648844 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m20:05:58.649527 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m20:05:58.685701 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:05:58.724296 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m20:05:58.731074 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m20:05:58.728562 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m20:05:58.733099 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m20:05:58.730044 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m20:05:58.735714 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m20:05:58.732163 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m20:05:58.736576 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_track_duration_ms
from spotify_data.gold.daily_user_stats
where avg_track_duration_ms is null



  
  
      
    ) dbt_internal_test
[0m20:05:58.736954 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:05:58.733503 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.daily_user_stats
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m20:05:58.738419 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:05:58.736131 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from spotify_data.gold.daily_user_stats
where date is null



  
  
      
    ) dbt_internal_test
[0m20:05:58.740087 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:05:58.734872 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m20:05:58.742775 [debug] [Thread-1 (]: On test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from spotify_data.silver.silver_plays
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not duration_ms >= 1
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not duration_ms <= 600000
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:05:58.743248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:59.428496 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.691 seconds
[0m20:05:59.429447 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.691 seconds
[0m20:05:59.444193 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155: Close
[0m20:05:59.446467 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87: Close
[0m20:05:59.445740 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.702 seconds
[0m20:05:59.451677 [debug] [Thread-1 (]: On test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39: Close
[0m20:05:59.483381 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.743 seconds
[0m20:05:59.486542 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9: Close
[0m20:05:59.498640 [info ] [Thread-1 (]: 1 of 43 PASS dbt_utils_accepted_range_silver_plays_duration_ms__600000__1 ...... [[32mPASS[0m in 0.91s]
[0m20:05:59.499911 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m20:05:59.501157 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:05:59.502182 [info ] [Thread-1 (]: 5 of 43 START test not_null_daily_user_stats_total_plays ....................... [RUN]
[0m20:05:59.503395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39, now test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282)
[0m20:05:59.503830 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:05:59.509834 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m20:05:59.510481 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:05:59.513911 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m20:05:59.514824 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m20:05:59.516997 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.daily_user_stats
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m20:05:59.517471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:59.522036 [info ] [Thread-4 (]: 4 of 43 PASS not_null_daily_user_stats_total_listening_time_ms ................. [[32mPASS[0m in 0.92s]
[0m20:05:59.528373 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:05:59.528822 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:05:59.532760 [info ] [Thread-4 (]: 6 of 43 START test not_null_daily_user_stats_unique_artists .................... [RUN]
[0m20:05:59.533448 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87, now test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f)
[0m20:05:59.522882 [info ] [Thread-2 (]: 2 of 43 PASS not_null_daily_user_stats_avg_track_duration_ms ................... [[32mPASS[0m in 0.93s]
[0m20:05:59.535599 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:05:59.537692 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:05:59.533838 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:05:59.545286 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m20:05:59.547980 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:05:59.540754 [info ] [Thread-2 (]: 7 of 43 START test not_null_daily_user_stats_unique_tracks ..................... [RUN]
[0m20:05:59.551222 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155, now test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac)
[0m20:05:59.551597 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:05:59.550720 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m20:05:59.558026 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m20:05:59.566349 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:05:59.562207 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m20:05:59.571832 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m20:05:59.575944 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unique_artists
from spotify_data.gold.daily_user_stats
where unique_artists is null



  
  
      
    ) dbt_internal_test
[0m20:05:59.574390 [info ] [Thread-3 (]: 3 of 43 PASS not_null_daily_user_stats_date .................................... [[32mPASS[0m in 0.98s]
[0m20:05:59.589974 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:05:59.579142 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m20:05:59.591181 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unique_tracks
from spotify_data.gold.daily_user_stats
where unique_tracks is null



  
  
      
    ) dbt_internal_test
[0m20:05:59.591581 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:05:59.587652 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:05:59.590509 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:05:59.599424 [info ] [Thread-3 (]: 8 of 43 START test not_null_daily_user_stats_user_id ........................... [RUN]
[0m20:05:59.600714 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9, now test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b)
[0m20:05:59.622170 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:05:59.641417 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m20:05:59.643515 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:05:59.660456 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m20:05:59.662695 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m20:05:59.674049 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from spotify_data.gold.daily_user_stats
where user_id is null



  
  
      
    ) dbt_internal_test
[0m20:05:59.686605 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:06:00.342030 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.824 seconds
[0m20:06:00.344156 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282: Close
[0m20:06:00.346237 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.755 seconds
[0m20:06:00.350239 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac: Close
[0m20:06:00.394796 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.807 seconds
[0m20:06:00.397493 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f: Close
[0m20:06:00.435491 [info ] [Thread-1 (]: 5 of 43 PASS not_null_daily_user_stats_total_plays ............................. [[32mPASS[0m in 0.93s]
[0m20:06:00.436632 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:06:00.437148 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:06:00.438070 [info ] [Thread-1 (]: 9 of 43 START test not_null_device_usage_avg_track_duration_ms ................. [RUN]
[0m20:06:00.442609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282, now test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003)
[0m20:06:00.443085 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:06:00.447884 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m20:06:00.448638 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:06:00.451410 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m20:06:00.452547 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m20:06:00.453010 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_track_duration_ms
from spotify_data.gold.device_usage
where avg_track_duration_ms is null



  
  
      
    ) dbt_internal_test
[0m20:06:00.453462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:00.480629 [info ] [Thread-2 (]: 7 of 43 PASS not_null_daily_user_stats_unique_tracks ........................... [[32mPASS[0m in 0.93s]
[0m20:06:00.486776 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:06:00.495184 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:06:00.501242 [info ] [Thread-2 (]: 10 of 43 START test not_null_device_usage_device_type .......................... [RUN]
[0m20:06:00.493342 [info ] [Thread-4 (]: 6 of 43 PASS not_null_daily_user_stats_unique_artists .......................... [[32mPASS[0m in 0.96s]
[0m20:06:00.505160 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:06:00.504357 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac, now test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c)
[0m20:06:00.507296 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:06:00.505716 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:06:00.513799 [info ] [Thread-4 (]: 11 of 43 START test not_null_device_usage_play_percentage ...................... [RUN]
[0m20:06:00.514616 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f, now test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2)
[0m20:06:00.518032 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:06:00.528431 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m20:06:00.530349 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:06:00.538242 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m20:06:00.541608 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m20:06:00.545126 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:06:00.544400 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m20:06:00.551530 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select device_type
from spotify_data.gold.device_usage
where device_type is null



  
  
      
    ) dbt_internal_test
[0m20:06:00.551956 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:06:00.551068 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m20:06:00.554730 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m20:06:00.556037 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select play_percentage
from spotify_data.gold.device_usage
where play_percentage is null



  
  
      
    ) dbt_internal_test
[0m20:06:00.556421 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:06:01.115869 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.559 seconds
[0m20:06:01.118208 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2: Close
[0m20:06:01.137439 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.451 seconds
[0m20:06:01.139225 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b: Close
[0m20:06:01.187527 [info ] [Thread-4 (]: 11 of 43 PASS not_null_device_usage_play_percentage ............................ [[32mPASS[0m in 0.67s]
[0m20:06:01.188664 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:06:01.189650 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:06:01.190214 [info ] [Thread-4 (]: 12 of 43 START test not_null_device_usage_total_listening_time_ms .............. [RUN]
[0m20:06:01.190683 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2, now test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2)
[0m20:06:01.191102 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:06:01.196357 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m20:06:01.196979 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:06:01.199866 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m20:06:01.200749 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m20:06:01.201597 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.device_usage
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m20:06:01.201993 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:06:01.226906 [info ] [Thread-3 (]: 8 of 43 PASS not_null_daily_user_stats_user_id ................................. [[32mPASS[0m in 1.63s]
[0m20:06:01.234098 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:06:01.244425 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:06:01.248376 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.696 seconds
[0m20:06:01.251353 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.798 seconds
[0m20:06:01.245442 [info ] [Thread-3 (]: 13 of 43 START test not_null_device_usage_total_plays .......................... [RUN]
[0m20:06:01.264939 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b, now test.spotify_analytics.not_null_device_usage_total_plays.90a295df48)
[0m20:06:01.265414 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:06:01.264103 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003: Close
[0m20:06:01.257214 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c: Close
[0m20:06:01.282896 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m20:06:01.285248 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:06:01.292397 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m20:06:01.295533 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m20:06:01.297322 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_device_usage_total_plays.90a295df48: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.device_usage
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m20:06:01.297820 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:06:01.382988 [info ] [Thread-1 (]: 9 of 43 PASS not_null_device_usage_avg_track_duration_ms ....................... [[32mPASS[0m in 0.94s]
[0m20:06:01.386216 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:06:01.386672 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m20:06:01.389077 [info ] [Thread-1 (]: 14 of 43 START test not_null_silver_plays_artist_name .......................... [RUN]
[0m20:06:01.389602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003, now test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad)
[0m20:06:01.394077 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m20:06:01.403070 [info ] [Thread-2 (]: 10 of 43 PASS not_null_device_usage_device_type ................................ [[32mPASS[0m in 0.90s]
[0m20:06:01.413310 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:06:01.421995 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m20:06:01.411421 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m20:06:01.425836 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m20:06:01.424043 [info ] [Thread-2 (]: 15 of 43 START test not_null_silver_plays_duration_ms .......................... [RUN]
[0m20:06:01.434358 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c, now test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076)
[0m20:06:01.434877 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m20:06:01.450717 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m20:06:01.451789 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m20:06:01.453021 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m20:06:01.455340 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m20:06:01.453684 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select artist_name
from spotify_data.silver.silver_plays
where artist_name is null



  
  
      
    ) dbt_internal_test
[0m20:06:01.461372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:01.460786 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m20:06:01.465256 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m20:06:01.473084 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select duration_ms
from spotify_data.silver.silver_plays
where duration_ms is null



  
  
      
    ) dbt_internal_test
[0m20:06:01.473538 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:06:01.813756 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.612 seconds
[0m20:06:01.817110 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2: Close
[0m20:06:01.922351 [info ] [Thread-4 (]: 12 of 43 PASS not_null_device_usage_total_listening_time_ms .................... [[32mPASS[0m in 0.73s]
[0m20:06:01.924298 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:06:01.924832 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m20:06:01.925307 [info ] [Thread-4 (]: 16 of 43 START test not_null_silver_plays_event_id ............................. [RUN]
[0m20:06:01.926380 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2, now test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd)
[0m20:06:01.926797 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m20:06:01.932384 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m20:06:01.933045 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m20:06:01.935927 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m20:06:01.936810 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m20:06:01.937228 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from spotify_data.silver.silver_plays
where event_id is null



  
  
      
    ) dbt_internal_test
[0m20:06:01.937662 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:06:02.136280 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.663 seconds
[0m20:06:02.144091 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.846 seconds
[0m20:06:02.152199 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_device_usage_total_plays.90a295df48: Close
[0m20:06:02.148308 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076: Close
[0m20:06:02.240598 [info ] [Thread-2 (]: 15 of 43 PASS not_null_silver_plays_duration_ms ................................ [[32mPASS[0m in 0.81s]
[0m20:06:02.241458 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m20:06:02.242258 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m20:06:02.242727 [info ] [Thread-2 (]: 17 of 43 START test not_null_silver_plays_event_type ........................... [RUN]
[0m20:06:02.244348 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076, now test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa)
[0m20:06:02.244756 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m20:06:02.249285 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m20:06:02.251891 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m20:06:02.255910 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m20:06:02.257243 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m20:06:02.257705 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_type
from spotify_data.silver.silver_plays
where event_type is null



  
  
      
    ) dbt_internal_test
[0m20:06:02.258099 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:06:02.322210 [info ] [Thread-3 (]: 13 of 43 PASS not_null_device_usage_total_plays ................................ [[32mPASS[0m in 1.06s]
[0m20:06:02.325125 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:06:02.327021 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m20:06:02.327549 [info ] [Thread-3 (]: 18 of 43 START test not_null_silver_plays_played_at ............................ [RUN]
[0m20:06:02.328278 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_plays.90a295df48, now test.spotify_analytics.not_null_silver_plays_played_at.8281565f95)
[0m20:06:02.328656 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m20:06:02.338657 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m20:06:02.339338 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m20:06:02.345488 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m20:06:02.347761 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m20:06:02.349227 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_played_at.8281565f95: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select played_at
from spotify_data.silver.silver_plays
where played_at is null



  
  
      
    ) dbt_internal_test
[0m20:06:02.349592 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:06:02.394476 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.933 seconds
[0m20:06:02.400311 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad: Close
[0m20:06:02.483027 [info ] [Thread-1 (]: 14 of 43 PASS not_null_silver_plays_artist_name ................................ [[32mPASS[0m in 1.09s]
[0m20:06:02.487005 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m20:06:02.487777 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m20:06:02.493646 [info ] [Thread-1 (]: 19 of 43 START test not_null_silver_plays_processed_at ......................... [RUN]
[0m20:06:02.494191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad, now test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed)
[0m20:06:02.494580 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m20:06:02.507389 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m20:06:02.508050 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m20:06:02.511235 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m20:06:02.512240 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m20:06:02.512646 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select processed_at
from spotify_data.silver.silver_plays
where processed_at is null



  
  
      
    ) dbt_internal_test
[0m20:06:02.513525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:02.719122 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.781 seconds
[0m20:06:02.721400 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd: Close
[0m20:06:02.753616 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.495 seconds
[0m20:06:02.756154 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa: Close
[0m20:06:02.801662 [info ] [Thread-2 (]: 17 of 43 PASS not_null_silver_plays_event_type ................................. [[32mPASS[0m in 0.56s]
[0m20:06:02.802792 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m20:06:02.803290 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m20:06:02.803724 [info ] [Thread-2 (]: 20 of 43 START test not_null_silver_plays_track_id ............................. [RUN]
[0m20:06:02.804999 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa, now test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9)
[0m20:06:02.805689 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m20:06:02.810814 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m20:06:02.813942 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m20:06:02.816803 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m20:06:02.813341 [info ] [Thread-4 (]: 16 of 43 PASS not_null_silver_plays_event_id ................................... [[32mPASS[0m in 0.89s]
[0m20:06:02.819295 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m20:06:02.818678 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m20:06:02.820559 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_id
from spotify_data.silver.silver_plays
where track_id is null



  
  
      
    ) dbt_internal_test
[0m20:06:02.820959 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:06:02.820159 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m20:06:02.821998 [info ] [Thread-4 (]: 21 of 43 START test not_null_silver_plays_track_name ........................... [RUN]
[0m20:06:02.822453 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd, now test.spotify_analytics.not_null_silver_plays_track_name.c6334add30)
[0m20:06:02.822825 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m20:06:02.828876 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m20:06:02.833590 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m20:06:02.836823 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m20:06:02.841604 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m20:06:02.844910 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.495 seconds
[0m20:06:02.847221 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_track_name.c6334add30: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_name
from spotify_data.silver.silver_plays
where track_name is null



  
  
      
    ) dbt_internal_test
[0m20:06:02.850125 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:06:02.849617 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_played_at.8281565f95: Close
[0m20:06:03.033022 [info ] [Thread-3 (]: 18 of 43 PASS not_null_silver_plays_played_at .................................. [[32mPASS[0m in 0.70s]
[0m20:06:03.033780 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m20:06:03.040040 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m20:06:03.054349 [info ] [Thread-3 (]: 22 of 43 START test not_null_silver_plays_user_id .............................. [RUN]
[0m20:06:03.058981 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_played_at.8281565f95, now test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4)
[0m20:06:03.059449 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m20:06:03.083139 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.569 seconds
[0m20:06:03.109352 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m20:06:03.101466 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed: Close
[0m20:06:03.120339 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m20:06:03.170838 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m20:06:03.178354 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m20:06:03.180605 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from spotify_data.silver.silver_plays
where user_id is null



  
  
      
    ) dbt_internal_test
[0m20:06:03.187122 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:06:03.230077 [info ] [Thread-1 (]: 19 of 43 PASS not_null_silver_plays_processed_at ............................... [[32mPASS[0m in 0.74s]
[0m20:06:03.234520 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m20:06:03.236632 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:06:03.237075 [info ] [Thread-1 (]: 23 of 43 START test not_null_top_artists_artist_name ........................... [RUN]
[0m20:06:03.270420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed, now test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e)
[0m20:06:03.270951 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:06:03.286160 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m20:06:03.286844 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:06:03.297216 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m20:06:03.303957 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m20:06:03.313613 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select artist_name
from spotify_data.gold.top_artists
where artist_name is null



  
  
      
    ) dbt_internal_test
[0m20:06:03.325617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:03.580395 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.759 seconds
[0m20:06:03.583515 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9: Close
[0m20:06:03.630522 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.780 seconds
[0m20:06:03.632390 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_track_name.c6334add30: Close
[0m20:06:03.679262 [info ] [Thread-2 (]: 20 of 43 PASS not_null_silver_plays_track_id ................................... [[32mPASS[0m in 0.87s]
[0m20:06:03.680805 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m20:06:03.681291 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:06:03.681718 [info ] [Thread-2 (]: 24 of 43 START test not_null_top_artists_first_played_at ....................... [RUN]
[0m20:06:03.682398 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9, now test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14)
[0m20:06:03.682781 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:06:03.688643 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m20:06:03.689271 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:06:03.692929 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m20:06:03.696388 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m20:06:03.696819 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_played_at
from spotify_data.gold.top_artists
where first_played_at is null



  
  
      
    ) dbt_internal_test
[0m20:06:03.695349 [info ] [Thread-4 (]: 21 of 43 PASS not_null_silver_plays_track_name ................................. [[32mPASS[0m in 0.87s]
[0m20:06:03.698945 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m20:06:03.697611 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:06:03.699437 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:06:03.701025 [info ] [Thread-4 (]: 25 of 43 START test not_null_top_artists_last_played_at ........................ [RUN]
[0m20:06:03.701683 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_track_name.c6334add30, now test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca)
[0m20:06:03.705678 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:06:03.710295 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m20:06:03.712755 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:06:03.715963 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m20:06:03.718467 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m20:06:03.718911 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_played_at
from spotify_data.gold.top_artists
where last_played_at is null



  
  
      
    ) dbt_internal_test
[0m20:06:03.732205 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:06:03.816815 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.630 seconds
[0m20:06:03.828715 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4: Close
[0m20:06:03.912411 [info ] [Thread-3 (]: 22 of 43 PASS not_null_silver_plays_user_id .................................... [[32mPASS[0m in 0.86s]
[0m20:06:03.915758 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m20:06:03.918280 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:06:03.918677 [info ] [Thread-3 (]: 26 of 43 START test not_null_top_artists_rank .................................. [RUN]
[0m20:06:03.921969 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4, now test.spotify_analytics.not_null_top_artists_rank.d14513fc96)
[0m20:06:03.926956 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:06:03.936979 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m20:06:03.938285 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:06:03.942475 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m20:06:03.944316 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m20:06:03.944765 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_rank.d14513fc96: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rank
from spotify_data.gold.top_artists
where rank is null



  
  
      
    ) dbt_internal_test
[0m20:06:03.945182 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:06:04.087773 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.762 seconds
[0m20:06:04.090159 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e: Close
[0m20:06:04.159106 [info ] [Thread-1 (]: 23 of 43 PASS not_null_top_artists_artist_name ................................. [[32mPASS[0m in 0.89s]
[0m20:06:04.161005 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:06:04.161486 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:06:04.161966 [info ] [Thread-1 (]: 27 of 43 START test not_null_top_artists_total_listening_time_ms ............... [RUN]
[0m20:06:04.162408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e, now test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c)
[0m20:06:04.162780 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:06:04.169451 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m20:06:04.170086 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:06:04.172722 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m20:06:04.173607 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m20:06:04.174454 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.top_artists
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m20:06:04.174878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:04.302904 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.605 seconds
[0m20:06:04.306418 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14: Close
[0m20:06:04.324143 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.592 seconds
[0m20:06:04.328321 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca: Close
[0m20:06:04.423345 [info ] [Thread-4 (]: 25 of 43 PASS not_null_top_artists_last_played_at .............................. [[32mPASS[0m in 0.72s]
[0m20:06:04.427144 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:06:04.427617 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:06:04.426470 [info ] [Thread-2 (]: 24 of 43 PASS not_null_top_artists_first_played_at ............................. [[32mPASS[0m in 0.74s]
[0m20:06:04.428445 [info ] [Thread-4 (]: 28 of 43 START test not_null_top_artists_total_plays ........................... [RUN]
[0m20:06:04.432020 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca, now test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11)
[0m20:06:04.432443 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:06:04.430602 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:06:04.438569 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:06:04.443989 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m20:06:04.447451 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:06:04.451844 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m20:06:04.442740 [info ] [Thread-2 (]: 29 of 43 START test not_null_top_artists_unique_tracks ......................... [RUN]
[0m20:06:04.455306 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14, now test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13)
[0m20:06:04.455742 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:06:04.454566 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m20:06:04.463406 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.top_artists
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m20:06:04.463973 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:06:04.465923 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m20:06:04.471364 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:06:04.473974 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m20:06:04.475641 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.530 seconds
[0m20:06:04.477995 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m20:06:04.481703 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unique_tracks
from spotify_data.gold.top_artists
where unique_tracks is null



  
  
      
    ) dbt_internal_test
[0m20:06:04.484808 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:06:04.481268 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_rank.d14513fc96: Close
[0m20:06:04.607226 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.432 seconds
[0m20:06:04.619077 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c: Close
[0m20:06:04.629060 [info ] [Thread-3 (]: 26 of 43 PASS not_null_top_artists_rank ........................................ [[32mPASS[0m in 0.71s]
[0m20:06:04.633689 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:06:04.636038 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:06:04.636946 [info ] [Thread-3 (]: 30 of 43 START test not_null_top_tracks_artist_name ............................ [RUN]
[0m20:06:04.639233 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_rank.d14513fc96, now test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461)
[0m20:06:04.639672 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:06:04.648082 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m20:06:04.653134 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:06:04.660021 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m20:06:04.666066 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m20:06:04.666487 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select artist_name
from spotify_data.gold.top_tracks
where artist_name is null



  
  
      
    ) dbt_internal_test
[0m20:06:04.668410 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:06:04.706287 [info ] [Thread-1 (]: 27 of 43 PASS not_null_top_artists_total_listening_time_ms ..................... [[32mPASS[0m in 0.54s]
[0m20:06:04.712482 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:06:04.714408 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:06:04.718330 [info ] [Thread-1 (]: 31 of 43 START test not_null_top_tracks_first_played_at ........................ [RUN]
[0m20:06:04.724075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c, now test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31)
[0m20:06:04.724506 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:06:04.745147 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m20:06:04.745788 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:06:04.748389 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m20:06:04.754920 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m20:06:04.755358 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_played_at
from spotify_data.gold.top_tracks
where first_played_at is null



  
  
      
    ) dbt_internal_test
[0m20:06:04.772303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:05.137139 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.652 seconds
[0m20:06:05.139327 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13: Close
[0m20:06:05.178208 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.714 seconds
[0m20:06:05.180797 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11: Close
[0m20:06:05.207385 [info ] [Thread-2 (]: 29 of 43 PASS not_null_top_artists_unique_tracks ............................... [[32mPASS[0m in 0.75s]
[0m20:06:05.208712 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:06:05.209955 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:06:05.210655 [info ] [Thread-2 (]: 32 of 43 START test not_null_top_tracks_last_played_at ......................... [RUN]
[0m20:06:05.211391 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13, now test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532)
[0m20:06:05.211819 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:06:05.216993 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m20:06:05.219192 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:06:05.221986 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m20:06:05.223287 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m20:06:05.223751 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_played_at
from spotify_data.gold.top_tracks
where last_played_at is null



  
  
      
    ) dbt_internal_test
[0m20:06:05.224141 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:06:05.300610 [info ] [Thread-4 (]: 28 of 43 PASS not_null_top_artists_total_plays ................................. [[32mPASS[0m in 0.87s]
[0m20:06:05.308027 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:06:05.310081 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:06:05.312973 [info ] [Thread-4 (]: 33 of 43 START test not_null_top_tracks_rank ................................... [RUN]
[0m20:06:05.313510 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11, now test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4)
[0m20:06:05.315956 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:06:05.343195 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m20:06:05.347102 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:06:05.353730 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m20:06:05.356372 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m20:06:05.359017 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rank
from spotify_data.gold.top_tracks
where rank is null



  
  
      
    ) dbt_internal_test
[0m20:06:05.361224 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:06:05.377336 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.606 seconds
[0m20:06:05.394871 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31: Close
[0m20:06:05.446523 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.778 seconds
[0m20:06:05.473403 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461: Close
[0m20:06:05.537595 [info ] [Thread-1 (]: 31 of 43 PASS not_null_top_tracks_first_played_at .............................. [[32mPASS[0m in 0.81s]
[0m20:06:05.544694 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:06:05.548280 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:06:05.548719 [info ] [Thread-1 (]: 34 of 43 START test not_null_top_tracks_total_listening_time_ms ................ [RUN]
[0m20:06:05.556424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31, now test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac)
[0m20:06:05.558880 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:06:05.591623 [info ] [Thread-3 (]: 30 of 43 PASS not_null_top_tracks_artist_name .................................. [[32mPASS[0m in 0.95s]
[0m20:06:05.602889 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:06:05.606030 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:06:05.615426 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m20:06:05.609944 [info ] [Thread-3 (]: 35 of 43 START test not_null_top_tracks_total_plays ............................ [RUN]
[0m20:06:05.617279 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461, now test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893)
[0m20:06:05.620684 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:06:05.631085 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:06:05.659787 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m20:06:05.664209 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:06:05.637752 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m20:06:05.676958 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m20:06:05.678403 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m20:06:05.688096 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.top_tracks
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m20:06:05.679802 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m20:06:05.690909 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.top_tracks
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m20:06:05.691365 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:06:05.688514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:06.164777 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.803 seconds
[0m20:06:06.173199 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.949 seconds
[0m20:06:06.175792 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4: Close
[0m20:06:06.177581 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532: Close
[0m20:06:06.222803 [info ] [Thread-4 (]: 33 of 43 PASS not_null_top_tracks_rank ......................................... [[32mPASS[0m in 0.91s]
[0m20:06:06.224532 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:06:06.225032 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:06:06.225482 [info ] [Thread-4 (]: 36 of 43 START test not_null_top_tracks_track_id ............................... [RUN]
[0m20:06:06.226245 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4, now test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78)
[0m20:06:06.226639 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:06:06.231763 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m20:06:06.233333 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:06:06.236149 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m20:06:06.237009 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m20:06:06.237417 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_id
from spotify_data.gold.top_tracks
where track_id is null



  
  
      
    ) dbt_internal_test
[0m20:06:06.237821 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:06:06.268414 [info ] [Thread-2 (]: 32 of 43 PASS not_null_top_tracks_last_played_at ............................... [[32mPASS[0m in 1.06s]
[0m20:06:06.272189 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:06:06.273336 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:06:06.275175 [info ] [Thread-2 (]: 37 of 43 START test not_null_top_tracks_track_name ............................. [RUN]
[0m20:06:06.276956 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532, now test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203)
[0m20:06:06.277348 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:06:06.298817 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m20:06:06.300952 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:06:06.308881 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m20:06:06.318174 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m20:06:06.318616 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_name
from spotify_data.gold.top_tracks
where track_name is null



  
  
      
    ) dbt_internal_test
[0m20:06:06.320073 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:06:06.424986 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.734 seconds
[0m20:06:06.431411 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac: Close
[0m20:06:06.503915 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.812 seconds
[0m20:06:06.505974 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893: Close
[0m20:06:06.569749 [info ] [Thread-1 (]: 34 of 43 PASS not_null_top_tracks_total_listening_time_ms ...................... [[32mPASS[0m in 1.01s]
[0m20:06:06.570559 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:06:06.571408 [debug] [Thread-1 (]: Began running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:06:06.572369 [info ] [Thread-1 (]: 38 of 43 START test unique_device_usage_device_type ............................ [RUN]
[0m20:06:06.573566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac, now test.spotify_analytics.unique_device_usage_device_type.e75362861b)
[0m20:06:06.574026 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:06:06.583696 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m20:06:06.584403 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:06:06.587101 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m20:06:06.588832 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m20:06:06.589317 [debug] [Thread-1 (]: On test.spotify_analytics.unique_device_usage_device_type.e75362861b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_device_usage_device_type.e75362861b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    device_type as unique_field,
    count(*) as n_records

from spotify_data.gold.device_usage
where device_type is not null
group by device_type
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:06:06.589707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:06.605918 [info ] [Thread-3 (]: 35 of 43 PASS not_null_top_tracks_total_plays .................................. [[32mPASS[0m in 0.99s]
[0m20:06:06.608844 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:06:06.613350 [debug] [Thread-3 (]: Began running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m20:06:06.613962 [info ] [Thread-3 (]: 39 of 43 START test unique_silver_plays_event_id ............................... [RUN]
[0m20:06:06.615270 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893, now test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf)
[0m20:06:06.615722 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m20:06:06.627805 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m20:06:06.630511 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m20:06:06.636157 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m20:06:06.639566 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m20:06:06.640229 [debug] [Thread-3 (]: On test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from spotify_data.silver.silver_plays
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:06:06.640640 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:06:06.716002 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.396 seconds
[0m20:06:06.722347 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203: Close
[0m20:06:06.825895 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.588 seconds
[0m20:06:06.830648 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78: Close
[0m20:06:06.869629 [info ] [Thread-2 (]: 37 of 43 PASS not_null_top_tracks_track_name ................................... [[32mPASS[0m in 0.59s]
[0m20:06:06.874356 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:06:06.875157 [debug] [Thread-2 (]: Began running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:06:06.876167 [info ] [Thread-2 (]: 40 of 43 START test unique_top_artists_artist_name ............................. [RUN]
[0m20:06:06.877137 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203, now test.spotify_analytics.unique_top_artists_artist_name.008ffa1533)
[0m20:06:06.878542 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:06:06.884096 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m20:06:06.885236 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:06:06.887998 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m20:06:06.889673 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m20:06:06.890175 [debug] [Thread-2 (]: On test.spotify_analytics.unique_top_artists_artist_name.008ffa1533: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    artist_name as unique_field,
    count(*) as n_records

from spotify_data.gold.top_artists
where artist_name is not null
group by artist_name
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:06:06.890992 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:06:06.936249 [info ] [Thread-4 (]: 36 of 43 PASS not_null_top_tracks_track_id ..................................... [[32mPASS[0m in 0.71s]
[0m20:06:06.943481 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:06:06.948533 [debug] [Thread-4 (]: Began running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:06:06.951038 [info ] [Thread-4 (]: 41 of 43 START test unique_top_artists_rank .................................... [RUN]
[0m20:06:06.951746 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78, now test.spotify_analytics.unique_top_artists_rank.68b5480aed)
[0m20:06:06.953227 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:06:06.965335 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m20:06:06.967641 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:06:06.973991 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m20:06:06.975803 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m20:06:06.976229 [debug] [Thread-4 (]: On test.spotify_analytics.unique_top_artists_rank.68b5480aed: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_artists_rank.68b5480aed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rank as unique_field,
    count(*) as n_records

from spotify_data.gold.top_artists
where rank is not null
group by rank
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:06:06.979523 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:06:07.511807 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.621 seconds
[0m20:06:07.513769 [debug] [Thread-2 (]: On test.spotify_analytics.unique_top_artists_artist_name.008ffa1533: Close
[0m20:06:07.537017 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.947 seconds
[0m20:06:07.539729 [debug] [Thread-1 (]: On test.spotify_analytics.unique_device_usage_device_type.e75362861b: Close
[0m20:06:07.547117 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.906 seconds
[0m20:06:07.549483 [debug] [Thread-3 (]: On test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf: Close
[0m20:06:07.590905 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.611 seconds
[0m20:06:07.592818 [debug] [Thread-4 (]: On test.spotify_analytics.unique_top_artists_rank.68b5480aed: Close
[0m20:06:07.633589 [info ] [Thread-2 (]: 40 of 43 PASS unique_top_artists_artist_name ................................... [[32mPASS[0m in 0.76s]
[0m20:06:07.638921 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:06:07.635699 [info ] [Thread-1 (]: 38 of 43 PASS unique_device_usage_device_type .................................. [[32mPASS[0m in 1.06s]
[0m20:06:07.644463 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:06:07.638268 [info ] [Thread-4 (]: 41 of 43 PASS unique_top_artists_rank .......................................... [[32mPASS[0m in 0.69s]
[0m20:06:07.645597 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:06:07.645026 [debug] [Thread-1 (]: Began running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:06:07.646152 [info ] [Thread-1 (]: 43 of 43 START test unique_top_tracks_track_id ................................. [RUN]
[0m20:06:07.643738 [debug] [Thread-2 (]: Began running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:06:07.648543 [info ] [Thread-2 (]: 42 of 43 START test unique_top_tracks_rank ..................................... [RUN]
[0m20:06:07.647965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_device_usage_device_type.e75362861b, now test.spotify_analytics.unique_top_tracks_track_id.865b43a659)
[0m20:06:07.651821 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:06:07.649066 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_top_artists_artist_name.008ffa1533, now test.spotify_analytics.unique_top_tracks_rank.8fecde1136)
[0m20:06:07.656931 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m20:06:07.657533 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:06:07.659056 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:06:07.663624 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m20:06:07.670544 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:06:07.669445 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m20:06:07.673162 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m20:06:07.675687 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m20:06:07.678346 [debug] [Thread-1 (]: On test.spotify_analytics.unique_top_tracks_track_id.865b43a659: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    track_id as unique_field,
    count(*) as n_records

from spotify_data.gold.top_tracks
where track_id is not null
group by track_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:06:07.678738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:07.674731 [info ] [Thread-3 (]: 39 of 43 PASS unique_silver_plays_event_id ..................................... [[32mPASS[0m in 1.06s]
[0m20:06:07.680150 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m20:06:07.677895 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m20:06:07.680595 [debug] [Thread-2 (]: On test.spotify_analytics.unique_top_tracks_rank.8fecde1136: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rank as unique_field,
    count(*) as n_records

from spotify_data.gold.top_tracks
where rank is not null
group by rank
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:06:07.681567 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:06:08.248983 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.567 seconds
[0m20:06:08.251732 [debug] [Thread-2 (]: On test.spotify_analytics.unique_top_tracks_rank.8fecde1136: Close
[0m20:06:08.308436 [info ] [Thread-2 (]: 42 of 43 PASS unique_top_tracks_rank ........................................... [[32mPASS[0m in 0.66s]
[0m20:06:08.309763 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:06:08.317393 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.639 seconds
[0m20:06:08.320783 [debug] [Thread-1 (]: On test.spotify_analytics.unique_top_tracks_track_id.865b43a659: Close
[0m20:06:08.379453 [info ] [Thread-1 (]: 43 of 43 PASS unique_top_tracks_track_id ....................................... [[32mPASS[0m in 0.73s]
[0m20:06:08.380649 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:06:08.383434 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:06:08.384458 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_rank.8fecde1136' was properly closed.
[0m20:06:08.384792 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_track_id.865b43a659' was properly closed.
[0m20:06:08.385194 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf' was properly closed.
[0m20:06:08.385479 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_artists_rank.68b5480aed' was properly closed.
[0m20:06:08.385890 [info ] [MainThread]: 
[0m20:06:08.386616 [info ] [MainThread]: Finished running 43 data tests in 0 hours 0 minutes and 11.02 seconds (11.02s).
[0m20:06:08.394800 [debug] [MainThread]: Command end result
[0m20:06:08.432373 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:06:08.434714 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:06:08.454502 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m20:06:08.455642 [info ] [MainThread]: 
[0m20:06:08.456618 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:06:08.457325 [info ] [MainThread]: 
[0m20:06:08.458000 [info ] [MainThread]: Done. PASS=43 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=43
[0m20:06:08.460307 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 12.970161, "process_in_blocks": "16", "process_kernel_time": 0.918842, "process_mem_max_rss": "262184", "process_out_blocks": "4048", "process_user_time": 9.552567}
[0m20:06:08.460894 [debug] [MainThread]: Command `dbt test` succeeded at 20:06:08.460751 after 12.97 seconds
[0m20:06:08.461351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7681167ebfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7681167ebf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7681167ebe90>]}
[0m20:06:08.461806 [debug] [MainThread]: Flushing usage events
[0m20:06:08.567172 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:05:26.142500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726f5ded24d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726f5df30a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726f5df30ad0>]}


============================== 21:05:26.154276 | ffd1d8c9-8c2e-4f3b-a8ca-c794ea8f93b9 ==============================
[0m21:05:26.154276 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:05:26.155322 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'warn_error': 'None', 'invocation_command': 'dbt compile', 'log_cache_events': 'False', 'target_path': 'None', 'quiet': 'False', 'debug': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'no_print': 'None', 'partial_parse': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'log_path': '/opt/airflow/dbt/logs', 'use_colors': 'True', 'log_format': 'default'}
[0m21:05:27.683713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffd1d8c9-8c2e-4f3b-a8ca-c794ea8f93b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726f60810a50>]}
[0m21:05:27.764078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ffd1d8c9-8c2e-4f3b-a8ca-c794ea8f93b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726f5efe57d0>]}
[0m21:05:27.765756 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:05:28.043695 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:05:28.414929 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m21:05:28.416116 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/user_listening_profile.sql
[0m21:05:28.416770 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/silver/track_audio_features.sql
[0m21:05:28.667138 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.spotify_analytics.track_audio_features' (models/silver/track_audio_features.sql) depends on a source named 'bronze.track_audio_features' which was not found
[0m21:05:28.671144 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 2.6120718, "process_in_blocks": "81664", "process_kernel_time": 0.597869, "process_mem_max_rss": "225644", "process_out_blocks": "16", "process_user_time": 3.402206}
[0m21:05:28.671970 [debug] [MainThread]: Command `dbt compile` failed at 21:05:28.671828 after 2.61 seconds
[0m21:05:28.672435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726f5ded3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726f4c668b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726f5ded2650>]}
[0m21:05:28.673502 [debug] [MainThread]: Flushing usage events
[0m21:05:28.769819 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:08:53.998463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a07d5cc1210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a07d5cc1750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a07d5cc10d0>]}


============================== 21:08:54.005744 | 4801c0c8-0c41-47c9-bcec-8ebd56e4f5a9 ==============================
[0m21:08:54.005744 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:08:54.006738 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/opt/airflow/dbt', 'write_json': 'True', 'log_format': 'default', 'no_print': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'target_path': 'None', 'version_check': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'printer_width': '80', 'invocation_command': 'dbt compile', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'log_cache_events': 'False', 'debug': 'False', 'partial_parse': 'True'}
[0m21:08:55.090827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4801c0c8-0c41-47c9-bcec-8ebd56e4f5a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a07c4a42d50>]}
[0m21:08:55.169953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4801c0c8-0c41-47c9-bcec-8ebd56e4f5a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a07d6da5910>]}
[0m21:08:55.171475 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:08:55.393364 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:08:55.626999 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m21:08:55.628236 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/track_recommendations.sql
[0m21:08:55.628642 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/user_listening_profile.sql
[0m21:08:55.628995 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/silver/track_audio_features.sql
[0m21:08:55.870763 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.spotify_analytics.track_audio_features' (models/silver/track_audio_features.sql) depends on a source named 'bronze.track_audio_features' which was not found
[0m21:08:55.873615 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 1.9682574, "process_in_blocks": "0", "process_kernel_time": 0.434017, "process_mem_max_rss": "226140", "process_out_blocks": "16", "process_user_time": 3.26803}
[0m21:08:55.874413 [debug] [MainThread]: Command `dbt compile` failed at 21:08:55.874301 after 1.97 seconds
[0m21:08:55.875258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a07d5c6e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a07c4413050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a07d5c6e0d0>]}
[0m21:08:55.875762 [debug] [MainThread]: Flushing usage events
[0m21:08:55.970290 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:13:52.746157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7fd8011150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7fd7fbfed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7fd8010a10>]}


============================== 21:13:52.753375 | 7c48a34c-e1f1-400a-a1c6-fabcec136bce ==============================
[0m21:13:52.753375 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:13:52.754433 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'static_parser': 'True', 'profiles_dir': 'dbt', 'empty': 'False', 'no_print': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'log_path': 'dbt/logs', 'indirect_selection': 'eager', 'warn_error': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'quiet': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt compile --project-dir dbt --profiles-dir dbt', 'debug': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False'}
[0m21:13:53.835959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c48a34c-e1f1-400a-a1c6-fabcec136bce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7fda92fa50>]}
[0m21:13:53.910269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c48a34c-e1f1-400a-a1c6-fabcec136bce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7fd90d9190>]}
[0m21:13:53.911277 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:13:54.149772 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:13:54.332298 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
[0m21:13:54.333813 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/silver/track_audio_features.sql
[0m21:13:54.334236 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/track_recommendations.sql
[0m21:13:54.334558 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/user_listening_profile.sql
[0m21:13:54.335905 [debug] [MainThread]: Partial parsing: updated file: spotify_analytics://models/bronze/sources.yml
[0m21:13:54.786570 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.accepted_range`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m21:13:54.788035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7c48a34c-e1f1-400a-a1c6-fabcec136bce', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7fc28f0ed0>]}
[0m21:13:55.121352 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m21:13:55.135648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c48a34c-e1f1-400a-a1c6-fabcec136bce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7fc2391050>]}
[0m21:13:55.373960 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m21:13:55.377379 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m21:13:55.418052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c48a34c-e1f1-400a-a1c6-fabcec136bce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7fc2bbb490>]}
[0m21:13:55.418696 [info ] [MainThread]: Found 8 models, 43 data tests, 2 sources, 604 macros
[0m21:13:55.419131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c48a34c-e1f1-400a-a1c6-fabcec136bce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7fc237fb50>]}
[0m21:13:55.423042 [info ] [MainThread]: 
[0m21:13:55.424619 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:13:55.425521 [info ] [MainThread]: 
[0m21:13:55.426397 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:13:55.432381 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m21:13:55.433080 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m21:13:55.460834 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m21:13:55.465412 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m21:13:55.465722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:55.465016 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m21:13:55.467220 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m21:13:55.467508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:56.399499 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.932 seconds
[0m21:13:56.401596 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m21:13:56.426444 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.961 seconds
[0m21:13:56.428548 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m21:13:56.479781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c48a34c-e1f1-400a-a1c6-fabcec136bce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7fc2b9b990>]}
[0m21:13:56.488017 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m21:13:56.488508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.silver_plays)
[0m21:13:56.488902 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m21:13:56.489269 [debug] [Thread-2 (]: Began running node model.spotify_analytics.track_audio_features
[0m21:13:56.495125 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.track_audio_features)
[0m21:13:56.495524 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.track_audio_features
[0m21:13:56.489584 [debug] [Thread-3 (]: Began running node model.spotify_analytics.track_recommendations
[0m21:13:56.505670 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.spotify_analytics.track_recommendations'
[0m21:13:56.506050 [debug] [Thread-3 (]: Began compiling node model.spotify_analytics.track_recommendations
[0m21:13:56.504659 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m21:13:56.511157 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m21:13:56.510536 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.track_audio_features"
[0m21:13:56.509122 [debug] [Thread-3 (]: Writing injected SQL for node "model.spotify_analytics.track_recommendations"
[0m21:13:56.511800 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m21:13:56.512875 [debug] [Thread-4 (]: Began running node model.spotify_analytics.daily_user_stats
[0m21:13:56.513321 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.spotify_analytics.daily_user_stats'
[0m21:13:56.513662 [debug] [Thread-4 (]: Began compiling node model.spotify_analytics.daily_user_stats
[0m21:13:56.514068 [debug] [Thread-3 (]: Began executing node model.spotify_analytics.track_recommendations
[0m21:13:56.514371 [debug] [Thread-1 (]: Began running node model.spotify_analytics.device_usage
[0m21:13:56.514700 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.track_audio_features
[0m21:13:56.527413 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.track_audio_features
[0m21:13:56.524944 [debug] [Thread-3 (]: Finished running node model.spotify_analytics.track_recommendations
[0m21:13:56.528706 [debug] [Thread-3 (]: Began running node model.spotify_analytics.top_tracks
[0m21:13:56.529537 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.track_recommendations, now model.spotify_analytics.top_tracks)
[0m21:13:56.526192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.silver_plays, now model.spotify_analytics.device_usage)
[0m21:13:56.523784 [debug] [Thread-4 (]: Writing injected SQL for node "model.spotify_analytics.daily_user_stats"
[0m21:13:56.531691 [debug] [Thread-4 (]: Began executing node model.spotify_analytics.daily_user_stats
[0m21:13:56.527940 [debug] [Thread-2 (]: Began running node model.spotify_analytics.top_artists
[0m21:13:56.533165 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.track_audio_features, now model.spotify_analytics.top_artists)
[0m21:13:56.533528 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.top_artists
[0m21:13:56.529954 [debug] [Thread-3 (]: Began compiling node model.spotify_analytics.top_tracks
[0m21:13:56.530804 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.device_usage
[0m21:13:56.532588 [debug] [Thread-4 (]: Finished running node model.spotify_analytics.daily_user_stats
[0m21:13:56.549098 [debug] [Thread-4 (]: Began running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m21:13:56.549538 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.daily_user_stats, now test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39)
[0m21:13:56.544050 [debug] [Thread-3 (]: Writing injected SQL for node "model.spotify_analytics.top_tracks"
[0m21:13:56.538842 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.top_artists"
[0m21:13:56.552602 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.top_artists
[0m21:13:56.548537 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.device_usage"
[0m21:13:56.549951 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m21:13:56.551646 [debug] [Thread-3 (]: Began executing node model.spotify_analytics.top_tracks
[0m21:13:56.558876 [debug] [Thread-3 (]: Finished running node model.spotify_analytics.top_tracks
[0m21:13:56.553647 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.top_artists
[0m21:13:56.560438 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m21:13:56.560830 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.top_artists, now test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076)
[0m21:13:56.561180 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m21:13:56.558180 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m21:13:56.567899 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m21:13:56.568537 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m21:13:56.559789 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m21:13:56.570445 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.top_tracks, now test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad)
[0m21:13:56.570779 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m21:13:56.569893 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.device_usage
[0m21:13:56.569434 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m21:13:56.584212 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39, now test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd)
[0m21:13:56.584549 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m21:13:56.582886 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.device_usage
[0m21:13:56.589863 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m21:13:56.581580 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m21:13:56.590765 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m21:13:56.591396 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m21:13:56.583364 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m21:13:56.592279 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m21:13:56.589018 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m21:13:56.593807 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m21:13:56.594389 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m21:13:56.590264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.device_usage, now test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa)
[0m21:13:56.595366 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m21:13:56.591798 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m21:13:56.603756 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076, now test.spotify_analytics.not_null_silver_plays_played_at.8281565f95)
[0m21:13:56.604253 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m21:13:56.595026 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m21:13:56.592830 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m21:13:56.612913 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m21:13:56.611882 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd, now test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed)
[0m21:13:56.616671 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m21:13:56.610671 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m21:13:56.616179 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m21:13:56.613570 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad, now test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9)
[0m21:13:56.625154 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m21:13:56.622402 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m21:13:56.624326 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m21:13:56.631514 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m21:13:56.623215 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m21:13:56.632548 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m21:13:56.632925 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m21:13:56.633306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa, now test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4)
[0m21:13:56.633639 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m21:13:56.629841 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m21:13:56.639342 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m21:13:56.630434 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m21:13:56.640888 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m21:13:56.641252 [debug] [Thread-4 (]: Began running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m21:13:56.631929 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m21:13:56.642068 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_played_at.8281565f95, now test.spotify_analytics.not_null_silver_plays_track_name.c6334add30)
[0m21:13:56.642390 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m21:13:56.639969 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m21:13:56.638749 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m21:13:56.648258 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m21:13:56.647723 [debug] [Thread-3 (]: Began running node model.spotify_analytics.user_listening_profile
[0m21:13:56.641675 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed, now test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf)
[0m21:13:56.649622 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m21:13:56.647270 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m21:13:56.648836 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m21:13:56.655906 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m21:13:56.656314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4, now test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155)
[0m21:13:56.656648 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m21:13:56.649231 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9, now model.spotify_analytics.user_listening_profile)
[0m21:13:56.801190 [debug] [Thread-3 (]: Began compiling node model.spotify_analytics.user_listening_profile
[0m21:13:56.660350 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m21:13:56.806841 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m21:13:56.807542 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m21:13:56.657473 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m21:13:56.812836 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m21:13:56.806199 [debug] [Thread-3 (]: Writing injected SQL for node "model.spotify_analytics.user_listening_profile"
[0m21:13:56.815558 [debug] [Thread-3 (]: Began executing node model.spotify_analytics.user_listening_profile
[0m21:13:56.816174 [debug] [Thread-3 (]: Finished running node model.spotify_analytics.user_listening_profile
[0m21:13:56.812233 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m21:13:56.816982 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf, now test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9)
[0m21:13:56.817316 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m21:13:56.811789 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m21:13:56.822631 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m21:13:56.816537 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m21:13:56.823670 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.user_listening_profile, now test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282)
[0m21:13:56.824037 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m21:13:56.813991 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m21:13:56.828954 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_track_name.c6334add30, now test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87)
[0m21:13:56.829305 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m21:13:56.823232 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m21:13:56.833970 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m21:13:56.828507 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m21:13:56.834841 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m21:13:56.822086 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m21:13:56.836410 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m21:13:56.834346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155, now test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f)
[0m21:13:56.837789 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m21:13:56.833532 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m21:13:56.852149 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m21:13:56.835436 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m21:13:56.853482 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m21:13:56.853895 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282, now test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac)
[0m21:13:56.837026 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m21:13:56.856154 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m21:13:56.853045 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m21:13:56.861819 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m21:13:56.854927 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m21:13:56.856695 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9, now test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b)
[0m21:13:56.868079 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m21:13:56.862312 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87, now test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461)
[0m21:13:56.873055 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m21:13:56.860702 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m21:13:56.879469 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m21:13:56.867223 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m21:13:56.880695 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m21:13:56.880193 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m21:13:56.872595 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m21:13:56.882608 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m21:13:56.881281 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m21:13:56.883709 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m21:13:56.884091 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac, now test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532)
[0m21:13:56.884433 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m21:13:56.881708 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m21:13:56.889898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f, now test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31)
[0m21:13:56.890258 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m21:13:56.889497 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m21:13:56.895498 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m21:13:56.896101 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m21:13:56.883233 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m21:13:56.896927 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m21:13:56.888977 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m21:13:56.898214 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m21:13:56.894936 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m21:13:56.899633 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m21:13:56.897281 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b, now test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac)
[0m21:13:56.900609 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m21:13:56.900230 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m21:13:56.905238 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m21:13:56.905599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31, now test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893)
[0m21:13:56.899126 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m21:13:56.906345 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m21:13:56.906683 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532, now test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78)
[0m21:13:56.907028 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m21:13:56.896491 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m21:13:56.905966 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m21:13:56.904811 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m21:13:56.917160 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m21:13:56.911956 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461, now test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4)
[0m21:13:56.911496 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m21:13:56.916623 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m21:13:56.923877 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m21:13:56.918592 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m21:13:56.917728 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m21:13:56.930298 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m21:13:56.924500 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m21:13:56.931243 [debug] [Thread-1 (]: Began running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m21:13:56.923334 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m21:13:56.930739 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac, now test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203)
[0m21:13:56.933291 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m21:13:56.932339 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m21:13:56.931651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893, now test.spotify_analytics.unique_top_tracks_rank.8fecde1136)
[0m21:13:56.940611 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m21:13:56.929677 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m21:13:56.939610 [debug] [Thread-3 (]: Began running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m21:13:56.947691 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78, now test.spotify_analytics.unique_top_tracks_track_id.865b43a659)
[0m21:13:56.948072 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m21:13:56.947191 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m21:13:56.954293 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m21:13:56.946592 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m21:13:56.945431 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m21:13:56.956525 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m21:13:56.957118 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m21:13:56.956051 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m21:13:56.954950 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m21:13:56.958321 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m21:13:56.958663 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203, now test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca)
[0m21:13:56.957915 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m21:13:56.960443 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4, now test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14)
[0m21:13:56.960768 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m21:13:56.957491 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m21:13:56.967487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_top_tracks_rank.8fecde1136, now test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e)
[0m21:13:56.967880 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m21:13:56.959021 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m21:13:56.964697 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m21:13:56.977024 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m21:13:56.967083 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m21:13:56.978624 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m21:13:56.972160 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m21:13:56.979917 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m21:13:56.980482 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m21:13:56.978109 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m21:13:56.976439 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m21:13:56.979352 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m21:13:56.983171 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m21:13:56.983589 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_top_tracks_track_id.865b43a659, now test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11)
[0m21:13:56.981729 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m21:13:56.984325 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14, now test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c)
[0m21:13:56.984653 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m21:13:56.981353 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m21:13:56.989637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e, now test.spotify_analytics.not_null_top_artists_rank.d14513fc96)
[0m21:13:56.990015 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m21:13:56.982639 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m21:13:56.994780 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m21:13:56.995206 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m21:13:56.995573 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca, now test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13)
[0m21:13:56.983948 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m21:13:56.989209 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m21:13:57.003810 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m21:13:57.004628 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m21:13:56.995931 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m21:13:56.994162 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m21:13:57.005526 [debug] [Thread-2 (]: Began running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m21:13:57.022275 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c, now test.spotify_analytics.unique_top_artists_artist_name.008ffa1533)
[0m21:13:57.012768 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m21:13:57.023616 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m21:13:57.024013 [debug] [Thread-1 (]: Began running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m21:13:57.011467 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m21:13:57.024990 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m21:13:57.025580 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m21:13:57.021307 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m21:13:57.022709 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m21:13:57.025964 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m21:13:57.026562 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m21:13:57.033309 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m21:13:57.031284 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m21:13:57.034570 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m21:13:57.024398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_rank.d14513fc96, now test.spotify_analytics.unique_top_artists_rank.68b5480aed)
[0m21:13:57.035553 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m21:13:57.032655 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13, now test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003)
[0m21:13:57.042100 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m21:13:57.035172 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m21:13:57.047194 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m21:13:57.047568 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_top_artists_artist_name.008ffa1533, now test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2)
[0m21:13:57.033697 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m21:13:57.048265 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11, now test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c)
[0m21:13:57.048593 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m21:13:57.047920 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m21:13:57.046730 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m21:13:57.058863 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m21:13:57.059535 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m21:13:57.052644 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m21:13:57.053327 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m21:13:57.061523 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m21:13:57.060002 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m21:13:57.062579 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003, now test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2)
[0m21:13:57.062940 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m21:13:57.058238 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m21:13:57.067703 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m21:13:57.062141 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m21:13:57.068738 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m21:13:57.069130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_top_artists_rank.68b5480aed, now test.spotify_analytics.not_null_device_usage_total_plays.90a295df48)
[0m21:13:57.069459 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m21:13:57.060542 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m21:13:57.074946 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m21:13:57.068316 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m21:13:57.067180 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m21:13:57.076000 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m21:13:57.075385 [debug] [Thread-3 (]: Began running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m21:13:57.077024 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c, now test.spotify_analytics.unique_device_usage_device_type.e75362861b)
[0m21:13:57.076588 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m21:13:57.074284 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m21:13:57.078536 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m21:13:57.077981 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m21:13:57.082479 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m21:13:57.086762 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m21:13:57.088708 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m21:13:57.089578 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m21:13:57.090792 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:13:57.091238 [debug] [MainThread]: Connection 'test.spotify_analytics.not_null_device_usage_total_plays.90a295df48' was properly closed.
[0m21:13:57.091507 [debug] [MainThread]: Connection 'test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2' was properly closed.
[0m21:13:57.091782 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_device_usage_device_type.e75362861b' was properly closed.
[0m21:13:57.093129 [debug] [MainThread]: Connection 'test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2' was properly closed.
[0m21:13:57.101602 [debug] [MainThread]: Command end result
[0m21:13:57.141568 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m21:13:57.145643 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m21:13:57.177968 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt/target/run_results.json
[0m21:13:57.178843 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:13:57.185400 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 4.5170765, "process_in_blocks": "1448", "process_kernel_time": 0.549017, "process_mem_max_rss": "255288", "process_out_blocks": "5176", "process_user_time": 5.110063}
[0m21:13:57.188563 [debug] [MainThread]: Command `dbt compile` succeeded at 21:13:57.188431 after 4.52 seconds
[0m21:13:57.189481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7fd80184d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7fd8018490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7fd801ad90>]}
[0m21:13:57.190425 [debug] [MainThread]: Flushing usage events
[0m21:13:57.285625 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:14:26.065183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789e1d8a4f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789e1d8a5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789e1d8a4c50>]}


============================== 21:14:26.073290 | ce661be9-a149-4e37-a8f2-fab0d9b37bd8 ==============================
[0m21:14:26.073290 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:14:26.074363 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_path': 'dbt/logs', 'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'profiles_dir': 'dbt', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir dbt --profiles-dir dbt --models track_audio_features user_listening_profile track_recommendations', 'no_print': 'None', 'target_path': 'None', 'debug': 'False', 'log_format': 'default', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True'}
[0m21:14:26.074784 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m21:14:26.075992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ce661be9-a149-4e37-a8f2-fab0d9b37bd8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789e1d84e990>]}
[0m21:14:27.206110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce661be9-a149-4e37-a8f2-fab0d9b37bd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789e0c63a510>]}
[0m21:14:27.315435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce661be9-a149-4e37-a8f2-fab0d9b37bd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789e1e978ed0>]}
[0m21:14:27.316792 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:14:27.546332 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:14:27.705998 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:14:27.706834 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:14:27.713758 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m21:14:27.775345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce661be9-a149-4e37-a8f2-fab0d9b37bd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789e0c481110>]}
[0m21:14:27.890017 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m21:14:27.892361 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m21:14:27.919138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce661be9-a149-4e37-a8f2-fab0d9b37bd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789e0c479710>]}
[0m21:14:27.919700 [info ] [MainThread]: Found 8 models, 43 data tests, 2 sources, 604 macros
[0m21:14:27.920120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce661be9-a149-4e37-a8f2-fab0d9b37bd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789e0c288050>]}
[0m21:14:27.923341 [info ] [MainThread]: 
[0m21:14:27.925167 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:14:27.926076 [info ] [MainThread]: 
[0m21:14:27.927209 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:14:27.932494 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m21:14:27.933062 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m21:14:27.965513 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m21:14:27.966801 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m21:14:27.967174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:14:27.966400 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m21:14:27.968153 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m21:14:27.968474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:14:28.879075 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.911 seconds
[0m21:14:28.881520 [debug] [ThreadPool]: On list_spotify_data: Close
[0m21:14:28.897679 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.930 seconds
[0m21:14:28.899099 [debug] [ThreadPool]: On list_spotify_data: Close
[0m21:14:28.939053 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_silver)
[0m21:14:28.945214 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_gold)
[0m21:14:28.956436 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m21:14:28.959895 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m21:14:28.960191 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:14:28.959500 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m21:14:28.960969 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m21:14:28.961268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:14:29.298377 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.337 seconds
[0m21:14:29.300481 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m21:14:29.308185 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.348 seconds
[0m21:14:29.309912 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m21:14:29.359962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce661be9-a149-4e37-a8f2-fab0d9b37bd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789e07f2d850>]}
[0m21:14:29.364643 [debug] [Thread-1 (]: Began running node model.spotify_analytics.track_audio_features
[0m21:14:29.365470 [debug] [Thread-2 (]: Began running node model.spotify_analytics.track_recommendations
[0m21:14:29.365998 [info ] [Thread-1 (]: 1 of 3 START sql table model silver.track_audio_features ....................... [RUN]
[0m21:14:29.367132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.track_audio_features)
[0m21:14:29.367515 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.track_audio_features
[0m21:14:29.366641 [info ] [Thread-2 (]: 2 of 3 START sql table model gold.track_recommendations ........................ [RUN]
[0m21:14:29.374144 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.track_recommendations)
[0m21:14:29.374650 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.track_recommendations
[0m21:14:29.379623 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.track_audio_features"
[0m21:14:29.382956 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.track_recommendations"
[0m21:14:29.384002 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.track_audio_features
[0m21:14:29.384986 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.track_recommendations
[0m21:14:29.481616 [debug] [Thread-2 (]: Writing runtime sql for node "model.spotify_analytics.track_recommendations"
[0m21:14:29.482760 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.track_audio_features"
[0m21:14:29.485091 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.track_audio_features"
[0m21:14:29.486880 [debug] [Thread-1 (]: On model.spotify_analytics.track_audio_features: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.track_audio_features"} */
create or replace transient table spotify_data.silver.track_audio_features
         as
        (

/*
    Track Audio Features - Silver Layer
    
    Combines track metadata from plays with audio features from Spotify API
    This is a clean, deduplicated view of all tracks with their audio characteristics
*/

SELECT 
    af.track_id,
    af.danceability,
    af.energy,
    af.key,
    af.loudness,
    af.mode,
    af.speechiness,
    af.acousticness,
    af.instrumentalness,
    af.liveness,
    af.valence,
    af.tempo,
    af.duration_ms,
    af.time_signature,
    af.fetched_at
FROM spotify_data.bronze.track_audio_features af
WHERE af.track_id IS NOT NULL
        );
[0m21:14:29.487332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:14:29.486410 [debug] [Thread-2 (]: Using snowflake connection "model.spotify_analytics.track_recommendations"
[0m21:14:29.489269 [debug] [Thread-2 (]: On model.spotify_analytics.track_recommendations: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.track_recommendations"} */
create or replace transient table spotify_data.gold.track_recommendations
         as
        (

/*
    Track Recommendations - Gold Layer
    
    This table is populated by the generate_recommendations.py script
    DBT just ensures the structure exists - Python script fills the data
*/

-- This creates an empty table with the correct schema
-- The Python script will TRUNCATE and INSERT recommendations
SELECT 
    CAST(NULL AS VARCHAR(255)) as track_id,
    CAST(NULL AS VARCHAR(500)) as track_name,
    CAST(NULL AS VARCHAR(500)) as artist_name,
    CAST(NULL AS VARCHAR(500)) as album_name,
    CAST(NULL AS FLOAT) as similarity_score,
    CAST(NULL AS FLOAT) as danceability,
    CAST(NULL AS FLOAT) as energy,
    CAST(NULL AS FLOAT) as valence,
    CAST(NULL AS FLOAT) as tempo,
    CAST(NULL AS FLOAT) as acousticness,
    CAST(NULL AS FLOAT) as instrumentalness,
    CAST(NULL AS FLOAT) as speechiness,
    CAST(NULL AS FLOAT) as loudness,
    CAST(NULL AS TIMESTAMP_NTZ) as recommended_at,
    CAST(NULL AS INTEGER) as rank
WHERE 1=0  -- Empty table, just schema
        );
[0m21:14:29.491178 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:14:29.807803 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c0fc9a-0004-1445-000a-68a20006d4ea
[0m21:14:29.808544 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
[0m21:14:29.809147 [debug] [Thread-1 (]: On model.spotify_analytics.track_audio_features: Close
[0m21:14:29.861780 [debug] [Thread-1 (]: Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql
[0m21:14:29.864165 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce661be9-a149-4e37-a8f2-fab0d9b37bd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789e042d3b10>]}
[0m21:14:29.864952 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model silver.track_audio_features .............. [[31mERROR[0m in 0.50s]
[0m21:14:29.865514 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.track_audio_features
[0m21:14:29.866068 [debug] [Thread-7 (]: Marking all children of 'model.spotify_analytics.track_audio_features' to be skipped because of status 'error'.  Reason: Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql.
[0m21:14:29.868595 [debug] [Thread-4 (]: Began running node model.spotify_analytics.user_listening_profile
[0m21:14:29.869348 [info ] [Thread-4 (]: 3 of 3 SKIP relation gold.user_listening_profile ............................... [[33mSKIP[0m]
[0m21:14:29.870296 [debug] [Thread-4 (]: Finished running node model.spotify_analytics.user_listening_profile
[0m21:14:30.589602 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.098 seconds
[0m21:14:30.619231 [debug] [Thread-2 (]: On model.spotify_analytics.track_recommendations: Close
[0m21:14:30.659041 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce661be9-a149-4e37-a8f2-fab0d9b37bd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789de45b88d0>]}
[0m21:14:30.659804 [info ] [Thread-2 (]: 2 of 3 OK created sql table model gold.track_recommendations ................... [[32mSUCCESS 1[0m in 1.28s]
[0m21:14:30.661578 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.track_recommendations
[0m21:14:30.663642 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:14:30.663998 [debug] [MainThread]: Connection 'model.spotify_analytics.track_audio_features' was properly closed.
[0m21:14:30.664271 [debug] [MainThread]: Connection 'model.spotify_analytics.track_recommendations' was properly closed.
[0m21:14:30.664611 [info ] [MainThread]: 
[0m21:14:30.665470 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.74 seconds (2.74s).
[0m21:14:30.667724 [debug] [MainThread]: Command end result
[0m21:14:30.713244 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m21:14:30.715338 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m21:14:30.722232 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt/target/run_results.json
[0m21:14:30.722570 [info ] [MainThread]: 
[0m21:14:30.724176 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:14:30.725031 [info ] [MainThread]: 
[0m21:14:30.725932 [error] [MainThread]: [31mFailure in model track_audio_features (models/silver/track_audio_features.sql)[0m
[0m21:14:30.726972 [error] [MainThread]:   Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql
[0m21:14:30.728008 [info ] [MainThread]: 
[0m21:14:30.728776 [info ] [MainThread]:   compiled code at target/compiled/spotify_analytics/models/silver/track_audio_features.sql
[0m21:14:30.729463 [info ] [MainThread]: 
[0m21:14:30.731080 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=3
[0m21:14:30.731932 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:14:30.733624 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.7359333, "process_in_blocks": "384", "process_kernel_time": 0.574656, "process_mem_max_rss": "250508", "process_out_blocks": "3184", "process_user_time": 4.173668}
[0m21:14:30.734261 [debug] [MainThread]: Command `dbt run` failed at 21:14:30.734162 after 4.74 seconds
[0m21:14:30.734629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789e222ca250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789e1d84e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789e1d8b7bd0>]}
[0m21:14:30.735057 [debug] [MainThread]: Flushing usage events
[0m21:14:30.825203 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:14:39.991821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beab08957d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beab089c650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beab089c790>]}


============================== 21:14:39.998291 | d5a7c2c0-736f-48c5-abe1-5b1353c915fe ==============================
[0m21:14:39.998291 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:14:40.000221 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'no_print': 'None', 'static_parser': 'True', 'empty': 'False', 'version_check': 'True', 'introspect': 'True', 'use_colors': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'warn_error': 'None', 'printer_width': '80', 'partial_parse': 'True', 'target_path': 'None', 'write_json': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt compile'}
[0m21:14:41.164241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5a7c2c0-736f-48c5-abe1-5b1353c915fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beab18521d0>]}
[0m21:14:41.245510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5a7c2c0-736f-48c5-abe1-5b1353c915fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bea9b7a4510>]}
[0m21:14:41.247352 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:14:41.467550 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:14:41.747451 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:14:41.747986 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:14:41.755864 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m21:14:41.810129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5a7c2c0-736f-48c5-abe1-5b1353c915fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bea9b23c950>]}
[0m21:14:41.929648 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m21:14:41.931651 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m21:14:41.954061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5a7c2c0-736f-48c5-abe1-5b1353c915fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bea9b42cf90>]}
[0m21:14:41.954652 [info ] [MainThread]: Found 8 models, 43 data tests, 2 sources, 604 macros
[0m21:14:41.955147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5a7c2c0-736f-48c5-abe1-5b1353c915fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bea9afd7410>]}
[0m21:14:41.961529 [info ] [MainThread]: 
[0m21:14:41.962267 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:14:41.962834 [info ] [MainThread]: 
[0m21:14:41.964628 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:14:41.970338 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m21:14:41.973821 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m21:14:42.006712 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m21:14:42.007371 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m21:14:42.008164 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m21:14:42.008469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:14:42.007768 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m21:14:42.010357 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:14:43.068959 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.060 seconds
[0m21:14:43.071506 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m21:14:43.110221 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.100 seconds
[0m21:14:43.112811 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m21:14:43.184228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5a7c2c0-736f-48c5-abe1-5b1353c915fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beab25ac0d0>]}
[0m21:14:43.189099 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m21:14:43.189606 [debug] [Thread-2 (]: Began running node model.spotify_analytics.track_audio_features
[0m21:14:43.191451 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.track_audio_features)
[0m21:14:43.191874 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.track_audio_features
[0m21:14:43.190950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.silver_plays)
[0m21:14:43.190015 [debug] [Thread-3 (]: Began running node model.spotify_analytics.track_recommendations
[0m21:14:43.198646 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.spotify_analytics.track_recommendations'
[0m21:14:43.198113 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m21:14:43.199664 [debug] [Thread-3 (]: Began compiling node model.spotify_analytics.track_recommendations
[0m21:14:43.207003 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.track_audio_features"
[0m21:14:43.203530 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m21:14:43.210644 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m21:14:43.209984 [debug] [Thread-3 (]: Writing injected SQL for node "model.spotify_analytics.track_recommendations"
[0m21:14:43.212339 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.track_audio_features
[0m21:14:43.212913 [debug] [Thread-3 (]: Began executing node model.spotify_analytics.track_recommendations
[0m21:14:43.214251 [debug] [Thread-3 (]: Finished running node model.spotify_analytics.track_recommendations
[0m21:14:43.213595 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.track_audio_features
[0m21:14:43.211821 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m21:14:43.215583 [debug] [Thread-4 (]: Began running node model.spotify_analytics.daily_user_stats
[0m21:14:43.216097 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.spotify_analytics.daily_user_stats'
[0m21:14:43.216457 [debug] [Thread-4 (]: Began compiling node model.spotify_analytics.daily_user_stats
[0m21:14:43.220876 [debug] [Thread-4 (]: Writing injected SQL for node "model.spotify_analytics.daily_user_stats"
[0m21:14:43.221298 [debug] [Thread-3 (]: Began running node model.spotify_analytics.device_usage
[0m21:14:43.222569 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.track_recommendations, now model.spotify_analytics.device_usage)
[0m21:14:43.222108 [debug] [Thread-1 (]: Began running node model.spotify_analytics.top_tracks
[0m21:14:43.223562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.silver_plays, now model.spotify_analytics.top_tracks)
[0m21:14:43.223931 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.top_tracks
[0m21:14:43.221751 [debug] [Thread-2 (]: Began running node model.spotify_analytics.top_artists
[0m21:14:43.229808 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.track_audio_features, now model.spotify_analytics.top_artists)
[0m21:14:43.230211 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.top_artists
[0m21:14:43.222969 [debug] [Thread-3 (]: Began compiling node model.spotify_analytics.device_usage
[0m21:14:43.228971 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.top_tracks"
[0m21:14:43.238321 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.top_tracks
[0m21:14:43.234027 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.top_artists"
[0m21:14:43.242546 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.top_artists
[0m21:14:43.237783 [debug] [Thread-4 (]: Began executing node model.spotify_analytics.daily_user_stats
[0m21:14:43.244041 [debug] [Thread-4 (]: Finished running node model.spotify_analytics.daily_user_stats
[0m21:14:43.244449 [debug] [Thread-4 (]: Began running node model.spotify_analytics.user_listening_profile
[0m21:14:43.237268 [debug] [Thread-3 (]: Writing injected SQL for node "model.spotify_analytics.device_usage"
[0m21:14:43.245029 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.daily_user_stats, now model.spotify_analytics.user_listening_profile)
[0m21:14:43.247633 [debug] [Thread-4 (]: Began compiling node model.spotify_analytics.user_listening_profile
[0m21:14:43.243373 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.top_artists
[0m21:14:43.245585 [debug] [Thread-3 (]: Began executing node model.spotify_analytics.device_usage
[0m21:14:43.254086 [debug] [Thread-3 (]: Finished running node model.spotify_analytics.device_usage
[0m21:14:43.241753 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.top_tracks
[0m21:14:43.255186 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m21:14:43.252621 [debug] [Thread-2 (]: Began running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m21:14:43.256490 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.top_artists, now test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39)
[0m21:14:43.251461 [debug] [Thread-4 (]: Writing injected SQL for node "model.spotify_analytics.user_listening_profile"
[0m21:14:43.254631 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m21:14:43.260024 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.device_usage, now test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad)
[0m21:14:43.260461 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m21:14:43.255655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.top_tracks, now test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076)
[0m21:14:43.266327 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m21:14:43.257571 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m21:14:43.258939 [debug] [Thread-4 (]: Began executing node model.spotify_analytics.user_listening_profile
[0m21:14:43.285638 [debug] [Thread-4 (]: Finished running node model.spotify_analytics.user_listening_profile
[0m21:14:43.284814 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m21:14:43.294789 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m21:14:43.295468 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m21:14:43.287064 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m21:14:43.296464 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.user_listening_profile, now test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd)
[0m21:14:43.289903 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m21:14:43.297845 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m21:14:43.294144 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m21:14:43.299507 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m21:14:43.297313 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m21:14:43.295959 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m21:14:43.305513 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad, now test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa)
[0m21:14:43.305912 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m21:14:43.300114 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m21:14:43.312229 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m21:14:43.298951 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m21:14:43.313109 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m21:14:43.305012 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m21:14:43.314472 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m21:14:43.312670 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39, now test.spotify_analytics.not_null_silver_plays_played_at.8281565f95)
[0m21:14:43.315877 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m21:14:43.315502 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m21:14:43.323520 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m21:14:43.324012 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd, now test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9)
[0m21:14:43.313480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076, now test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed)
[0m21:14:43.325580 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m21:14:43.324414 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m21:14:43.322716 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m21:14:43.333704 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m21:14:43.341479 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m21:14:43.332262 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m21:14:43.340822 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m21:14:43.344502 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m21:14:43.345001 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m21:14:43.345426 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m21:14:43.343997 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m21:14:43.347227 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m21:14:43.346528 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m21:14:43.349050 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa, now test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4)
[0m21:14:43.342487 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m21:14:43.350350 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m21:14:43.346067 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_played_at.8281565f95, now test.spotify_analytics.not_null_silver_plays_track_name.c6334add30)
[0m21:14:43.351418 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m21:14:43.348569 [debug] [Thread-1 (]: Began running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m21:14:43.356615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed, now test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf)
[0m21:14:43.357010 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m21:14:43.349448 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m21:14:43.351036 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m21:14:43.367929 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m21:14:43.368352 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9, now test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155)
[0m21:14:43.356158 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m21:14:43.368717 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m21:14:43.367454 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m21:14:43.370367 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m21:14:43.369781 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m21:14:43.376843 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m21:14:43.374578 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m21:14:43.378683 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m21:14:43.378176 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m21:14:43.376293 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m21:14:43.377491 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m21:14:43.381480 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m21:14:43.381874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf, now test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87)
[0m21:14:43.382237 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m21:14:43.379408 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m21:14:43.387466 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m21:14:43.387925 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155, now test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282)
[0m21:14:43.380003 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m21:14:43.389171 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m21:14:43.389549 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4, now test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f)
[0m21:14:43.381063 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m21:14:43.390363 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_track_name.c6334add30, now test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9)
[0m21:14:43.390721 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m21:14:43.389941 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m21:14:43.388326 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m21:14:43.385999 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m21:14:43.407496 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m21:14:43.396384 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m21:14:43.414478 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m21:14:43.410037 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m21:14:43.416080 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m21:14:43.406521 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m21:14:43.411446 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m21:14:43.418399 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m21:14:43.416754 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m21:14:43.419956 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m21:14:43.420428 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f, now test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b)
[0m21:14:43.417363 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m21:14:43.421591 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m21:14:43.415472 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m21:14:43.420833 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m21:14:43.422045 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m21:14:43.428101 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282, now test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e)
[0m21:14:43.423289 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m21:14:43.433025 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9, now test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14)
[0m21:14:43.433453 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m21:14:43.419308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87, now test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac)
[0m21:14:43.441004 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m21:14:43.427613 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m21:14:43.446806 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m21:14:43.430266 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m21:14:43.447536 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m21:14:43.471121 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m21:14:43.471575 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b, now test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca)
[0m21:14:43.464453 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m21:14:43.461533 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m21:14:43.475064 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m21:14:43.473717 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m21:14:43.473089 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m21:14:43.469204 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m21:14:43.484494 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m21:14:43.478222 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m21:14:43.490835 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m21:14:43.475718 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m21:14:43.492674 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m21:14:43.493165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac, now test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c)
[0m21:14:43.488435 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m21:14:43.495126 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m21:14:43.492124 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e, now test.spotify_analytics.not_null_top_artists_rank.d14513fc96)
[0m21:14:43.496799 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m21:14:43.490271 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m21:14:43.503029 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m21:14:43.504001 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14, now test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11)
[0m21:14:43.504412 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m21:14:43.495967 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m21:14:43.510149 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m21:14:43.493555 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m21:14:43.501837 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m21:14:43.516176 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m21:14:43.510614 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca, now test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13)
[0m21:14:43.517349 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m21:14:43.516815 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m21:14:43.515526 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m21:14:43.524625 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m21:14:43.523176 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m21:14:43.525841 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m21:14:43.523641 [debug] [Thread-4 (]: Began running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m21:14:43.526906 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_rank.d14513fc96, now test.spotify_analytics.unique_top_artists_artist_name.008ffa1533)
[0m21:14:43.525282 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m21:14:43.521254 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m21:14:43.529175 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m21:14:43.528170 [debug] [Thread-1 (]: Began running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m21:14:43.526439 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m21:14:43.530667 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m21:14:43.531126 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11, now test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003)
[0m21:14:43.531492 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m21:14:43.529798 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m21:14:43.536202 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m21:14:43.527309 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m21:14:43.530245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c, now test.spotify_analytics.unique_top_artists_rank.68b5480aed)
[0m21:14:43.542073 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m21:14:43.536599 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13, now test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c)
[0m21:14:43.546701 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m21:14:43.535675 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m21:14:43.551969 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m21:14:43.541601 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m21:14:43.553164 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m21:14:43.546278 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m21:14:43.554761 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m21:14:43.552584 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m21:14:43.556186 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m21:14:43.551368 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m21:14:43.557182 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m21:14:43.555749 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m21:14:43.558516 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m21:14:43.553753 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m21:14:43.569826 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m21:14:43.556594 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003, now test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2)
[0m21:14:43.570875 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m21:14:43.558110 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m21:14:43.576177 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m21:14:43.569130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_top_artists_rank.68b5480aed, now test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2)
[0m21:14:43.577151 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m21:14:43.570365 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_top_artists_artist_name.008ffa1533, now test.spotify_analytics.not_null_device_usage_total_plays.90a295df48)
[0m21:14:43.582519 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m21:14:43.576645 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c, now test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461)
[0m21:14:43.589234 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m21:14:43.575486 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m21:14:43.581957 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m21:14:43.595455 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m21:14:43.593907 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m21:14:43.597957 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m21:14:43.596147 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m21:14:43.599243 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m21:14:43.597256 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m21:14:43.600683 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m21:14:43.601314 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m21:14:43.593244 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m21:14:43.602297 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m21:14:43.598370 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m21:14:43.599660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2, now test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532)
[0m21:14:43.604337 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m21:14:43.601734 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m21:14:43.603404 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2, now test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31)
[0m21:14:43.610338 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m21:14:43.602928 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m21:14:43.609394 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_plays.90a295df48, now test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4)
[0m21:14:43.616252 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m21:14:43.608804 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m21:14:43.615783 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m21:14:43.614345 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m21:14:43.622443 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m21:14:43.620991 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m21:14:43.623805 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m21:14:43.619954 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m21:14:43.624753 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m21:14:43.621477 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461, now test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac)
[0m21:14:43.625948 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m21:14:43.623161 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m21:14:43.631283 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m21:14:43.624234 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m21:14:43.632320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532, now test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893)
[0m21:14:43.632710 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m21:14:43.625554 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m21:14:43.631885 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31, now test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78)
[0m21:14:43.638521 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m21:14:43.630797 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m21:14:43.637342 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m21:14:43.647468 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4, now test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203)
[0m21:14:43.636892 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m21:14:43.648613 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m21:14:43.649351 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m21:14:43.649885 [debug] [Thread-1 (]: Began running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m21:14:43.650297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893, now test.spotify_analytics.unique_device_usage_device_type.e75362861b)
[0m21:14:43.647970 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m21:14:43.645706 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m21:14:43.657808 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m21:14:43.650665 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m21:14:43.644911 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m21:14:43.666465 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m21:14:43.658913 [debug] [Thread-3 (]: Began running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m21:14:43.668812 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac, now test.spotify_analytics.unique_top_tracks_rank.8fecde1136)
[0m21:14:43.669247 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m21:14:43.656537 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m21:14:43.667352 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m21:14:43.675147 [debug] [Thread-2 (]: Began running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m21:14:43.675560 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78, now test.spotify_analytics.unique_top_tracks_track_id.865b43a659)
[0m21:14:43.673229 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m21:14:43.676542 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m21:14:43.674614 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m21:14:43.677767 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m21:14:43.677170 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m21:14:43.675977 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m21:14:43.678936 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m21:14:43.678364 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m21:14:43.683912 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m21:14:43.683222 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m21:14:43.685221 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m21:14:43.686320 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m21:14:43.687533 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:14:43.687911 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_device_usage_device_type.e75362861b' was properly closed.
[0m21:14:43.688242 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_track_id.865b43a659' was properly closed.
[0m21:14:43.688531 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_rank.8fecde1136' was properly closed.
[0m21:14:43.688818 [debug] [MainThread]: Connection 'test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203' was properly closed.
[0m21:14:43.695987 [debug] [MainThread]: Command end result
[0m21:14:43.741824 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m21:14:43.744896 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m21:14:43.754464 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m21:14:43.756539 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 3.8375187, "process_in_blocks": "0", "process_kernel_time": 0.494761, "process_mem_max_rss": "250780", "process_out_blocks": "3752", "process_user_time": 4.320729}
[0m21:14:43.757572 [debug] [MainThread]: Command `dbt compile` succeeded at 21:14:43.757467 after 3.84 seconds
[0m21:14:43.758033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beab0827d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beab0827810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beab0827c90>]}
[0m21:14:43.758471 [debug] [MainThread]: Flushing usage events
[0m21:14:43.847235 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:14:48.970423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be55bf13e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be55bf10a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be55bf00dd0>]}


============================== 21:14:48.978135 | f0b7424c-28a0-4139-90bc-e190d3efab92 ==============================
[0m21:14:48.978135 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:14:48.978705 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'cache_selected_only': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'no_print': 'None', 'introspect': 'True', 'debug': 'False', 'write_json': 'True', 'printer_width': '80', 'invocation_command': 'dbt run --select silver.*', 'target_path': 'None', 'use_colors': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/opt/airflow/dbt/logs', 'quiet': 'False', 'warn_error': 'None', 'empty': 'False'}
[0m21:14:50.055966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0b7424c-28a0-4139-90bc-e190d3efab92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be54dd5e310>]}
[0m21:14:50.145538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0b7424c-28a0-4139-90bc-e190d3efab92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be55cfd57d0>]}
[0m21:14:50.147028 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:14:50.372114 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:14:50.676939 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:14:50.677441 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:14:50.692215 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m21:14:50.744014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0b7424c-28a0-4139-90bc-e190d3efab92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be546c6edd0>]}
[0m21:14:50.881998 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m21:14:50.884333 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m21:14:50.908814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0b7424c-28a0-4139-90bc-e190d3efab92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be546573f50>]}
[0m21:14:50.909378 [info ] [MainThread]: Found 8 models, 43 data tests, 2 sources, 604 macros
[0m21:14:50.910389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0b7424c-28a0-4139-90bc-e190d3efab92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be5468af7d0>]}
[0m21:14:50.913356 [info ] [MainThread]: 
[0m21:14:50.914003 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:14:50.914532 [info ] [MainThread]: 
[0m21:14:50.915424 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:14:50.925786 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m21:14:50.943342 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m21:14:50.943889 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m21:14:50.944242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:14:51.623367 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.679 seconds
[0m21:14:51.625674 [debug] [ThreadPool]: On list_spotify_data: Close
[0m21:14:51.685274 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_silver)
[0m21:14:51.686907 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m21:14:51.725791 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m21:14:51.726907 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m21:14:51.727289 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:14:51.732175 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m21:14:51.734067 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m21:14:51.734486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:14:52.354253 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.620 seconds
[0m21:14:52.356221 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m21:14:52.470271 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.743 seconds
[0m21:14:52.472146 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m21:14:52.543461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0b7424c-28a0-4139-90bc-e190d3efab92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be546ab1d50>]}
[0m21:14:52.548223 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m21:14:52.549685 [info ] [Thread-1 (]: 1 of 2 START sql table model silver.silver_plays ............................... [RUN]
[0m21:14:52.550198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.silver_plays)
[0m21:14:52.550577 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m21:14:52.548662 [debug] [Thread-2 (]: Began running node model.spotify_analytics.track_audio_features
[0m21:14:52.556205 [info ] [Thread-2 (]: 2 of 2 START sql table model silver.track_audio_features ....................... [RUN]
[0m21:14:52.556929 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.track_audio_features)
[0m21:14:52.557329 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.track_audio_features
[0m21:14:52.563035 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m21:14:52.567923 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m21:14:52.566803 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.track_audio_features"
[0m21:14:52.574153 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.track_audio_features
[0m21:14:52.629266 [debug] [Thread-2 (]: Writing runtime sql for node "model.spotify_analytics.track_audio_features"
[0m21:14:52.630172 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.silver_plays"
[0m21:14:52.633184 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.silver_plays"
[0m21:14:52.634810 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.silver_plays"} */
create or replace transient table spotify_data.silver.silver_plays
         as
        (

-- ============================================================================
-- SILVER LAYER: CLEANED PLAYS DATA
-- ============================================================================
-- Purpose: Transform bronze plays data into clean, analytics-ready format
-- 
-- Transformations:
--   1. Deduplicate records (DISTINCT on event_id)
--   2. Cast all data types from VARIANT to proper types
--   3. Filter invalid records (defensive WHERE clauses)
--   4. Add processing metadata (processed_at timestamp)
--
-- Source: bronze.plays (external table reading from S3 Parquet files)
-- Target: SILVER.silver_plays (materialized table)
-- ============================================================================

WITH source_data AS (
    SELECT 
        VALUE:event_id::VARCHAR AS event_id,
        VALUE:user_id::VARCHAR AS user_id,
        VALUE:event_type::VARCHAR AS event_type,
        VALUE:track_id::VARCHAR AS track_id,
        VALUE:track_name::VARCHAR AS track_name,
        VALUE:artist_name::VARCHAR AS artist_name,
        VALUE:album_name::VARCHAR AS album_name,
        VALUE:duration_ms::NUMBER AS duration_ms,
        VALUE:played_at::VARCHAR AS played_at,
        VALUE:device_type::VARCHAR AS device_type
    FROM spotify_data.bronze.plays
),

deduplicated AS (
    SELECT DISTINCT
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM source_data
    WHERE 
        -- Data quality filters
        user_id IS NOT NULL
        AND duration_ms > 0
        AND duration_ms < 600000  -- Less than 10 minutes (catches data errors)
        AND event_id IS NOT NULL
)

SELECT 
    -- Identifiers
    event_id::VARCHAR AS event_id,
    user_id::VARCHAR AS user_id,
    event_type::VARCHAR AS event_type,
    
    -- Track information
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    duration_ms::NUMBER AS duration_ms,
    
    -- Timestamps
    TRY_CAST(played_at AS TIMESTAMP) AS played_at,
    
    -- Device context
    device_type::VARCHAR AS device_type,
    
    -- Metadata
    CURRENT_TIMESTAMP() AS processed_at
    
FROM deduplicated
        );
[0m21:14:52.635375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:14:52.634233 [debug] [Thread-2 (]: Using snowflake connection "model.spotify_analytics.track_audio_features"
[0m21:14:52.636267 [debug] [Thread-2 (]: On model.spotify_analytics.track_audio_features: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.track_audio_features"} */
create or replace transient table spotify_data.silver.track_audio_features
         as
        (

/*
    Track Audio Features - Silver Layer
    
    Combines track metadata from plays with audio features from Spotify API
    This is a clean, deduplicated view of all tracks with their audio characteristics
*/

SELECT 
    af.track_id,
    af.danceability,
    af.energy,
    af.key,
    af.loudness,
    af.mode,
    af.speechiness,
    af.acousticness,
    af.instrumentalness,
    af.liveness,
    af.valence,
    af.tempo,
    af.duration_ms,
    af.time_signature,
    af.fetched_at
FROM spotify_data.bronze.track_audio_features af
WHERE af.track_id IS NOT NULL
        );
[0m21:14:52.636655 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:14:53.091115 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c0fc9a-0004-171d-000a-68a20008f282
[0m21:14:53.091695 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
[0m21:14:53.092255 [debug] [Thread-2 (]: On model.spotify_analytics.track_audio_features: Close
[0m21:14:53.153402 [debug] [Thread-2 (]: Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql
[0m21:14:53.155572 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0b7424c-28a0-4139-90bc-e190d3efab92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be546c939d0>]}
[0m21:14:53.157355 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model silver.track_audio_features .............. [[31mERROR[0m in 0.60s]
[0m21:14:53.164754 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.track_audio_features
[0m21:14:53.166101 [debug] [Thread-7 (]: Marking all children of 'model.spotify_analytics.track_audio_features' to be skipped because of status 'error'.  Reason: Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql.
[0m21:14:54.718333 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.083 seconds
[0m21:14:54.743605 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: Close
[0m21:14:54.843134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0b7424c-28a0-4139-90bc-e190d3efab92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be545a2b3d0>]}
[0m21:14:54.844014 [info ] [Thread-1 (]: 1 of 2 OK created sql table model silver.silver_plays .......................... [[32mSUCCESS 1[0m in 2.29s]
[0m21:14:54.845059 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m21:14:54.848217 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:14:54.848671 [debug] [MainThread]: Connection 'model.spotify_analytics.silver_plays' was properly closed.
[0m21:14:54.849124 [debug] [MainThread]: Connection 'model.spotify_analytics.track_audio_features' was properly closed.
[0m21:14:54.849532 [info ] [MainThread]: 
[0m21:14:54.850129 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.93 seconds (3.93s).
[0m21:14:54.851961 [debug] [MainThread]: Command end result
[0m21:14:54.890604 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m21:14:54.893262 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m21:14:54.899557 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m21:14:54.899962 [info ] [MainThread]: 
[0m21:14:54.900351 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:14:54.901384 [info ] [MainThread]: 
[0m21:14:54.901797 [error] [MainThread]: [31mFailure in model track_audio_features (models/silver/track_audio_features.sql)[0m
[0m21:14:54.902660 [error] [MainThread]:   Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql
[0m21:14:54.903924 [info ] [MainThread]: 
[0m21:14:54.904516 [info ] [MainThread]:   compiled code at target/compiled/spotify_analytics/models/silver/track_audio_features.sql
[0m21:14:54.905043 [info ] [MainThread]: 
[0m21:14:54.905574 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m21:14:54.907558 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.008813, "process_in_blocks": "0", "process_kernel_time": 0.50101, "process_mem_max_rss": "249728", "process_out_blocks": "3176", "process_user_time": 4.320616}
[0m21:14:54.908086 [debug] [MainThread]: Command `dbt run` failed at 21:14:54.907978 after 6.01 seconds
[0m21:14:54.908483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be5605ad1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be55dba8fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be55bf13790>]}
[0m21:14:54.908875 [debug] [MainThread]: Flushing usage events
[0m21:14:55.011243 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:18:00.801776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7780536cd310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778050bae250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778050bacbd0>]}


============================== 21:18:00.808635 | 2c878624-e686-4b0f-b82b-9cca794a7292 ==============================
[0m21:18:00.808635 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:18:00.809200 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'introspect': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run --select silver.*', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'static_parser': 'True', 'target_path': 'None', 'profiles_dir': '/opt/airflow/dbt', 'use_experimental_parser': 'False'}
[0m21:18:01.882134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c878624-e686-4b0f-b82b-9cca794a7292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7780425724d0>]}
[0m21:18:01.964336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c878624-e686-4b0f-b82b-9cca794a7292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778051cdd7d0>]}
[0m21:18:01.965462 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:18:02.192300 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:18:02.500248 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:18:02.500729 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:18:02.508162 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m21:18:02.565640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c878624-e686-4b0f-b82b-9cca794a7292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77803b7b5690>]}
[0m21:18:02.683842 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m21:18:02.686335 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m21:18:02.714136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c878624-e686-4b0f-b82b-9cca794a7292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77803b4fd990>]}
[0m21:18:02.715172 [info ] [MainThread]: Found 8 models, 43 data tests, 2 sources, 604 macros
[0m21:18:02.716482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c878624-e686-4b0f-b82b-9cca794a7292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7780530f3690>]}
[0m21:18:02.718567 [info ] [MainThread]: 
[0m21:18:02.719271 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:18:02.720770 [info ] [MainThread]: 
[0m21:18:02.721539 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:18:02.726409 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m21:18:02.743497 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m21:18:02.743980 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m21:18:02.744304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:18:05.601074 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.857 seconds
[0m21:18:05.603677 [debug] [ThreadPool]: On list_spotify_data: Close
[0m21:18:05.727929 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_gold)
[0m21:18:05.729315 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m21:18:05.750800 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m21:18:05.752992 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m21:18:05.753329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:18:05.752534 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m21:18:05.754521 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m21:18:05.754889 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:18:06.432565 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.679 seconds
[0m21:18:06.434399 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m21:18:07.304398 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.549 seconds
[0m21:18:07.308442 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m21:18:07.390939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c878624-e686-4b0f-b82b-9cca794a7292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77803b60d6d0>]}
[0m21:18:07.395652 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m21:18:07.396117 [debug] [Thread-2 (]: Began running node model.spotify_analytics.track_audio_features
[0m21:18:07.396640 [info ] [Thread-1 (]: 1 of 2 START sql table model silver.silver_plays ............................... [RUN]
[0m21:18:07.398946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.silver_plays)
[0m21:18:07.398043 [info ] [Thread-2 (]: 2 of 2 START sql table model silver.track_audio_features ....................... [RUN]
[0m21:18:07.410602 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.track_audio_features)
[0m21:18:07.411178 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.track_audio_features
[0m21:18:07.407559 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m21:18:07.440709 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.track_audio_features"
[0m21:18:07.447522 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.track_audio_features
[0m21:18:07.446015 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m21:18:07.455516 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m21:18:07.527221 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.silver_plays"
[0m21:18:07.529621 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.silver_plays"
[0m21:18:07.526777 [debug] [Thread-2 (]: Writing runtime sql for node "model.spotify_analytics.track_audio_features"
[0m21:18:07.530381 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.silver_plays"} */
create or replace transient table spotify_data.silver.silver_plays
         as
        (

-- ============================================================================
-- SILVER LAYER: CLEANED PLAYS DATA
-- ============================================================================
-- Purpose: Transform bronze plays data into clean, analytics-ready format
-- 
-- Transformations:
--   1. Deduplicate records (DISTINCT on event_id)
--   2. Cast all data types from VARIANT to proper types
--   3. Filter invalid records (defensive WHERE clauses)
--   4. Add processing metadata (processed_at timestamp)
--
-- Source: bronze.plays (external table reading from S3 Parquet files)
-- Target: SILVER.silver_plays (materialized table)
-- ============================================================================

WITH source_data AS (
    SELECT 
        VALUE:event_id::VARCHAR AS event_id,
        VALUE:user_id::VARCHAR AS user_id,
        VALUE:event_type::VARCHAR AS event_type,
        VALUE:track_id::VARCHAR AS track_id,
        VALUE:track_name::VARCHAR AS track_name,
        VALUE:artist_name::VARCHAR AS artist_name,
        VALUE:album_name::VARCHAR AS album_name,
        VALUE:duration_ms::NUMBER AS duration_ms,
        VALUE:played_at::VARCHAR AS played_at,
        VALUE:device_type::VARCHAR AS device_type
    FROM spotify_data.bronze.plays
),

deduplicated AS (
    SELECT DISTINCT
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM source_data
    WHERE 
        -- Data quality filters
        user_id IS NOT NULL
        AND duration_ms > 0
        AND duration_ms < 600000  -- Less than 10 minutes (catches data errors)
        AND event_id IS NOT NULL
)

SELECT 
    -- Identifiers
    event_id::VARCHAR AS event_id,
    user_id::VARCHAR AS user_id,
    event_type::VARCHAR AS event_type,
    
    -- Track information
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    duration_ms::NUMBER AS duration_ms,
    
    -- Timestamps
    TRY_CAST(played_at AS TIMESTAMP) AS played_at,
    
    -- Device context
    device_type::VARCHAR AS device_type,
    
    -- Metadata
    CURRENT_TIMESTAMP() AS processed_at
    
FROM deduplicated
        );
[0m21:18:07.532791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:07.532348 [debug] [Thread-2 (]: Using snowflake connection "model.spotify_analytics.track_audio_features"
[0m21:18:07.534062 [debug] [Thread-2 (]: On model.spotify_analytics.track_audio_features: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.track_audio_features"} */
create or replace transient table spotify_data.silver.track_audio_features
         as
        (

/*
    Track Audio Features - Silver Layer
    
    Combines track metadata from plays with audio features from Spotify API
    This is a clean, deduplicated view of all tracks with their audio characteristics
*/

SELECT 
    af.track_id,
    af.danceability,
    af.energy,
    af.key,
    af.loudness,
    af.mode,
    af.speechiness,
    af.acousticness,
    af.instrumentalness,
    af.liveness,
    af.valence,
    af.tempo,
    af.duration_ms,
    af.time_signature,
    af.fetched_at
FROM spotify_data.bronze.track_audio_features af
WHERE af.track_id IS NOT NULL
        );
[0m21:18:07.534454 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:18:08.337361 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c0fc9e-0004-171d-000a-68a20008f28e
[0m21:18:08.337916 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
[0m21:18:08.338467 [debug] [Thread-2 (]: On model.spotify_analytics.track_audio_features: Close
[0m21:18:08.492756 [debug] [Thread-2 (]: Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql
[0m21:18:08.498600 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c878624-e686-4b0f-b82b-9cca794a7292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77803b301e50>]}
[0m21:18:08.500246 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model silver.track_audio_features .............. [[31mERROR[0m in 1.08s]
[0m21:18:08.502364 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.track_audio_features
[0m21:18:08.504585 [debug] [Thread-7 (]: Marking all children of 'model.spotify_analytics.track_audio_features' to be skipped because of status 'error'.  Reason: Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql.
[0m21:18:10.020259 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.487 seconds
[0m21:18:10.057070 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: Close
[0m21:18:10.122579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c878624-e686-4b0f-b82b-9cca794a7292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778050bc04d0>]}
[0m21:18:10.123575 [info ] [Thread-1 (]: 1 of 2 OK created sql table model silver.silver_plays .......................... [[32mSUCCESS 1[0m in 2.72s]
[0m21:18:10.124664 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m21:18:10.126384 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:18:10.126753 [debug] [MainThread]: Connection 'model.spotify_analytics.track_audio_features' was properly closed.
[0m21:18:10.127231 [debug] [MainThread]: Connection 'model.spotify_analytics.silver_plays' was properly closed.
[0m21:18:10.127623 [info ] [MainThread]: 
[0m21:18:10.128143 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 7.41 seconds (7.41s).
[0m21:18:10.129438 [debug] [MainThread]: Command end result
[0m21:18:10.168593 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m21:18:10.171055 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m21:18:10.177264 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m21:18:10.177632 [info ] [MainThread]: 
[0m21:18:10.179362 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:18:10.179990 [info ] [MainThread]: 
[0m21:18:10.180616 [error] [MainThread]: [31mFailure in model track_audio_features (models/silver/track_audio_features.sql)[0m
[0m21:18:10.181213 [error] [MainThread]:   Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql
[0m21:18:10.182004 [info ] [MainThread]: 
[0m21:18:10.183528 [info ] [MainThread]:   compiled code at target/compiled/spotify_analytics/models/silver/track_audio_features.sql
[0m21:18:10.184086 [info ] [MainThread]: 
[0m21:18:10.184634 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m21:18:10.186185 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.453719, "process_in_blocks": "0", "process_kernel_time": 0.526835, "process_mem_max_rss": "251140", "process_out_blocks": "3184", "process_user_time": 4.286288}
[0m21:18:10.186667 [debug] [MainThread]: Command `dbt run` failed at 21:18:10.186581 after 9.45 seconds
[0m21:18:10.187113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778050b97f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77803b80b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778051d7f0d0>]}
[0m21:18:10.187528 [debug] [MainThread]: Flushing usage events
[0m21:18:10.276317 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:26:08.490026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b15dce47710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b15dd28d2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b15dce45750>]}


============================== 21:26:08.506738 | 69caea8b-8f4f-48cb-9fb0-742508831c7e ==============================
[0m21:26:08.506738 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:26:08.508408 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'partial_parse': 'True', 'log_path': '/opt/airflow/dbt/logs', 'use_colors': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'empty': 'False', 'printer_width': '80', 'version_check': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --select silver.*', 'static_parser': 'True', 'write_json': 'True', 'introspect': 'True', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'send_anonymous_usage_stats': 'True', 'target_path': 'None'}
[0m21:26:09.586677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69caea8b-8f4f-48cb-9fb0-742508831c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b15ceb72b90>]}
[0m21:26:09.671278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69caea8b-8f4f-48cb-9fb0-742508831c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b15ddf31650>]}
[0m21:26:09.672262 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:26:09.911223 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:26:10.066699 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:26:10.067263 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:26:10.075296 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m21:26:10.129353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69caea8b-8f4f-48cb-9fb0-742508831c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b15dd545290>]}
[0m21:26:10.248780 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m21:26:10.251185 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m21:26:10.275247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69caea8b-8f4f-48cb-9fb0-742508831c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b15c767de10>]}
[0m21:26:10.276757 [info ] [MainThread]: Found 8 models, 43 data tests, 2 sources, 604 macros
[0m21:26:10.277192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69caea8b-8f4f-48cb-9fb0-742508831c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b15d71b0090>]}
[0m21:26:10.282470 [info ] [MainThread]: 
[0m21:26:10.283486 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:26:10.283822 [info ] [MainThread]: 
[0m21:26:10.284376 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:26:10.290210 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m21:26:10.309828 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m21:26:10.310345 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m21:26:10.311195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:11.445302 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.134 seconds
[0m21:26:11.451122 [debug] [ThreadPool]: On list_spotify_data: Close
[0m21:26:11.516433 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m21:26:11.517180 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_silver)
[0m21:26:11.533484 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m21:26:11.537448 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m21:26:11.537774 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:11.536575 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m21:26:11.538976 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m21:26:11.539368 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:26:12.269163 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.731 seconds
[0m21:26:12.271158 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m21:26:12.288691 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.749 seconds
[0m21:26:12.291245 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m21:26:12.355321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69caea8b-8f4f-48cb-9fb0-742508831c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b15df915390>]}
[0m21:26:12.362763 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m21:26:12.363303 [debug] [Thread-2 (]: Began running node model.spotify_analytics.track_audio_features
[0m21:26:12.363920 [info ] [Thread-1 (]: 1 of 2 START sql table model silver.silver_plays ............................... [RUN]
[0m21:26:12.366217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.silver_plays)
[0m21:26:12.366643 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m21:26:12.364839 [info ] [Thread-2 (]: 2 of 2 START sql table model silver.track_audio_features ....................... [RUN]
[0m21:26:12.373226 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.track_audio_features)
[0m21:26:12.373786 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.track_audio_features
[0m21:26:12.385072 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.track_audio_features"
[0m21:26:12.387462 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m21:26:12.389326 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m21:26:12.388168 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.track_audio_features
[0m21:26:12.451155 [debug] [Thread-2 (]: Writing runtime sql for node "model.spotify_analytics.track_audio_features"
[0m21:26:12.455303 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.silver_plays"
[0m21:26:12.456778 [debug] [Thread-2 (]: Using snowflake connection "model.spotify_analytics.track_audio_features"
[0m21:26:12.460115 [debug] [Thread-2 (]: On model.spotify_analytics.track_audio_features: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.track_audio_features"} */
create or replace transient table spotify_data.silver.track_audio_features
         as
        (

/*
    Track Audio Features - Silver Layer
    
    Combines track metadata from plays with audio features from Spotify API
    This is a clean, deduplicated view of all tracks with their audio characteristics
*/

SELECT 
    af.track_id,
    af.danceability,
    af.energy,
    af.key,
    af.loudness,
    af.mode,
    af.speechiness,
    af.acousticness,
    af.instrumentalness,
    af.liveness,
    af.valence,
    af.tempo,
    af.duration_ms,
    af.time_signature,
    af.fetched_at
FROM spotify_data.bronze.track_audio_features af
WHERE af.track_id IS NOT NULL
        );
[0m21:26:12.460520 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:26:12.459545 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.silver_plays"
[0m21:26:12.461092 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.silver_plays"} */
create or replace transient table spotify_data.silver.silver_plays
         as
        (

-- ============================================================================
-- SILVER LAYER: CLEANED PLAYS DATA
-- ============================================================================
-- Purpose: Transform bronze plays data into clean, analytics-ready format
-- 
-- Transformations:
--   1. Deduplicate records (DISTINCT on event_id)
--   2. Cast all data types from VARIANT to proper types
--   3. Filter invalid records (defensive WHERE clauses)
--   4. Add processing metadata (processed_at timestamp)
--
-- Source: bronze.plays (external table reading from S3 Parquet files)
-- Target: SILVER.silver_plays (materialized table)
-- ============================================================================

WITH source_data AS (
    SELECT 
        VALUE:event_id::VARCHAR AS event_id,
        VALUE:user_id::VARCHAR AS user_id,
        VALUE:event_type::VARCHAR AS event_type,
        VALUE:track_id::VARCHAR AS track_id,
        VALUE:track_name::VARCHAR AS track_name,
        VALUE:artist_name::VARCHAR AS artist_name,
        VALUE:album_name::VARCHAR AS album_name,
        VALUE:duration_ms::NUMBER AS duration_ms,
        VALUE:played_at::VARCHAR AS played_at,
        VALUE:device_type::VARCHAR AS device_type
    FROM spotify_data.bronze.plays
),

deduplicated AS (
    SELECT DISTINCT
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM source_data
    WHERE 
        -- Data quality filters
        user_id IS NOT NULL
        AND duration_ms > 0
        AND duration_ms < 600000  -- Less than 10 minutes (catches data errors)
        AND event_id IS NOT NULL
)

SELECT 
    -- Identifiers
    event_id::VARCHAR AS event_id,
    user_id::VARCHAR AS user_id,
    event_type::VARCHAR AS event_type,
    
    -- Track information
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    duration_ms::NUMBER AS duration_ms,
    
    -- Timestamps
    TRY_CAST(played_at AS TIMESTAMP) AS played_at,
    
    -- Device context
    device_type::VARCHAR AS device_type,
    
    -- Metadata
    CURRENT_TIMESTAMP() AS processed_at
    
FROM deduplicated
        );
[0m21:26:12.461541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:12.852426 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c0fca6-0004-1445-000a-68a20006d516
[0m21:26:12.852992 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
[0m21:26:12.853571 [debug] [Thread-2 (]: On model.spotify_analytics.track_audio_features: Close
[0m21:26:13.194000 [debug] [Thread-2 (]: Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql
[0m21:26:13.196188 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69caea8b-8f4f-48cb-9fb0-742508831c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b15c49541d0>]}
[0m21:26:13.196935 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model silver.track_audio_features .............. [[31mERROR[0m in 0.82s]
[0m21:26:13.197528 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.track_audio_features
[0m21:26:13.199329 [debug] [Thread-7 (]: Marking all children of 'model.spotify_analytics.track_audio_features' to be skipped because of status 'error'.  Reason: Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql.
[0m21:26:15.395391 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.934 seconds
[0m21:26:15.426008 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: Close
[0m21:26:15.465041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69caea8b-8f4f-48cb-9fb0-742508831c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b15c736afd0>]}
[0m21:26:15.465815 [info ] [Thread-1 (]: 1 of 2 OK created sql table model silver.silver_plays .......................... [[32mSUCCESS 1[0m in 3.10s]
[0m21:26:15.466790 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m21:26:15.469496 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:26:15.470356 [debug] [MainThread]: Connection 'model.spotify_analytics.silver_plays' was properly closed.
[0m21:26:15.470696 [debug] [MainThread]: Connection 'model.spotify_analytics.track_audio_features' was properly closed.
[0m21:26:15.471182 [info ] [MainThread]: 
[0m21:26:15.471781 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.19 seconds (5.19s).
[0m21:26:15.472789 [debug] [MainThread]: Command end result
[0m21:26:15.514396 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m21:26:15.516881 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m21:26:15.524419 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m21:26:15.524801 [info ] [MainThread]: 
[0m21:26:15.525539 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:26:15.526248 [info ] [MainThread]: 
[0m21:26:15.526880 [error] [MainThread]: [31mFailure in model track_audio_features (models/silver/track_audio_features.sql)[0m
[0m21:26:15.527509 [error] [MainThread]:   Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql
[0m21:26:15.529068 [info ] [MainThread]: 
[0m21:26:15.529496 [info ] [MainThread]:   compiled code at target/compiled/spotify_analytics/models/silver/track_audio_features.sql
[0m21:26:15.529831 [info ] [MainThread]: 
[0m21:26:15.530630 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m21:26:15.532583 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.1137075, "process_in_blocks": "0", "process_kernel_time": 0.505669, "process_mem_max_rss": "251096", "process_out_blocks": "3184", "process_user_time": 4.238991}
[0m21:26:15.533155 [debug] [MainThread]: Command `dbt run` failed at 21:26:15.533062 after 7.11 seconds
[0m21:26:15.533556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b15dcdf2210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b15dcdf1190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b15e140cd10>]}
[0m21:26:15.534412 [debug] [MainThread]: Flushing usage events
[0m21:26:15.627090 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:36:20.383948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723b1c025e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723b19590490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723b194fc510>]}


============================== 21:36:20.391273 | 19b910d4-19ee-4a5b-9d8b-cab9e4c886cd ==============================
[0m21:36:20.391273 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:36:20.392268 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'use_colors': 'True', 'version_check': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/opt/airflow/dbt', 'log_cache_events': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'log_path': '/opt/airflow/dbt/logs', 'empty': 'False', 'log_format': 'default', 'partial_parse': 'True', 'invocation_command': 'dbt run --select silver.*', 'target_path': 'None', 'use_experimental_parser': 'False', 'write_json': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'debug': 'False'}
[0m21:36:21.436878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19b910d4-19ee-4a5b-9d8b-cab9e4c886cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723b080e5510>]}
[0m21:36:21.517432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19b910d4-19ee-4a5b-9d8b-cab9e4c886cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723b08122590>]}
[0m21:36:21.518377 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:36:21.748117 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:36:21.905669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:36:21.906200 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:36:21.914320 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m21:36:21.969177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19b910d4-19ee-4a5b-9d8b-cab9e4c886cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723b03fec050>]}
[0m21:36:22.086745 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m21:36:22.088884 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m21:36:22.112761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19b910d4-19ee-4a5b-9d8b-cab9e4c886cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723b03d85f10>]}
[0m21:36:22.113770 [info ] [MainThread]: Found 8 models, 43 data tests, 2 sources, 604 macros
[0m21:36:22.114526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19b910d4-19ee-4a5b-9d8b-cab9e4c886cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723b1aa32e50>]}
[0m21:36:22.116502 [info ] [MainThread]: 
[0m21:36:22.117374 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:36:22.117687 [info ] [MainThread]: 
[0m21:36:22.122912 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:36:22.128447 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m21:36:22.147958 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m21:36:22.148477 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m21:36:22.148817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:36:23.411364 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.262 seconds
[0m21:36:23.413787 [debug] [ThreadPool]: On list_spotify_data: Close
[0m21:36:23.495307 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m21:36:23.497239 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_silver)
[0m21:36:23.518149 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m21:36:23.518597 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m21:36:23.520363 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m21:36:23.520716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:36:23.519022 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m21:36:23.522061 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:36:24.028946 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.507 seconds
[0m21:36:24.030887 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m21:36:24.404339 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.884 seconds
[0m21:36:24.406490 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m21:36:24.457040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19b910d4-19ee-4a5b-9d8b-cab9e4c886cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723b03d89c10>]}
[0m21:36:24.463509 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m21:36:24.464046 [debug] [Thread-2 (]: Began running node model.spotify_analytics.track_audio_features
[0m21:36:24.464621 [info ] [Thread-1 (]: 1 of 2 START sql table model silver.silver_plays ............................... [RUN]
[0m21:36:24.466883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.silver_plays)
[0m21:36:24.467322 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m21:36:24.466354 [info ] [Thread-2 (]: 2 of 2 START sql table model silver.track_audio_features ....................... [RUN]
[0m21:36:24.478844 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.track_audio_features)
[0m21:36:24.479304 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.track_audio_features
[0m21:36:24.477904 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m21:36:24.483965 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m21:36:24.483297 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.track_audio_features"
[0m21:36:24.490189 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.track_audio_features
[0m21:36:24.546788 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.silver_plays"
[0m21:36:24.547523 [debug] [Thread-2 (]: Writing runtime sql for node "model.spotify_analytics.track_audio_features"
[0m21:36:24.550542 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.silver_plays"
[0m21:36:24.552441 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.silver_plays"} */
create or replace transient table spotify_data.silver.silver_plays
         as
        (

-- ============================================================================
-- SILVER LAYER: CLEANED PLAYS DATA
-- ============================================================================
-- Purpose: Transform bronze plays data into clean, analytics-ready format
-- 
-- Transformations:
--   1. Deduplicate records (DISTINCT on event_id)
--   2. Cast all data types from VARIANT to proper types
--   3. Filter invalid records (defensive WHERE clauses)
--   4. Add processing metadata (processed_at timestamp)
--
-- Source: bronze.plays (external table reading from S3 Parquet files)
-- Target: SILVER.silver_plays (materialized table)
-- ============================================================================

WITH source_data AS (
    SELECT 
        VALUE:event_id::VARCHAR AS event_id,
        VALUE:user_id::VARCHAR AS user_id,
        VALUE:event_type::VARCHAR AS event_type,
        VALUE:track_id::VARCHAR AS track_id,
        VALUE:track_name::VARCHAR AS track_name,
        VALUE:artist_name::VARCHAR AS artist_name,
        VALUE:album_name::VARCHAR AS album_name,
        VALUE:duration_ms::NUMBER AS duration_ms,
        VALUE:played_at::VARCHAR AS played_at,
        VALUE:device_type::VARCHAR AS device_type
    FROM spotify_data.bronze.plays
),

deduplicated AS (
    SELECT DISTINCT
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM source_data
    WHERE 
        -- Data quality filters
        user_id IS NOT NULL
        AND duration_ms > 0
        AND duration_ms < 600000  -- Less than 10 minutes (catches data errors)
        AND event_id IS NOT NULL
)

SELECT 
    -- Identifiers
    event_id::VARCHAR AS event_id,
    user_id::VARCHAR AS user_id,
    event_type::VARCHAR AS event_type,
    
    -- Track information
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    duration_ms::NUMBER AS duration_ms,
    
    -- Timestamps
    TRY_CAST(played_at AS TIMESTAMP) AS played_at,
    
    -- Device context
    device_type::VARCHAR AS device_type,
    
    -- Metadata
    CURRENT_TIMESTAMP() AS processed_at
    
FROM deduplicated
        );
[0m21:36:24.552912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:36:24.551743 [debug] [Thread-2 (]: Using snowflake connection "model.spotify_analytics.track_audio_features"
[0m21:36:24.554203 [debug] [Thread-2 (]: On model.spotify_analytics.track_audio_features: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.track_audio_features"} */
create or replace transient table spotify_data.silver.track_audio_features
         as
        (

/*
    Track Audio Features - Silver Layer
    
    Combines track metadata from plays with audio features from Spotify API
    This is a clean, deduplicated view of all tracks with their audio characteristics
*/

SELECT 
    af.track_id,
    af.danceability,
    af.energy,
    af.key,
    af.loudness,
    af.mode,
    af.speechiness,
    af.acousticness,
    af.instrumentalness,
    af.liveness,
    af.valence,
    af.tempo,
    af.duration_ms,
    af.time_signature,
    af.fetched_at
FROM spotify_data.bronze.track_audio_features af
WHERE af.track_id IS NOT NULL
        );
[0m21:36:24.555263 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:36:24.989826 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c0fcb0-0004-162f-000a-68a20008930a
[0m21:36:24.990384 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
[0m21:36:24.991003 [debug] [Thread-2 (]: On model.spotify_analytics.track_audio_features: Close
[0m21:36:25.084247 [debug] [Thread-2 (]: Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql
[0m21:36:25.086139 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19b910d4-19ee-4a5b-9d8b-cab9e4c886cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723b08f22590>]}
[0m21:36:25.086956 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model silver.track_audio_features .............. [[31mERROR[0m in 0.61s]
[0m21:36:25.088019 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.track_audio_features
[0m21:36:25.088616 [debug] [Thread-7 (]: Marking all children of 'model.spotify_analytics.track_audio_features' to be skipped because of status 'error'.  Reason: Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql.
[0m21:36:27.956442 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.403 seconds
[0m21:36:27.988613 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: Close
[0m21:36:28.044446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19b910d4-19ee-4a5b-9d8b-cab9e4c886cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723ae3e565d0>]}
[0m21:36:28.045338 [info ] [Thread-1 (]: 1 of 2 OK created sql table model silver.silver_plays .......................... [[32mSUCCESS 1[0m in 3.58s]
[0m21:36:28.047538 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m21:36:28.049481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:36:28.049988 [debug] [MainThread]: Connection 'model.spotify_analytics.silver_plays' was properly closed.
[0m21:36:28.051115 [debug] [MainThread]: Connection 'model.spotify_analytics.track_audio_features' was properly closed.
[0m21:36:28.051737 [info ] [MainThread]: 
[0m21:36:28.052252 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.93 seconds (5.93s).
[0m21:36:28.054878 [debug] [MainThread]: Command end result
[0m21:36:28.092329 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m21:36:28.095209 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m21:36:28.101956 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m21:36:28.102345 [info ] [MainThread]: 
[0m21:36:28.103175 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:36:28.104520 [info ] [MainThread]: 
[0m21:36:28.104978 [error] [MainThread]: [31mFailure in model track_audio_features (models/silver/track_audio_features.sql)[0m
[0m21:36:28.105388 [error] [MainThread]:   Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql
[0m21:36:28.105733 [info ] [MainThread]: 
[0m21:36:28.107230 [info ] [MainThread]:   compiled code at target/compiled/spotify_analytics/models/silver/track_audio_features.sql
[0m21:36:28.107568 [info ] [MainThread]: 
[0m21:36:28.108600 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m21:36:28.110478 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.7926583, "process_in_blocks": "0", "process_kernel_time": 0.520838, "process_mem_max_rss": "249936", "process_out_blocks": "3184", "process_user_time": 4.182212}
[0m21:36:28.111307 [debug] [MainThread]: Command `dbt run` failed at 21:36:28.111209 after 7.79 seconds
[0m21:36:28.111705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723b194e7750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723b194e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723b080f4490>]}
[0m21:36:28.112139 [debug] [MainThread]: Flushing usage events
[0m21:36:28.197966 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:05:23.527129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709a0d937d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709a0d940610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709a0d943850>]}


============================== 22:05:23.535172 | f9c0cb32-3c28-4183-aa69-5d1084aab58d ==============================
[0m22:05:23.535172 [info ] [MainThread]: Running with dbt=1.10.15
[0m22:05:23.536154 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'quiet': 'False', 'warn_error': 'None', 'debug': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt compile', 'no_print': 'None', 'static_parser': 'True', 'log_path': '/opt/airflow/dbt/logs', 'log_format': 'default', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'use_colors': 'True', 'profiles_dir': '/opt/airflow/dbt', 'empty': 'False', 'version_check': 'True', 'write_json': 'True', 'target_path': 'None'}
[0m22:05:24.608223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9c0cb32-3c28-4183-aa69-5d1084aab58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709a0d935750>]}
[0m22:05:24.693380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9c0cb32-3c28-4183-aa69-5d1084aab58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709a0e88bdd0>]}
[0m22:05:24.694915 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:05:24.918620 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m22:05:25.078069 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:05:25.079829 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:05:25.089139 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m22:05:25.175885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9c0cb32-3c28-4183-aa69-5d1084aab58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7099fc5256d0>]}
[0m22:05:25.290180 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:05:25.292506 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:05:25.315112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9c0cb32-3c28-4183-aa69-5d1084aab58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709a0fe2d790>]}
[0m22:05:25.315681 [info ] [MainThread]: Found 8 models, 43 data tests, 2 sources, 604 macros
[0m22:05:25.316094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9c0cb32-3c28-4183-aa69-5d1084aab58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709a0e0355d0>]}
[0m22:05:25.329786 [info ] [MainThread]: 
[0m22:05:25.330876 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:05:25.331580 [info ] [MainThread]: 
[0m22:05:25.332471 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:05:25.339932 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m22:05:25.341187 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m22:05:25.373993 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m22:05:25.374564 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m22:05:25.374977 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m22:05:25.376631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:25.375321 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m22:05:25.378318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:26.165460 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.787 seconds
[0m22:05:26.167788 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m22:05:26.560558 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.184 seconds
[0m22:05:26.562933 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m22:05:26.667021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9c0cb32-3c28-4183-aa69-5d1084aab58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7099fc1235d0>]}
[0m22:05:26.672314 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m22:05:26.672826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.silver_plays)
[0m22:05:26.673278 [debug] [Thread-2 (]: Began running node model.spotify_analytics.track_audio_features
[0m22:05:26.674981 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.track_audio_features)
[0m22:05:26.674529 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m22:05:26.673646 [debug] [Thread-3 (]: Began running node model.spotify_analytics.track_recommendations
[0m22:05:26.682209 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.spotify_analytics.track_recommendations'
[0m22:05:26.675782 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.track_audio_features
[0m22:05:26.682646 [debug] [Thread-3 (]: Began compiling node model.spotify_analytics.track_recommendations
[0m22:05:26.691781 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m22:05:26.705039 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m22:05:26.698926 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.track_audio_features"
[0m22:05:26.707302 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.track_audio_features
[0m22:05:26.703687 [debug] [Thread-3 (]: Writing injected SQL for node "model.spotify_analytics.track_recommendations"
[0m22:05:26.708541 [debug] [Thread-3 (]: Began executing node model.spotify_analytics.track_recommendations
[0m22:05:26.709170 [debug] [Thread-3 (]: Finished running node model.spotify_analytics.track_recommendations
[0m22:05:26.707993 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.track_audio_features
[0m22:05:26.706303 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m22:05:26.710760 [debug] [Thread-4 (]: Began running node model.spotify_analytics.daily_user_stats
[0m22:05:26.711305 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.spotify_analytics.daily_user_stats'
[0m22:05:26.712137 [debug] [Thread-2 (]: Began running node model.spotify_analytics.device_usage
[0m22:05:26.713563 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.track_audio_features, now model.spotify_analytics.device_usage)
[0m22:05:26.713169 [debug] [Thread-4 (]: Began compiling node model.spotify_analytics.daily_user_stats
[0m22:05:26.712793 [debug] [Thread-3 (]: Began running node model.spotify_analytics.top_tracks
[0m22:05:26.719375 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.track_recommendations, now model.spotify_analytics.top_tracks)
[0m22:05:26.713966 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.device_usage
[0m22:05:26.712468 [debug] [Thread-1 (]: Began running node model.spotify_analytics.top_artists
[0m22:05:26.724638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.silver_plays, now model.spotify_analytics.top_artists)
[0m22:05:26.725055 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.top_artists
[0m22:05:26.719762 [debug] [Thread-3 (]: Began compiling node model.spotify_analytics.top_tracks
[0m22:05:26.718899 [debug] [Thread-4 (]: Writing injected SQL for node "model.spotify_analytics.daily_user_stats"
[0m22:05:26.733730 [debug] [Thread-4 (]: Began executing node model.spotify_analytics.daily_user_stats
[0m22:05:26.724190 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.device_usage"
[0m22:05:26.735059 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.device_usage
[0m22:05:26.729145 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.top_artists"
[0m22:05:26.736262 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.top_artists
[0m22:05:26.734427 [debug] [Thread-4 (]: Finished running node model.spotify_analytics.daily_user_stats
[0m22:05:26.737744 [debug] [Thread-4 (]: Began running node model.spotify_analytics.user_listening_profile
[0m22:05:26.738193 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.daily_user_stats, now model.spotify_analytics.user_listening_profile)
[0m22:05:26.738552 [debug] [Thread-4 (]: Began compiling node model.spotify_analytics.user_listening_profile
[0m22:05:26.732925 [debug] [Thread-3 (]: Writing injected SQL for node "model.spotify_analytics.top_tracks"
[0m22:05:26.743404 [debug] [Thread-3 (]: Began executing node model.spotify_analytics.top_tracks
[0m22:05:26.735688 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.device_usage
[0m22:05:26.737307 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.top_artists
[0m22:05:26.745009 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m22:05:26.744561 [debug] [Thread-2 (]: Began running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m22:05:26.746489 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.device_usage, now test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39)
[0m22:05:26.746889 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m22:05:26.744084 [debug] [Thread-3 (]: Finished running node model.spotify_analytics.top_tracks
[0m22:05:26.753522 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m22:05:26.753986 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.top_tracks, now test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076)
[0m22:05:26.754361 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m22:05:26.742789 [debug] [Thread-4 (]: Writing injected SQL for node "model.spotify_analytics.user_listening_profile"
[0m22:05:26.745894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.top_artists, now test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad)
[0m22:05:26.783791 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m22:05:26.780170 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m22:05:26.763764 [debug] [Thread-4 (]: Began executing node model.spotify_analytics.user_listening_profile
[0m22:05:26.791489 [debug] [Thread-4 (]: Finished running node model.spotify_analytics.user_listening_profile
[0m22:05:26.783233 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m22:05:26.792480 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m22:05:26.793131 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m22:05:26.793522 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m22:05:26.790074 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m22:05:26.794683 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m22:05:26.788485 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m22:05:26.791954 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m22:05:26.796183 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.user_listening_profile, now test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd)
[0m22:05:26.795732 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m22:05:26.795224 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m22:05:26.799091 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39, now test.spotify_analytics.not_null_silver_plays_played_at.8281565f95)
[0m22:05:26.799482 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m22:05:26.796544 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m22:05:26.793959 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076, now test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa)
[0m22:05:26.808757 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m22:05:26.798577 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m22:05:26.803772 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m22:05:26.814476 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m22:05:26.807920 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m22:05:26.815768 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m22:05:26.812247 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m22:05:26.816971 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m22:05:26.817567 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m22:05:26.818050 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m22:05:26.816392 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m22:05:26.815167 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m22:05:26.820337 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m22:05:26.820742 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_played_at.8281565f95, now test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4)
[0m22:05:26.821130 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m22:05:26.818474 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa, now test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9)
[0m22:05:26.826194 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m22:05:26.812698 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m22:05:26.831306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad, now test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed)
[0m22:05:26.819779 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m22:05:26.832130 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd, now test.spotify_analytics.not_null_silver_plays_track_name.c6334add30)
[0m22:05:26.832515 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m22:05:26.831714 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m22:05:26.825700 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m22:05:26.842413 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m22:05:26.836663 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m22:05:26.844210 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m22:05:26.830567 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m22:05:26.843525 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m22:05:26.848878 [debug] [Thread-2 (]: Began running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m22:05:26.849351 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4, now test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf)
[0m22:05:26.846014 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m22:05:26.845022 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m22:05:26.852026 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m22:05:26.852526 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_track_name.c6334add30, now test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155)
[0m22:05:26.853064 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m22:05:26.848324 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m22:05:26.859089 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m22:05:26.851067 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m22:05:26.860530 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m22:05:26.849734 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m22:05:26.860066 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m22:05:26.861010 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9, now test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9)
[0m22:05:26.871572 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m22:05:26.864043 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m22:05:26.878577 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m22:05:26.875534 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m22:05:26.870591 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m22:05:26.879917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed, now test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87)
[0m22:05:26.880311 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m22:05:26.877534 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m22:05:26.879393 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m22:05:26.886053 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m22:05:26.886445 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155, now test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282)
[0m22:05:26.886943 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m22:05:26.885581 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m22:05:26.884981 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m22:05:26.893361 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m22:05:26.891705 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m22:05:26.891189 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m22:05:26.895358 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m22:05:26.892360 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m22:05:26.896986 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m22:05:26.894023 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m22:05:26.898345 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m22:05:26.898795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87, now test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac)
[0m22:05:26.894790 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m22:05:26.899621 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m22:05:26.900061 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9, now test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b)
[0m22:05:26.895983 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m22:05:26.900828 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m22:05:26.899227 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m22:05:26.897906 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf, now test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f)
[0m22:05:26.900430 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m22:05:26.901757 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282, now test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003)
[0m22:05:26.911819 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m22:05:26.906931 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m22:05:26.905555 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m22:05:26.923419 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m22:05:26.911400 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m22:05:26.915836 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m22:05:26.926659 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m22:05:26.924595 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m22:05:26.928222 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m22:05:26.927617 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m22:05:26.932041 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m22:05:26.928656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac, now test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c)
[0m22:05:26.933536 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m22:05:26.926041 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m22:05:26.941241 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m22:05:26.931402 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m22:05:26.933086 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003, now test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2)
[0m22:05:26.943549 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m22:05:26.941758 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m22:05:26.951057 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b, now test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2)
[0m22:05:26.951468 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m22:05:26.942789 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m22:05:26.956536 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m22:05:26.950453 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m22:05:26.948641 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m22:05:26.955825 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m22:05:26.960036 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m22:05:26.958886 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m22:05:26.961547 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m22:05:26.957029 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m22:05:26.962401 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f, now test.spotify_analytics.not_null_device_usage_total_plays.90a295df48)
[0m22:05:26.957629 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m22:05:26.963465 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m22:05:26.960937 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m22:05:26.965266 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m22:05:26.962785 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m22:05:26.963861 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m22:05:26.970536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c, now test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14)
[0m22:05:26.965720 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2, now test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca)
[0m22:05:26.971817 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m22:05:26.961997 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m22:05:26.976585 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2, now test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e)
[0m22:05:26.977011 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m22:05:26.969597 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m22:05:26.982235 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m22:05:26.970974 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m22:05:26.975651 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m22:05:26.987773 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m22:05:26.980693 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m22:05:26.989443 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m22:05:26.982935 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m22:05:26.990689 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m22:05:26.991197 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_plays.90a295df48, now test.spotify_analytics.not_null_top_artists_rank.d14513fc96)
[0m22:05:26.988927 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m22:05:26.992939 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m22:05:26.993319 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca, now test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c)
[0m22:05:26.990198 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m22:05:26.994535 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m22:05:26.986727 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m22:05:26.995508 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m22:05:26.996127 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m22:05:26.994981 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e, now test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11)
[0m22:05:26.996622 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m22:05:26.993667 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m22:05:26.991572 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m22:05:27.008542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14, now test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13)
[0m22:05:27.031823 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m22:05:26.998839 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m22:05:27.042814 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m22:05:27.058305 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m22:05:27.041827 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m22:05:27.061416 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m22:05:27.062093 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m22:05:27.057620 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m22:05:27.063272 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m22:05:27.059213 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m22:05:27.060390 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m22:05:27.064998 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m22:05:27.062646 [debug] [Thread-2 (]: Began running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m22:05:27.066113 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_rank.d14513fc96, now test.spotify_analytics.unique_device_usage_device_type.e75362861b)
[0m22:05:27.063965 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m22:05:27.067469 [debug] [Thread-1 (]: Began running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m22:05:27.067910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13, now test.spotify_analytics.unique_top_artists_rank.68b5480aed)
[0m22:05:27.068297 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m22:05:27.065627 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m22:05:27.074846 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m22:05:27.075354 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11, now test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461)
[0m22:05:27.064439 [debug] [Thread-3 (]: Began running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m22:05:27.066482 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m22:05:27.075727 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m22:05:27.076145 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c, now test.spotify_analytics.unique_top_artists_artist_name.008ffa1533)
[0m22:05:27.086108 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m22:05:27.091894 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m22:05:27.093802 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m22:05:27.085549 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m22:05:27.102475 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m22:05:27.091229 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m22:05:27.103965 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m22:05:27.099984 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m22:05:27.105807 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m22:05:27.101781 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m22:05:27.103333 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m22:05:27.107500 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m22:05:27.107950 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_device_usage_device_type.e75362861b, now test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532)
[0m22:05:27.108327 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m22:05:27.107028 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m22:05:27.106468 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m22:05:27.105024 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m22:05:27.115817 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m22:05:27.115346 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m22:05:27.117136 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_top_artists_artist_name.008ffa1533, now test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4)
[0m22:05:27.117534 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m22:05:27.113317 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m22:05:27.123018 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m22:05:27.114778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_top_artists_rank.68b5480aed, now test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31)
[0m22:05:27.124084 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m22:05:27.116654 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461, now test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac)
[0m22:05:27.129599 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m22:05:27.123670 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m22:05:27.135336 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m22:05:27.122006 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m22:05:27.129159 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m22:05:27.137972 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m22:05:27.135773 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532, now test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893)
[0m22:05:27.139057 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m22:05:27.138590 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m22:05:27.136370 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m22:05:27.145107 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m22:05:27.143753 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m22:05:27.146024 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m22:05:27.143255 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m22:05:27.147210 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m22:05:27.145506 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m22:05:27.144442 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m22:05:27.149122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31, now test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78)
[0m22:05:27.149481 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m22:05:27.146629 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m22:05:27.154258 [debug] [Thread-4 (]: Began running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m22:05:27.148288 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m22:05:27.155174 [debug] [Thread-2 (]: Began running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m22:05:27.155557 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893, now test.spotify_analytics.unique_top_tracks_track_id.865b43a659)
[0m22:05:27.148685 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4, now test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203)
[0m22:05:27.154655 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac, now test.spotify_analytics.unique_top_tracks_rank.8fecde1136)
[0m22:05:27.158067 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m22:05:27.153782 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m22:05:27.164221 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m22:05:27.156603 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m22:05:27.157074 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m22:05:27.163568 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m22:05:27.165293 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m22:05:27.170185 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m22:05:27.177517 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m22:05:27.179380 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m22:05:27.176179 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m22:05:27.179811 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m22:05:27.180629 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m22:05:27.182157 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m22:05:27.181525 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m22:05:27.183444 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:27.184541 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_track_id.865b43a659' was properly closed.
[0m22:05:27.184894 [debug] [MainThread]: Connection 'test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78' was properly closed.
[0m22:05:27.185560 [debug] [MainThread]: Connection 'test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203' was properly closed.
[0m22:05:27.185843 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_rank.8fecde1136' was properly closed.
[0m22:05:27.193041 [debug] [MainThread]: Command end result
[0m22:05:27.231102 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:05:27.233064 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:05:27.244679 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m22:05:27.246420 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 3.792163, "process_in_blocks": "56", "process_kernel_time": 0.535858, "process_mem_max_rss": "256928", "process_out_blocks": "3768", "process_user_time": 4.303394}
[0m22:05:27.247162 [debug] [MainThread]: Command `dbt compile` succeeded at 22:05:27.247042 after 3.79 seconds
[0m22:05:27.247599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709a0d943850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709a0d941550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709a0dd79110>]}
[0m22:05:27.248104 [debug] [MainThread]: Flushing usage events
[0m22:05:27.337357 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:05:32.354270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c45b43c1490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c45b436ec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c45b43cc850>]}


============================== 22:05:32.363221 | c41939e5-d52e-4782-80fc-e7560735dac8 ==============================
[0m22:05:32.363221 [info ] [MainThread]: Running with dbt=1.10.15
[0m22:05:32.364301 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'no_print': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'static_parser': 'True', 'warn_error': 'None', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'quiet': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'write_json': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run --select silver.*', 'log_cache_events': 'False', 'version_check': 'True', 'partial_parse': 'True', 'log_format': 'default', 'log_path': '/opt/airflow/dbt/logs', 'introspect': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/opt/airflow/dbt'}
[0m22:05:33.533389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c41939e5-d52e-4782-80fc-e7560735dac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c459f212590>]}
[0m22:05:33.616050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c41939e5-d52e-4782-80fc-e7560735dac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c45b4924250>]}
[0m22:05:33.617009 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:05:33.846564 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m22:05:34.006302 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:05:34.006819 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:05:34.014467 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m22:05:34.068987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c41939e5-d52e-4782-80fc-e7560735dac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c459ec00750>]}
[0m22:05:34.183843 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:05:34.185805 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:05:34.210630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c41939e5-d52e-4782-80fc-e7560735dac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c459eea9d10>]}
[0m22:05:34.211823 [info ] [MainThread]: Found 8 models, 43 data tests, 2 sources, 604 macros
[0m22:05:34.212452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c41939e5-d52e-4782-80fc-e7560735dac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c459f06bcd0>]}
[0m22:05:34.216045 [info ] [MainThread]: 
[0m22:05:34.217382 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:05:34.218137 [info ] [MainThread]: 
[0m22:05:34.218996 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:05:34.224780 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m22:05:34.253914 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m22:05:34.254367 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m22:05:34.254711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:35.271845 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.017 seconds
[0m22:05:35.274026 [debug] [ThreadPool]: On list_spotify_data: Close
[0m22:05:35.379729 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_gold)
[0m22:05:35.387595 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m22:05:35.392191 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m22:05:35.395366 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m22:05:35.395698 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:35.394887 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m22:05:35.397938 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m22:05:35.401972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:35.842371 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.440 seconds
[0m22:05:35.844924 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m22:05:35.938825 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.543 seconds
[0m22:05:35.940975 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m22:05:35.996802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c41939e5-d52e-4782-80fc-e7560735dac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c45b58810d0>]}
[0m22:05:36.001305 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m22:05:36.001914 [info ] [Thread-1 (]: 1 of 2 START sql table model silver.silver_plays ............................... [RUN]
[0m22:05:36.003397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.silver_plays)
[0m22:05:36.003801 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m22:05:36.005026 [debug] [Thread-2 (]: Began running node model.spotify_analytics.track_audio_features
[0m22:05:36.011496 [info ] [Thread-2 (]: 2 of 2 START sql table model silver.track_audio_features ....................... [RUN]
[0m22:05:36.012063 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.track_audio_features)
[0m22:05:36.012460 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.track_audio_features
[0m22:05:36.017072 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.track_audio_features"
[0m22:05:36.022631 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.track_audio_features
[0m22:05:36.021986 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m22:05:36.030124 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m22:05:36.086518 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.silver_plays"
[0m22:05:36.091373 [debug] [Thread-2 (]: Writing runtime sql for node "model.spotify_analytics.track_audio_features"
[0m22:05:36.094812 [debug] [Thread-2 (]: Using snowflake connection "model.spotify_analytics.track_audio_features"
[0m22:05:36.093713 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.silver_plays"
[0m22:05:36.095801 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.silver_plays"} */
create or replace transient table spotify_data.silver.silver_plays
         as
        (

-- ============================================================================
-- SILVER LAYER: CLEANED PLAYS DATA
-- ============================================================================
-- Purpose: Transform bronze plays data into clean, analytics-ready format
-- 
-- Transformations:
--   1. Deduplicate records (DISTINCT on event_id)
--   2. Cast all data types from VARIANT to proper types
--   3. Filter invalid records (defensive WHERE clauses)
--   4. Add processing metadata (processed_at timestamp)
--
-- Source: bronze.plays (external table reading from S3 Parquet files)
-- Target: SILVER.silver_plays (materialized table)
-- ============================================================================

WITH source_data AS (
    SELECT 
        VALUE:event_id::VARCHAR AS event_id,
        VALUE:user_id::VARCHAR AS user_id,
        VALUE:event_type::VARCHAR AS event_type,
        VALUE:track_id::VARCHAR AS track_id,
        VALUE:track_name::VARCHAR AS track_name,
        VALUE:artist_name::VARCHAR AS artist_name,
        VALUE:album_name::VARCHAR AS album_name,
        VALUE:duration_ms::NUMBER AS duration_ms,
        VALUE:played_at::VARCHAR AS played_at,
        VALUE:device_type::VARCHAR AS device_type
    FROM spotify_data.bronze.plays
),

deduplicated AS (
    SELECT DISTINCT
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM source_data
    WHERE 
        -- Data quality filters
        user_id IS NOT NULL
        AND duration_ms > 0
        AND duration_ms < 600000  -- Less than 10 minutes (catches data errors)
        AND event_id IS NOT NULL
)

SELECT 
    -- Identifiers
    event_id::VARCHAR AS event_id,
    user_id::VARCHAR AS user_id,
    event_type::VARCHAR AS event_type,
    
    -- Track information
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    duration_ms::NUMBER AS duration_ms,
    
    -- Timestamps
    TRY_CAST(played_at AS TIMESTAMP) AS played_at,
    
    -- Device context
    device_type::VARCHAR AS device_type,
    
    -- Metadata
    CURRENT_TIMESTAMP() AS processed_at
    
FROM deduplicated
        );
[0m22:05:36.095323 [debug] [Thread-2 (]: On model.spotify_analytics.track_audio_features: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.track_audio_features"} */
create or replace transient table spotify_data.silver.track_audio_features
         as
        (

/*
    Track Audio Features - Silver Layer
    
    Combines track metadata from plays with audio features from Spotify API
    This is a clean, deduplicated view of all tracks with their audio characteristics
*/

SELECT 
    af.track_id,
    af.danceability,
    af.energy,
    af.key,
    af.loudness,
    af.mode,
    af.speechiness,
    af.acousticness,
    af.instrumentalness,
    af.liveness,
    af.valence,
    af.tempo,
    af.duration_ms,
    af.time_signature,
    af.fetched_at
FROM spotify_data.bronze.track_audio_features af
WHERE af.track_id IS NOT NULL
        );
[0m22:05:36.097349 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:05:36.096258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:36.637489 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c0fccd-0004-171d-000a-68a20008f306
[0m22:05:36.638348 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
[0m22:05:36.638934 [debug] [Thread-2 (]: On model.spotify_analytics.track_audio_features: Close
[0m22:05:36.723204 [debug] [Thread-2 (]: Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql
[0m22:05:36.725459 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c41939e5-d52e-4782-80fc-e7560735dac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c459f08f790>]}
[0m22:05:36.726279 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model silver.track_audio_features .............. [[31mERROR[0m in 0.71s]
[0m22:05:36.727339 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.track_audio_features
[0m22:05:36.727907 [debug] [Thread-7 (]: Marking all children of 'model.spotify_analytics.track_audio_features' to be skipped because of status 'error'.  Reason: Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql.
[0m22:05:38.534087 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.438 seconds
[0m22:05:38.561458 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: Close
[0m22:05:38.608420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c41939e5-d52e-4782-80fc-e7560735dac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c459c532050>]}
[0m22:05:38.609392 [info ] [Thread-1 (]: 1 of 2 OK created sql table model silver.silver_plays .......................... [[32mSUCCESS 1[0m in 2.60s]
[0m22:05:38.611503 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m22:05:38.613913 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:38.614393 [debug] [MainThread]: Connection 'model.spotify_analytics.track_audio_features' was properly closed.
[0m22:05:38.614705 [debug] [MainThread]: Connection 'model.spotify_analytics.silver_plays' was properly closed.
[0m22:05:38.615338 [info ] [MainThread]: 
[0m22:05:38.616149 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 4.40 seconds (4.40s).
[0m22:05:38.618347 [debug] [MainThread]: Command end result
[0m22:05:38.656212 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:05:38.658323 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:05:38.664931 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m22:05:38.665298 [info ] [MainThread]: 
[0m22:05:38.665680 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:05:38.666664 [info ] [MainThread]: 
[0m22:05:38.668138 [error] [MainThread]: [31mFailure in model track_audio_features (models/silver/track_audio_features.sql)[0m
[0m22:05:38.668573 [error] [MainThread]:   Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql
[0m22:05:38.669920 [info ] [MainThread]: 
[0m22:05:38.670317 [info ] [MainThread]:   compiled code at target/compiled/spotify_analytics/models/silver/track_audio_features.sql
[0m22:05:38.670641 [info ] [MainThread]: 
[0m22:05:38.671374 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m22:05:38.672458 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.3813295, "process_in_blocks": "0", "process_kernel_time": 0.535418, "process_mem_max_rss": "251076", "process_out_blocks": "3176", "process_user_time": 4.291132}
[0m22:05:38.672974 [debug] [MainThread]: Command `dbt run` failed at 22:05:38.672880 after 6.38 seconds
[0m22:05:38.674419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c45b43cf510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c458ee333d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c458ee33610>]}
[0m22:05:38.674823 [debug] [MainThread]: Flushing usage events
[0m22:05:38.762374 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:09:17.599457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734289afe490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734289afe990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734289afcd10>]}


============================== 22:09:17.606362 | 90c6b243-33e0-434d-84bc-5ed42070f641 ==============================
[0m22:09:17.606362 [info ] [MainThread]: Running with dbt=1.10.15
[0m22:09:17.608245 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'introspect': 'True', 'empty': 'False', 'printer_width': '80', 'log_format': 'default', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'quiet': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'no_print': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select silver.*', 'partial_parse': 'True'}
[0m22:09:18.670163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90c6b243-33e0-434d-84bc-5ed42070f641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73428aafa4d0>]}
[0m22:09:18.748163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90c6b243-33e0-434d-84bc-5ed42070f641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73428ac0d850>]}
[0m22:09:18.749549 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:09:18.982255 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m22:09:19.166761 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:09:19.169473 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:09:19.181507 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m22:09:19.238512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90c6b243-33e0-434d-84bc-5ed42070f641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734278570810>]}
[0m22:09:19.365736 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:09:19.368239 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:09:19.392357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90c6b243-33e0-434d-84bc-5ed42070f641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73427826f150>]}
[0m22:09:19.393417 [info ] [MainThread]: Found 8 models, 43 data tests, 2 sources, 604 macros
[0m22:09:19.394258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90c6b243-33e0-434d-84bc-5ed42070f641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734289b04c90>]}
[0m22:09:19.396279 [info ] [MainThread]: 
[0m22:09:19.397418 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:09:19.398424 [info ] [MainThread]: 
[0m22:09:19.402357 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:09:19.408979 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m22:09:19.427675 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m22:09:19.428192 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m22:09:19.428513 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:09:20.374387 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.946 seconds
[0m22:09:20.376686 [debug] [ThreadPool]: On list_spotify_data: Close
[0m22:09:20.422339 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m22:09:20.428280 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_gold)
[0m22:09:20.433977 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m22:09:20.437619 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m22:09:20.438376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:09:20.437160 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m22:09:20.442175 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m22:09:20.443083 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:09:20.871688 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.433 seconds
[0m22:09:20.873079 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.430 seconds
[0m22:09:20.876032 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m22:09:20.877940 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m22:09:20.943776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90c6b243-33e0-434d-84bc-5ed42070f641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73427170c4d0>]}
[0m22:09:20.948813 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m22:09:20.949259 [debug] [Thread-2 (]: Began running node model.spotify_analytics.track_audio_features
[0m22:09:20.949781 [info ] [Thread-1 (]: 1 of 2 START sql table model silver.silver_plays ............................... [RUN]
[0m22:09:20.951552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.silver_plays)
[0m22:09:20.951945 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m22:09:20.950687 [info ] [Thread-2 (]: 2 of 2 START sql table model silver.track_audio_features ....................... [RUN]
[0m22:09:20.958258 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.track_audio_features)
[0m22:09:20.958667 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.track_audio_features
[0m22:09:20.963492 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.track_audio_features"
[0m22:09:20.968227 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.track_audio_features
[0m22:09:20.967579 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m22:09:20.974252 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m22:09:21.092914 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.silver_plays"
[0m22:09:21.093593 [debug] [Thread-2 (]: Writing runtime sql for node "model.spotify_analytics.track_audio_features"
[0m22:09:21.098668 [debug] [Thread-2 (]: Using snowflake connection "model.spotify_analytics.track_audio_features"
[0m22:09:21.103756 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.silver_plays"
[0m22:09:21.108213 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.silver_plays"} */
create or replace transient table spotify_data.silver.silver_plays
         as
        (

-- ============================================================================
-- SILVER LAYER: CLEANED PLAYS DATA
-- ============================================================================
-- Purpose: Transform bronze plays data into clean, analytics-ready format
-- 
-- Transformations:
--   1. Deduplicate records (DISTINCT on event_id)
--   2. Cast all data types from VARIANT to proper types
--   3. Filter invalid records (defensive WHERE clauses)
--   4. Add processing metadata (processed_at timestamp)
--
-- Source: bronze.plays (external table reading from S3 Parquet files)
-- Target: SILVER.silver_plays (materialized table)
-- ============================================================================

WITH source_data AS (
    SELECT 
        VALUE:event_id::VARCHAR AS event_id,
        VALUE:user_id::VARCHAR AS user_id,
        VALUE:event_type::VARCHAR AS event_type,
        VALUE:track_id::VARCHAR AS track_id,
        VALUE:track_name::VARCHAR AS track_name,
        VALUE:artist_name::VARCHAR AS artist_name,
        VALUE:album_name::VARCHAR AS album_name,
        VALUE:duration_ms::NUMBER AS duration_ms,
        VALUE:played_at::VARCHAR AS played_at,
        VALUE:device_type::VARCHAR AS device_type
    FROM spotify_data.bronze.plays
),

deduplicated AS (
    SELECT DISTINCT
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM source_data
    WHERE 
        -- Data quality filters
        user_id IS NOT NULL
        AND duration_ms > 0
        AND duration_ms < 600000  -- Less than 10 minutes (catches data errors)
        AND event_id IS NOT NULL
)

SELECT 
    -- Identifiers
    event_id::VARCHAR AS event_id,
    user_id::VARCHAR AS user_id,
    event_type::VARCHAR AS event_type,
    
    -- Track information
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    duration_ms::NUMBER AS duration_ms,
    
    -- Timestamps
    TRY_CAST(played_at AS TIMESTAMP) AS played_at,
    
    -- Device context
    device_type::VARCHAR AS device_type,
    
    -- Metadata
    CURRENT_TIMESTAMP() AS processed_at
    
FROM deduplicated
        );
[0m22:09:21.105408 [debug] [Thread-2 (]: On model.spotify_analytics.track_audio_features: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.track_audio_features"} */
create or replace transient table spotify_data.silver.track_audio_features
         as
        (

/*
    Track Audio Features - Silver Layer
    
    Combines track metadata from plays with audio features from Spotify API
    This is a clean, deduplicated view of all tracks with their audio characteristics
*/

SELECT 
    af.track_id,
    af.danceability,
    af.energy,
    af.key,
    af.loudness,
    af.mode,
    af.speechiness,
    af.acousticness,
    af.instrumentalness,
    af.liveness,
    af.valence,
    af.tempo,
    af.duration_ms,
    af.time_signature,
    af.fetched_at
FROM spotify_data.bronze.track_audio_features af
WHERE af.track_id IS NOT NULL
        );
[0m22:09:21.110194 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:09:21.108718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:09:21.808429 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c0fcd1-0004-1445-000a-68a20006d57a
[0m22:09:21.809637 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
[0m22:09:21.810370 [debug] [Thread-2 (]: On model.spotify_analytics.track_audio_features: Close
[0m22:09:21.852274 [debug] [Thread-2 (]: Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql
[0m22:09:21.854446 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90c6b243-33e0-434d-84bc-5ed42070f641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734253f46350>]}
[0m22:09:21.855239 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model silver.track_audio_features .............. [[31mERROR[0m in 0.89s]
[0m22:09:21.856192 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.track_audio_features
[0m22:09:21.856711 [debug] [Thread-7 (]: Marking all children of 'model.spotify_analytics.track_audio_features' to be skipped because of status 'error'.  Reason: Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql.
[0m22:09:23.049642 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.941 seconds
[0m22:09:23.074566 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: Close
[0m22:09:23.114997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90c6b243-33e0-434d-84bc-5ed42070f641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734278a8a790>]}
[0m22:09:23.116409 [info ] [Thread-1 (]: 1 of 2 OK created sql table model silver.silver_plays .......................... [[32mSUCCESS 1[0m in 2.16s]
[0m22:09:23.117082 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m22:09:23.118806 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:09:23.119233 [debug] [MainThread]: Connection 'model.spotify_analytics.track_audio_features' was properly closed.
[0m22:09:23.120589 [debug] [MainThread]: Connection 'model.spotify_analytics.silver_plays' was properly closed.
[0m22:09:23.121105 [info ] [MainThread]: 
[0m22:09:23.121775 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.72 seconds (3.72s).
[0m22:09:23.123278 [debug] [MainThread]: Command end result
[0m22:09:23.161639 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:09:23.164564 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:09:23.172739 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m22:09:23.173340 [info ] [MainThread]: 
[0m22:09:23.174453 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:09:23.175559 [info ] [MainThread]: 
[0m22:09:23.176317 [error] [MainThread]: [31mFailure in model track_audio_features (models/silver/track_audio_features.sql)[0m
[0m22:09:23.176964 [error] [MainThread]:   Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql
[0m22:09:23.178256 [info ] [MainThread]: 
[0m22:09:23.179392 [info ] [MainThread]:   compiled code at target/compiled/spotify_analytics/models/silver/track_audio_features.sql
[0m22:09:23.180053 [info ] [MainThread]: 
[0m22:09:23.180636 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m22:09:23.181926 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.647037, "process_in_blocks": "0", "process_kernel_time": 0.544838, "process_mem_max_rss": "249912", "process_out_blocks": "3184", "process_user_time": 4.256308}
[0m22:09:23.183363 [debug] [MainThread]: Command `dbt run` failed at 22:09:23.183254 after 5.65 seconds
[0m22:09:23.183803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734289afe190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734289afdc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73428e1c0fd0>]}
[0m22:09:23.184248 [debug] [MainThread]: Flushing usage events
[0m22:09:23.268400 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:14:20.049423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77001b37f790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77001b37d690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77001b37d990>]}


============================== 22:14:20.057720 | ce19d256-0be1-4e91-ad83-720c26d5fb01 ==============================
[0m22:14:20.057720 [info ] [MainThread]: Running with dbt=1.10.15
[0m22:14:20.059052 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'printer_width': '80', 'quiet': 'False', 'empty': 'False', 'profiles_dir': '/opt/airflow/dbt', 'target_path': 'None', 'warn_error': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'no_print': 'None', 'log_path': '/opt/airflow/dbt/logs', 'cache_selected_only': 'False', 'debug': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'introspect': 'True', 'use_colors': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select silver.*'}
[0m22:14:21.199152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce19d256-0be1-4e91-ad83-720c26d5fb01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77001b344e50>]}
[0m22:14:21.279804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce19d256-0be1-4e91-ad83-720c26d5fb01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7700061c9210>]}
[0m22:14:21.280756 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:14:21.551619 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m22:14:21.722098 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:14:21.722638 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:14:21.728453 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m22:14:21.781827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce19d256-0be1-4e91-ad83-720c26d5fb01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7700060fd690>]}
[0m22:14:21.922079 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:14:21.926334 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:14:21.967287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce19d256-0be1-4e91-ad83-720c26d5fb01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770005f14dd0>]}
[0m22:14:21.969934 [info ] [MainThread]: Found 8 models, 43 data tests, 2 sources, 604 macros
[0m22:14:21.974330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce19d256-0be1-4e91-ad83-720c26d5fb01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7700060efcd0>]}
[0m22:14:21.977430 [info ] [MainThread]: 
[0m22:14:21.978392 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:14:21.979655 [info ] [MainThread]: 
[0m22:14:21.980687 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:14:21.986637 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m22:14:22.003500 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m22:14:22.003976 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m22:14:22.004754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:14:22.973038 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.968 seconds
[0m22:14:22.977103 [debug] [ThreadPool]: On list_spotify_data: Close
[0m22:14:23.034815 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_silver)
[0m22:14:23.041635 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m22:14:23.046785 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m22:14:23.050895 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m22:14:23.051284 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:14:23.049893 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m22:14:23.052082 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m22:14:23.052424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:14:23.491821 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.439 seconds
[0m22:14:23.494379 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m22:14:23.722936 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.672 seconds
[0m22:14:23.729759 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m22:14:23.808951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce19d256-0be1-4e91-ad83-720c26d5fb01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770005ef25d0>]}
[0m22:14:23.814348 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m22:14:23.815492 [debug] [Thread-2 (]: Began running node model.spotify_analytics.track_audio_features
[0m22:14:23.815128 [info ] [Thread-1 (]: 1 of 2 START sql table model silver.silver_plays ............................... [RUN]
[0m22:14:23.818148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.silver_plays)
[0m22:14:23.816593 [info ] [Thread-2 (]: 2 of 2 START sql table model silver.track_audio_features ....................... [RUN]
[0m22:14:23.820226 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.track_audio_features)
[0m22:14:23.819690 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m22:14:23.820629 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.track_audio_features
[0m22:14:23.831078 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.track_audio_features"
[0m22:14:23.836202 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.track_audio_features
[0m22:14:23.835094 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m22:14:23.843270 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m22:14:23.899290 [debug] [Thread-2 (]: Writing runtime sql for node "model.spotify_analytics.track_audio_features"
[0m22:14:23.902125 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.silver_plays"
[0m22:14:23.903485 [debug] [Thread-2 (]: Using snowflake connection "model.spotify_analytics.track_audio_features"
[0m22:14:23.906039 [debug] [Thread-2 (]: On model.spotify_analytics.track_audio_features: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.track_audio_features"} */
create or replace transient table spotify_data.silver.track_audio_features
         as
        (

/*
    Track Audio Features - Silver Layer
    
    Combines track metadata from plays with audio features from Spotify API
    This is a clean, deduplicated view of all tracks with their audio characteristics
*/

SELECT 
    af.track_id,
    af.danceability,
    af.energy,
    af.key,
    af.loudness,
    af.mode,
    af.speechiness,
    af.acousticness,
    af.instrumentalness,
    af.liveness,
    af.valence,
    af.tempo,
    af.duration_ms,
    af.time_signature,
    af.fetched_at
FROM spotify_data.bronze.track_audio_features af
WHERE af.track_id IS NOT NULL
        );
[0m22:14:23.906434 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:14:23.905588 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.silver_plays"
[0m22:14:23.907350 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.silver_plays"} */
create or replace transient table spotify_data.silver.silver_plays
         as
        (

-- ============================================================================
-- SILVER LAYER: CLEANED PLAYS DATA
-- ============================================================================
-- Purpose: Transform bronze plays data into clean, analytics-ready format
-- 
-- Transformations:
--   1. Deduplicate records (DISTINCT on event_id)
--   2. Cast all data types from VARIANT to proper types
--   3. Filter invalid records (defensive WHERE clauses)
--   4. Add processing metadata (processed_at timestamp)
--
-- Source: bronze.plays (external table reading from S3 Parquet files)
-- Target: SILVER.silver_plays (materialized table)
-- ============================================================================

WITH source_data AS (
    SELECT 
        VALUE:event_id::VARCHAR AS event_id,
        VALUE:user_id::VARCHAR AS user_id,
        VALUE:event_type::VARCHAR AS event_type,
        VALUE:track_id::VARCHAR AS track_id,
        VALUE:track_name::VARCHAR AS track_name,
        VALUE:artist_name::VARCHAR AS artist_name,
        VALUE:album_name::VARCHAR AS album_name,
        VALUE:duration_ms::NUMBER AS duration_ms,
        VALUE:played_at::VARCHAR AS played_at,
        VALUE:device_type::VARCHAR AS device_type
    FROM spotify_data.bronze.plays
),

deduplicated AS (
    SELECT DISTINCT
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM source_data
    WHERE 
        -- Data quality filters
        user_id IS NOT NULL
        AND duration_ms > 0
        AND duration_ms < 600000  -- Less than 10 minutes (catches data errors)
        AND event_id IS NOT NULL
)

SELECT 
    -- Identifiers
    event_id::VARCHAR AS event_id,
    user_id::VARCHAR AS user_id,
    event_type::VARCHAR AS event_type,
    
    -- Track information
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    duration_ms::NUMBER AS duration_ms,
    
    -- Timestamps
    TRY_CAST(played_at AS TIMESTAMP) AS played_at,
    
    -- Device context
    device_type::VARCHAR AS device_type,
    
    -- Metadata
    CURRENT_TIMESTAMP() AS processed_at
    
FROM deduplicated
        );
[0m22:14:23.908330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:14:24.364376 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c0fcd6-0004-162f-000a-68a200089352
[0m22:14:24.365519 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
[0m22:14:24.366675 [debug] [Thread-2 (]: On model.spotify_analytics.track_audio_features: Close
[0m22:14:24.411322 [debug] [Thread-2 (]: Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql
[0m22:14:24.413537 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce19d256-0be1-4e91-ad83-720c26d5fb01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770005d92150>]}
[0m22:14:24.414735 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model silver.track_audio_features .............. [[31mERROR[0m in 0.59s]
[0m22:14:24.416333 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.track_audio_features
[0m22:14:24.416956 [debug] [Thread-7 (]: Marking all children of 'model.spotify_analytics.track_audio_features' to be skipped because of status 'error'.  Reason: Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql.
[0m22:14:26.032123 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.124 seconds
[0m22:14:26.059070 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: Close
[0m22:14:26.098292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce19d256-0be1-4e91-ad83-720c26d5fb01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fff5ff5e10>]}
[0m22:14:26.099437 [info ] [Thread-1 (]: 1 of 2 OK created sql table model silver.silver_plays .......................... [[32mSUCCESS 1[0m in 2.28s]
[0m22:14:26.100883 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m22:14:26.102385 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:14:26.102757 [debug] [MainThread]: Connection 'model.spotify_analytics.silver_plays' was properly closed.
[0m22:14:26.103183 [debug] [MainThread]: Connection 'model.spotify_analytics.track_audio_features' was properly closed.
[0m22:14:26.103564 [info ] [MainThread]: 
[0m22:14:26.104617 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 4.12 seconds (4.12s).
[0m22:14:26.106193 [debug] [MainThread]: Command end result
[0m22:14:26.156195 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:14:26.160819 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:14:26.176758 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m22:14:26.177226 [info ] [MainThread]: 
[0m22:14:26.178499 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:14:26.179253 [info ] [MainThread]: 
[0m22:14:26.181210 [error] [MainThread]: [31mFailure in model track_audio_features (models/silver/track_audio_features.sql)[0m
[0m22:14:26.181703 [error] [MainThread]:   Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql
[0m22:14:26.183147 [info ] [MainThread]: 
[0m22:14:26.183536 [info ] [MainThread]:   compiled code at target/compiled/spotify_analytics/models/silver/track_audio_features.sql
[0m22:14:26.185960 [info ] [MainThread]: 
[0m22:14:26.190060 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m22:14:26.191639 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.2069874, "process_in_blocks": "0", "process_kernel_time": 0.52333, "process_mem_max_rss": "250048", "process_out_blocks": "3184", "process_user_time": 4.26841}
[0m22:14:26.193405 [debug] [MainThread]: Command `dbt run` failed at 22:14:26.193281 after 6.21 seconds
[0m22:14:26.194010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77001b344f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77001b344cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77001b393bd0>]}
[0m22:14:26.194454 [debug] [MainThread]: Flushing usage events
[0m22:14:26.289086 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:24:30.809518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79babc049010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79babc346d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79babc0495d0>]}


============================== 22:24:30.816392 | 5a9d8d2b-5687-47e7-ae6d-c88c3d4ba096 ==============================
[0m22:24:30.816392 [info ] [MainThread]: Running with dbt=1.10.15
[0m22:24:30.817343 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'invocation_command': 'dbt run --select silver.*', 'printer_width': '80', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'log_path': '/opt/airflow/dbt/logs', 'quiet': 'False', 'write_json': 'True', 'debug': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'log_format': 'default', 'no_print': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt'}
[0m22:24:31.903298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a9d8d2b-5687-47e7-ae6d-c88c3d4ba096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79babc71ba50>]}
[0m22:24:31.980581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a9d8d2b-5687-47e7-ae6d-c88c3d4ba096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79babd12d790>]}
[0m22:24:31.982051 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:24:32.203930 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m22:24:32.403726 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:24:32.405191 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:24:32.412383 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m22:24:32.472750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a9d8d2b-5687-47e7-ae6d-c88c3d4ba096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79baa6c2d850>]}
[0m22:24:32.589781 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:24:32.592115 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:24:32.622437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a9d8d2b-5687-47e7-ae6d-c88c3d4ba096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79baa66cbe90>]}
[0m22:24:32.623243 [info ] [MainThread]: Found 8 models, 43 data tests, 2 sources, 604 macros
[0m22:24:32.623651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a9d8d2b-5687-47e7-ae6d-c88c3d4ba096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79baa6dcd310>]}
[0m22:24:32.627423 [info ] [MainThread]: 
[0m22:24:32.628168 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:24:32.628745 [info ] [MainThread]: 
[0m22:24:32.629295 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:24:32.634722 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m22:24:32.651463 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m22:24:32.651876 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m22:24:32.652210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:33.541834 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.890 seconds
[0m22:24:33.543585 [debug] [ThreadPool]: On list_spotify_data: Close
[0m22:24:33.660100 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_silver)
[0m22:24:33.666378 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m22:24:33.675447 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m22:24:33.676191 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m22:24:33.677050 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m22:24:33.677377 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:24:33.676686 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m22:24:33.678115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:34.167879 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.490 seconds
[0m22:24:34.169671 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m22:24:34.591622 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.913 seconds
[0m22:24:34.594329 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m22:24:34.637909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a9d8d2b-5687-47e7-ae6d-c88c3d4ba096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79baa67f8a50>]}
[0m22:24:34.642530 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m22:24:34.643023 [debug] [Thread-2 (]: Began running node model.spotify_analytics.track_audio_features
[0m22:24:34.643530 [info ] [Thread-1 (]: 1 of 2 START sql table model silver.silver_plays ............................... [RUN]
[0m22:24:34.644778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.silver_plays)
[0m22:24:34.644316 [info ] [Thread-2 (]: 2 of 2 START sql table model silver.track_audio_features ....................... [RUN]
[0m22:24:34.647176 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.track_audio_features)
[0m22:24:34.646679 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m22:24:34.647803 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.track_audio_features
[0m22:24:34.657845 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.track_audio_features"
[0m22:24:34.661910 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.track_audio_features
[0m22:24:34.661268 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m22:24:34.669678 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m22:24:34.717865 [debug] [Thread-2 (]: Writing runtime sql for node "model.spotify_analytics.track_audio_features"
[0m22:24:34.723164 [debug] [Thread-2 (]: Using snowflake connection "model.spotify_analytics.track_audio_features"
[0m22:24:34.721403 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.silver_plays"
[0m22:24:34.723635 [debug] [Thread-2 (]: On model.spotify_analytics.track_audio_features: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.track_audio_features"} */
create or replace transient table spotify_data.silver.track_audio_features
         as
        (

/*
    Track Audio Features - Silver Layer
    
    Combines track metadata from plays with audio features from Spotify API
    This is a clean, deduplicated view of all tracks with their audio characteristics
*/

SELECT 
    af.track_id,
    af.danceability,
    af.energy,
    af.key,
    af.loudness,
    af.mode,
    af.speechiness,
    af.acousticness,
    af.instrumentalness,
    af.liveness,
    af.valence,
    af.tempo,
    af.duration_ms,
    af.time_signature,
    af.fetched_at
FROM spotify_data.bronze.track_audio_features af
WHERE af.track_id IS NOT NULL
        );
[0m22:24:34.726518 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:24:34.725670 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.silver_plays"
[0m22:24:34.728792 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.silver_plays"} */
create or replace transient table spotify_data.silver.silver_plays
         as
        (

-- ============================================================================
-- SILVER LAYER: CLEANED PLAYS DATA
-- ============================================================================
-- Purpose: Transform bronze plays data into clean, analytics-ready format
-- 
-- Transformations:
--   1. Deduplicate records (DISTINCT on event_id)
--   2. Cast all data types from VARIANT to proper types
--   3. Filter invalid records (defensive WHERE clauses)
--   4. Add processing metadata (processed_at timestamp)
--
-- Source: bronze.plays (external table reading from S3 Parquet files)
-- Target: SILVER.silver_plays (materialized table)
-- ============================================================================

WITH source_data AS (
    SELECT 
        VALUE:event_id::VARCHAR AS event_id,
        VALUE:user_id::VARCHAR AS user_id,
        VALUE:event_type::VARCHAR AS event_type,
        VALUE:track_id::VARCHAR AS track_id,
        VALUE:track_name::VARCHAR AS track_name,
        VALUE:artist_name::VARCHAR AS artist_name,
        VALUE:album_name::VARCHAR AS album_name,
        VALUE:duration_ms::NUMBER AS duration_ms,
        VALUE:played_at::VARCHAR AS played_at,
        VALUE:device_type::VARCHAR AS device_type
    FROM spotify_data.bronze.plays
),

deduplicated AS (
    SELECT DISTINCT
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM source_data
    WHERE 
        -- Data quality filters
        user_id IS NOT NULL
        AND duration_ms > 0
        AND duration_ms < 600000  -- Less than 10 minutes (catches data errors)
        AND event_id IS NOT NULL
)

SELECT 
    -- Identifiers
    event_id::VARCHAR AS event_id,
    user_id::VARCHAR AS user_id,
    event_type::VARCHAR AS event_type,
    
    -- Track information
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    duration_ms::NUMBER AS duration_ms,
    
    -- Timestamps
    TRY_CAST(played_at AS TIMESTAMP) AS played_at,
    
    -- Device context
    device_type::VARCHAR AS device_type,
    
    -- Metadata
    CURRENT_TIMESTAMP() AS processed_at
    
FROM deduplicated
        );
[0m22:24:34.729288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:35.551720 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c0fce0-0004-1445-000a-68a20006d58a
[0m22:24:35.553062 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
[0m22:24:35.553671 [debug] [Thread-2 (]: On model.spotify_analytics.track_audio_features: Close
[0m22:24:35.621693 [debug] [Thread-2 (]: Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql
[0m22:24:35.623483 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a9d8d2b-5687-47e7-ae6d-c88c3d4ba096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79baa6defa90>]}
[0m22:24:35.624220 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model silver.track_audio_features .............. [[31mERROR[0m in 0.98s]
[0m22:24:35.626332 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.track_audio_features
[0m22:24:35.626888 [debug] [Thread-7 (]: Marking all children of 'model.spotify_analytics.track_audio_features' to be skipped because of status 'error'.  Reason: Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql.
[0m22:24:36.685180 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.956 seconds
[0m22:24:36.712781 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: Close
[0m22:24:36.756701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a9d8d2b-5687-47e7-ae6d-c88c3d4ba096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79baa6dcea10>]}
[0m22:24:36.757635 [info ] [Thread-1 (]: 1 of 2 OK created sql table model silver.silver_plays .......................... [[32mSUCCESS 1[0m in 2.11s]
[0m22:24:36.758592 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m22:24:36.762152 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:24:36.762531 [debug] [MainThread]: Connection 'model.spotify_analytics.track_audio_features' was properly closed.
[0m22:24:36.762834 [debug] [MainThread]: Connection 'model.spotify_analytics.silver_plays' was properly closed.
[0m22:24:36.763325 [info ] [MainThread]: 
[0m22:24:36.763699 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 4.13 seconds (4.13s).
[0m22:24:36.765135 [debug] [MainThread]: Command end result
[0m22:24:36.803724 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:24:36.805790 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:24:36.812955 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m22:24:36.813375 [info ] [MainThread]: 
[0m22:24:36.814141 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:24:36.814973 [info ] [MainThread]: 
[0m22:24:36.816395 [error] [MainThread]: [31mFailure in model track_audio_features (models/silver/track_audio_features.sql)[0m
[0m22:24:36.817048 [error] [MainThread]:   Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql
[0m22:24:36.817846 [info ] [MainThread]: 
[0m22:24:36.818831 [info ] [MainThread]:   compiled code at target/compiled/spotify_analytics/models/silver/track_audio_features.sql
[0m22:24:36.819668 [info ] [MainThread]: 
[0m22:24:36.820227 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m22:24:36.821332 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.0787067, "process_in_blocks": "0", "process_kernel_time": 0.50438, "process_mem_max_rss": "250160", "process_out_blocks": "3184", "process_user_time": 4.240774}
[0m22:24:36.821833 [debug] [MainThread]: Command `dbt run` failed at 22:24:36.821743 after 6.08 seconds
[0m22:24:36.822273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bac0709150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bac0708dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79babc057850>]}
[0m22:24:36.822662 [debug] [MainThread]: Flushing usage events
[0m22:24:36.912211 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:05:25.122503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7839ab2b3a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7839ab2b3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7839ab2b0a10>]}


============================== 23:05:25.132232 | 02edaa7f-a614-4f22-8b6d-6e5a19ca738c ==============================
[0m23:05:25.132232 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:05:25.132830 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'use_colors': 'True', 'quiet': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'printer_width': '80', 'write_json': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'invocation_command': 'dbt compile', 'partial_parse': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'empty': 'False'}
[0m23:05:26.588438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02edaa7f-a614-4f22-8b6d-6e5a19ca738c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78399606ea50>]}
[0m23:05:26.725347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02edaa7f-a614-4f22-8b6d-6e5a19ca738c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7839adc66f10>]}
[0m23:05:26.728448 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:05:26.966060 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m23:05:27.336205 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:05:27.337521 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:05:27.344986 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m23:05:27.396481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02edaa7f-a614-4f22-8b6d-6e5a19ca738c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783995ea57d0>]}
[0m23:05:27.514948 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m23:05:27.518270 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m23:05:27.550835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02edaa7f-a614-4f22-8b6d-6e5a19ca738c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783995b96690>]}
[0m23:05:27.551431 [info ] [MainThread]: Found 8 models, 43 data tests, 2 sources, 604 macros
[0m23:05:27.552527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02edaa7f-a614-4f22-8b6d-6e5a19ca738c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78399620bad0>]}
[0m23:05:27.556118 [info ] [MainThread]: 
[0m23:05:27.556785 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:05:27.557334 [info ] [MainThread]: 
[0m23:05:27.561081 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:05:27.566629 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m23:05:27.567574 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m23:05:27.604484 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m23:05:27.605539 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m23:05:27.606385 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m23:05:27.606693 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:27.606027 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m23:05:27.607998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:28.669916 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.063 seconds
[0m23:05:28.672137 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m23:05:30.334257 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.726 seconds
[0m23:05:30.336052 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m23:05:30.413560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02edaa7f-a614-4f22-8b6d-6e5a19ca738c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783997cb4610>]}
[0m23:05:30.421884 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m23:05:30.422400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.silver_plays)
[0m23:05:30.422800 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m23:05:30.423564 [debug] [Thread-2 (]: Began running node model.spotify_analytics.track_audio_features
[0m23:05:30.429523 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.track_audio_features)
[0m23:05:30.429974 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.track_audio_features
[0m23:05:30.423965 [debug] [Thread-3 (]: Began running node model.spotify_analytics.track_recommendations
[0m23:05:30.436365 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.spotify_analytics.track_recommendations'
[0m23:05:30.436782 [debug] [Thread-3 (]: Began compiling node model.spotify_analytics.track_recommendations
[0m23:05:30.435553 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m23:05:30.441469 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.track_audio_features"
[0m23:05:30.446262 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.track_audio_features
[0m23:05:30.447186 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.track_audio_features
[0m23:05:30.445100 [debug] [Thread-3 (]: Writing injected SQL for node "model.spotify_analytics.track_recommendations"
[0m23:05:30.447702 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m23:05:30.448344 [debug] [Thread-3 (]: Began executing node model.spotify_analytics.track_recommendations
[0m23:05:30.450500 [debug] [Thread-3 (]: Finished running node model.spotify_analytics.track_recommendations
[0m23:05:30.449250 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m23:05:30.452779 [debug] [Thread-4 (]: Began running node model.spotify_analytics.daily_user_stats
[0m23:05:30.453469 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.spotify_analytics.daily_user_stats'
[0m23:05:30.453935 [debug] [Thread-4 (]: Began compiling node model.spotify_analytics.daily_user_stats
[0m23:05:30.454313 [debug] [Thread-3 (]: Began running node model.spotify_analytics.device_usage
[0m23:05:30.454671 [debug] [Thread-1 (]: Began running node model.spotify_analytics.top_artists
[0m23:05:30.455081 [debug] [Thread-2 (]: Began running node model.spotify_analytics.top_tracks
[0m23:05:30.463278 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.track_audio_features, now model.spotify_analytics.top_tracks)
[0m23:05:30.460184 [debug] [Thread-4 (]: Writing injected SQL for node "model.spotify_analytics.daily_user_stats"
[0m23:05:30.462480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.silver_plays, now model.spotify_analytics.top_artists)
[0m23:05:30.464292 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.top_artists
[0m23:05:30.461976 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.track_recommendations, now model.spotify_analytics.device_usage)
[0m23:05:30.463718 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.top_tracks
[0m23:05:30.470051 [debug] [Thread-3 (]: Began compiling node model.spotify_analytics.device_usage
[0m23:05:30.475718 [debug] [Thread-4 (]: Began executing node model.spotify_analytics.daily_user_stats
[0m23:05:30.480393 [debug] [Thread-4 (]: Finished running node model.spotify_analytics.daily_user_stats
[0m23:05:30.474470 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.top_tracks"
[0m23:05:30.482549 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.top_tracks
[0m23:05:30.479664 [debug] [Thread-3 (]: Writing injected SQL for node "model.spotify_analytics.device_usage"
[0m23:05:30.484029 [debug] [Thread-3 (]: Began executing node model.spotify_analytics.device_usage
[0m23:05:30.476323 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.top_artists"
[0m23:05:30.485209 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.top_artists
[0m23:05:30.480823 [debug] [Thread-4 (]: Began running node model.spotify_analytics.user_listening_profile
[0m23:05:30.486907 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.daily_user_stats, now model.spotify_analytics.user_listening_profile)
[0m23:05:30.487551 [debug] [Thread-4 (]: Began compiling node model.spotify_analytics.user_listening_profile
[0m23:05:30.483350 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.top_tracks
[0m23:05:30.485796 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.top_artists
[0m23:05:30.492804 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m23:05:30.493265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.top_artists, now test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad)
[0m23:05:30.484631 [debug] [Thread-3 (]: Finished running node model.spotify_analytics.device_usage
[0m23:05:30.490615 [debug] [Thread-4 (]: Writing injected SQL for node "model.spotify_analytics.user_listening_profile"
[0m23:05:30.494597 [debug] [Thread-4 (]: Began executing node model.spotify_analytics.user_listening_profile
[0m23:05:30.495244 [debug] [Thread-4 (]: Finished running node model.spotify_analytics.user_listening_profile
[0m23:05:30.491711 [debug] [Thread-2 (]: Began running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m23:05:30.496420 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.top_tracks, now test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39)
[0m23:05:30.494065 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m23:05:30.497883 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.device_usage, now test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076)
[0m23:05:30.498290 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m23:05:30.495804 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m23:05:30.493638 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m23:05:30.497392 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m23:05:30.504136 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.user_listening_profile, now test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd)
[0m23:05:30.518396 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m23:05:30.538658 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m23:05:30.544698 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m23:05:30.543480 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m23:05:30.540563 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m23:05:30.545464 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m23:05:30.546297 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m23:05:30.546740 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m23:05:30.549019 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m23:05:30.547198 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m23:05:30.550465 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m23:05:30.547672 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m23:05:30.551968 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m23:05:30.552372 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m23:05:30.548258 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m23:05:30.553276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad, now test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa)
[0m23:05:30.549437 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m23:05:30.554083 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076, now test.spotify_analytics.not_null_silver_plays_played_at.8281565f95)
[0m23:05:30.554436 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m23:05:30.550892 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m23:05:30.562023 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd, now test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed)
[0m23:05:30.562434 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m23:05:30.553664 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m23:05:30.552783 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39, now test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9)
[0m23:05:30.571398 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m23:05:30.566215 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m23:05:30.576788 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m23:05:30.576191 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m23:05:30.578479 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m23:05:30.570964 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m23:05:30.580083 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m23:05:30.577449 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m23:05:30.581157 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m23:05:30.581558 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed, now test.spotify_analytics.not_null_silver_plays_track_name.c6334add30)
[0m23:05:30.575633 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m23:05:30.581945 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m23:05:30.580690 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m23:05:30.579551 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m23:05:30.588670 [debug] [Thread-3 (]: Began running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m23:05:30.589094 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_played_at.8281565f95, now test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf)
[0m23:05:30.589466 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m23:05:30.588168 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m23:05:30.595418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa, now test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4)
[0m23:05:30.582444 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m23:05:30.597044 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m23:05:30.586908 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m23:05:30.598001 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m23:05:30.596350 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m23:05:30.597462 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m23:05:30.615707 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9, now test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155)
[0m23:05:30.598603 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m23:05:30.617482 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m23:05:30.614950 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m23:05:30.619541 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m23:05:30.616194 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m23:05:30.618505 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_track_name.c6334add30, now test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9)
[0m23:05:30.626211 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m23:05:30.620415 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m23:05:30.625688 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m23:05:30.631832 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m23:05:30.633056 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf, now test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87)
[0m23:05:30.632434 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m23:05:30.634946 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m23:05:30.634008 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m23:05:30.631285 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m23:05:30.637409 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m23:05:30.633549 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m23:05:30.636161 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m23:05:30.645001 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m23:05:30.638024 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m23:05:30.636836 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m23:05:30.647332 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m23:05:30.647718 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155, now test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac)
[0m23:05:30.648111 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m23:05:30.646354 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m23:05:30.652978 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9, now test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f)
[0m23:05:30.653371 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m23:05:30.644049 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m23:05:30.658535 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m23:05:30.645846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4, now test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282)
[0m23:05:30.659690 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m23:05:30.652459 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m23:05:30.664454 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m23:05:30.665106 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m23:05:30.657964 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m23:05:30.659303 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m23:05:30.667544 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m23:05:30.668087 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87, now test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003)
[0m23:05:30.665553 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m23:05:30.669340 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac, now test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b)
[0m23:05:30.669736 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m23:05:30.663905 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m23:05:30.675051 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m23:05:30.667015 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m23:05:30.676357 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m23:05:30.668922 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m23:05:30.675700 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m23:05:30.676820 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m23:05:30.674030 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m23:05:30.685429 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m23:05:30.683355 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m23:05:30.687344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282, now test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2)
[0m23:05:30.687770 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m23:05:30.686187 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m23:05:30.694457 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m23:05:30.683831 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f, now test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c)
[0m23:05:30.686811 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m23:05:30.693776 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m23:05:30.698758 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m23:05:30.696616 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m23:05:30.695534 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b, now test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2)
[0m23:05:30.705328 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m23:05:30.697956 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m23:05:30.710958 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m23:05:30.699832 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m23:05:30.704815 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m23:05:30.713399 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m23:05:30.714017 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m23:05:30.714488 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m23:05:30.710210 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m23:05:30.715455 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m23:05:30.716049 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m23:05:30.711412 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m23:05:30.717331 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003, now test.spotify_analytics.not_null_device_usage_total_plays.90a295df48)
[0m23:05:30.712749 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m23:05:30.718611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2, now test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e)
[0m23:05:30.719004 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m23:05:30.714910 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c, now test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14)
[0m23:05:30.725097 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m23:05:30.716421 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m23:05:30.730179 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2, now test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca)
[0m23:05:30.730556 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m23:05:30.717701 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m23:05:30.729696 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m23:05:30.740340 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m23:05:30.724905 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m23:05:30.734702 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m23:05:30.742050 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m23:05:30.741406 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m23:05:30.743226 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m23:05:30.739069 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m23:05:30.744764 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m23:05:30.742646 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m23:05:30.745871 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m23:05:30.744144 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14, now test.spotify_analytics.not_null_top_artists_rank.d14513fc96)
[0m23:05:30.743684 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m23:05:30.748139 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m23:05:30.746303 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca, now test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c)
[0m23:05:30.748969 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m23:05:30.745392 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m23:05:30.754123 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m23:05:30.754569 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_plays.90a295df48, now test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13)
[0m23:05:30.748569 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m23:05:30.755822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e, now test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11)
[0m23:05:30.756205 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m23:05:30.746671 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m23:05:30.752645 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m23:05:30.765838 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m23:05:30.754967 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m23:05:30.761794 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m23:05:30.766543 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m23:05:30.774492 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m23:05:30.775145 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c, now test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461)
[0m23:05:30.775563 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m23:05:30.765170 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m23:05:30.772418 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m23:05:30.782191 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m23:05:30.773272 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m23:05:30.783716 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m23:05:30.784145 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m23:05:30.783073 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m23:05:30.781503 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m23:05:30.786902 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m23:05:30.784618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11, now test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31)
[0m23:05:30.787760 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m23:05:30.787357 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m23:05:30.784960 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m23:05:30.795245 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m23:05:30.785361 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m23:05:30.796369 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13, now test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532)
[0m23:05:30.796732 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m23:05:30.794566 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_rank.d14513fc96, now test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4)
[0m23:05:30.803361 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m23:05:30.795945 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m23:05:30.808104 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m23:05:30.800947 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m23:05:30.809694 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m23:05:30.802930 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m23:05:30.811111 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m23:05:30.807628 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m23:05:30.812319 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m23:05:30.809046 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461, now test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac)
[0m23:05:30.813339 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m23:05:30.812920 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m23:05:30.817951 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m23:05:30.818379 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4, now test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893)
[0m23:05:30.811715 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m23:05:30.810533 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m23:05:30.820601 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m23:05:30.821023 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532, now test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203)
[0m23:05:30.821395 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m23:05:30.818742 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m23:05:30.819202 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m23:05:30.833408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31, now test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78)
[0m23:05:30.825039 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m23:05:30.834775 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m23:05:30.835450 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m23:05:30.817470 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m23:05:30.836986 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m23:05:30.834234 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m23:05:30.833074 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m23:05:30.852247 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m23:05:30.836399 [debug] [Thread-3 (]: Began running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m23:05:30.853540 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203, now test.spotify_analytics.unique_device_usage_device_type.e75362861b)
[0m23:05:30.853942 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m23:05:30.838075 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m23:05:30.858564 [debug] [Thread-2 (]: Began running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m23:05:30.859057 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac, now test.spotify_analytics.unique_top_artists_artist_name.008ffa1533)
[0m23:05:30.859468 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m23:05:30.851391 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m23:05:30.865346 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m23:05:30.853066 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m23:05:30.866581 [debug] [Thread-4 (]: Began running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m23:05:30.857961 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m23:05:30.868524 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m23:05:30.869165 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m23:05:30.867011 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893, now test.spotify_analytics.unique_top_artists_rank.68b5480aed)
[0m23:05:30.870048 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m23:05:30.866082 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m23:05:30.875053 [debug] [Thread-1 (]: Began running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m23:05:30.875455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78, now test.spotify_analytics.unique_top_tracks_track_id.865b43a659)
[0m23:05:30.874575 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m23:05:30.876411 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m23:05:30.869591 [debug] [Thread-3 (]: Began running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m23:05:30.877533 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_device_usage_device_type.e75362861b, now test.spotify_analytics.unique_top_tracks_rank.8fecde1136)
[0m23:05:30.877913 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m23:05:30.874269 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m23:05:30.883148 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m23:05:30.877044 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m23:05:30.875821 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m23:05:30.883772 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m23:05:30.882561 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m23:05:30.888242 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m23:05:30.887604 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m23:05:30.889441 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m23:05:30.890044 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m23:05:30.888844 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m23:05:30.891259 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:05:30.891603 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_track_id.865b43a659' was properly closed.
[0m23:05:30.892397 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_artists_artist_name.008ffa1533' was properly closed.
[0m23:05:30.892687 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_rank.8fecde1136' was properly closed.
[0m23:05:30.893548 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_artists_rank.68b5480aed' was properly closed.
[0m23:05:30.901381 [debug] [MainThread]: Command end result
[0m23:05:30.944830 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m23:05:30.946950 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m23:05:30.956883 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m23:05:30.960576 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 5.9071865, "process_in_blocks": "80776", "process_kernel_time": 0.688545, "process_mem_max_rss": "250952", "process_out_blocks": "3760", "process_user_time": 4.335659}
[0m23:05:30.961170 [debug] [MainThread]: Command `dbt compile` succeeded at 23:05:30.961061 after 5.91 seconds
[0m23:05:30.961593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7839ab243610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7839ab243090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7839ab2bc290>]}
[0m23:05:30.962355 [debug] [MainThread]: Flushing usage events
[0m23:05:31.064948 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:05:36.518522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be057421190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be057421650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be057421450>]}


============================== 23:05:36.531342 | 5c37598e-3571-46f9-bc83-0de3cc779ac5 ==============================
[0m23:05:36.531342 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:05:36.533081 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'invocation_command': 'dbt run --select silver.*', 'fail_fast': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_path': '/opt/airflow/dbt/logs', 'printer_width': '80', 'write_json': 'True', 'partial_parse': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'empty': 'False', 'use_colors': 'True', 'introspect': 'True'}
[0m23:05:37.590678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c37598e-3571-46f9-bc83-0de3cc779ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be057412b10>]}
[0m23:05:37.668274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c37598e-3571-46f9-bc83-0de3cc779ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be0584fd7d0>]}
[0m23:05:37.669705 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:05:37.928163 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m23:05:38.093281 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:05:38.093747 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:05:38.100942 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m23:05:38.156416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c37598e-3571-46f9-bc83-0de3cc779ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be0421275d0>]}
[0m23:05:38.268922 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m23:05:38.270904 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m23:05:38.297839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c37598e-3571-46f9-bc83-0de3cc779ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be041a7ffd0>]}
[0m23:05:38.298692 [info ] [MainThread]: Found 8 models, 43 data tests, 2 sources, 604 macros
[0m23:05:38.299591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c37598e-3571-46f9-bc83-0de3cc779ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be041b6fad0>]}
[0m23:05:38.302508 [info ] [MainThread]: 
[0m23:05:38.303360 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:05:38.303922 [info ] [MainThread]: 
[0m23:05:38.305152 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:05:38.310692 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m23:05:38.326921 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m23:05:38.327787 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m23:05:38.328126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:39.220740 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.893 seconds
[0m23:05:39.222834 [debug] [ThreadPool]: On list_spotify_data: Close
[0m23:05:39.295846 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_silver)
[0m23:05:39.302303 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m23:05:39.307515 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m23:05:39.311123 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m23:05:39.311465 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:05:39.310148 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m23:05:39.312234 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m23:05:39.312570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:39.785337 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.474 seconds
[0m23:05:39.787186 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m23:05:40.083754 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.771 seconds
[0m23:05:40.086301 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m23:05:40.135767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c37598e-3571-46f9-bc83-0de3cc779ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be05763dc50>]}
[0m23:05:40.144665 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m23:05:40.146644 [debug] [Thread-2 (]: Began running node model.spotify_analytics.track_audio_features
[0m23:05:40.146290 [info ] [Thread-1 (]: 1 of 2 START sql table model silver.silver_plays ............................... [RUN]
[0m23:05:40.148473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.silver_plays)
[0m23:05:40.148980 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m23:05:40.147192 [info ] [Thread-2 (]: 2 of 2 START sql table model silver.track_audio_features ....................... [RUN]
[0m23:05:40.155364 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.track_audio_features)
[0m23:05:40.155764 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.track_audio_features
[0m23:05:40.160831 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.track_audio_features"
[0m23:05:40.165407 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.track_audio_features
[0m23:05:40.164337 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m23:05:40.172265 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m23:05:40.229124 [debug] [Thread-2 (]: Writing runtime sql for node "model.spotify_analytics.track_audio_features"
[0m23:05:40.230510 [debug] [Thread-2 (]: Using snowflake connection "model.spotify_analytics.track_audio_features"
[0m23:05:40.231209 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.silver_plays"
[0m23:05:40.231661 [debug] [Thread-2 (]: On model.spotify_analytics.track_audio_features: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.track_audio_features"} */
create or replace transient table spotify_data.silver.track_audio_features
         as
        (

/*
    Track Audio Features - Silver Layer
    
    Combines track metadata from plays with audio features from Spotify API
    This is a clean, deduplicated view of all tracks with their audio characteristics
*/

SELECT 
    af.track_id,
    af.danceability,
    af.energy,
    af.key,
    af.loudness,
    af.mode,
    af.speechiness,
    af.acousticness,
    af.instrumentalness,
    af.liveness,
    af.valence,
    af.tempo,
    af.duration_ms,
    af.time_signature,
    af.fetched_at
FROM spotify_data.bronze.track_audio_features af
WHERE af.track_id IS NOT NULL
        );
[0m23:05:40.233141 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:05:40.236539 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.silver_plays"
[0m23:05:40.240630 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.silver_plays"} */
create or replace transient table spotify_data.silver.silver_plays
         as
        (

-- ============================================================================
-- SILVER LAYER: CLEANED PLAYS DATA
-- ============================================================================
-- Purpose: Transform bronze plays data into clean, analytics-ready format
-- 
-- Transformations:
--   1. Deduplicate records (DISTINCT on event_id)
--   2. Cast all data types from VARIANT to proper types
--   3. Filter invalid records (defensive WHERE clauses)
--   4. Add processing metadata (processed_at timestamp)
--
-- Source: bronze.plays (external table reading from S3 Parquet files)
-- Target: SILVER.silver_plays (materialized table)
-- ============================================================================

WITH source_data AS (
    SELECT 
        VALUE:event_id::VARCHAR AS event_id,
        VALUE:user_id::VARCHAR AS user_id,
        VALUE:event_type::VARCHAR AS event_type,
        VALUE:track_id::VARCHAR AS track_id,
        VALUE:track_name::VARCHAR AS track_name,
        VALUE:artist_name::VARCHAR AS artist_name,
        VALUE:album_name::VARCHAR AS album_name,
        VALUE:duration_ms::NUMBER AS duration_ms,
        VALUE:played_at::VARCHAR AS played_at,
        VALUE:device_type::VARCHAR AS device_type
    FROM spotify_data.bronze.plays
),

deduplicated AS (
    SELECT DISTINCT
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM source_data
    WHERE 
        -- Data quality filters
        user_id IS NOT NULL
        AND duration_ms > 0
        AND duration_ms < 600000  -- Less than 10 minutes (catches data errors)
        AND event_id IS NOT NULL
)

SELECT 
    -- Identifiers
    event_id::VARCHAR AS event_id,
    user_id::VARCHAR AS user_id,
    event_type::VARCHAR AS event_type,
    
    -- Track information
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    duration_ms::NUMBER AS duration_ms,
    
    -- Timestamps
    TRY_CAST(played_at AS TIMESTAMP) AS played_at,
    
    -- Device context
    device_type::VARCHAR AS device_type,
    
    -- Metadata
    CURRENT_TIMESTAMP() AS processed_at
    
FROM deduplicated
        );
[0m23:05:40.241112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:05:40.655917 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c0fd09-0004-162f-000a-68a2000893ba
[0m23:05:40.656749 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
[0m23:05:40.657326 [debug] [Thread-2 (]: On model.spotify_analytics.track_audio_features: Close
[0m23:05:40.723640 [debug] [Thread-2 (]: Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql
[0m23:05:40.726626 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c37598e-3571-46f9-bc83-0de3cc779ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be04220f750>]}
[0m23:05:40.727458 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model silver.track_audio_features .............. [[31mERROR[0m in 0.57s]
[0m23:05:40.728428 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.track_audio_features
[0m23:05:40.729879 [debug] [Thread-7 (]: Marking all children of 'model.spotify_analytics.track_audio_features' to be skipped because of status 'error'.  Reason: Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql.
[0m23:05:42.982561 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.741 seconds
[0m23:05:43.011725 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: Close
[0m23:05:43.064312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c37598e-3571-46f9-bc83-0de3cc779ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be04237c310>]}
[0m23:05:43.065446 [info ] [Thread-1 (]: 1 of 2 OK created sql table model silver.silver_plays .......................... [[32mSUCCESS 1[0m in 2.92s]
[0m23:05:43.066477 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m23:05:43.068069 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:05:43.068922 [debug] [MainThread]: Connection 'model.spotify_analytics.silver_plays' was properly closed.
[0m23:05:43.069243 [debug] [MainThread]: Connection 'model.spotify_analytics.track_audio_features' was properly closed.
[0m23:05:43.070123 [info ] [MainThread]: 
[0m23:05:43.070506 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 4.76 seconds (4.76s).
[0m23:05:43.072280 [debug] [MainThread]: Command end result
[0m23:05:43.114186 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m23:05:43.116304 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m23:05:43.122616 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m23:05:43.123948 [info ] [MainThread]: 
[0m23:05:43.124767 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:05:43.125950 [info ] [MainThread]: 
[0m23:05:43.126596 [error] [MainThread]: [31mFailure in model track_audio_features (models/silver/track_audio_features.sql)[0m
[0m23:05:43.127250 [error] [MainThread]:   Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql
[0m23:05:43.128416 [info ] [MainThread]: 
[0m23:05:43.129493 [info ] [MainThread]:   compiled code at target/compiled/spotify_analytics/models/silver/track_audio_features.sql
[0m23:05:43.130456 [info ] [MainThread]: 
[0m23:05:43.131095 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m23:05:43.132684 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.675305, "process_in_blocks": "376", "process_kernel_time": 0.539543, "process_mem_max_rss": "249980", "process_out_blocks": "3176", "process_user_time": 4.161685}
[0m23:05:43.133201 [debug] [MainThread]: Command `dbt run` failed at 23:05:43.133112 after 6.68 seconds
[0m23:05:43.133602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be05bc0e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be05835b990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be0420332d0>]}
[0m23:05:43.134051 [debug] [MainThread]: Flushing usage events
[0m23:05:43.219540 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:09:06.957960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3650864f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c36508f4510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3650865a50>]}


============================== 23:09:06.965742 | 2356e255-aec5-4a09-8152-3603cb24409a ==============================
[0m23:09:06.965742 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:09:06.967164 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'empty': 'False', 'use_colors': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'profiles_dir': '/opt/airflow/dbt', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'quiet': 'False', 'partial_parse': 'True', 'version_check': 'True', 'log_format': 'default', 'target_path': 'None', 'cache_selected_only': 'False', 'static_parser': 'True', 'invocation_command': 'dbt run --select silver.*', 'no_print': 'None', 'debug': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'printer_width': '80'}
[0m23:09:08.023300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2356e255-aec5-4a09-8152-3603cb24409a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c363b6463d0>]}
[0m23:09:08.117597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2356e255-aec5-4a09-8152-3603cb24409a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c36519f9810>]}
[0m23:09:08.121176 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:09:08.361924 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m23:09:08.517611 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:09:08.518147 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:09:08.531669 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m23:09:08.584116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2356e255-aec5-4a09-8152-3603cb24409a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c363afb7f10>]}
[0m23:09:08.702498 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m23:09:08.705015 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m23:09:08.730195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2356e255-aec5-4a09-8152-3603cb24409a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c363b295d90>]}
[0m23:09:08.730810 [info ] [MainThread]: Found 8 models, 43 data tests, 2 sources, 604 macros
[0m23:09:08.731589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2356e255-aec5-4a09-8152-3603cb24409a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c363b2cbb10>]}
[0m23:09:08.734080 [info ] [MainThread]: 
[0m23:09:08.734729 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:09:08.735350 [info ] [MainThread]: 
[0m23:09:08.736077 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:09:08.741307 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m23:09:08.757645 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m23:09:08.758036 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m23:09:08.758364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:09.645166 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.887 seconds
[0m23:09:09.648283 [debug] [ThreadPool]: On list_spotify_data: Close
[0m23:09:09.734942 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_silver)
[0m23:09:09.742278 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m23:09:09.752787 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m23:09:09.757062 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m23:09:09.757632 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:09:09.756560 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m23:09:09.759059 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m23:09:09.759383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:10.445935 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.688 seconds
[0m23:09:10.447947 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m23:09:10.451764 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.692 seconds
[0m23:09:10.453979 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m23:09:10.514356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2356e255-aec5-4a09-8152-3603cb24409a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c363a598410>]}
[0m23:09:10.518817 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m23:09:10.520539 [debug] [Thread-2 (]: Began running node model.spotify_analytics.track_audio_features
[0m23:09:10.521595 [info ] [Thread-1 (]: 1 of 2 START sql table model silver.silver_plays ............................... [RUN]
[0m23:09:10.522963 [info ] [Thread-2 (]: 2 of 2 START sql table model silver.track_audio_features ....................... [RUN]
[0m23:09:10.525393 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.track_audio_features)
[0m23:09:10.524091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.silver_plays)
[0m23:09:10.526369 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m23:09:10.525968 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.track_audio_features
[0m23:09:10.538097 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.track_audio_features"
[0m23:09:10.544393 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.track_audio_features
[0m23:09:10.543569 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m23:09:10.550297 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m23:09:10.602251 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.silver_plays"
[0m23:09:10.605171 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.silver_plays"
[0m23:09:10.609541 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.silver_plays"} */
create or replace transient table spotify_data.silver.silver_plays
         as
        (

-- ============================================================================
-- SILVER LAYER: CLEANED PLAYS DATA
-- ============================================================================
-- Purpose: Transform bronze plays data into clean, analytics-ready format
-- 
-- Transformations:
--   1. Deduplicate records (DISTINCT on event_id)
--   2. Cast all data types from VARIANT to proper types
--   3. Filter invalid records (defensive WHERE clauses)
--   4. Add processing metadata (processed_at timestamp)
--
-- Source: bronze.plays (external table reading from S3 Parquet files)
-- Target: SILVER.silver_plays (materialized table)
-- ============================================================================

WITH source_data AS (
    SELECT 
        VALUE:event_id::VARCHAR AS event_id,
        VALUE:user_id::VARCHAR AS user_id,
        VALUE:event_type::VARCHAR AS event_type,
        VALUE:track_id::VARCHAR AS track_id,
        VALUE:track_name::VARCHAR AS track_name,
        VALUE:artist_name::VARCHAR AS artist_name,
        VALUE:album_name::VARCHAR AS album_name,
        VALUE:duration_ms::NUMBER AS duration_ms,
        VALUE:played_at::VARCHAR AS played_at,
        VALUE:device_type::VARCHAR AS device_type
    FROM spotify_data.bronze.plays
),

deduplicated AS (
    SELECT DISTINCT
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM source_data
    WHERE 
        -- Data quality filters
        user_id IS NOT NULL
        AND duration_ms > 0
        AND duration_ms < 600000  -- Less than 10 minutes (catches data errors)
        AND event_id IS NOT NULL
)

SELECT 
    -- Identifiers
    event_id::VARCHAR AS event_id,
    user_id::VARCHAR AS user_id,
    event_type::VARCHAR AS event_type,
    
    -- Track information
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    duration_ms::NUMBER AS duration_ms,
    
    -- Timestamps
    TRY_CAST(played_at AS TIMESTAMP) AS played_at,
    
    -- Device context
    device_type::VARCHAR AS device_type,
    
    -- Metadata
    CURRENT_TIMESTAMP() AS processed_at
    
FROM deduplicated
        );
[0m23:09:10.610075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:09:10.608784 [debug] [Thread-2 (]: Writing runtime sql for node "model.spotify_analytics.track_audio_features"
[0m23:09:10.613003 [debug] [Thread-2 (]: Using snowflake connection "model.spotify_analytics.track_audio_features"
[0m23:09:10.615193 [debug] [Thread-2 (]: On model.spotify_analytics.track_audio_features: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.track_audio_features"} */
create or replace transient table spotify_data.silver.track_audio_features
         as
        (

/*
    Track Audio Features - Silver Layer
    
    Combines track metadata from plays with audio features from Spotify API
    This is a clean, deduplicated view of all tracks with their audio characteristics
*/

SELECT 
    af.track_id,
    af.danceability,
    af.energy,
    af.key,
    af.loudness,
    af.mode,
    af.speechiness,
    af.acousticness,
    af.instrumentalness,
    af.liveness,
    af.valence,
    af.tempo,
    af.duration_ms,
    af.time_signature,
    af.fetched_at
FROM spotify_data.bronze.track_audio_features af
WHERE af.track_id IS NOT NULL
        );
[0m23:09:10.615750 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:09:11.042413 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c0fd0d-0004-162f-000a-68a2000893c6
[0m23:09:11.043440 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
[0m23:09:11.044004 [debug] [Thread-2 (]: On model.spotify_analytics.track_audio_features: Close
[0m23:09:11.095731 [debug] [Thread-2 (]: Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql
[0m23:09:11.097709 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2356e255-aec5-4a09-8152-3603cb24409a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c36508cef50>]}
[0m23:09:11.099985 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model silver.track_audio_features .............. [[31mERROR[0m in 0.57s]
[0m23:09:11.101348 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.track_audio_features
[0m23:09:11.101972 [debug] [Thread-7 (]: Marking all children of 'model.spotify_analytics.track_audio_features' to be skipped because of status 'error'.  Reason: Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql.
[0m23:09:12.784347 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.174 seconds
[0m23:09:12.809503 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: Close
[0m23:09:12.864893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2356e255-aec5-4a09-8152-3603cb24409a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c363b4bf850>]}
[0m23:09:12.865749 [info ] [Thread-1 (]: 1 of 2 OK created sql table model silver.silver_plays .......................... [[32mSUCCESS 1[0m in 2.34s]
[0m23:09:12.866368 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m23:09:12.869402 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:09:12.869763 [debug] [MainThread]: Connection 'model.spotify_analytics.track_audio_features' was properly closed.
[0m23:09:12.870178 [debug] [MainThread]: Connection 'model.spotify_analytics.silver_plays' was properly closed.
[0m23:09:12.870591 [info ] [MainThread]: 
[0m23:09:12.871356 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 4.13 seconds (4.13s).
[0m23:09:12.872364 [debug] [MainThread]: Command end result
[0m23:09:12.909664 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m23:09:12.911530 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m23:09:12.918142 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m23:09:12.918496 [info ] [MainThread]: 
[0m23:09:12.921404 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:09:12.921781 [info ] [MainThread]: 
[0m23:09:12.922271 [error] [MainThread]: [31mFailure in model track_audio_features (models/silver/track_audio_features.sql)[0m
[0m23:09:12.922665 [error] [MainThread]:   Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql
[0m23:09:12.923025 [info ] [MainThread]: 
[0m23:09:12.925559 [info ] [MainThread]:   compiled code at target/compiled/spotify_analytics/models/silver/track_audio_features.sql
[0m23:09:12.926624 [info ] [MainThread]: 
[0m23:09:12.927376 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m23:09:12.928619 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.036979, "process_in_blocks": "0", "process_kernel_time": 0.562544, "process_mem_max_rss": "249544", "process_out_blocks": "3184", "process_user_time": 4.271675}
[0m23:09:12.929197 [debug] [MainThread]: Command `dbt run` failed at 23:09:12.929093 after 6.04 seconds
[0m23:09:12.930203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3654face90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c36508f4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c36508f4710>]}
[0m23:09:12.931170 [debug] [MainThread]: Flushing usage events
[0m23:09:13.016000 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:15:35.761045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79eeb3353b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79eeb32fe490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79eeb3353e90>]}


============================== 23:15:35.768356 | e384508f-49fb-4d62-8530-1b4fee13ce1a ==============================
[0m23:15:35.768356 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:15:35.769925 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'target_path': 'None', 'no_print': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run --select silver.*', 'log_cache_events': 'False', 'log_format': 'default', 'introspect': 'True', 'version_check': 'True', 'empty': 'False', 'quiet': 'False', 'write_json': 'True', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True'}
[0m23:15:36.854417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e384508f-49fb-4d62-8530-1b4fee13ce1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79eea4bc33d0>]}
[0m23:15:36.957799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e384508f-49fb-4d62-8530-1b4fee13ce1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79eeb4425750>]}
[0m23:15:36.958772 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:15:37.201687 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m23:15:37.499161 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:15:37.499704 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:15:37.511358 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m23:15:37.566116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e384508f-49fb-4d62-8530-1b4fee13ce1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ee9df39d10>]}
[0m23:15:37.688289 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m23:15:37.690217 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m23:15:37.713744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e384508f-49fb-4d62-8530-1b4fee13ce1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ee9dabe690>]}
[0m23:15:37.714330 [info ] [MainThread]: Found 8 models, 43 data tests, 2 sources, 604 macros
[0m23:15:37.714707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e384508f-49fb-4d62-8530-1b4fee13ce1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ee9f95cfd0>]}
[0m23:15:37.718609 [info ] [MainThread]: 
[0m23:15:37.722230 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:15:37.724589 [info ] [MainThread]: 
[0m23:15:37.725436 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:15:37.732033 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m23:15:37.751033 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m23:15:37.752237 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m23:15:37.753037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:15:38.820167 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.067 seconds
[0m23:15:38.822630 [debug] [ThreadPool]: On list_spotify_data: Close
[0m23:15:38.947671 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_gold)
[0m23:15:38.948452 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m23:15:38.965318 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m23:15:38.968285 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m23:15:38.968603 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:15:38.967411 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m23:15:38.970014 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m23:15:38.970344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:15:40.035494 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.065 seconds
[0m23:15:40.038229 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m23:15:40.498431 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.530 seconds
[0m23:15:40.500416 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m23:15:40.582000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e384508f-49fb-4d62-8530-1b4fee13ce1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ee9dc37a50>]}
[0m23:15:40.586953 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m23:15:40.587925 [info ] [Thread-1 (]: 1 of 2 START sql table model silver.silver_plays ............................... [RUN]
[0m23:15:40.588387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.silver_plays)
[0m23:15:40.587364 [debug] [Thread-2 (]: Began running node model.spotify_analytics.track_audio_features
[0m23:15:40.589569 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m23:15:40.590505 [info ] [Thread-2 (]: 2 of 2 START sql table model silver.track_audio_features ....................... [RUN]
[0m23:15:40.597251 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.track_audio_features)
[0m23:15:40.597645 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.track_audio_features
[0m23:15:40.616127 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.track_audio_features"
[0m23:15:40.618511 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.track_audio_features
[0m23:15:40.617665 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m23:15:40.625160 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m23:15:40.709475 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.silver_plays"
[0m23:15:40.715013 [debug] [Thread-2 (]: Writing runtime sql for node "model.spotify_analytics.track_audio_features"
[0m23:15:40.718802 [debug] [Thread-2 (]: Using snowflake connection "model.spotify_analytics.track_audio_features"
[0m23:15:40.717228 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.silver_plays"
[0m23:15:40.720204 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.silver_plays"} */
create or replace transient table spotify_data.silver.silver_plays
         as
        (

-- ============================================================================
-- SILVER LAYER: CLEANED PLAYS DATA
-- ============================================================================
-- Purpose: Transform bronze plays data into clean, analytics-ready format
-- 
-- Transformations:
--   1. Deduplicate records (DISTINCT on event_id)
--   2. Cast all data types from VARIANT to proper types
--   3. Filter invalid records (defensive WHERE clauses)
--   4. Add processing metadata (processed_at timestamp)
--
-- Source: bronze.plays (external table reading from S3 Parquet files)
-- Target: SILVER.silver_plays (materialized table)
-- ============================================================================

WITH source_data AS (
    SELECT 
        VALUE:event_id::VARCHAR AS event_id,
        VALUE:user_id::VARCHAR AS user_id,
        VALUE:event_type::VARCHAR AS event_type,
        VALUE:track_id::VARCHAR AS track_id,
        VALUE:track_name::VARCHAR AS track_name,
        VALUE:artist_name::VARCHAR AS artist_name,
        VALUE:album_name::VARCHAR AS album_name,
        VALUE:duration_ms::NUMBER AS duration_ms,
        VALUE:played_at::VARCHAR AS played_at,
        VALUE:device_type::VARCHAR AS device_type
    FROM spotify_data.bronze.plays
),

deduplicated AS (
    SELECT DISTINCT
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM source_data
    WHERE 
        -- Data quality filters
        user_id IS NOT NULL
        AND duration_ms > 0
        AND duration_ms < 600000  -- Less than 10 minutes (catches data errors)
        AND event_id IS NOT NULL
)

SELECT 
    -- Identifiers
    event_id::VARCHAR AS event_id,
    user_id::VARCHAR AS user_id,
    event_type::VARCHAR AS event_type,
    
    -- Track information
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    duration_ms::NUMBER AS duration_ms,
    
    -- Timestamps
    TRY_CAST(played_at AS TIMESTAMP) AS played_at,
    
    -- Device context
    device_type::VARCHAR AS device_type,
    
    -- Metadata
    CURRENT_TIMESTAMP() AS processed_at
    
FROM deduplicated
        );
[0m23:15:40.720668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:15:40.719704 [debug] [Thread-2 (]: On model.spotify_analytics.track_audio_features: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.track_audio_features"} */
create or replace transient table spotify_data.silver.track_audio_features
         as
        (

/*
    Track Audio Features - Silver Layer
    
    Combines track metadata from plays with audio features from Spotify API
    This is a clean, deduplicated view of all tracks with their audio characteristics
*/

SELECT 
    af.track_id,
    af.danceability,
    af.energy,
    af.key,
    af.loudness,
    af.mode,
    af.speechiness,
    af.acousticness,
    af.instrumentalness,
    af.liveness,
    af.valence,
    af.tempo,
    af.duration_ms,
    af.time_signature,
    af.fetched_at
FROM spotify_data.bronze.track_audio_features af
WHERE af.track_id IS NOT NULL
        );
[0m23:15:40.722033 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:15:41.240639 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c0fd13-0004-1445-000a-68a20006d5ee
[0m23:15:41.241758 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
[0m23:15:41.242409 [debug] [Thread-2 (]: On model.spotify_analytics.track_audio_features: Close
[0m23:15:41.327935 [debug] [Thread-2 (]: Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql
[0m23:15:41.330541 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e384508f-49fb-4d62-8530-1b4fee13ce1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ee9e0ab950>]}
[0m23:15:41.331502 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model silver.track_audio_features .............. [[31mERROR[0m in 0.73s]
[0m23:15:41.332672 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.track_audio_features
[0m23:15:41.333317 [debug] [Thread-7 (]: Marking all children of 'model.spotify_analytics.track_audio_features' to be skipped because of status 'error'.  Reason: Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql.
[0m23:15:43.704592 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.984 seconds
[0m23:15:43.732036 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: Close
[0m23:15:43.803056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e384508f-49fb-4d62-8530-1b4fee13ce1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ee8ffc8790>]}
[0m23:15:43.803973 [info ] [Thread-1 (]: 1 of 2 OK created sql table model silver.silver_plays .......................... [[32mSUCCESS 1[0m in 3.21s]
[0m23:15:43.805025 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m23:15:43.808733 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:15:43.809358 [debug] [MainThread]: Connection 'model.spotify_analytics.silver_plays' was properly closed.
[0m23:15:43.809706 [debug] [MainThread]: Connection 'model.spotify_analytics.track_audio_features' was properly closed.
[0m23:15:43.810144 [info ] [MainThread]: 
[0m23:15:43.811415 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 6.08 seconds (6.08s).
[0m23:15:43.812661 [debug] [MainThread]: Command end result
[0m23:15:43.851300 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m23:15:43.853278 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m23:15:43.860525 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m23:15:43.860939 [info ] [MainThread]: 
[0m23:15:43.861365 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:15:43.862354 [info ] [MainThread]: 
[0m23:15:43.863040 [error] [MainThread]: [31mFailure in model track_audio_features (models/silver/track_audio_features.sql)[0m
[0m23:15:43.864534 [error] [MainThread]:   Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql
[0m23:15:43.865391 [info ] [MainThread]: 
[0m23:15:43.866399 [info ] [MainThread]:   compiled code at target/compiled/spotify_analytics/models/silver/track_audio_features.sql
[0m23:15:43.866960 [info ] [MainThread]: 
[0m23:15:43.867560 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m23:15:43.868669 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.175009, "process_in_blocks": "0", "process_kernel_time": 0.552001, "process_mem_max_rss": "249508", "process_out_blocks": "3184", "process_user_time": 4.261907}
[0m23:15:43.869204 [debug] [MainThread]: Command `dbt run` failed at 23:15:43.869111 after 8.18 seconds
[0m23:15:43.869601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79eeb36ac950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79eeb7b56950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79eeb7a10d50>]}
[0m23:15:43.870504 [debug] [MainThread]: Flushing usage events
[0m23:15:43.958514 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:25:48.150437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7457bb0abe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7457bb0abe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7457bb0a8a90>]}


============================== 23:25:48.157275 | ead4d331-92c5-467f-af92-21e5c34054a5 ==============================
[0m23:25:48.157275 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:25:48.158249 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'warn_error': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'empty': 'False', 'quiet': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'no_print': 'None', 'introspect': 'True', 'profiles_dir': '/opt/airflow/dbt', 'invocation_command': 'dbt run --select silver.*', 'log_path': '/opt/airflow/dbt/logs'}
[0m23:25:49.188561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ead4d331-92c5-467f-af92-21e5c34054a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7457bb10a310>]}
[0m23:25:49.269003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ead4d331-92c5-467f-af92-21e5c34054a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7457bc179810>]}
[0m23:25:49.269979 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:25:49.492469 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m23:25:49.644829 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:25:49.645393 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:25:49.654176 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m23:25:49.705520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ead4d331-92c5-467f-af92-21e5c34054a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7457bd9c4f90>]}
[0m23:25:49.824956 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m23:25:49.827172 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m23:25:49.877360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ead4d331-92c5-467f-af92-21e5c34054a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7457a59995d0>]}
[0m23:25:49.878966 [info ] [MainThread]: Found 8 models, 43 data tests, 2 sources, 604 macros
[0m23:25:49.885622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ead4d331-92c5-467f-af92-21e5c34054a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7457a5cac590>]}
[0m23:25:49.888776 [info ] [MainThread]: 
[0m23:25:49.889549 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:25:49.890112 [info ] [MainThread]: 
[0m23:25:49.890875 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:25:49.895052 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m23:25:49.912874 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m23:25:49.913346 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m23:25:49.913926 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:25:50.898518 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.985 seconds
[0m23:25:50.903158 [debug] [ThreadPool]: On list_spotify_data: Close
[0m23:25:50.992174 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m23:25:50.998261 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_silver)
[0m23:25:51.024053 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m23:25:51.024559 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m23:25:51.025446 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m23:25:51.026147 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m23:25:51.026475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:25:51.025779 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:25:51.548672 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.522 seconds
[0m23:25:51.551300 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m23:25:51.966563 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.941 seconds
[0m23:25:51.970256 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m23:25:52.032945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ead4d331-92c5-467f-af92-21e5c34054a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7457a5790f90>]}
[0m23:25:52.037430 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m23:25:52.038358 [debug] [Thread-2 (]: Began running node model.spotify_analytics.track_audio_features
[0m23:25:52.038039 [info ] [Thread-1 (]: 1 of 2 START sql table model silver.silver_plays ............................... [RUN]
[0m23:25:52.041890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.silver_plays)
[0m23:25:52.042301 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m23:25:52.041480 [info ] [Thread-2 (]: 2 of 2 START sql table model silver.track_audio_features ....................... [RUN]
[0m23:25:52.049389 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.track_audio_features)
[0m23:25:52.049885 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.track_audio_features
[0m23:25:52.053534 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m23:25:52.059509 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m23:25:52.058626 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.track_audio_features"
[0m23:25:52.067095 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.track_audio_features
[0m23:25:52.121500 [debug] [Thread-2 (]: Writing runtime sql for node "model.spotify_analytics.track_audio_features"
[0m23:25:52.122898 [debug] [Thread-2 (]: Using snowflake connection "model.spotify_analytics.track_audio_features"
[0m23:25:52.123647 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.silver_plays"
[0m23:25:52.124166 [debug] [Thread-2 (]: On model.spotify_analytics.track_audio_features: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.track_audio_features"} */
create or replace transient table spotify_data.silver.track_audio_features
         as
        (

/*
    Track Audio Features - Silver Layer
    
    Combines track metadata from plays with audio features from Spotify API
    This is a clean, deduplicated view of all tracks with their audio characteristics
*/

SELECT 
    af.track_id,
    af.danceability,
    af.energy,
    af.key,
    af.loudness,
    af.mode,
    af.speechiness,
    af.acousticness,
    af.instrumentalness,
    af.liveness,
    af.valence,
    af.tempo,
    af.duration_ms,
    af.time_signature,
    af.fetched_at
FROM spotify_data.bronze.track_audio_features af
WHERE af.track_id IS NOT NULL
        );
[0m23:25:52.126801 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:25:52.126358 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.silver_plays"
[0m23:25:52.129156 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.silver_plays"} */
create or replace transient table spotify_data.silver.silver_plays
         as
        (

-- ============================================================================
-- SILVER LAYER: CLEANED PLAYS DATA
-- ============================================================================
-- Purpose: Transform bronze plays data into clean, analytics-ready format
-- 
-- Transformations:
--   1. Deduplicate records (DISTINCT on event_id)
--   2. Cast all data types from VARIANT to proper types
--   3. Filter invalid records (defensive WHERE clauses)
--   4. Add processing metadata (processed_at timestamp)
--
-- Source: bronze.plays (external table reading from S3 Parquet files)
-- Target: SILVER.silver_plays (materialized table)
-- ============================================================================

WITH source_data AS (
    SELECT 
        VALUE:event_id::VARCHAR AS event_id,
        VALUE:user_id::VARCHAR AS user_id,
        VALUE:event_type::VARCHAR AS event_type,
        VALUE:track_id::VARCHAR AS track_id,
        VALUE:track_name::VARCHAR AS track_name,
        VALUE:artist_name::VARCHAR AS artist_name,
        VALUE:album_name::VARCHAR AS album_name,
        VALUE:duration_ms::NUMBER AS duration_ms,
        VALUE:played_at::VARCHAR AS played_at,
        VALUE:device_type::VARCHAR AS device_type
    FROM spotify_data.bronze.plays
),

deduplicated AS (
    SELECT DISTINCT
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM source_data
    WHERE 
        -- Data quality filters
        user_id IS NOT NULL
        AND duration_ms > 0
        AND duration_ms < 600000  -- Less than 10 minutes (catches data errors)
        AND event_id IS NOT NULL
)

SELECT 
    -- Identifiers
    event_id::VARCHAR AS event_id,
    user_id::VARCHAR AS user_id,
    event_type::VARCHAR AS event_type,
    
    -- Track information
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    duration_ms::NUMBER AS duration_ms,
    
    -- Timestamps
    TRY_CAST(played_at AS TIMESTAMP) AS played_at,
    
    -- Device context
    device_type::VARCHAR AS device_type,
    
    -- Metadata
    CURRENT_TIMESTAMP() AS processed_at
    
FROM deduplicated
        );
[0m23:25:52.129633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:25:52.796935 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c0fd1d-0004-171d-000a-68a20008f35e
[0m23:25:52.798198 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
[0m23:25:52.799089 [debug] [Thread-2 (]: On model.spotify_analytics.track_audio_features: Close
[0m23:25:52.854451 [debug] [Thread-2 (]: Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql
[0m23:25:52.856835 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ead4d331-92c5-467f-af92-21e5c34054a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7457a5c6f750>]}
[0m23:25:52.857666 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model silver.track_audio_features .............. [[31mERROR[0m in 0.81s]
[0m23:25:52.858630 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.track_audio_features
[0m23:25:52.860222 [debug] [Thread-7 (]: Marking all children of 'model.spotify_analytics.track_audio_features' to be skipped because of status 'error'.  Reason: Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql.
[0m23:25:54.506075 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.376 seconds
[0m23:25:54.536179 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: Close
[0m23:25:54.585804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ead4d331-92c5-467f-af92-21e5c34054a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7457a5dfe050>]}
[0m23:25:54.586665 [info ] [Thread-1 (]: 1 of 2 OK created sql table model silver.silver_plays .......................... [[32mSUCCESS 1[0m in 2.54s]
[0m23:25:54.587355 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m23:25:54.589645 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:25:54.590532 [debug] [MainThread]: Connection 'model.spotify_analytics.track_audio_features' was properly closed.
[0m23:25:54.590840 [debug] [MainThread]: Connection 'model.spotify_analytics.silver_plays' was properly closed.
[0m23:25:54.591351 [info ] [MainThread]: 
[0m23:25:54.592014 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 4.70 seconds (4.70s).
[0m23:25:54.593013 [debug] [MainThread]: Command end result
[0m23:25:54.637512 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m23:25:54.639721 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m23:25:54.646032 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m23:25:54.646400 [info ] [MainThread]: 
[0m23:25:54.647344 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:25:54.647683 [info ] [MainThread]: 
[0m23:25:54.648704 [error] [MainThread]: [31mFailure in model track_audio_features (models/silver/track_audio_features.sql)[0m
[0m23:25:54.649384 [error] [MainThread]:   Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql
[0m23:25:54.651130 [info ] [MainThread]: 
[0m23:25:54.651770 [info ] [MainThread]:   compiled code at target/compiled/spotify_analytics/models/silver/track_audio_features.sql
[0m23:25:54.652290 [info ] [MainThread]: 
[0m23:25:54.653224 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m23:25:54.654299 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.569167, "process_in_blocks": "0", "process_kernel_time": 0.508642, "process_mem_max_rss": "249644", "process_out_blocks": "3184", "process_user_time": 4.138514}
[0m23:25:54.654813 [debug] [MainThread]: Command `dbt run` failed at 23:25:54.654723 after 6.57 seconds
[0m23:25:54.655366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7457bb03bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7457bb03bf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7457bf764d50>]}
[0m23:25:54.655860 [debug] [MainThread]: Flushing usage events
[0m23:25:54.740682 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:05:23.268074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed853d87cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed8540ae490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed8540ae750>]}


============================== 00:05:23.275187 | e49f9547-f573-4fb2-93e6-30e141b4df7f ==============================
[0m00:05:23.275187 [info ] [MainThread]: Running with dbt=1.10.15
[0m00:05:23.277173 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'no_print': 'None', 'log_path': '/opt/airflow/dbt/logs', 'indirect_selection': 'eager', 'quiet': 'False', 'warn_error': 'None', 'target_path': 'None', 'use_experimental_parser': 'False', 'version_check': 'True', 'partial_parse': 'True', 'profiles_dir': '/opt/airflow/dbt', 'introspect': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'empty': 'False', 'write_json': 'True', 'printer_width': '80', 'fail_fast': 'False'}
[0m00:05:24.485620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e49f9547-f573-4fb2-93e6-30e141b4df7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed854d42290>]}
[0m00:05:24.564725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e49f9547-f573-4fb2-93e6-30e141b4df7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed854e555d0>]}
[0m00:05:24.565696 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m00:05:24.833299 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m00:05:24.995637 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:05:24.996133 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:05:25.010538 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m00:05:25.056109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e49f9547-f573-4fb2-93e6-30e141b4df7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed83e9224d0>]}
[0m00:05:25.176160 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m00:05:25.178472 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m00:05:25.203728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e49f9547-f573-4fb2-93e6-30e141b4df7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed83e913f10>]}
[0m00:05:25.204454 [info ] [MainThread]: Found 8 models, 43 data tests, 2 sources, 604 macros
[0m00:05:25.205728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e49f9547-f573-4fb2-93e6-30e141b4df7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed83e749090>]}
[0m00:05:25.208560 [info ] [MainThread]: 
[0m00:05:25.209459 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:05:25.209784 [info ] [MainThread]: 
[0m00:05:25.211375 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:05:25.217033 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m00:05:25.217730 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m00:05:25.260184 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m00:05:25.260690 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m00:05:25.261270 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m00:05:25.261630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:05:25.262925 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m00:05:25.265137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:05:26.180578 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.915 seconds
[0m00:05:26.182370 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m00:05:26.198111 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.936 seconds
[0m00:05:26.202942 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m00:05:26.289223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e49f9547-f573-4fb2-93e6-30e141b4df7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed83eb1f810>]}
[0m00:05:26.295447 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m00:05:26.297154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.silver_plays)
[0m00:05:26.296498 [debug] [Thread-2 (]: Began running node model.spotify_analytics.track_audio_features
[0m00:05:26.297620 [debug] [Thread-3 (]: Began running node model.spotify_analytics.track_recommendations
[0m00:05:26.300325 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.spotify_analytics.track_recommendations'
[0m00:05:26.298080 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m00:05:26.299599 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.track_audio_features)
[0m00:05:26.308197 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.track_audio_features
[0m00:05:26.300751 [debug] [Thread-3 (]: Began compiling node model.spotify_analytics.track_recommendations
[0m00:05:26.313599 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.track_audio_features"
[0m00:05:26.317748 [debug] [Thread-3 (]: Writing injected SQL for node "model.spotify_analytics.track_recommendations"
[0m00:05:26.322409 [debug] [Thread-3 (]: Began executing node model.spotify_analytics.track_recommendations
[0m00:05:26.320637 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m00:05:26.323747 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m00:05:26.321336 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.track_audio_features
[0m00:05:26.325497 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.track_audio_features
[0m00:05:26.323156 [debug] [Thread-3 (]: Finished running node model.spotify_analytics.track_recommendations
[0m00:05:26.324388 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m00:05:26.327020 [debug] [Thread-4 (]: Began running node model.spotify_analytics.daily_user_stats
[0m00:05:26.328377 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.spotify_analytics.daily_user_stats'
[0m00:05:26.327426 [debug] [Thread-3 (]: Began running node model.spotify_analytics.device_usage
[0m00:05:26.327894 [debug] [Thread-1 (]: Began running node model.spotify_analytics.top_artists
[0m00:05:26.330617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.silver_plays, now model.spotify_analytics.top_artists)
[0m00:05:26.328774 [debug] [Thread-4 (]: Began compiling node model.spotify_analytics.daily_user_stats
[0m00:05:26.329140 [debug] [Thread-2 (]: Began running node model.spotify_analytics.top_tracks
[0m00:05:26.335419 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.track_audio_features, now model.spotify_analytics.top_tracks)
[0m00:05:26.329642 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.track_recommendations, now model.spotify_analytics.device_usage)
[0m00:05:26.336967 [debug] [Thread-3 (]: Began compiling node model.spotify_analytics.device_usage
[0m00:05:26.331451 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.top_artists
[0m00:05:26.335793 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.top_tracks
[0m00:05:26.334959 [debug] [Thread-4 (]: Writing injected SQL for node "model.spotify_analytics.daily_user_stats"
[0m00:05:26.340782 [debug] [Thread-3 (]: Writing injected SQL for node "model.spotify_analytics.device_usage"
[0m00:05:26.350224 [debug] [Thread-3 (]: Began executing node model.spotify_analytics.device_usage
[0m00:05:26.344627 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.top_artists"
[0m00:05:26.351441 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.top_artists
[0m00:05:26.348676 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.top_tracks"
[0m00:05:26.349642 [debug] [Thread-4 (]: Began executing node model.spotify_analytics.daily_user_stats
[0m00:05:26.353702 [debug] [Thread-4 (]: Finished running node model.spotify_analytics.daily_user_stats
[0m00:05:26.352083 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.top_artists
[0m00:05:26.354551 [debug] [Thread-1 (]: Began running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m00:05:26.354958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.top_artists, now test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39)
[0m00:05:26.355357 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m00:05:26.352614 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.top_tracks
[0m00:05:26.361689 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.top_tracks
[0m00:05:26.354150 [debug] [Thread-4 (]: Began running node model.spotify_analytics.user_listening_profile
[0m00:05:26.362575 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.daily_user_stats, now model.spotify_analytics.user_listening_profile)
[0m00:05:26.362963 [debug] [Thread-4 (]: Began compiling node model.spotify_analytics.user_listening_profile
[0m00:05:26.350893 [debug] [Thread-3 (]: Finished running node model.spotify_analytics.device_usage
[0m00:05:26.367179 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m00:05:26.362144 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m00:05:26.376177 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.top_tracks, now test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad)
[0m00:05:26.367649 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.device_usage, now test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076)
[0m00:05:26.377706 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m00:05:26.366586 [debug] [Thread-4 (]: Writing injected SQL for node "model.spotify_analytics.user_listening_profile"
[0m00:05:26.376777 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m00:05:26.394609 [debug] [Thread-4 (]: Began executing node model.spotify_analytics.user_listening_profile
[0m00:05:26.389441 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m00:05:26.400449 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m00:05:26.401081 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m00:05:26.393441 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m00:05:26.402048 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m00:05:26.398641 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m00:05:26.399895 [debug] [Thread-4 (]: Finished running node model.spotify_analytics.user_listening_profile
[0m00:05:26.404161 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m00:05:26.404584 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.user_listening_profile, now test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa)
[0m00:05:26.405064 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m00:05:26.401503 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m00:05:26.410218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39, now test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd)
[0m00:05:26.403161 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m00:05:26.411058 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m00:05:26.411441 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076, now test.spotify_analytics.not_null_silver_plays_played_at.8281565f95)
[0m00:05:26.403689 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m00:05:26.413498 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m00:05:26.410600 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m00:05:26.413950 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m00:05:26.418918 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad, now test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed)
[0m00:05:26.409757 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m00:05:26.420293 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m00:05:26.411787 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m00:05:26.420921 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m00:05:26.425524 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m00:05:26.425932 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa, now test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9)
[0m00:05:26.426292 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m00:05:26.418382 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m00:05:26.431451 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m00:05:26.419766 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m00:05:26.425059 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m00:05:26.436942 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m00:05:26.430828 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m00:05:26.438112 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m00:05:26.432085 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m00:05:26.437569 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m00:05:26.449868 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m00:05:26.441354 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m00:05:26.451652 [debug] [Thread-4 (]: Began running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m00:05:26.452517 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9, now test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf)
[0m00:05:26.436386 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m00:05:26.453815 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m00:05:26.454657 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m00:05:26.455180 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m00:05:26.450506 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_played_at.8281565f95, now test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4)
[0m00:05:26.456601 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m00:05:26.453008 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m00:05:26.441795 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m00:05:26.469465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd, now test.spotify_analytics.not_null_silver_plays_track_name.c6334add30)
[0m00:05:26.469999 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m00:05:26.456169 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed, now test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155)
[0m00:05:26.476976 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m00:05:26.478220 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m00:05:26.482777 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m00:05:26.475664 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m00:05:26.484462 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m00:05:26.476522 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m00:05:26.485593 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m00:05:26.486186 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m00:05:26.483937 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m00:05:26.485066 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m00:05:26.488016 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m00:05:26.488415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_track_name.c6334add30, now test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282)
[0m00:05:26.487578 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m00:05:26.482169 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m00:05:26.489784 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m00:05:26.489220 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4, now test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87)
[0m00:05:26.490868 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m00:05:26.488765 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m00:05:26.486624 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m00:05:26.499719 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf, now test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9)
[0m00:05:26.500114 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m00:05:26.490372 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m00:05:26.504685 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m00:05:26.499274 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m00:05:26.495089 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m00:05:26.506762 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m00:05:26.504233 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m00:05:26.508151 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m00:05:26.507638 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m00:05:26.506077 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155, now test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f)
[0m00:05:26.510773 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m00:05:26.509255 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m00:05:26.508754 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m00:05:26.516597 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m00:05:26.517018 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9, now test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b)
[0m00:05:26.509655 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m00:05:26.518296 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87, now test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac)
[0m00:05:26.515005 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m00:05:26.518659 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m00:05:26.515691 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m00:05:26.526040 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m00:05:26.517816 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m00:05:26.526581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282, now test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003)
[0m00:05:26.534830 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m00:05:26.524978 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m00:05:26.541398 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m00:05:26.533797 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m00:05:26.543820 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m00:05:26.532595 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m00:05:26.540546 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m00:05:26.545838 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m00:05:26.546525 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m00:05:26.544283 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m00:05:26.547493 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f, now test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c)
[0m00:05:26.547888 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m00:05:26.542257 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m00:05:26.554168 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m00:05:26.544829 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m00:05:26.555325 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m00:05:26.546975 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m00:05:26.556146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003, now test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2)
[0m00:05:26.556494 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m00:05:26.554616 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac, now test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2)
[0m00:05:26.561709 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m00:05:26.555732 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m00:05:26.567719 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b, now test.spotify_analytics.not_null_device_usage_total_plays.90a295df48)
[0m00:05:26.568142 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m00:05:26.561255 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m00:05:26.573302 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m00:05:26.567284 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m00:05:26.566378 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m00:05:26.575019 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m00:05:26.574504 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m00:05:26.572716 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m00:05:26.576823 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m00:05:26.573955 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m00:05:26.578286 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m00:05:26.575661 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m00:05:26.579604 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m00:05:26.580024 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2, now test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14)
[0m00:05:26.580397 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m00:05:26.576339 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m00:05:26.585598 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m00:05:26.586033 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c, now test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca)
[0m00:05:26.586417 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m00:05:26.577409 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m00:05:26.592166 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m00:05:26.592581 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_plays.90a295df48, now test.spotify_analytics.not_null_top_artists_rank.d14513fc96)
[0m00:05:26.592980 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m00:05:26.585104 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m00:05:26.596866 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m00:05:26.578657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2, now test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e)
[0m00:05:26.597933 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m00:05:26.597476 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m00:05:26.607243 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m00:05:26.596290 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m00:05:26.608889 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m00:05:26.590691 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m00:05:26.610246 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m00:05:26.608154 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14, now test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c)
[0m00:05:26.613142 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m00:05:26.609614 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m00:05:26.611251 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m00:05:26.620059 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m00:05:26.620544 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca, now test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13)
[0m00:05:26.619407 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m00:05:26.625224 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_rank.d14513fc96, now test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11)
[0m00:05:26.620981 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m00:05:26.624275 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m00:05:26.632293 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m00:05:26.618280 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m00:05:26.633596 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m00:05:26.625620 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m00:05:26.632990 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m00:05:26.634220 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m00:05:26.641211 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m00:05:26.639807 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m00:05:26.642198 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m00:05:26.641627 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c, now test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31)
[0m00:05:26.643298 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m00:05:26.640713 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m00:05:26.642810 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m00:05:26.648907 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m00:05:26.649301 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13, now test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532)
[0m00:05:26.638654 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m00:05:26.650592 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m00:05:26.647016 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m00:05:26.651829 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m00:05:26.651293 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m00:05:26.652900 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m00:05:26.653271 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11, now test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4)
[0m00:05:26.647471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e, now test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461)
[0m00:05:26.654496 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m00:05:26.649655 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m00:05:26.652449 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m00:05:26.663415 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m00:05:26.663811 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31, now test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac)
[0m00:05:26.658300 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m00:05:26.665644 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m00:05:26.666272 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m00:05:26.654096 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m00:05:26.664196 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m00:05:26.666714 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m00:05:26.662925 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m00:05:26.676449 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m00:05:26.670893 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m00:05:26.677948 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m00:05:26.674716 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m00:05:26.675202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461, now test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893)
[0m00:05:26.677427 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m00:05:26.682364 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m00:05:26.682811 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532, now test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78)
[0m00:05:26.683206 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m00:05:26.678524 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m00:05:26.681158 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m00:05:26.680727 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m00:05:26.697288 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m00:05:26.688138 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m00:05:26.689781 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m00:05:26.699536 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4, now test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203)
[0m00:05:26.700020 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m00:05:26.697799 [debug] [Thread-3 (]: Began running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m00:05:26.707891 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac, now test.spotify_analytics.unique_device_usage_device_type.e75362861b)
[0m00:05:26.708402 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m00:05:26.712842 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m00:05:26.696490 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m00:05:26.716777 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m00:05:26.713623 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m00:05:26.718231 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m00:05:26.718631 [debug] [Thread-2 (]: Began running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m00:05:26.719087 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78, now test.spotify_analytics.unique_top_artists_artist_name.008ffa1533)
[0m00:05:26.719458 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m00:05:26.715841 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m00:05:26.725263 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m00:05:26.717489 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m00:05:26.726374 [debug] [Thread-1 (]: Began running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m00:05:26.726760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893, now test.spotify_analytics.unique_top_artists_rank.68b5480aed)
[0m00:05:26.727149 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m00:05:26.724704 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m00:05:26.725901 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m00:05:26.732659 [debug] [Thread-4 (]: Began running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m00:05:26.724166 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m00:05:26.732249 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m00:05:26.735362 [debug] [Thread-3 (]: Began running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m00:05:26.735933 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_device_usage_device_type.e75362861b, now test.spotify_analytics.unique_top_tracks_track_id.865b43a659)
[0m00:05:26.736301 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m00:05:26.734386 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m00:05:26.741441 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m00:05:26.731500 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m00:05:26.742016 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m00:05:26.742599 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m00:05:26.733063 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203, now test.spotify_analytics.unique_top_tracks_rank.8fecde1136)
[0m00:05:26.743168 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m00:05:26.740304 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m00:05:26.748319 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m00:05:26.747733 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m00:05:26.749486 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m00:05:26.748944 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m00:05:26.750080 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m00:05:26.752125 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:05:26.752469 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_artists_rank.68b5480aed' was properly closed.
[0m00:05:26.752788 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_artists_artist_name.008ffa1533' was properly closed.
[0m00:05:26.753180 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_track_id.865b43a659' was properly closed.
[0m00:05:26.753462 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_rank.8fecde1136' was properly closed.
[0m00:05:26.766919 [debug] [MainThread]: Command end result
[0m00:05:26.808755 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m00:05:26.810887 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m00:05:26.820866 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m00:05:26.823128 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 3.6218312, "process_in_blocks": "1872", "process_kernel_time": 0.564897, "process_mem_max_rss": "257268", "process_out_blocks": "3768", "process_user_time": 4.347973}
[0m00:05:26.823628 [debug] [MainThread]: Command `dbt compile` succeeded at 00:05:26.823538 after 3.62 seconds
[0m00:05:26.824821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed858586850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed858440d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed8584401d0>]}
[0m00:05:26.825329 [debug] [MainThread]: Flushing usage events
[0m00:05:26.917499 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:05:31.734511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b661d015990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b661d014250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b661d015690>]}


============================== 00:05:31.741456 | 9342e560-5d8b-436b-bba7-f5565710472d ==============================
[0m00:05:31.741456 [info ] [MainThread]: Running with dbt=1.10.15
[0m00:05:31.745200 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'no_print': 'None', 'invocation_command': 'dbt run --select silver.*', 'printer_width': '80', 'quiet': 'False', 'write_json': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_path': '/opt/airflow/dbt/logs', 'use_colors': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'log_cache_events': 'False', 'debug': 'False', 'empty': 'False', 'indirect_selection': 'eager'}
[0m00:05:32.820995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9342e560-5d8b-436b-bba7-f5565710472d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6607e9e710>]}
[0m00:05:32.902134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9342e560-5d8b-436b-bba7-f5565710472d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b661e0e1750>]}
[0m00:05:32.903084 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m00:05:33.131940 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m00:05:33.297647 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:05:33.298130 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:05:33.305679 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m00:05:33.389344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9342e560-5d8b-436b-bba7-f5565710472d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6607963e90>]}
[0m00:05:33.513081 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m00:05:33.515222 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m00:05:33.538761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9342e560-5d8b-436b-bba7-f5565710472d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b66077f7fd0>]}
[0m00:05:33.539362 [info ] [MainThread]: Found 8 models, 43 data tests, 2 sources, 604 macros
[0m00:05:33.540098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9342e560-5d8b-436b-bba7-f5565710472d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6607d5b350>]}
[0m00:05:33.542230 [info ] [MainThread]: 
[0m00:05:33.543758 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:05:33.544372 [info ] [MainThread]: 
[0m00:05:33.545140 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:05:33.549890 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m00:05:33.568106 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m00:05:33.568616 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m00:05:33.568973 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:05:34.553431 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.984 seconds
[0m00:05:34.555253 [debug] [ThreadPool]: On list_spotify_data: Close
[0m00:05:34.604982 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_gold)
[0m00:05:34.605805 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m00:05:34.625605 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m00:05:34.629542 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m00:05:34.629902 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:05:34.629091 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m00:05:34.631638 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m00:05:34.632017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:05:35.203487 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.574 seconds
[0m00:05:35.205831 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m00:05:35.625783 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.994 seconds
[0m00:05:35.628235 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m00:05:35.700332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9342e560-5d8b-436b-bba7-f5565710472d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b661cbf6a50>]}
[0m00:05:35.705762 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m00:05:35.706217 [debug] [Thread-2 (]: Began running node model.spotify_analytics.track_audio_features
[0m00:05:35.706776 [info ] [Thread-1 (]: 1 of 2 START sql table model silver.silver_plays ............................... [RUN]
[0m00:05:35.707707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.silver_plays)
[0m00:05:35.708097 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m00:05:35.707246 [info ] [Thread-2 (]: 2 of 2 START sql table model silver.track_audio_features ....................... [RUN]
[0m00:05:35.715286 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.track_audio_features)
[0m00:05:35.715686 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.track_audio_features
[0m00:05:35.727780 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m00:05:35.728241 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.track_audio_features"
[0m00:05:35.728989 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.track_audio_features
[0m00:05:35.730283 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m00:05:35.794188 [debug] [Thread-2 (]: Writing runtime sql for node "model.spotify_analytics.track_audio_features"
[0m00:05:35.793695 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.silver_plays"
[0m00:05:35.796840 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.silver_plays"
[0m00:05:35.797908 [debug] [Thread-2 (]: Using snowflake connection "model.spotify_analytics.track_audio_features"
[0m00:05:35.800767 [debug] [Thread-2 (]: On model.spotify_analytics.track_audio_features: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.track_audio_features"} */
create or replace transient table spotify_data.silver.track_audio_features
         as
        (

/*
    Track Audio Features - Silver Layer
    
    Combines track metadata from plays with audio features from Spotify API
    This is a clean, deduplicated view of all tracks with their audio characteristics
*/

SELECT 
    af.track_id,
    af.danceability,
    af.energy,
    af.key,
    af.loudness,
    af.mode,
    af.speechiness,
    af.acousticness,
    af.instrumentalness,
    af.liveness,
    af.valence,
    af.tempo,
    af.duration_ms,
    af.time_signature,
    af.fetched_at
FROM spotify_data.bronze.track_audio_features af
WHERE af.track_id IS NOT NULL
        );
[0m00:05:35.801366 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:05:35.798786 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.silver_plays"} */
create or replace transient table spotify_data.silver.silver_plays
         as
        (

-- ============================================================================
-- SILVER LAYER: CLEANED PLAYS DATA
-- ============================================================================
-- Purpose: Transform bronze plays data into clean, analytics-ready format
-- 
-- Transformations:
--   1. Deduplicate records (DISTINCT on event_id)
--   2. Cast all data types from VARIANT to proper types
--   3. Filter invalid records (defensive WHERE clauses)
--   4. Add processing metadata (processed_at timestamp)
--
-- Source: bronze.plays (external table reading from S3 Parquet files)
-- Target: SILVER.silver_plays (materialized table)
-- ============================================================================

WITH source_data AS (
    SELECT 
        VALUE:event_id::VARCHAR AS event_id,
        VALUE:user_id::VARCHAR AS user_id,
        VALUE:event_type::VARCHAR AS event_type,
        VALUE:track_id::VARCHAR AS track_id,
        VALUE:track_name::VARCHAR AS track_name,
        VALUE:artist_name::VARCHAR AS artist_name,
        VALUE:album_name::VARCHAR AS album_name,
        VALUE:duration_ms::NUMBER AS duration_ms,
        VALUE:played_at::VARCHAR AS played_at,
        VALUE:device_type::VARCHAR AS device_type
    FROM spotify_data.bronze.plays
),

deduplicated AS (
    SELECT DISTINCT
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM source_data
    WHERE 
        -- Data quality filters
        user_id IS NOT NULL
        AND duration_ms > 0
        AND duration_ms < 600000  -- Less than 10 minutes (catches data errors)
        AND event_id IS NOT NULL
)

SELECT 
    -- Identifiers
    event_id::VARCHAR AS event_id,
    user_id::VARCHAR AS user_id,
    event_type::VARCHAR AS event_type,
    
    -- Track information
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    duration_ms::NUMBER AS duration_ms,
    
    -- Timestamps
    TRY_CAST(played_at AS TIMESTAMP) AS played_at,
    
    -- Device context
    device_type::VARCHAR AS device_type,
    
    -- Metadata
    CURRENT_TIMESTAMP() AS processed_at
    
FROM deduplicated
        );
[0m00:05:35.802034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:05:36.768626 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c0fd45-0004-162f-000a-68a200089442
[0m00:05:36.769223 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
[0m00:05:36.769805 [debug] [Thread-2 (]: On model.spotify_analytics.track_audio_features: Close
[0m00:05:36.862760 [debug] [Thread-2 (]: Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql
[0m00:05:36.864590 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9342e560-5d8b-436b-bba7-f5565710472d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6607d16fd0>]}
[0m00:05:36.866335 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model silver.track_audio_features .............. [[31mERROR[0m in 1.15s]
[0m00:05:36.867763 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.track_audio_features
[0m00:05:36.868337 [debug] [Thread-7 (]: Marking all children of 'model.spotify_analytics.track_audio_features' to be skipped because of status 'error'.  Reason: Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql.
[0m00:05:38.437449 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.635 seconds
[0m00:05:38.469096 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: Close
[0m00:05:38.540845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9342e560-5d8b-436b-bba7-f5565710472d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b661d6dd490>]}
[0m00:05:38.541763 [info ] [Thread-1 (]: 1 of 2 OK created sql table model silver.silver_plays .......................... [[32mSUCCESS 1[0m in 2.83s]
[0m00:05:38.543264 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m00:05:38.545335 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:05:38.545702 [debug] [MainThread]: Connection 'model.spotify_analytics.silver_plays' was properly closed.
[0m00:05:38.546131 [debug] [MainThread]: Connection 'model.spotify_analytics.track_audio_features' was properly closed.
[0m00:05:38.546549 [info ] [MainThread]: 
[0m00:05:38.547406 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.00 seconds (5.00s).
[0m00:05:38.549508 [debug] [MainThread]: Command end result
[0m00:05:38.586278 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m00:05:38.588011 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m00:05:38.594688 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m00:05:38.595096 [info ] [MainThread]: 
[0m00:05:38.595808 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:05:38.596497 [info ] [MainThread]: 
[0m00:05:38.597593 [error] [MainThread]: [31mFailure in model track_audio_features (models/silver/track_audio_features.sql)[0m
[0m00:05:38.598223 [error] [MainThread]:   Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql
[0m00:05:38.601298 [info ] [MainThread]: 
[0m00:05:38.602934 [info ] [MainThread]:   compiled code at target/compiled/spotify_analytics/models/silver/track_audio_features.sql
[0m00:05:38.603610 [info ] [MainThread]: 
[0m00:05:38.604217 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m00:05:38.606488 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.936685, "process_in_blocks": "0", "process_kernel_time": 0.550462, "process_mem_max_rss": "249216", "process_out_blocks": "3176", "process_user_time": 4.245321}
[0m00:05:38.607142 [debug] [MainThread]: Command `dbt run` failed at 00:05:38.607004 after 6.94 seconds
[0m00:05:38.607590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b661d33a310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6607db0bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b66216cd0d0>]}
[0m00:05:38.608072 [debug] [MainThread]: Flushing usage events
[0m00:05:38.696401 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:08:32.269180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fefced5c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fefced4510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fefced5850>]}


============================== 00:08:32.276121 | 92d26ef6-c97f-45de-89e6-332eef58ab4a ==============================
[0m00:08:32.276121 [info ] [MainThread]: Running with dbt=1.10.15
[0m00:08:32.276676 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'introspect': 'True', 'version_check': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/opt/airflow/dbt/logs', 'target_path': 'None', 'indirect_selection': 'eager', 'debug': 'False', 'quiet': 'False', 'partial_parse': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_format': 'default', 'invocation_command': 'dbt run --select silver.*', 'use_colors': 'True', 'printer_width': '80', 'empty': 'False'}
[0m00:08:33.349741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92d26ef6-c97f-45de-89e6-332eef58ab4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fefced7610>]}
[0m00:08:33.430140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92d26ef6-c97f-45de-89e6-332eef58ab4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fefdfa9910>]}
[0m00:08:33.431219 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m00:08:33.660177 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m00:08:33.820385 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:08:33.820938 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:08:33.828228 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m00:08:33.894697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92d26ef6-c97f-45de-89e6-332eef58ab4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fee7a31c10>]}
[0m00:08:34.034844 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m00:08:34.037268 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m00:08:34.074286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92d26ef6-c97f-45de-89e6-332eef58ab4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fee74c3f90>]}
[0m00:08:34.074947 [info ] [MainThread]: Found 8 models, 43 data tests, 2 sources, 604 macros
[0m00:08:34.075354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92d26ef6-c97f-45de-89e6-332eef58ab4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fee75af790>]}
[0m00:08:34.078122 [info ] [MainThread]: 
[0m00:08:34.078552 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:08:34.079279 [info ] [MainThread]: 
[0m00:08:34.080519 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:08:34.085814 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m00:08:34.101752 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m00:08:34.102137 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m00:08:34.102446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:08:37.082326 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.980 seconds
[0m00:08:37.085077 [debug] [ThreadPool]: On list_spotify_data: Close
[0m00:08:37.146913 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_silver)
[0m00:08:37.153305 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m00:08:37.158599 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m00:08:37.171479 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m00:08:37.171833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:08:37.170685 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m00:08:37.175205 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m00:08:37.175640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:08:37.904582 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.729 seconds
[0m00:08:37.911301 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m00:08:37.945716 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.774 seconds
[0m00:08:37.947338 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m00:08:38.013842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92d26ef6-c97f-45de-89e6-332eef58ab4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fee7a55710>]}
[0m00:08:38.018347 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m00:08:38.020259 [debug] [Thread-2 (]: Began running node model.spotify_analytics.track_audio_features
[0m00:08:38.019893 [info ] [Thread-1 (]: 1 of 2 START sql table model silver.silver_plays ............................... [RUN]
[0m00:08:38.022032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.silver_plays)
[0m00:08:38.022447 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m00:08:38.020748 [info ] [Thread-2 (]: 2 of 2 START sql table model silver.track_audio_features ....................... [RUN]
[0m00:08:38.028496 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.track_audio_features)
[0m00:08:38.028944 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.track_audio_features
[0m00:08:38.033483 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.track_audio_features"
[0m00:08:38.038111 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m00:08:38.042769 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m00:08:38.038805 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.track_audio_features
[0m00:08:38.109173 [debug] [Thread-2 (]: Writing runtime sql for node "model.spotify_analytics.track_audio_features"
[0m00:08:38.110422 [debug] [Thread-2 (]: Using snowflake connection "model.spotify_analytics.track_audio_features"
[0m00:08:38.108660 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.silver_plays"
[0m00:08:38.111096 [debug] [Thread-2 (]: On model.spotify_analytics.track_audio_features: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.track_audio_features"} */
create or replace transient table spotify_data.silver.track_audio_features
         as
        (

/*
    Track Audio Features - Silver Layer
    
    Combines track metadata from plays with audio features from Spotify API
    This is a clean, deduplicated view of all tracks with their audio characteristics
*/

SELECT 
    af.track_id,
    af.danceability,
    af.energy,
    af.key,
    af.loudness,
    af.mode,
    af.speechiness,
    af.acousticness,
    af.instrumentalness,
    af.liveness,
    af.valence,
    af.tempo,
    af.duration_ms,
    af.time_signature,
    af.fetched_at
FROM spotify_data.bronze.track_audio_features af
WHERE af.track_id IS NOT NULL
        );
[0m00:08:38.114748 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:08:38.114070 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.silver_plays"
[0m00:08:38.116142 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.silver_plays"} */
create or replace transient table spotify_data.silver.silver_plays
         as
        (

-- ============================================================================
-- SILVER LAYER: CLEANED PLAYS DATA
-- ============================================================================
-- Purpose: Transform bronze plays data into clean, analytics-ready format
-- 
-- Transformations:
--   1. Deduplicate records (DISTINCT on event_id)
--   2. Cast all data types from VARIANT to proper types
--   3. Filter invalid records (defensive WHERE clauses)
--   4. Add processing metadata (processed_at timestamp)
--
-- Source: bronze.plays (external table reading from S3 Parquet files)
-- Target: SILVER.silver_plays (materialized table)
-- ============================================================================

WITH source_data AS (
    SELECT 
        VALUE:event_id::VARCHAR AS event_id,
        VALUE:user_id::VARCHAR AS user_id,
        VALUE:event_type::VARCHAR AS event_type,
        VALUE:track_id::VARCHAR AS track_id,
        VALUE:track_name::VARCHAR AS track_name,
        VALUE:artist_name::VARCHAR AS artist_name,
        VALUE:album_name::VARCHAR AS album_name,
        VALUE:duration_ms::NUMBER AS duration_ms,
        VALUE:played_at::VARCHAR AS played_at,
        VALUE:device_type::VARCHAR AS device_type
    FROM spotify_data.bronze.plays
),

deduplicated AS (
    SELECT DISTINCT
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM source_data
    WHERE 
        -- Data quality filters
        user_id IS NOT NULL
        AND duration_ms > 0
        AND duration_ms < 600000  -- Less than 10 minutes (catches data errors)
        AND event_id IS NOT NULL
)

SELECT 
    -- Identifiers
    event_id::VARCHAR AS event_id,
    user_id::VARCHAR AS user_id,
    event_type::VARCHAR AS event_type,
    
    -- Track information
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    duration_ms::NUMBER AS duration_ms,
    
    -- Timestamps
    TRY_CAST(played_at AS TIMESTAMP) AS played_at,
    
    -- Device context
    device_type::VARCHAR AS device_type,
    
    -- Metadata
    CURRENT_TIMESTAMP() AS processed_at
    
FROM deduplicated
        );
[0m00:08:38.116594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:08:38.554574 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c0fd48-0004-171d-000a-68a20008f3c2
[0m00:08:38.555173 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
[0m00:08:38.556131 [debug] [Thread-2 (]: On model.spotify_analytics.track_audio_features: Close
[0m00:08:38.606270 [debug] [Thread-2 (]: Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql
[0m00:08:38.608270 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92d26ef6-c97f-45de-89e6-332eef58ab4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fee763f2d0>]}
[0m00:08:38.609202 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model silver.track_audio_features .............. [[31mERROR[0m in 0.58s]
[0m00:08:38.611412 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.track_audio_features
[0m00:08:38.612452 [debug] [Thread-7 (]: Marking all children of 'model.spotify_analytics.track_audio_features' to be skipped because of status 'error'.  Reason: Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql.
[0m00:08:40.409736 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.293 seconds
[0m00:08:40.434742 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: Close
[0m00:08:40.513298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92d26ef6-c97f-45de-89e6-332eef58ab4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fee7bc3e90>]}
[0m00:08:40.514168 [info ] [Thread-1 (]: 1 of 2 OK created sql table model silver.silver_plays .......................... [[32mSUCCESS 1[0m in 2.49s]
[0m00:08:40.516028 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m00:08:40.518110 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:08:40.518502 [debug] [MainThread]: Connection 'model.spotify_analytics.silver_plays' was properly closed.
[0m00:08:40.518804 [debug] [MainThread]: Connection 'model.spotify_analytics.track_audio_features' was properly closed.
[0m00:08:40.521417 [info ] [MainThread]: 
[0m00:08:40.522196 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 6.44 seconds (6.44s).
[0m00:08:40.524391 [debug] [MainThread]: Command end result
[0m00:08:40.571003 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m00:08:40.574460 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m00:08:40.590785 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m00:08:40.592723 [info ] [MainThread]: 
[0m00:08:40.594198 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:08:40.594571 [info ] [MainThread]: 
[0m00:08:40.596807 [error] [MainThread]: [31mFailure in model track_audio_features (models/silver/track_audio_features.sql)[0m
[0m00:08:40.597287 [error] [MainThread]:   Database Error in model track_audio_features (models/silver/track_audio_features.sql)
  002003 (42S02): SQL compilation error:
  Object 'SPOTIFY_DATA.BRONZE.TRACK_AUDIO_FEATURES' does not exist or not authorized.
  compiled code at target/run/spotify_analytics/models/silver/track_audio_features.sql
[0m00:08:40.597612 [info ] [MainThread]: 
[0m00:08:40.600870 [info ] [MainThread]:   compiled code at target/compiled/spotify_analytics/models/silver/track_audio_features.sql
[0m00:08:40.601265 [info ] [MainThread]: 
[0m00:08:40.602416 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m00:08:40.606728 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.4004, "process_in_blocks": "0", "process_kernel_time": 0.555314, "process_mem_max_rss": "249624", "process_out_blocks": "3184", "process_user_time": 4.213037}
[0m00:08:40.608685 [debug] [MainThread]: Command `dbt run` failed at 00:08:40.608543 after 8.40 seconds
[0m00:08:40.611399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fefce6be90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fefce6b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ff01594190>]}
[0m00:08:40.611924 [debug] [MainThread]: Flushing usage events
[0m00:08:40.747667 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:15:54.329132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4b85bc9190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4b85bc9450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4b85bc94d0>]}


============================== 00:15:54.335924 | a7956cd8-1d21-4175-b024-baf05c2ae3d3 ==============================
[0m00:15:54.335924 [info ] [MainThread]: Running with dbt=1.10.15
[0m00:15:54.338436 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'write_json': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select silver.*', 'use_colors': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'log_cache_events': 'False', 'warn_error': 'None', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'quiet': 'False', 'profiles_dir': '/opt/airflow/dbt', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'partial_parse': 'True', 'static_parser': 'True', 'introspect': 'True', 'empty': 'False', 'use_experimental_parser': 'False'}
[0m00:15:55.434684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7956cd8-1d21-4175-b024-baf05c2ae3d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4b86b6c690>]}
[0m00:15:55.513615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7956cd8-1d21-4175-b024-baf05c2ae3d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4b86ca5750>]}
[0m00:15:55.514592 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m00:15:55.749020 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m00:15:55.904243 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m00:15:55.905044 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/track_recommendations.sql
[0m00:15:55.905446 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/silver/track_audio_features.sql
[0m00:15:55.906882 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/user_listening_profile.sql
[0m00:15:56.153060 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.spotify_analytics.track_audio_features' (models/silver/track_audio_features.sql) depends on a source named 'bronze.track_audio_features' which was not found
[0m00:15:56.155344 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8948557, "process_in_blocks": "400", "process_kernel_time": 0.412813, "process_mem_max_rss": "225420", "process_out_blocks": "8", "process_user_time": 3.291856}
[0m00:15:56.156161 [debug] [MainThread]: Command `dbt run` failed at 00:15:56.156053 after 1.90 seconds
[0m00:15:56.156585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4b741e4bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4b74359210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4b8a274210>]}
[0m00:15:56.157967 [debug] [MainThread]: Flushing usage events
[0m00:15:56.258538 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:26:00.412964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78233d097bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78233d0978d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78233d097210>]}


============================== 00:26:00.419757 | c685cb78-bbc2-4ca0-8827-af3bda1ba2d4 ==============================
[0m00:26:00.419757 [info ] [MainThread]: Running with dbt=1.10.15
[0m00:26:00.420331 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'invocation_command': 'dbt run --select silver.*', 'quiet': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'no_print': 'None', 'version_check': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'printer_width': '80', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'static_parser': 'True'}
[0m00:26:01.525331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c685cb78-bbc2-4ca0-8827-af3bda1ba2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78233d77d0d0>]}
[0m00:26:01.605600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c685cb78-bbc2-4ca0-8827-af3bda1ba2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78233e1717d0>]}
[0m00:26:01.606970 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m00:26:01.835104 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m00:26:01.990181 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m00:26:01.991411 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/user_listening_profile.sql
[0m00:26:01.992261 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/silver/track_audio_features.sql
[0m00:26:01.992627 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/track_recommendations.sql
[0m00:26:02.278899 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.spotify_analytics.track_audio_features' (models/silver/track_audio_features.sql) depends on a source named 'bronze.track_audio_features' which was not found
[0m00:26:02.284957 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.941842, "process_in_blocks": "0", "process_kernel_time": 0.4239, "process_mem_max_rss": "225300", "process_out_blocks": "16", "process_user_time": 3.291394}
[0m00:26:02.285753 [debug] [MainThread]: Command `dbt run` failed at 00:26:02.285641 after 1.94 seconds
[0m00:26:02.286247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78233d3c68d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782341886850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782327811cd0>]}
[0m00:26:02.286708 [debug] [MainThread]: Flushing usage events
[0m00:26:02.375555 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:05:26.034331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7472b367c650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7472b3ae1690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7472b367f6d0>]}


============================== 01:05:26.047506 | 6f0f5336-4625-4752-8654-d85a19db7241 ==============================
[0m01:05:26.047506 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:05:26.048281 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'cache_selected_only': 'False', 'fail_fast': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'target_path': 'None', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt compile', 'no_print': 'None', 'warn_error': 'None', 'printer_width': '80', 'log_format': 'default', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_cache_events': 'False', 'version_check': 'True'}
[0m01:05:27.386890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f0f5336-4625-4752-8654-d85a19db7241', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7472b36b2b50>]}
[0m01:05:27.509445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f0f5336-4625-4752-8654-d85a19db7241', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74729e30f210>]}
[0m01:05:27.511376 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m01:05:27.736540 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m01:05:27.909271 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m01:05:27.910045 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/user_listening_profile.sql
[0m01:05:27.910448 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/silver/track_audio_features.sql
[0m01:05:27.911201 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/track_recommendations.sql
[0m01:05:28.157067 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.spotify_analytics.track_audio_features' (models/silver/track_audio_features.sql) depends on a source named 'bronze.track_audio_features' which was not found
[0m01:05:28.159241 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 2.20182, "process_in_blocks": "69216", "process_kernel_time": 0.527465, "process_mem_max_rss": "225032", "process_out_blocks": "16", "process_user_time": 3.348924}
[0m01:05:28.160042 [debug] [MainThread]: Command `dbt compile` failed at 01:05:28.159926 after 2.20 seconds
[0m01:05:28.160463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7472b39f2590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7472b36dc190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7472b36e7e90>]}
[0m01:05:28.161596 [debug] [MainThread]: Flushing usage events
[0m01:05:28.253987 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:09:17.423634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adee5717250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adee47f39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adee4875c90>]}


============================== 01:09:17.429333 | a7f7a30c-ff4d-4bf1-b2a7-754e39972b5e ==============================
[0m01:09:17.429333 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:09:17.430325 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'empty': 'False', 'quiet': 'False', 'debug': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'use_colors': 'True', 'fail_fast': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt compile', 'warn_error': 'None', 'target_path': 'None', 'no_print': 'None'}
[0m01:09:18.491350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7f7a30c-ff4d-4bf1-b2a7-754e39972b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adecf58a490>]}
[0m01:09:18.687997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7f7a30c-ff4d-4bf1-b2a7-754e39972b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adecf4f6210>]}
[0m01:09:18.691445 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m01:09:18.953287 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m01:09:19.120191 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m01:09:19.121406 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/user_listening_profile.sql
[0m01:09:19.122254 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/track_recommendations.sql
[0m01:09:19.122680 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/silver/track_audio_features.sql
[0m01:09:19.470216 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.spotify_analytics.track_audio_features' (models/silver/track_audio_features.sql) depends on a source named 'bronze.track_audio_features' which was not found
[0m01:09:19.472331 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 2.1181085, "process_in_blocks": "0", "process_kernel_time": 0.435736, "process_mem_max_rss": "225544", "process_out_blocks": "16", "process_user_time": 3.269136}
[0m01:09:19.473087 [debug] [MainThread]: Command `dbt compile` failed at 01:09:19.472973 after 2.12 seconds
[0m01:09:19.473528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adee47f0f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adee47f2610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adee8f38fd0>]}
[0m01:09:19.473975 [debug] [MainThread]: Flushing usage events
[0m01:09:19.568038 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:44:49.991309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724dd567bd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724dd5687a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724dd5687a90>]}


============================== 17:44:50.008459 | 60416f48-09d9-45a0-aecd-1ce9951b69f8 ==============================
[0m17:44:50.008459 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:44:50.009251 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'use_colors': 'True', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error': 'None', 'invocation_command': 'dbt compile', 'log_path': '/opt/airflow/dbt/logs', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'static_parser': 'True', 'profiles_dir': '/opt/airflow/dbt', 'partial_parse': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'printer_width': '80', 'use_experimental_parser': 'False'}
[0m17:44:52.323230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60416f48-09d9-45a0-aecd-1ce9951b69f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724dc443f190>]}
[0m17:44:52.402538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60416f48-09d9-45a0-aecd-1ce9951b69f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724dd7b7ccd0>]}
[0m17:44:52.404998 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m17:44:52.825041 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m17:44:53.241915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m17:44:53.242742 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/track_recommendations.sql
[0m17:44:53.243287 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/user_listening_profile.sql
[0m17:44:53.243751 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/silver/track_audio_features.sql
[0m17:44:53.484302 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.spotify_analytics.track_audio_features' (models/silver/track_audio_features.sql) depends on a source named 'bronze.track_audio_features' which was not found
[0m17:44:53.486782 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 3.5659776, "process_in_blocks": "128000", "process_kernel_time": 0.633944, "process_mem_max_rss": "222248", "process_out_blocks": "16", "process_user_time": 3.388884}
[0m17:44:53.487711 [debug] [MainThread]: Command `dbt compile` failed at 17:44:53.487503 after 3.57 seconds
[0m17:44:53.488173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724dd55f30d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724dd55f2650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724dd568fc90>]}
[0m17:44:53.488695 [debug] [MainThread]: Flushing usage events
[0m17:44:53.602735 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:54:59.050298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8172b66a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8172b12c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8172b11d90>]}


============================== 17:54:59.060906 | 750b2ad8-3f33-4813-aa29-769ccb430f65 ==============================
[0m17:54:59.060906 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:54:59.061549 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'version_check': 'True', 'printer_width': '80', 'static_parser': 'True', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_format': 'default', 'empty': 'False', 'warn_error': 'None', 'no_print': 'None', 'write_json': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt compile', 'debug': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/opt/airflow/dbt/logs'}
[0m17:55:00.966543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '750b2ad8-3f33-4813-aa29-769ccb430f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a815d8f1310>]}
[0m17:55:01.045661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '750b2ad8-3f33-4813-aa29-769ccb430f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8173b0a9d0>]}
[0m17:55:01.048539 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m17:55:01.288259 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m17:55:01.696553 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m17:55:01.697766 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/silver/track_audio_features.sql
[0m17:55:01.698211 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/user_listening_profile.sql
[0m17:55:01.699005 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/track_recommendations.sql
[0m17:55:01.944823 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.spotify_analytics.track_audio_features' (models/silver/track_audio_features.sql) depends on a source named 'bronze.track_audio_features' which was not found
[0m17:55:01.948131 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 2.964163, "process_in_blocks": "77792", "process_kernel_time": 0.559624, "process_mem_max_rss": "223080", "process_out_blocks": "16", "process_user_time": 3.33894}
[0m17:55:01.949177 [debug] [MainThread]: Command `dbt compile` failed at 17:55:01.949051 after 2.97 seconds
[0m17:55:01.949667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8172b109d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a817721c1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a815d457cd0>]}
[0m17:55:01.950163 [debug] [MainThread]: Flushing usage events
[0m17:55:02.062287 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:00:39.382743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b48e8482cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b48e842c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b48e87a6990>]}


============================== 18:00:39.393269 | b45c3bb3-b844-4fdc-bdd6-48c91ea9d065 ==============================
[0m18:00:39.393269 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:00:39.394672 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/opt/airflow/dbt', 'no_print': 'None', 'debug': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt compile', 'log_cache_events': 'False', 'write_json': 'True', 'warn_error': 'None', 'quiet': 'False', 'log_format': 'default', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'empty': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None'}
[0m18:00:40.992175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b45c3bb3-b844-4fdc-bdd6-48c91ea9d065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b48e943a250>]}
[0m18:00:41.073465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b45c3bb3-b844-4fdc-bdd6-48c91ea9d065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b48d85d88d0>]}
[0m18:00:41.075413 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:00:41.313023 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m18:00:41.635719 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m18:00:41.636769 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/silver/track_audio_features.sql
[0m18:00:41.637777 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/user_listening_profile.sql
[0m18:00:41.638161 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/track_recommendations.sql
[0m18:00:41.921557 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.spotify_analytics.track_audio_features' (models/silver/track_audio_features.sql) depends on a source named 'bronze.track_audio_features' which was not found
[0m18:00:41.924457 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 2.610817, "process_in_blocks": "75016", "process_kernel_time": 0.546084, "process_mem_max_rss": "223588", "process_out_blocks": "16", "process_user_time": 3.40513}
[0m18:00:41.926343 [debug] [MainThread]: Command `dbt compile` failed at 18:00:41.926173 after 2.61 seconds
[0m18:00:41.926884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b48e8413d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b48e8413c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b48d2bf2350>]}
[0m18:00:41.927403 [debug] [MainThread]: Flushing usage events
[0m18:00:42.018741 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:04:05.972601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726d7b9c50d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726d7b9c5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726d7b9c5090>]}


============================== 18:04:05.979827 | a184c610-a1e3-4689-b54b-690863a1aaa2 ==============================
[0m18:04:05.979827 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:04:05.981221 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'printer_width': '80', 'static_parser': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_path': '/opt/airflow/dbt/logs', 'no_print': 'None', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'profiles_dir': '/opt/airflow/dbt', 'warn_error': 'None', 'use_colors': 'True', 'empty': 'False', 'write_json': 'True', 'debug': 'False', 'target_path': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt compile'}
[0m18:04:07.095719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a184c610-a1e3-4689-b54b-690863a1aaa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726d665c1150>]}
[0m18:04:07.174023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a184c610-a1e3-4689-b54b-690863a1aaa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726d7ca7d550>]}
[0m18:04:07.174997 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:04:07.394797 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m18:04:07.557796 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m18:04:07.558544 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/user_listening_profile.sql
[0m18:04:07.559350 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/silver/track_audio_features.sql
[0m18:04:07.559691 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/track_recommendations.sql
[0m18:04:07.826732 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.spotify_analytics.track_audio_features' (models/silver/track_audio_features.sql) depends on a source named 'bronze.track_audio_features' which was not found
[0m18:04:07.828510 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 1.9255025, "process_in_blocks": "0", "process_kernel_time": 0.426071, "process_mem_max_rss": "223716", "process_out_blocks": "16", "process_user_time": 3.246538}
[0m18:04:07.829288 [debug] [MainThread]: Command `dbt compile` failed at 18:04:07.829172 after 1.93 seconds
[0m18:04:07.830231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726d7b9c4690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726d7b9c5c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726d800441d0>]}
[0m18:04:07.831113 [debug] [MainThread]: Flushing usage events
[0m18:04:07.922293 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:10:38.123539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dc9787fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dc97baa910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dc9787d9d0>]}


============================== 18:10:38.130415 | 643eea3f-a017-4caf-b2d3-216a9ce2af0c ==============================
[0m18:10:38.130415 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:10:38.131410 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'fail_fast': 'False', 'version_check': 'True', 'printer_width': '80', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'introspect': 'True', 'use_colors': 'True', 'profiles_dir': '/opt/airflow/dbt', 'warn_error': 'None', 'empty': 'False', 'invocation_command': 'dbt compile', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'target_path': 'None', 'partial_parse': 'True'}
[0m18:10:39.193272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '643eea3f-a017-4caf-b2d3-216a9ce2af0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dc9a19f2d0>]}
[0m18:10:39.280116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '643eea3f-a017-4caf-b2d3-216a9ce2af0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dc89130050>]}
[0m18:10:39.281155 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:10:39.500891 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m18:10:39.701688 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m18:10:39.702467 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/track_recommendations.sql
[0m18:10:39.702908 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/silver/track_audio_features.sql
[0m18:10:39.703254 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/user_listening_profile.sql
[0m18:10:39.942256 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.spotify_analytics.track_audio_features' (models/silver/track_audio_features.sql) depends on a source named 'bronze.track_audio_features' which was not found
[0m18:10:39.944487 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 1.8893822, "process_in_blocks": "0", "process_kernel_time": 0.415897, "process_mem_max_rss": "223584", "process_out_blocks": "16", "process_user_time": 3.260364}
[0m18:10:39.945290 [debug] [MainThread]: Command `dbt compile` failed at 18:10:39.945176 after 1.89 seconds
[0m18:10:39.945733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dc97841150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dc81f8d5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dc97884050>]}
[0m18:10:39.947371 [debug] [MainThread]: Flushing usage events
[0m18:10:40.045429 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:20:45.042645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3f893dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3f89fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3f89f850>]}


============================== 18:20:45.048983 | 85fc60a0-345c-43a2-8876-b3a496023663 ==============================
[0m18:20:45.048983 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:20:45.050147 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/opt/airflow/dbt', 'target_path': 'None', 'use_colors': 'True', 'version_check': 'True', 'invocation_command': 'dbt compile', 'write_json': 'True', 'no_print': 'None', 'printer_width': '80', 'static_parser': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'fail_fast': 'False', 'empty': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'quiet': 'False', 'warn_error': 'None'}
[0m18:20:46.123660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85fc60a0-345c-43a2-8876-b3a496023663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b2a61a2d0>]}
[0m18:20:46.203713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85fc60a0-345c-43a2-8876-b3a496023663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b4096d690>]}
[0m18:20:46.204678 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:20:46.428074 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m18:20:46.621961 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m18:20:46.622664 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/user_listening_profile.sql
[0m18:20:46.623103 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/track_recommendations.sql
[0m18:20:46.623445 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/silver/track_audio_features.sql
[0m18:20:46.858160 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.spotify_analytics.track_audio_features' (models/silver/track_audio_features.sql) depends on a source named 'bronze.track_audio_features' which was not found
[0m18:20:46.860707 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 1.8894892, "process_in_blocks": "0", "process_kernel_time": 0.39142, "process_mem_max_rss": "223724", "process_out_blocks": "16", "process_user_time": 3.26066}
[0m18:20:46.861469 [debug] [MainThread]: Command `dbt compile` failed at 18:20:46.861365 after 1.89 seconds
[0m18:20:46.861935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3f7f3690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3f7f3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b29ec52d0>]}
[0m18:20:46.862377 [debug] [MainThread]: Flushing usage events
[0m18:20:46.951540 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:23:46.060991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e19fc65d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e19fc65d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e19f949c10>]}


============================== 18:23:46.067804 | de816bff-c3f8-4d89-88a6-77f34bd2e991 ==============================
[0m18:23:46.067804 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:23:46.068357 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt compile --project-dir dbt --profiles-dir dbt', 'quiet': 'False', 'introspect': 'True', 'static_parser': 'True', 'log_path': 'dbt/logs', 'use_colors': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'profiles_dir': 'dbt', 'cache_selected_only': 'False', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'fail_fast': 'False', 'target_path': 'None', 'warn_error': 'None', 'log_cache_events': 'False', 'version_check': 'True', 'log_format': 'default', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None'}
[0m18:23:47.163878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de816bff-c3f8-4d89-88a6-77f34bd2e991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e18bdd5f10>]}
[0m18:23:47.253780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de816bff-c3f8-4d89-88a6-77f34bd2e991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e1a0a29190>]}
[0m18:23:47.254710 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:23:47.502317 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m18:23:47.682779 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:23:47.683287 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:23:47.691257 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m18:23:47.743441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de816bff-c3f8-4d89-88a6-77f34bd2e991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e18a8cfa50>]}
[0m18:23:47.839562 [error] [MainThread]: Encountered an error:
[Errno 13] Permission denied: 'dbt/target/manifest.json'
[0m18:23:47.847277 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 389, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 416, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 2130, in parse_manifest
    write_manifest(manifest, runtime_config.project_target_path)
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 2105, in write_manifest
    manifest.write(path)
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/contracts/graph/manifest.py", line 1232, in write
    writable.write(path)
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/artifacts/schemas/base.py", line 36, in write
    write_json(path, self.to_dict(omit_none=False, context={"artifact": True}))  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt_common/clients/system.py", line 310, in write_json
    with open(path, "w", encoding="utf-8") as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: 'dbt/target/manifest.json'

[0m18:23:47.850991 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 1.8830132, "process_in_blocks": "7456", "process_kernel_time": 0.402257, "process_mem_max_rss": "222676", "process_out_blocks": "16", "process_user_time": 3.204151}
[0m18:23:47.851770 [debug] [MainThread]: Command `dbt compile` failed at 18:23:47.851646 after 1.88 seconds
[0m18:23:47.853237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e19f90c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e19f90c810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e18a3fd890>]}
[0m18:23:47.853863 [debug] [MainThread]: Flushing usage events
[0m18:23:47.944578 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:26:12.052433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b41a86fe350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b41a5c9fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b41a5c9c8d0>]}


============================== 18:26:12.059752 | 0b1ec3a1-ce7c-42a7-aede-34888bfaf5c3 ==============================
[0m18:26:12.059752 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:26:12.061218 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'log_cache_events': 'False', 'target_path': 'None', 'log_format': 'default', 'fail_fast': 'False', 'version_check': 'True', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'quiet': 'False', 'introspect': 'True', 'profiles_dir': '/opt/airflow/dbt', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'empty': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'static_parser': 'True', 'cache_selected_only': 'False'}
[0m18:26:13.148844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b1ec3a1-ce7c-42a7-aede-34888bfaf5c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b41a6bb7f50>]}
[0m18:26:13.335182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b1ec3a1-ce7c-42a7-aede-34888bfaf5c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b41a6d49750>]}
[0m18:26:13.336119 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:26:13.575277 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m18:26:13.732663 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:26:13.733196 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:26:13.740116 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m18:26:13.836509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b1ec3a1-ce7c-42a7-aede-34888bfaf5c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4194623ad0>]}
[0m18:26:13.927936 [error] [MainThread]: Encountered an error:
[Errno 13] Permission denied: '/opt/airflow/dbt/target/manifest.json'
[0m18:26:13.930436 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 389, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 416, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 2130, in parse_manifest
    write_manifest(manifest, runtime_config.project_target_path)
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 2105, in write_manifest
    manifest.write(path)
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/contracts/graph/manifest.py", line 1232, in write
    writable.write(path)
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/artifacts/schemas/base.py", line 36, in write
    write_json(path, self.to_dict(omit_none=False, context={"artifact": True}))  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt_common/clients/system.py", line 310, in write_json
    with open(path, "w", encoding="utf-8") as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/opt/airflow/dbt/target/manifest.json'

[0m18:26:13.932724 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 1.9471717, "process_in_blocks": "0", "process_kernel_time": 0.419494, "process_mem_max_rss": "222720", "process_out_blocks": "24", "process_user_time": 3.168072}
[0m18:26:13.938897 [debug] [MainThread]: Command `dbt compile` failed at 18:26:13.933441 after 1.95 seconds
[0m18:26:13.939486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b41a5c23a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b419437d190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4194623990>]}
[0m18:26:13.939981 [debug] [MainThread]: Flushing usage events
[0m18:26:14.030367 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:29:01.777279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728ef56e2cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728ef56e1b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728ef56e17d0>]}


============================== 18:29:01.784428 | 6dc5f2a6-f489-4a8b-8e19-2b30510cc508 ==============================
[0m18:29:01.784428 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:29:01.786561 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'invocation_command': 'dbt compile', 'use_colors': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_format': 'default', 'quiet': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'profiles_dir': '/opt/airflow/dbt', 'static_parser': 'True', 'write_json': 'True', 'empty': 'False', 'target_path': 'None', 'no_print': 'None'}
[0m18:29:02.842828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6dc5f2a6-f489-4a8b-8e19-2b30510cc508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728ef66d2210>]}
[0m18:29:02.920873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6dc5f2a6-f489-4a8b-8e19-2b30510cc508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728ee4656210>]}
[0m18:29:02.921832 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:29:03.141160 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m18:29:03.298783 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:29:03.299316 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:29:03.306371 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m18:29:03.360412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6dc5f2a6-f489-4a8b-8e19-2b30510cc508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728ee434e490>]}
[0m18:29:03.447914 [error] [MainThread]: Encountered an error:
[Errno 13] Permission denied: '/opt/airflow/dbt/target/manifest.json'
[0m18:29:03.451522 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 389, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 416, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 2130, in parse_manifest
    write_manifest(manifest, runtime_config.project_target_path)
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 2105, in write_manifest
    manifest.write(path)
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/contracts/graph/manifest.py", line 1232, in write
    writable.write(path)
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/artifacts/schemas/base.py", line 36, in write
    write_json(path, self.to_dict(omit_none=False, context={"artifact": True}))  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt_common/clients/system.py", line 310, in write_json
    with open(path, "w", encoding="utf-8") as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/opt/airflow/dbt/target/manifest.json'

[0m18:29:03.454167 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 1.7654657, "process_in_blocks": "0", "process_kernel_time": 0.458494, "process_mem_max_rss": "222740", "process_out_blocks": "16", "process_user_time": 3.169063}
[0m18:29:03.456122 [debug] [MainThread]: Command `dbt compile` failed at 18:29:03.455979 after 1.77 seconds
[0m18:29:03.459336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728ef586e9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728ef56639d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728ef56f7d10>]}
[0m18:29:03.460854 [debug] [MainThread]: Flushing usage events
[0m18:29:03.549333 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:36:35.692912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36f8e1c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36f9151ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36f8e1c650>]}


============================== 18:36:35.700715 | 0d2105df-027d-4092-89f3-e4a83097e3be ==============================
[0m18:36:35.700715 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:36:35.701840 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'empty': 'False', 'version_check': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_path': 'dbt/logs', 'printer_width': '80', 'quiet': 'False', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'profiles_dir': 'dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt compile --project-dir dbt --profiles-dir dbt', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'debug': 'False', 'fail_fast': 'False', 'target_path': 'None'}
[0m18:36:36.872392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d2105df-027d-4092-89f3-e4a83097e3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36e3cbe7d0>]}
[0m18:36:36.949018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d2105df-027d-4092-89f3-e4a83097e3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36f9f01010>]}
[0m18:36:36.951267 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:36:37.217905 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m18:36:37.369211 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:36:37.369756 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:36:37.377751 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m18:36:37.428307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d2105df-027d-4092-89f3-e4a83097e3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36e3980050>]}
[0m18:36:37.544668 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m18:36:37.549916 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m18:36:37.585755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d2105df-027d-4092-89f3-e4a83097e3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36e36c9750>]}
[0m18:36:37.586738 [info ] [MainThread]: Found 5 models, 43 data tests, 1 source, 604 macros
[0m18:36:37.587585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d2105df-027d-4092-89f3-e4a83097e3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36e3beff90>]}
[0m18:36:37.591398 [info ] [MainThread]: 
[0m18:36:37.592318 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:36:37.592999 [info ] [MainThread]: 
[0m18:36:37.602181 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:36:37.608478 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m18:36:37.610238 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m18:36:37.645395 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m18:36:37.650012 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m18:36:37.649573 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m18:36:37.651204 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m18:36:37.651653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:37.650915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:38.687992 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.037 seconds
[0m18:36:38.689605 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.038 seconds
[0m18:36:38.691613 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m18:36:38.693196 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m18:36:38.780537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d2105df-027d-4092-89f3-e4a83097e3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36e3588610>]}
[0m18:36:38.789578 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m18:36:38.790099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.silver_plays)
[0m18:36:38.790493 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m18:36:38.811755 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m18:36:38.812600 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m18:36:38.813758 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m18:36:38.814697 [debug] [Thread-3 (]: Began running node model.spotify_analytics.daily_user_stats
[0m18:36:38.815231 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.spotify_analytics.daily_user_stats'
[0m18:36:38.815568 [debug] [Thread-3 (]: Began compiling node model.spotify_analytics.daily_user_stats
[0m18:36:38.816830 [debug] [Thread-4 (]: Began running node model.spotify_analytics.device_usage
[0m18:36:38.823524 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.spotify_analytics.device_usage'
[0m18:36:38.817800 [debug] [Thread-2 (]: Began running node model.spotify_analytics.top_artists
[0m18:36:38.825348 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.top_artists)
[0m18:36:38.818598 [debug] [Thread-1 (]: Began running node model.spotify_analytics.top_tracks
[0m18:36:38.826470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.silver_plays, now model.spotify_analytics.top_tracks)
[0m18:36:38.826831 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.top_tracks
[0m18:36:38.822971 [debug] [Thread-3 (]: Writing injected SQL for node "model.spotify_analytics.daily_user_stats"
[0m18:36:38.832022 [debug] [Thread-3 (]: Began executing node model.spotify_analytics.daily_user_stats
[0m18:36:38.825740 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.top_artists
[0m18:36:38.824947 [debug] [Thread-4 (]: Began compiling node model.spotify_analytics.device_usage
[0m18:36:38.832707 [debug] [Thread-3 (]: Finished running node model.spotify_analytics.daily_user_stats
[0m18:36:38.843345 [debug] [Thread-3 (]: Began running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m18:36:38.836662 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.top_artists"
[0m18:36:38.831403 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.top_tracks"
[0m18:36:38.845532 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.top_tracks
[0m18:36:38.844014 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.daily_user_stats, now test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39)
[0m18:36:38.846746 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m18:36:38.842057 [debug] [Thread-4 (]: Writing injected SQL for node "model.spotify_analytics.device_usage"
[0m18:36:38.853212 [debug] [Thread-4 (]: Began executing node model.spotify_analytics.device_usage
[0m18:36:38.844550 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.top_artists
[0m18:36:38.854541 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.top_artists
[0m18:36:38.854912 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m18:36:38.855255 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.top_artists, now test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad)
[0m18:36:38.846411 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.top_tracks
[0m18:36:38.856404 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m18:36:38.853905 [debug] [Thread-4 (]: Finished running node model.spotify_analytics.device_usage
[0m18:36:38.863954 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m18:36:38.864338 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.device_usage, now test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd)
[0m18:36:38.855561 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m18:36:38.856736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.top_tracks, now test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076)
[0m18:36:38.871489 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m18:36:38.864664 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m18:36:38.863512 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m18:36:38.890440 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m18:36:38.893417 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m18:36:38.883661 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m18:36:38.892612 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m18:36:38.896133 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m18:36:38.895516 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m18:36:38.898241 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m18:36:38.897606 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m18:36:38.897201 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m18:36:38.900322 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m18:36:38.900716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076, now test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed)
[0m18:36:38.901068 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m18:36:38.893957 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m18:36:38.906587 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39, now test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa)
[0m18:36:38.906983 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m18:36:38.898617 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m18:36:38.899779 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m18:36:38.912727 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m18:36:38.913107 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m18:36:38.906063 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m18:36:38.914378 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m18:36:38.911149 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad, now test.spotify_analytics.not_null_silver_plays_played_at.8281565f95)
[0m18:36:38.915376 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m18:36:38.913440 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd, now test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9)
[0m18:36:38.920463 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m18:36:38.914963 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m18:36:38.926354 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m18:36:38.926707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed, now test.spotify_analytics.not_null_silver_plays_track_name.c6334add30)
[0m18:36:38.927063 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m18:36:38.910718 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m18:36:38.932142 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m18:36:38.920079 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m18:36:38.933240 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m18:36:38.925945 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m18:36:38.934540 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m18:36:38.932711 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m18:36:38.935516 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m18:36:38.935879 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa, now test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4)
[0m18:36:38.936194 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m18:36:38.933800 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m18:36:38.941063 [debug] [Thread-2 (]: Began running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m18:36:38.941446 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_played_at.8281565f95, now test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf)
[0m18:36:38.935104 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m18:36:38.942231 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m18:36:38.931550 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m18:36:38.944032 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m18:36:38.941797 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m18:36:38.944608 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m18:36:38.942573 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9, now test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155)
[0m18:36:38.951588 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m18:36:38.940637 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m18:36:38.958022 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m18:36:38.951187 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m18:36:38.959482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_track_name.c6334add30, now test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9)
[0m18:36:38.959861 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m18:36:38.959093 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m18:36:38.958648 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m18:36:38.965724 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m18:36:38.966265 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4, now test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87)
[0m18:36:38.963568 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m18:36:38.957390 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m18:36:38.964271 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m18:36:38.971542 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m18:36:38.970241 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m18:36:38.972699 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m18:36:38.973106 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m18:36:38.966657 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m18:36:38.972043 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m18:36:38.980591 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf, now test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282)
[0m18:36:38.980985 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m18:36:38.973469 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155, now test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f)
[0m18:36:38.985576 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m18:36:38.974924 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m18:36:38.990443 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m18:36:38.980084 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m18:36:38.992339 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m18:36:38.985174 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m18:36:38.993578 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m18:36:38.994168 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m18:36:38.992970 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m18:36:38.994983 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m18:36:38.995333 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87, now test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003)
[0m18:36:38.990833 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m18:36:38.996849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9, now test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac)
[0m18:36:38.997217 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m18:36:38.989778 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m18:36:39.003406 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m18:36:38.994578 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m18:36:39.004499 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282, now test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b)
[0m18:36:39.004857 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m18:36:38.995657 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m18:36:39.004060 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m18:36:39.015717 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m18:36:39.016112 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f, now test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c)
[0m18:36:39.016467 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m18:36:39.014863 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m18:36:39.021305 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m18:36:39.009730 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m18:36:39.022485 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m18:36:39.013642 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m18:36:39.023571 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m18:36:39.021948 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m18:36:39.024699 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m18:36:39.025097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac, now test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2)
[0m18:36:39.025424 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m18:36:39.023060 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m18:36:39.020676 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m18:36:39.031141 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m18:36:39.031715 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m18:36:39.032144 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m18:36:39.024261 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m18:36:39.032981 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m18:36:39.030521 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m18:36:39.037194 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b, now test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2)
[0m18:36:39.032483 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c, now test.spotify_analytics.not_null_device_usage_total_plays.90a295df48)
[0m18:36:39.038060 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m18:36:39.029081 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m18:36:39.043692 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m18:36:39.037665 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m18:36:39.033359 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003, now test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e)
[0m18:36:39.044491 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m18:36:39.051979 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m18:36:39.049724 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m18:36:39.053684 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m18:36:39.042904 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m18:36:39.051373 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m18:36:39.054384 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m18:36:39.054978 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m18:36:39.052468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2, now test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14)
[0m18:36:39.062104 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m18:36:39.060467 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m18:36:39.067798 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2, now test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca)
[0m18:36:39.068197 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m18:36:39.059942 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m18:36:39.067323 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m18:36:39.061712 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m18:36:39.075271 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m18:36:39.075790 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_plays.90a295df48, now test.spotify_analytics.not_null_top_artists_rank.d14513fc96)
[0m18:36:39.076597 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m18:36:39.074666 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m18:36:39.080993 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m18:36:39.076265 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m18:36:39.080346 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m18:36:39.084827 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m18:36:39.085399 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m18:36:39.082530 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m18:36:39.086208 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m18:36:39.086580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14, now test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13)
[0m18:36:39.081373 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m18:36:39.087331 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e, now test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c)
[0m18:36:39.088123 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m18:36:39.083881 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m18:36:39.085845 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m18:36:39.093803 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_rank.d14513fc96, now test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11)
[0m18:36:39.094168 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m18:36:39.086979 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m18:36:39.091746 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m18:36:39.102939 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m18:36:39.097870 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m18:36:39.104041 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m18:36:39.092278 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m18:36:39.105225 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m18:36:39.105573 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m18:36:39.105970 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca, now test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461)
[0m18:36:39.106290 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m18:36:39.103530 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m18:36:39.111285 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m18:36:39.111639 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c, now test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31)
[0m18:36:39.112002 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m18:36:39.102417 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m18:36:39.118308 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m18:36:39.104612 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m18:36:39.119415 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m18:36:39.119772 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11, now test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532)
[0m18:36:39.120134 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m18:36:39.118973 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m18:36:39.110872 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m18:36:39.124349 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m18:36:39.127218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13, now test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4)
[0m18:36:39.124959 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m18:36:39.128340 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m18:36:39.126622 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m18:36:39.129391 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m18:36:39.127661 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m18:36:39.128768 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m18:36:39.140115 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461, now test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac)
[0m18:36:39.123750 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m18:36:39.143242 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m18:36:39.130718 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m18:36:39.145124 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m18:36:39.140611 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m18:36:39.143948 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m18:36:39.164694 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m18:36:39.165123 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532, now test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78)
[0m18:36:39.165453 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m18:36:39.157425 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m18:36:39.171263 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m18:36:39.146861 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31, now test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893)
[0m18:36:39.172996 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m18:36:39.164260 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m18:36:39.180215 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m18:36:39.171902 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m18:36:39.184387 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m18:36:39.184749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4, now test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203)
[0m18:36:39.190611 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m18:36:39.180864 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m18:36:39.197180 [debug] [Thread-2 (]: Began running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m18:36:39.183949 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m18:36:39.198164 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m18:36:39.190182 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m18:36:39.199344 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m18:36:39.197605 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac, now test.spotify_analytics.unique_device_usage_device_type.e75362861b)
[0m18:36:39.200338 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m18:36:39.199946 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m18:36:39.198756 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m18:36:39.206691 [debug] [Thread-3 (]: Began running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m18:36:39.209930 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893, now test.spotify_analytics.unique_top_artists_artist_name.008ffa1533)
[0m18:36:39.206084 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m18:36:39.211450 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m18:36:39.207672 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m18:36:39.212782 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m18:36:39.208164 [debug] [Thread-4 (]: Began running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m18:36:39.213958 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78, now test.spotify_analytics.unique_top_artists_rank.68b5480aed)
[0m18:36:39.210440 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m18:36:39.213412 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m18:36:39.212183 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m18:36:39.221294 [debug] [Thread-2 (]: Began running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m18:36:39.214320 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m18:36:39.219758 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m18:36:39.226737 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m18:36:39.221734 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_device_usage_device_type.e75362861b, now test.spotify_analytics.unique_top_tracks_track_id.865b43a659)
[0m18:36:39.227767 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m18:36:39.220264 [debug] [Thread-1 (]: Began running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m18:36:39.226125 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m18:36:39.233348 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m18:36:39.227351 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m18:36:39.232845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203, now test.spotify_analytics.unique_top_tracks_rank.8fecde1136)
[0m18:36:39.234428 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m18:36:39.232341 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m18:36:39.233975 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m18:36:39.241628 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m18:36:39.242348 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m18:36:39.240682 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m18:36:39.243020 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m18:36:39.243572 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m18:36:39.245108 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:36:39.245421 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_track_id.865b43a659' was properly closed.
[0m18:36:39.245704 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_rank.8fecde1136' was properly closed.
[0m18:36:39.246025 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_artists_artist_name.008ffa1533' was properly closed.
[0m18:36:39.246334 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_artists_rank.68b5480aed' was properly closed.
[0m18:36:39.252341 [debug] [MainThread]: Command end result
[0m18:36:39.292347 [debug] [MainThread]: Wrote artifact WritableManifest to dbt/target/manifest.json
[0m18:36:39.295196 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt/target/semantic_manifest.json
[0m18:36:39.304383 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt/target/run_results.json
[0m18:36:39.306635 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 3.6792123, "process_in_blocks": "2048", "process_kernel_time": 0.52878, "process_mem_max_rss": "248068", "process_out_blocks": "3648", "process_user_time": 4.1999}
[0m18:36:39.307180 [debug] [MainThread]: Command `dbt compile` succeeded at 18:36:39.307082 after 3.68 seconds
[0m18:36:39.307841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36f9240bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36f8e24590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36fd6ffbd0>]}
[0m18:36:39.308276 [debug] [MainThread]: Flushing usage events
[0m18:36:39.389883 [debug] [MainThread]: An error was encountered while trying to flush usage events
