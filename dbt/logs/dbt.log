[0m19:15:24.304600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034d7e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104adb9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104adbb10>]}


============================== 19:15:24.306946 | c8bfa40c-617f-4349-9e38-94319b8c0400 ==============================
[0m19:15:24.306946 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:15:24.307192 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'printer_width': '80', 'empty': 'None', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'write_json': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'debug': 'False', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'use_experimental_parser': 'False', 'log_path': 'logs', 'use_colors': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'version_check': 'True'}
[0m19:15:24.314262 [info ] [MainThread]: dbt version: 1.10.15
[0m19:15:24.314437 [info ] [MainThread]: python version: 3.13.2
[0m19:15:24.314556 [info ] [MainThread]: python path: /Users/sunilmakkar/spotify-data-pipeline/venv/bin/python3.13
[0m19:15:24.314661 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit-Mach-O
[0m19:15:24.858287 [info ] [MainThread]: Using profiles dir at /Users/sunilmakkar/.dbt
[0m19:15:24.858506 [info ] [MainThread]: Using profiles.yml file at /Users/sunilmakkar/.dbt/profiles.yml
[0m19:15:24.858626 [info ] [MainThread]: Using dbt_project.yml file at /Users/sunilmakkar/spotify-data-pipeline/dbt/dbt_project.yml
[0m19:15:24.858759 [error] [MainThread]: Encountered an error:
Internal Error
  Profile should not be None if loading profile completed
[0m19:15:24.860115 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.5839615, "process_in_blocks": "0", "process_kernel_time": 0.155711, "process_mem_max_rss": "197836800", "process_out_blocks": "0", "process_user_time": 0.721194}
[0m19:15:24.860392 [debug] [MainThread]: Command `dbt debug` failed at 19:15:24.860353 after 0.58 seconds
[0m19:15:24.860528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b890050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b85c290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b76fce0>]}
[0m19:15:24.860674 [debug] [MainThread]: Flushing usage events
[0m19:15:25.051395 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:16:51.485484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041fbe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057ff9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057ffb10>]}


============================== 19:16:51.487950 | 54ed15d7-859b-4307-8003-b0b37a03bc9d ==============================
[0m19:16:51.487950 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:16:51.488200 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'debug': 'False', 'printer_width': '80', 'warn_error': 'None', 'target_path': 'None', 'no_print': 'None', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'empty': 'None', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs'}
[0m19:16:51.495194 [info ] [MainThread]: dbt version: 1.10.15
[0m19:16:51.495366 [info ] [MainThread]: python version: 3.13.2
[0m19:16:51.495480 [info ] [MainThread]: python path: /Users/sunilmakkar/spotify-data-pipeline/venv/bin/python3.13
[0m19:16:51.495580 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit-Mach-O
[0m19:16:52.045148 [info ] [MainThread]: Using profiles dir at /Users/sunilmakkar/.dbt
[0m19:16:52.045359 [info ] [MainThread]: Using profiles.yml file at /Users/sunilmakkar/.dbt/profiles.yml
[0m19:16:52.045479 [info ] [MainThread]: Using dbt_project.yml file at /Users/sunilmakkar/spotify-data-pipeline/dbt/dbt_project.yml
[0m19:16:52.045796 [info ] [MainThread]: adapter type: snowflake
[0m19:16:52.045905 [info ] [MainThread]: adapter version: 1.8.3
[0m19:16:52.082023 [info ] [MainThread]: Configuration:
[0m19:16:52.082241 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:16:52.082368 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:16:52.082472 [info ] [MainThread]: Required dependencies:
[0m19:16:52.082627 [debug] [MainThread]: Executing "git --help"
[0m19:16:52.097885 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:16:52.098478 [debug] [MainThread]: STDERR: "b''"
[0m19:16:52.098659 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:16:52.098810 [info ] [MainThread]: Connection:
[0m19:16:52.098938 [info ] [MainThread]:   account: uxojbrg-rm52997
[0m19:16:52.099041 [info ] [MainThread]:   user: sunni
[0m19:16:52.099142 [info ] [MainThread]:   database: spotify_data
[0m19:16:52.099237 [info ] [MainThread]:   warehouse: spotify_wh
[0m19:16:52.099342 [info ] [MainThread]:   role: accountadmin
[0m19:16:52.099435 [info ] [MainThread]:   schema: bronze
[0m19:16:52.099530 [info ] [MainThread]:   authenticator: None
[0m19:16:52.099625 [info ] [MainThread]:   oauth_client_id: None
[0m19:16:52.099717 [info ] [MainThread]:   query_tag: None
[0m19:16:52.099811 [info ] [MainThread]:   client_session_keep_alive: False
[0m19:16:52.099905 [info ] [MainThread]:   host: None
[0m19:16:52.099997 [info ] [MainThread]:   port: None
[0m19:16:52.100086 [info ] [MainThread]:   proxy_host: None
[0m19:16:52.100179 [info ] [MainThread]:   proxy_port: None
[0m19:16:52.100271 [info ] [MainThread]:   protocol: None
[0m19:16:52.100365 [info ] [MainThread]:   connect_retries: 1
[0m19:16:52.100456 [info ] [MainThread]:   connect_timeout: None
[0m19:16:52.100545 [info ] [MainThread]:   retry_on_database_errors: False
[0m19:16:52.100640 [info ] [MainThread]:   retry_all: False
[0m19:16:52.100728 [info ] [MainThread]:   insecure_mode: False
[0m19:16:52.100821 [info ] [MainThread]:   reuse_connections: None
[0m19:16:52.101110 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:16:52.146895 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m19:16:52.147396 [debug] [MainThread]: Using snowflake connection "debug"
[0m19:16:52.147520 [debug] [MainThread]: On debug: select 1 as id
[0m19:16:52.147619 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:16:53.482331 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.335 seconds
[0m19:16:53.483944 [debug] [MainThread]: On debug: Close
[0m19:16:53.694543 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:16:53.695296 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:16:53.698740 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.2405813, "process_in_blocks": "0", "process_kernel_time": 0.214003, "process_mem_max_rss": "218054656", "process_out_blocks": "0", "process_user_time": 0.892279}
[0m19:16:53.699323 [debug] [MainThread]: Command `dbt debug` succeeded at 19:16:53.699210 after 2.24 seconds
[0m19:16:53.699635 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:16:53.699931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c69a650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c66ae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c497f00>]}
[0m19:16:53.700299 [debug] [MainThread]: Flushing usage events
[0m19:16:53.882982 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:24:30.797547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11159be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d5f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d5fb10>]}


============================== 19:24:30.800005 | 7324a936-e3a0-458f-9773-b5b3fe09a954 ==============================
[0m19:24:30.800005 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:24:30.800278 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'target_path': 'None', 'warn_error': 'None', 'use_colors': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'debug': 'False', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'empty': 'False', 'no_print': 'None', 'quiet': 'False', 'partial_parse': 'True', 'log_cache_events': 'False'}
[0m19:24:31.389654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7324a936-e3a0-458f-9773-b5b3fe09a954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cb0b00>]}
[0m19:24:31.411368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7324a936-e3a0-458f-9773-b5b3fe09a954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123200e20>]}
[0m19:24:31.411831 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:24:31.460930 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:24:31.461290 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:24:31.461437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7324a936-e3a0-458f-9773-b5b3fe09a954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1231ad450>]}
[0m19:24:31.779850 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.example
[0m19:24:31.784259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7324a936-e3a0-458f-9773-b5b3fe09a954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112afcf50>]}
[0m19:24:31.804534 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m19:24:31.805826 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m19:24:31.814644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7324a936-e3a0-458f-9773-b5b3fe09a954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12650fbd0>]}
[0m19:24:31.814843 [info ] [MainThread]: Found 1 source, 489 macros
[0m19:24:31.814977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7324a936-e3a0-458f-9773-b5b3fe09a954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126218460>]}
[0m19:24:31.815825 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:24:31.816042 [debug] [MainThread]: Command end result
[0m19:24:31.824246 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m19:24:31.824883 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m19:24:31.826004 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m19:24:31.827556 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.05947, "process_in_blocks": "0", "process_kernel_time": 0.186255, "process_mem_max_rss": "210190336", "process_out_blocks": "0", "process_user_time": 1.133971}
[0m19:24:31.827742 [debug] [MainThread]: Command `dbt compile` succeeded at 19:24:31.827707 after 1.06 seconds
[0m19:24:31.827885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c55250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1265c76a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1265c7540>]}
[0m19:24:31.828011 [debug] [MainThread]: Flushing usage events
[0m19:24:32.164998 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:26:25.757869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10552fe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b33b10>]}


============================== 19:26:25.760286 | 5ad721d0-7a88-47f9-b428-ee4780feabf4 ==============================
[0m19:26:25.760286 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:26:25.760555 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt compile', 'no_print': 'None', 'write_json': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'quiet': 'False', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'indirect_selection': 'eager', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'version_check': 'True', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'printer_width': '80', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None'}
[0m19:26:26.340586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ad721d0-7a88-47f9-b428-ee4780feabf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e84b00>]}
[0m19:26:26.363538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ad721d0-7a88-47f9-b428-ee4780feabf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d828e20>]}
[0m19:26:26.364116 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:26:26.413640 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:26:26.439435 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:26:26.439679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5ad721d0-7a88-47f9-b428-ee4780feabf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d755650>]}
[0m19:26:26.759603 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.spotify_analytics.gold
- models.spotify_analytics.silver
- models.spotify_analytics.bronze
[0m19:26:26.763988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ad721d0-7a88-47f9-b428-ee4780feabf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d72af30>]}
[0m19:26:26.784234 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m19:26:26.785292 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m19:26:26.793896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ad721d0-7a88-47f9-b428-ee4780feabf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddbaa50>]}
[0m19:26:26.794078 [info ] [MainThread]: Found 1 source, 489 macros
[0m19:26:26.794207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ad721d0-7a88-47f9-b428-ee4780feabf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbff6c0>]}
[0m19:26:26.795029 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:26:26.795243 [debug] [MainThread]: Command end result
[0m19:26:26.803094 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m19:26:26.803782 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m19:26:26.804894 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m19:26:26.806204 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.076758, "process_in_blocks": "0", "process_kernel_time": 0.186535, "process_mem_max_rss": "209436672", "process_out_blocks": "0", "process_user_time": 1.16657}
[0m19:26:26.806394 [debug] [MainThread]: Command `dbt compile` succeeded at 19:26:26.806357 after 1.08 seconds
[0m19:26:26.806550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a29190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de0a200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de0a0a0>]}
[0m19:26:26.806689 [debug] [MainThread]: Flushing usage events
[0m19:26:27.134323 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:27:34.636782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bc7e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051bf9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051bfb10>]}


============================== 19:27:34.639186 | f5144faa-6fc9-43df-a1b3-752b7beadd16 ==============================
[0m19:27:34.639186 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:27:34.639442 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'printer_width': '80', 'invocation_command': 'dbt ls --resource-type source', 'fail_fast': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'target_path': 'None', 'no_print': 'None', 'version_check': 'True', 'write_json': 'True', 'empty': 'None', 'log_format': 'default', 'profiles_dir': '/Users/sunilmakkar/.dbt'}
[0m19:27:35.188529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5144faa-6fc9-43df-a1b3-752b7beadd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104510b00>]}
[0m19:27:35.210585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5144faa-6fc9-43df-a1b3-752b7beadd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be1cf30>]}
[0m19:27:35.211068 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:27:35.260714 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:27:35.296261 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:27:35.296423 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:27:35.296669 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.spotify_analytics.gold
- models.spotify_analytics.silver
- models.spotify_analytics.bronze
[0m19:27:35.302525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5144faa-6fc9-43df-a1b3-752b7beadd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bde1f50>]}
[0m19:27:35.324708 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m19:27:35.325693 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m19:27:35.333379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5144faa-6fc9-43df-a1b3-752b7beadd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdb6c60>]}
[0m19:27:35.333569 [info ] [MainThread]: Found 1 source, 489 macros
[0m19:27:35.333697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5144faa-6fc9-43df-a1b3-752b7beadd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0a3e70>]}
[0m19:27:35.334251 [info ] [MainThread]: source:spotify_analytics.bronze.plays
[0m19:27:35.335746 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.72563094, "process_in_blocks": "0", "process_kernel_time": 0.182889, "process_mem_max_rss": "205586432", "process_out_blocks": "0", "process_user_time": 0.879532}
[0m19:27:35.337354 [debug] [MainThread]: Command `dbt ls` succeeded at 19:27:35.335971 after 0.73 seconds
[0m19:27:35.337589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c37bd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050b5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c34b050>]}
[0m19:27:35.337710 [debug] [MainThread]: Flushing usage events
[0m19:27:35.626456 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:00:25.989163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aa7e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070ab9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070abb10>]}


============================== 15:00:25.991855 | 60e0ffc5-1b1f-4ac7-9933-e6d2947418a8 ==============================
[0m15:00:25.991855 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:00:25.992141 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'no_print': 'None', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'use_colors': 'True', 'partial_parse': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'empty': 'False', 'write_json': 'True', 'printer_width': '80', 'version_check': 'True', 'invocation_command': 'dbt compile --models silver_plays'}
[0m15:00:25.992356 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m15:00:25.992501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '60e0ffc5-1b1f-4ac7-9933-e6d2947418a8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070fd0f0>]}
[0m15:00:26.768123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60e0ffc5-1b1f-4ac7-9933-e6d2947418a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd9ce20>]}
[0m15:00:26.789456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60e0ffc5-1b1f-4ac7-9933-e6d2947418a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dccd050>]}
[0m15:00:26.789934 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:00:26.840006 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:00:26.877751 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:00:26.877983 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/silver/silver_plays.sql
[0m15:00:26.969145 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.spotify_analytics.gold
- models.spotify_analytics.bronze
[0m15:00:26.974705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60e0ffc5-1b1f-4ac7-9933-e6d2947418a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1467b0>]}
[0m15:00:27.002913 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m15:00:27.004288 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m15:00:27.012863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60e0ffc5-1b1f-4ac7-9933-e6d2947418a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10defe970>]}
[0m15:00:27.013046 [info ] [MainThread]: Found 1 model, 1 source, 489 macros
[0m15:00:27.013173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60e0ffc5-1b1f-4ac7-9933-e6d2947418a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e487ad0>]}
[0m15:00:27.013802 [info ] [MainThread]: 
[0m15:00:27.013942 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:00:27.014044 [info ] [MainThread]: 
[0m15:00:27.014234 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:00:27.014794 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_bronze'
[0m15:00:27.020459 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_bronze"
[0m15:00:27.020593 [debug] [ThreadPool]: On list_spotify_data_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_bronze"} */
show objects in spotify_data.bronze limit 10000
[0m15:00:27.020699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:28.648496 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.628 seconds
[0m15:00:28.651780 [debug] [ThreadPool]: On list_spotify_data_bronze: Close
[0m15:00:28.893079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60e0ffc5-1b1f-4ac7-9933-e6d2947418a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e461790>]}
[0m15:00:28.899990 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m15:00:28.900572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_bronze, now model.spotify_analytics.silver_plays)
[0m15:00:28.900957 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m15:00:28.909876 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m15:00:28.911001 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m15:00:28.911643 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m15:00:28.912544 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:00:28.912852 [debug] [MainThread]: Connection 'model.spotify_analytics.silver_plays' was properly closed.
[0m15:00:28.913401 [debug] [MainThread]: Command end result
[0m15:00:28.934736 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m15:00:28.936442 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m15:00:28.939923 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m15:00:28.940157 [info ] [MainThread]: Compiled node 'silver_plays' is:


-- ============================================================================
-- SILVER LAYER: CLEANED PLAYS DATA
-- ============================================================================
-- Purpose: Transform bronze plays data into clean, analytics-ready format
-- 
-- Transformations:
--   1. Deduplicate records (DISTINCT on event_id)
--   2. Cast all data types from VARIANT to proper types
--   3. Filter invalid records (defensive WHERE clauses)
--   4. Add processing metadata (processed_at timestamp)
--
-- Source: bronze.plays (external table reading from S3 Parquet files)
-- Target: SILVER.silver_plays (materialized table)
-- ============================================================================

WITH source_data AS (
    SELECT 
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM spotify_data.bronze.plays
),

deduplicated AS (
    SELECT DISTINCT
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM source_data
    WHERE 
        -- Data quality filters
        user_id IS NOT NULL
        AND duration_ms > 0
        AND duration_ms < 600000  -- Less than 10 minutes (catches data errors)
        AND event_id IS NOT NULL
)

SELECT 
    -- Identifiers
    event_id::VARCHAR AS event_id,
    user_id::VARCHAR AS user_id,
    event_type::VARCHAR AS event_type,
    
    -- Track information
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    duration_ms::NUMBER AS duration_ms,
    
    -- Timestamps
    TRY_CAST(played_at AS TIMESTAMP) AS played_at,
    
    -- Device context
    device_type::VARCHAR AS device_type,
    
    -- Metadata
    CURRENT_TIMESTAMP() AS processed_at
    
FROM deduplicated
[0m15:00:28.940625 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:00:28.946024 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.9871368, "process_in_blocks": "0", "process_kernel_time": 0.264011, "process_mem_max_rss": "231686144", "process_out_blocks": "0", "process_user_time": 1.135719}
[0m15:00:28.946360 [debug] [MainThread]: Command `dbt compile` succeeded at 15:00:28.946305 after 2.99 seconds
[0m15:00:28.946577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e582a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e42f1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e42d950>]}
[0m15:00:28.946775 [debug] [MainThread]: Flushing usage events
[0m15:00:29.276339 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:09:19.119013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d6be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10936f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10936fb10>]}


============================== 15:09:19.121590 | d1467bee-cc46-4e88-9ffd-6374f351f3be ==============================
[0m15:09:19.121590 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:09:19.121864 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --model silver_plays', 'empty': 'False', 'debug': 'False', 'write_json': 'True', 'introspect': 'True', 'version_check': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'printer_width': '80', 'use_colors': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'quiet': 'False', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs'}
[0m15:09:19.122070 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m15:09:19.122215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd1467bee-cc46-4e88-9ffd-6374f351f3be', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093c10f0>]}
[0m15:09:19.707366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1467bee-cc46-4e88-9ffd-6374f351f3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110060e20>]}
[0m15:09:19.729476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1467bee-cc46-4e88-9ffd-6374f351f3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff91050>]}
[0m15:09:19.730055 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:09:19.780417 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:09:19.829342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:09:19.829574 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:09:19.831724 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.spotify_analytics.gold
- models.spotify_analytics.bronze
[0m15:09:19.843434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1467bee-cc46-4e88-9ffd-6374f351f3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110409a90>]}
[0m15:09:19.873385 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m15:09:19.874823 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m15:09:19.886327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1467bee-cc46-4e88-9ffd-6374f351f3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110634bb0>]}
[0m15:09:19.886581 [info ] [MainThread]: Found 1 model, 1 source, 489 macros
[0m15:09:19.886720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1467bee-cc46-4e88-9ffd-6374f351f3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105e0a10>]}
[0m15:09:19.887368 [info ] [MainThread]: 
[0m15:09:19.887507 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:09:19.887616 [info ] [MainThread]: 
[0m15:09:19.887826 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:09:19.888194 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m15:09:19.893917 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m15:09:19.894071 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m15:09:19.894191 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:21.353852 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.459 seconds
[0m15:09:21.356578 [debug] [ThreadPool]: On list_spotify_data: Close
[0m15:09:21.624349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_bronze)
[0m15:09:21.634058 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_bronze"
[0m15:09:21.634463 [debug] [ThreadPool]: On list_spotify_data_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_bronze"} */
show objects in spotify_data.bronze limit 10000
[0m15:09:21.634717 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:22.533348 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.899 seconds
[0m15:09:22.534692 [debug] [ThreadPool]: On list_spotify_data_bronze: Close
[0m15:09:22.713754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1467bee-cc46-4e88-9ffd-6374f351f3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105cd3d0>]}
[0m15:09:22.718428 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m15:09:22.719127 [info ] [Thread-1 (]: 1 of 1 START sql table model bronze.silver_plays ............................... [RUN]
[0m15:09:22.719675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_bronze, now model.spotify_analytics.silver_plays)
[0m15:09:22.720079 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m15:09:22.730418 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m15:09:22.731525 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m15:09:22.752486 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.silver_plays"
[0m15:09:22.753906 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.silver_plays"
[0m15:09:22.754191 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.silver_plays"} */
create or replace transient table spotify_data.bronze.silver_plays
         as
        (

-- ============================================================================
-- SILVER LAYER: CLEANED PLAYS DATA
-- ============================================================================
-- Purpose: Transform bronze plays data into clean, analytics-ready format
-- 
-- Transformations:
--   1. Deduplicate records (DISTINCT on event_id)
--   2. Cast all data types from VARIANT to proper types
--   3. Filter invalid records (defensive WHERE clauses)
--   4. Add processing metadata (processed_at timestamp)
--
-- Source: bronze.plays (external table reading from S3 Parquet files)
-- Target: SILVER.silver_plays (materialized table)
-- ============================================================================

WITH source_data AS (
    SELECT 
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM spotify_data.bronze.plays
),

deduplicated AS (
    SELECT DISTINCT
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM source_data
    WHERE 
        -- Data quality filters
        user_id IS NOT NULL
        AND duration_ms > 0
        AND duration_ms < 600000  -- Less than 10 minutes (catches data errors)
        AND event_id IS NOT NULL
)

SELECT 
    -- Identifiers
    event_id::VARCHAR AS event_id,
    user_id::VARCHAR AS user_id,
    event_type::VARCHAR AS event_type,
    
    -- Track information
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    duration_ms::NUMBER AS duration_ms,
    
    -- Timestamps
    TRY_CAST(played_at AS TIMESTAMP) AS played_at,
    
    -- Device context
    device_type::VARCHAR AS device_type,
    
    -- Metadata
    CURRENT_TIMESTAMP() AS processed_at
    
FROM deduplicated
        );
[0m15:09:22.754450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:23.909998 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c0a21d-0003-f808-0000-000a68a2e1f9
[0m15:09:23.910664 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 22 at position 8
invalid identifier 'EVENT_ID'
[0m15:09:23.911289 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: Close
[0m15:09:24.076487 [debug] [Thread-1 (]: Database Error in model silver_plays (models/silver/silver_plays.sql)
  000904 (42000): SQL compilation error: error line 22 at position 8
  invalid identifier 'EVENT_ID'
  compiled code at target/run/spotify_analytics/models/silver/silver_plays.sql
[0m15:09:24.078877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1467bee-cc46-4e88-9ffd-6374f351f3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111182d00>]}
[0m15:09:24.079712 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bronze.silver_plays ...................... [[31mERROR[0m in 1.36s]
[0m15:09:24.080306 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m15:09:24.080823 [debug] [Thread-7 (]: Marking all children of 'model.spotify_analytics.silver_plays' to be skipped because of status 'error'.  Reason: Database Error in model silver_plays (models/silver/silver_plays.sql)
  000904 (42000): SQL compilation error: error line 22 at position 8
  invalid identifier 'EVENT_ID'
  compiled code at target/run/spotify_analytics/models/silver/silver_plays.sql.
[0m15:09:24.082947 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:09:24.083402 [debug] [MainThread]: Connection 'model.spotify_analytics.silver_plays' was properly closed.
[0m15:09:24.083733 [info ] [MainThread]: 
[0m15:09:24.084065 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.20 seconds (4.20s).
[0m15:09:24.084653 [debug] [MainThread]: Command end result
[0m15:09:24.101763 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m15:09:24.102863 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m15:09:24.106335 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m15:09:24.106526 [info ] [MainThread]: 
[0m15:09:24.106737 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:09:24.106906 [info ] [MainThread]: 
[0m15:09:24.107122 [error] [MainThread]: [31mFailure in model silver_plays (models/silver/silver_plays.sql)[0m
[0m15:09:24.107325 [error] [MainThread]:   Database Error in model silver_plays (models/silver/silver_plays.sql)
  000904 (42000): SQL compilation error: error line 22 at position 8
  invalid identifier 'EVENT_ID'
  compiled code at target/run/spotify_analytics/models/silver/silver_plays.sql
[0m15:09:24.107472 [info ] [MainThread]: 
[0m15:09:24.107649 [info ] [MainThread]:   compiled code at target/compiled/spotify_analytics/models/silver/silver_plays.sql
[0m15:09:24.107791 [info ] [MainThread]: 
[0m15:09:24.107949 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:09:24.108216 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:09:24.109933 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.0195, "process_in_blocks": "0", "process_kernel_time": 0.244531, "process_mem_max_rss": "232112128", "process_out_blocks": "0", "process_user_time": 1.298116}
[0m15:09:24.110236 [debug] [MainThread]: Command `dbt run` failed at 15:09:24.110179 after 5.02 seconds
[0m15:09:24.110459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111cf110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111a9eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106601d0>]}
[0m15:09:24.110658 [debug] [MainThread]: Flushing usage events
[0m15:09:24.453471 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:10:17.367095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10732be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a5f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a5fb10>]}


============================== 15:10:17.369500 | dd79577e-8ec9-4bc9-886a-59c3dfa6c62f ==============================
[0m15:10:17.369500 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:10:17.369748 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'cache_selected_only': 'False', 'empty': 'False', 'printer_width': '80', 'introspect': 'True', 'log_format': 'default', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'quiet': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'warn_error': 'None', 'debug': 'False', 'invocation_command': 'dbt run --model silver_plays', 'no_print': 'None'}
[0m15:10:17.369955 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m15:10:17.370102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dd79577e-8ec9-4bc9-886a-59c3dfa6c62f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ab10f0>]}
[0m15:10:17.948629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd79577e-8ec9-4bc9-886a-59c3dfa6c62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121500e20>]}
[0m15:10:17.970248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd79577e-8ec9-4bc9-886a-59c3dfa6c62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1214ad050>]}
[0m15:10:17.970748 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:10:18.020446 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:10:18.066068 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:10:18.066321 [debug] [MainThread]: Partial parsing: updated file: spotify_analytics://models/silver/silver_plays.sql
[0m15:10:18.149906 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.spotify_analytics.gold
- models.spotify_analytics.bronze
[0m15:10:18.155379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd79577e-8ec9-4bc9-886a-59c3dfa6c62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1218af980>]}
[0m15:10:18.183282 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m15:10:18.184370 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m15:10:18.194216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd79577e-8ec9-4bc9-886a-59c3dfa6c62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219f6970>]}
[0m15:10:18.194415 [info ] [MainThread]: Found 1 model, 1 source, 489 macros
[0m15:10:18.194547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd79577e-8ec9-4bc9-886a-59c3dfa6c62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121b86820>]}
[0m15:10:18.195138 [info ] [MainThread]: 
[0m15:10:18.195269 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:10:18.195372 [info ] [MainThread]: 
[0m15:10:18.195567 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:10:18.195889 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m15:10:18.200602 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m15:10:18.200721 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m15:10:18.200852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:19.326182 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.125 seconds
[0m15:10:19.330039 [debug] [ThreadPool]: On list_spotify_data: Close
[0m15:10:19.485682 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_bronze)
[0m15:10:19.496210 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_bronze"
[0m15:10:19.496599 [debug] [ThreadPool]: On list_spotify_data_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_bronze"} */
show objects in spotify_data.bronze limit 10000
[0m15:10:19.496853 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:10:20.209969 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.713 seconds
[0m15:10:20.214065 [debug] [ThreadPool]: On list_spotify_data_bronze: Close
[0m15:10:20.411208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd79577e-8ec9-4bc9-886a-59c3dfa6c62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121bc34d0>]}
[0m15:10:20.415470 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m15:10:20.416206 [info ] [Thread-1 (]: 1 of 1 START sql table model bronze.silver_plays ............................... [RUN]
[0m15:10:20.416715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_bronze, now model.spotify_analytics.silver_plays)
[0m15:10:20.417084 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m15:10:20.425003 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m15:10:20.425929 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m15:10:20.445781 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.silver_plays"
[0m15:10:20.446970 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.silver_plays"
[0m15:10:20.447244 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.silver_plays"} */
create or replace transient table spotify_data.bronze.silver_plays
         as
        (

-- ============================================================================
-- SILVER LAYER: CLEANED PLAYS DATA
-- ============================================================================
-- Purpose: Transform bronze plays data into clean, analytics-ready format
-- 
-- Transformations:
--   1. Deduplicate records (DISTINCT on event_id)
--   2. Cast all data types from VARIANT to proper types
--   3. Filter invalid records (defensive WHERE clauses)
--   4. Add processing metadata (processed_at timestamp)
--
-- Source: bronze.plays (external table reading from S3 Parquet files)
-- Target: SILVER.silver_plays (materialized table)
-- ============================================================================

WITH source_data AS (
    SELECT 
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM spotify_data.bronze.plays
),

deduplicated AS (
    SELECT DISTINCT
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM source_data
    WHERE 
        -- Data quality filters
        user_id IS NOT NULL
        AND duration_ms > 0
        AND duration_ms < 600000  -- Less than 10 minutes (catches data errors)
        AND event_id IS NOT NULL
)

SELECT 
    -- Identifiers
    event_id::VARCHAR AS event_id,
    user_id::VARCHAR AS user_id,
    event_type::VARCHAR AS event_type,
    
    -- Track information
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    duration_ms::NUMBER AS duration_ms,
    
    -- Timestamps
    TRY_CAST(played_at AS TIMESTAMP) AS played_at,
    
    -- Device context
    device_type::VARCHAR AS device_type,
    
    -- Metadata
    CURRENT_TIMESTAMP() AS processed_at
    
FROM deduplicated;
[0m15:10:20.447500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:21.305752 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c0a21e-0003-f25b-0000-000a68a24a0d
[0m15:10:21.306324 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 80 at position 17 unexpected ';'.
[0m15:10:21.306805 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: Close
[0m15:10:21.509742 [debug] [Thread-1 (]: Database Error in model silver_plays (models/silver/silver_plays.sql)
  001003 (42000): SQL compilation error:
  syntax error line 80 at position 17 unexpected ';'.
  compiled code at target/run/spotify_analytics/models/silver/silver_plays.sql
[0m15:10:21.512369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd79577e-8ec9-4bc9-886a-59c3dfa6c62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12465b750>]}
[0m15:10:21.513333 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bronze.silver_plays ...................... [[31mERROR[0m in 1.09s]
[0m15:10:21.513937 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m15:10:21.514509 [debug] [Thread-7 (]: Marking all children of 'model.spotify_analytics.silver_plays' to be skipped because of status 'error'.  Reason: Database Error in model silver_plays (models/silver/silver_plays.sql)
  001003 (42000): SQL compilation error:
  syntax error line 80 at position 17 unexpected ';'.
  compiled code at target/run/spotify_analytics/models/silver/silver_plays.sql.
[0m15:10:21.516622 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:10:21.516964 [debug] [MainThread]: Connection 'model.spotify_analytics.silver_plays' was properly closed.
[0m15:10:21.517258 [info ] [MainThread]: 
[0m15:10:21.517578 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.32 seconds (3.32s).
[0m15:10:21.518252 [debug] [MainThread]: Command end result
[0m15:10:21.535231 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m15:10:21.536698 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m15:10:21.540514 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m15:10:21.540713 [info ] [MainThread]: 
[0m15:10:21.540932 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:10:21.541106 [info ] [MainThread]: 
[0m15:10:21.541322 [error] [MainThread]: [31mFailure in model silver_plays (models/silver/silver_plays.sql)[0m
[0m15:10:21.541526 [error] [MainThread]:   Database Error in model silver_plays (models/silver/silver_plays.sql)
  001003 (42000): SQL compilation error:
  syntax error line 80 at position 17 unexpected ';'.
  compiled code at target/run/spotify_analytics/models/silver/silver_plays.sql
[0m15:10:21.541678 [info ] [MainThread]: 
[0m15:10:21.541856 [info ] [MainThread]:   compiled code at target/compiled/spotify_analytics/models/silver/silver_plays.sql
[0m15:10:21.542007 [info ] [MainThread]: 
[0m15:10:21.542176 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:10:21.542465 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:10:21.544134 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.204743, "process_in_blocks": "0", "process_kernel_time": 0.244269, "process_mem_max_rss": "229720064", "process_out_blocks": "0", "process_user_time": 1.371367}
[0m15:10:21.544398 [debug] [MainThread]: Command `dbt run` failed at 15:10:21.544349 after 4.21 seconds
[0m15:10:21.544600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124611a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12469b530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121a66ed0>]}
[0m15:10:21.544787 [debug] [MainThread]: Flushing usage events
[0m15:10:21.775944 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:14:35.809204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11953be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ac5f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ac5fb10>]}


============================== 15:14:35.811568 | 328dfda1-d7fb-4b30-baf1-bc3229ae8d4c ==============================
[0m15:14:35.811568 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:14:35.811809 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --model silver_plays', 'warn_error': 'None', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'introspect': 'True', 'printer_width': '80', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'log_format': 'default', 'no_print': 'None', 'empty': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'write_json': 'True', 'target_path': 'None', 'version_check': 'True'}
[0m15:14:35.811997 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m15:14:35.812138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '328dfda1-d7fb-4b30-baf1-bc3229ae8d4c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11acb10f0>]}
[0m15:14:36.390988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '328dfda1-d7fb-4b30-baf1-bc3229ae8d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bd00e20>]}
[0m15:14:36.412072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '328dfda1-d7fb-4b30-baf1-bc3229ae8d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bcad050>]}
[0m15:14:36.412529 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:14:36.461564 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:14:36.507119 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:14:36.507371 [debug] [MainThread]: Partial parsing: updated file: spotify_analytics://models/silver/silver_plays.sql
[0m15:14:36.594606 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.spotify_analytics.bronze
- models.spotify_analytics.gold
[0m15:14:36.600215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '328dfda1-d7fb-4b30-baf1-bc3229ae8d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c2af980>]}
[0m15:14:36.628295 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m15:14:36.629405 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m15:14:36.638845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '328dfda1-d7fb-4b30-baf1-bc3229ae8d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c3fa970>]}
[0m15:14:36.639030 [info ] [MainThread]: Found 1 model, 1 source, 489 macros
[0m15:14:36.639155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '328dfda1-d7fb-4b30-baf1-bc3229ae8d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c586820>]}
[0m15:14:36.639747 [info ] [MainThread]: 
[0m15:14:36.639876 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:14:36.639983 [info ] [MainThread]: 
[0m15:14:36.640176 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:14:36.640493 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m15:14:36.645282 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m15:14:36.645427 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m15:14:36.645540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:38.082919 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.437 seconds
[0m15:14:38.086644 [debug] [ThreadPool]: On list_spotify_data: Close
[0m15:14:38.289404 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_bronze)
[0m15:14:38.301487 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_bronze"
[0m15:14:38.302010 [debug] [ThreadPool]: On list_spotify_data_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_bronze"} */
show objects in spotify_data.bronze limit 10000
[0m15:14:38.302312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:39.457507 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.155 seconds
[0m15:14:39.461009 [debug] [ThreadPool]: On list_spotify_data_bronze: Close
[0m15:14:39.658761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '328dfda1-d7fb-4b30-baf1-bc3229ae8d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c5c3290>]}
[0m15:14:39.666424 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m15:14:39.667399 [info ] [Thread-1 (]: 1 of 1 START sql table model bronze.silver_plays ............................... [RUN]
[0m15:14:39.668098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_bronze, now model.spotify_analytics.silver_plays)
[0m15:14:39.668530 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m15:14:39.677557 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m15:14:39.679027 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m15:14:39.699272 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.silver_plays"
[0m15:14:39.700593 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.silver_plays"
[0m15:14:39.700915 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.silver_plays"} */
create or replace transient table spotify_data.bronze.silver_plays
         as
        (

-- ============================================================================
-- SILVER LAYER: CLEANED PLAYS DATA
-- ============================================================================
-- Purpose: Transform bronze plays data into clean, analytics-ready format
-- 
-- Transformations:
--   1. Deduplicate records (DISTINCT on event_id)
--   2. Cast all data types from VARIANT to proper types
--   3. Filter invalid records (defensive WHERE clauses)
--   4. Add processing metadata (processed_at timestamp)
--
-- Source: bronze.plays (external table reading from S3 Parquet files)
-- Target: SILVER.silver_plays (materialized table)
-- ============================================================================

WITH source_data AS (
    SELECT 
        VALUE:event_id::VARCHAR AS event_id,
        VALUE:user_id::VARCHAR AS user_id,
        VALUE:event_type::VARCHAR AS event_type,
        VALUE:track_id::VARCHAR AS track_id,
        VALUE:track_name::VARCHAR AS track_name,
        VALUE:artist_name::VARCHAR AS artist_name,
        VALUE:album_name::VARCHAR AS album_name,
        VALUE:duration_ms::NUMBER AS duration_ms,
        VALUE:played_at::VARCHAR AS played_at,
        VALUE:device_type::VARCHAR AS device_type
    FROM spotify_data.bronze.plays
),

deduplicated AS (
    SELECT DISTINCT
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM source_data
    WHERE 
        -- Data quality filters
        user_id IS NOT NULL
        AND duration_ms > 0
        AND duration_ms < 600000  -- Less than 10 minutes (catches data errors)
        AND event_id IS NOT NULL
)

SELECT 
    -- Identifiers
    event_id::VARCHAR AS event_id,
    user_id::VARCHAR AS user_id,
    event_type::VARCHAR AS event_type,
    
    -- Track information
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    duration_ms::NUMBER AS duration_ms,
    
    -- Timestamps
    TRY_CAST(played_at AS TIMESTAMP) AS played_at,
    
    -- Device context
    device_type::VARCHAR AS device_type,
    
    -- Metadata
    CURRENT_TIMESTAMP() AS processed_at
    
FROM deduplicated
        );
[0m15:14:39.701178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:41.871474 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.170 seconds
[0m15:14:41.897488 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: Close
[0m15:14:42.087947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '328dfda1-d7fb-4b30-baf1-bc3229ae8d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13685b750>]}
[0m15:14:42.089111 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bronze.silver_plays .......................... [[32mSUCCESS 1[0m in 2.42s]
[0m15:14:42.089805 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m15:14:42.091522 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:42.091854 [debug] [MainThread]: Connection 'model.spotify_analytics.silver_plays' was properly closed.
[0m15:14:42.092181 [info ] [MainThread]: 
[0m15:14:42.092539 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.45 seconds (5.45s).
[0m15:14:42.093235 [debug] [MainThread]: Command end result
[0m15:14:42.114556 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m15:14:42.115805 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m15:14:42.119777 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m15:14:42.119968 [info ] [MainThread]: 
[0m15:14:42.120187 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:14:42.120347 [info ] [MainThread]: 
[0m15:14:42.120529 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:14:42.120822 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:14:42.122585 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.341585, "process_in_blocks": "0", "process_kernel_time": 0.245109, "process_mem_max_rss": "235831296", "process_out_blocks": "0", "process_user_time": 1.354246}
[0m15:14:42.122856 [debug] [MainThread]: Command `dbt run` succeeded at 15:14:42.122805 after 6.34 seconds
[0m15:14:42.123066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136811b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13689acc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c466ed0>]}
[0m15:14:42.123260 [debug] [MainThread]: Flushing usage events
[0m15:14:42.610233 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:27:06.761750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12062be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123d5f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123d5fb10>]}


============================== 15:27:06.764338 | 7aaded93-23e5-4f60-9f11-d02097ad310f ==============================
[0m15:27:06.764338 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:27:06.764599 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'write_json': 'True', 'log_format': 'default', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select silver_plays --full-refresh', 'debug': 'False', 'cache_selected_only': 'False', 'quiet': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'printer_width': '80', 'partial_parse': 'True', 'use_colors': 'True', 'empty': 'False'}
[0m15:27:07.626664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7aaded93-23e5-4f60-9f11-d02097ad310f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1211b0b00>]}
[0m15:27:07.652692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7aaded93-23e5-4f60-9f11-d02097ad310f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134904e20>]}
[0m15:27:07.653243 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:27:07.711239 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:27:07.744273 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:27:07.744515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7aaded93-23e5-4f60-9f11-d02097ad310f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1348ae350>]}
[0m15:27:08.147132 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.spotify_analytics.bronze
- models.spotify_analytics.gold
[0m15:27:08.152401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7aaded93-23e5-4f60-9f11-d02097ad310f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134882f30>]}
[0m15:27:08.179593 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m15:27:08.180791 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m15:27:08.191590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7aaded93-23e5-4f60-9f11-d02097ad310f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13baa5710>]}
[0m15:27:08.191807 [info ] [MainThread]: Found 1 model, 1 source, 489 macros
[0m15:27:08.191940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7aaded93-23e5-4f60-9f11-d02097ad310f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b84bad0>]}
[0m15:27:08.192542 [info ] [MainThread]: 
[0m15:27:08.192678 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:27:08.192781 [info ] [MainThread]: 
[0m15:27:08.192987 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:27:08.193347 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m15:27:08.198979 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m15:27:08.199162 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m15:27:08.199272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:27:10.168761 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.969 seconds
[0m15:27:10.171452 [debug] [ThreadPool]: On list_spotify_data: Close
[0m15:27:10.420362 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now create_spotify_data_bronze_silver)
[0m15:27:10.420899 [debug] [ThreadPool]: Creating schema "database: "spotify_data"
schema: "bronze_silver"
"
[0m15:27:10.426819 [debug] [ThreadPool]: Using snowflake connection "create_spotify_data_bronze_silver"
[0m15:27:10.427218 [debug] [ThreadPool]: On create_spotify_data_bronze_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "create_spotify_data_bronze_silver"} */
create schema if not exists spotify_data.bronze_silver
[0m15:27:10.427451 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:27:11.406118 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.978 seconds
[0m15:27:11.408164 [debug] [ThreadPool]: On create_spotify_data_bronze_silver: Close
[0m15:27:11.746885 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_spotify_data_bronze_silver, now list_spotify_data_bronze_silver)
[0m15:27:11.757563 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_bronze_silver"
[0m15:27:11.758071 [debug] [ThreadPool]: On list_spotify_data_bronze_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_bronze_silver"} */
show objects in spotify_data.bronze_silver limit 10000
[0m15:27:11.758338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:27:12.971266 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.213 seconds
[0m15:27:12.974198 [debug] [ThreadPool]: On list_spotify_data_bronze_silver: Close
[0m15:27:13.175965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7aaded93-23e5-4f60-9f11-d02097ad310f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13babe090>]}
[0m15:27:13.181013 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m15:27:13.181775 [info ] [Thread-1 (]: 1 of 1 START sql table model bronze_silver.silver_plays ........................ [RUN]
[0m15:27:13.182290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_bronze_silver, now model.spotify_analytics.silver_plays)
[0m15:27:13.182701 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m15:27:13.191298 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m15:27:13.192162 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m15:27:13.212768 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.silver_plays"
[0m15:27:13.214444 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.silver_plays"
[0m15:27:13.214754 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.silver_plays"} */
create or replace transient table spotify_data.bronze_silver.silver_plays
         as
        (

-- ============================================================================
-- SILVER LAYER: CLEANED PLAYS DATA
-- ============================================================================
-- Purpose: Transform bronze plays data into clean, analytics-ready format
-- 
-- Transformations:
--   1. Deduplicate records (DISTINCT on event_id)
--   2. Cast all data types from VARIANT to proper types
--   3. Filter invalid records (defensive WHERE clauses)
--   4. Add processing metadata (processed_at timestamp)
--
-- Source: bronze.plays (external table reading from S3 Parquet files)
-- Target: SILVER.silver_plays (materialized table)
-- ============================================================================

WITH source_data AS (
    SELECT 
        VALUE:event_id::VARCHAR AS event_id,
        VALUE:user_id::VARCHAR AS user_id,
        VALUE:event_type::VARCHAR AS event_type,
        VALUE:track_id::VARCHAR AS track_id,
        VALUE:track_name::VARCHAR AS track_name,
        VALUE:artist_name::VARCHAR AS artist_name,
        VALUE:album_name::VARCHAR AS album_name,
        VALUE:duration_ms::NUMBER AS duration_ms,
        VALUE:played_at::VARCHAR AS played_at,
        VALUE:device_type::VARCHAR AS device_type
    FROM spotify_data.bronze.plays
),

deduplicated AS (
    SELECT DISTINCT
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM source_data
    WHERE 
        -- Data quality filters
        user_id IS NOT NULL
        AND duration_ms > 0
        AND duration_ms < 600000  -- Less than 10 minutes (catches data errors)
        AND event_id IS NOT NULL
)

SELECT 
    -- Identifiers
    event_id::VARCHAR AS event_id,
    user_id::VARCHAR AS user_id,
    event_type::VARCHAR AS event_type,
    
    -- Track information
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    duration_ms::NUMBER AS duration_ms,
    
    -- Timestamps
    TRY_CAST(played_at AS TIMESTAMP) AS played_at,
    
    -- Device context
    device_type::VARCHAR AS device_type,
    
    -- Metadata
    CURRENT_TIMESTAMP() AS processed_at
    
FROM deduplicated
        );
[0m15:27:13.215018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:18.467946 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.253 seconds
[0m15:27:18.493604 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: Close
[0m15:27:18.640492 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7aaded93-23e5-4f60-9f11-d02097ad310f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c815650>]}
[0m15:27:18.641690 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bronze_silver.silver_plays ................... [[32mSUCCESS 1[0m in 5.46s]
[0m15:27:18.642375 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m15:27:18.644165 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:27:18.644566 [debug] [MainThread]: Connection 'model.spotify_analytics.silver_plays' was properly closed.
[0m15:27:18.644925 [info ] [MainThread]: 
[0m15:27:18.645308 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.45 seconds (10.45s).
[0m15:27:18.646024 [debug] [MainThread]: Command end result
[0m15:27:18.664591 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m15:27:18.665951 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m15:27:18.669855 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m15:27:18.670070 [info ] [MainThread]: 
[0m15:27:18.670331 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:27:18.670505 [info ] [MainThread]: 
[0m15:27:18.670697 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:27:18.678931 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.946632, "process_in_blocks": "0", "process_kernel_time": 0.316527, "process_mem_max_rss": "232931328", "process_out_blocks": "0", "process_user_time": 1.823138}
[0m15:27:18.679324 [debug] [MainThread]: Command `dbt run` succeeded at 15:27:18.679259 after 11.95 seconds
[0m15:27:18.679578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e4b6ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bd784d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bda3c50>]}
[0m15:27:18.679821 [debug] [MainThread]: Flushing usage events
[0m15:27:18.970407 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:32:14.922057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10778fe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d939d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d93b10>]}


============================== 15:32:14.924803 | b9765a52-897c-4967-a05a-34df80d59785 ==============================
[0m15:32:14.924803 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:32:14.925072 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'invocation_command': 'dbt run --select silver_plays --full-refresh', 'warn_error': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'static_parser': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'partial_parse': 'True', 'fail_fast': 'False', 'write_json': 'True', 'printer_width': '80', 'version_check': 'True', 'no_print': 'None', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'target_path': 'None', 'debug': 'False'}
[0m15:32:15.503430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9765a52-897c-4967-a05a-34df80d59785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080e4b00>]}
[0m15:32:15.526086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9765a52-897c-4967-a05a-34df80d59785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa84e20>]}
[0m15:32:15.526681 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:32:15.576901 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:32:15.626444 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:32:15.626695 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://macros/get_custom_schema.sql
[0m15:32:15.627575 [info ] [MainThread]: Unable to do partial parsing because change detected to override macro. Starting full parse.
[0m15:32:15.998547 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.spotify_analytics.gold
- models.spotify_analytics.bronze
[0m15:32:16.003254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9765a52-897c-4967-a05a-34df80d59785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff2a850>]}
[0m15:32:16.029950 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m15:32:16.031860 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m15:32:16.042392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9765a52-897c-4967-a05a-34df80d59785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10862ed50>]}
[0m15:32:16.042596 [info ] [MainThread]: Found 1 model, 1 source, 490 macros
[0m15:32:16.042727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9765a52-897c-4967-a05a-34df80d59785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11009bbd0>]}
[0m15:32:16.043334 [info ] [MainThread]: 
[0m15:32:16.043469 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:32:16.043570 [info ] [MainThread]: 
[0m15:32:16.043765 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:32:16.044090 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m15:32:16.048809 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m15:32:16.048936 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m15:32:16.049041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:32:17.669698 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.620 seconds
[0m15:32:17.673287 [debug] [ThreadPool]: On list_spotify_data: Close
[0m15:32:17.878819 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_silver)
[0m15:32:17.891520 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m15:32:17.892055 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m15:32:17.892324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:32:18.864232 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.972 seconds
[0m15:32:18.867286 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m15:32:19.065711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9765a52-897c-4967-a05a-34df80d59785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe417e0>]}
[0m15:32:19.073219 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m15:32:19.074236 [info ] [Thread-1 (]: 1 of 1 START sql table model silver.silver_plays ............................... [RUN]
[0m15:32:19.075302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.silver_plays)
[0m15:32:19.075803 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m15:32:19.084829 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m15:32:19.085952 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m15:32:19.105133 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.silver_plays"
[0m15:32:19.106689 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.silver_plays"
[0m15:32:19.107004 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.silver_plays"} */
create or replace transient table spotify_data.silver.silver_plays
         as
        (

-- ============================================================================
-- SILVER LAYER: CLEANED PLAYS DATA
-- ============================================================================
-- Purpose: Transform bronze plays data into clean, analytics-ready format
-- 
-- Transformations:
--   1. Deduplicate records (DISTINCT on event_id)
--   2. Cast all data types from VARIANT to proper types
--   3. Filter invalid records (defensive WHERE clauses)
--   4. Add processing metadata (processed_at timestamp)
--
-- Source: bronze.plays (external table reading from S3 Parquet files)
-- Target: SILVER.silver_plays (materialized table)
-- ============================================================================

WITH source_data AS (
    SELECT 
        VALUE:event_id::VARCHAR AS event_id,
        VALUE:user_id::VARCHAR AS user_id,
        VALUE:event_type::VARCHAR AS event_type,
        VALUE:track_id::VARCHAR AS track_id,
        VALUE:track_name::VARCHAR AS track_name,
        VALUE:artist_name::VARCHAR AS artist_name,
        VALUE:album_name::VARCHAR AS album_name,
        VALUE:duration_ms::NUMBER AS duration_ms,
        VALUE:played_at::VARCHAR AS played_at,
        VALUE:device_type::VARCHAR AS device_type
    FROM spotify_data.bronze.plays
),

deduplicated AS (
    SELECT DISTINCT
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM source_data
    WHERE 
        -- Data quality filters
        user_id IS NOT NULL
        AND duration_ms > 0
        AND duration_ms < 600000  -- Less than 10 minutes (catches data errors)
        AND event_id IS NOT NULL
)

SELECT 
    -- Identifiers
    event_id::VARCHAR AS event_id,
    user_id::VARCHAR AS user_id,
    event_type::VARCHAR AS event_type,
    
    -- Track information
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    duration_ms::NUMBER AS duration_ms,
    
    -- Timestamps
    TRY_CAST(played_at AS TIMESTAMP) AS played_at,
    
    -- Device context
    device_type::VARCHAR AS device_type,
    
    -- Metadata
    CURRENT_TIMESTAMP() AS processed_at
    
FROM deduplicated
        );
[0m15:32:19.107260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:21.646482 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.539 seconds
[0m15:32:21.673357 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: Close
[0m15:32:21.872351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9765a52-897c-4967-a05a-34df80d59785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c02810>]}
[0m15:32:21.873552 [info ] [Thread-1 (]: 1 of 1 OK created sql table model silver.silver_plays .......................... [[32mSUCCESS 1[0m in 2.79s]
[0m15:32:21.874402 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m15:32:21.876298 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:32:21.876663 [debug] [MainThread]: Connection 'model.spotify_analytics.silver_plays' was properly closed.
[0m15:32:21.877016 [info ] [MainThread]: 
[0m15:32:21.877369 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.83 seconds (5.83s).
[0m15:32:21.878115 [debug] [MainThread]: Command end result
[0m15:32:21.904955 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m15:32:21.906050 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m15:32:21.909438 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m15:32:21.909641 [info ] [MainThread]: 
[0m15:32:21.909861 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:32:21.910018 [info ] [MainThread]: 
[0m15:32:21.910190 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:32:21.911980 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.025306, "process_in_blocks": "0", "process_kernel_time": 0.245611, "process_mem_max_rss": "234029056", "process_out_blocks": "0", "process_user_time": 1.682296}
[0m15:32:21.912260 [debug] [MainThread]: Command `dbt run` succeeded at 15:32:21.912211 after 7.03 seconds
[0m15:32:21.912470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe876a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cbf750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cbf4d0>]}
[0m15:32:21.912659 [debug] [MainThread]: Flushing usage events
[0m15:32:22.230175 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:46:38.910085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a3be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10615f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10615fb10>]}


============================== 15:46:38.912496 | ecc14b3f-5aee-495a-a434-ac763793b202 ==============================
[0m15:46:38.912496 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:46:38.912770 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt deps', 'warn_error': 'None', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'empty': 'None', 'no_print': 'None', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'target_path': 'None', 'quiet': 'False', 'write_json': 'True', 'log_format': 'default', 'printer_width': '80', 'debug': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'fail_fast': 'False', 'version_check': 'True', 'static_parser': 'True'}
[0m15:46:38.965659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecc14b3f-5aee-495a-a434-ac763793b202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051b0b00>]}
[0m15:46:38.975964 [debug] [MainThread]: Set downloads directory='/var/folders/vr/_xk0ypp143s2xjdd73dqc2zh0000gn/T/dbt-downloads-5c34n665'
[0m15:46:38.976183 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:46:39.166575 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:46:39.168155 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:46:39.280734 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:46:39.295930 [info ] [MainThread]: Updating lock file in file path: /Users/sunilmakkar/spotify-data-pipeline/dbt/package-lock.yml
[0m15:46:39.298291 [debug] [MainThread]: Set downloads directory='/var/folders/vr/_xk0ypp143s2xjdd73dqc2zh0000gn/T/dbt-downloads-f4geusuv'
[0m15:46:39.301171 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:46:39.686759 [info ] [MainThread]: Installed from version 1.1.1
[0m15:46:39.687034 [info ] [MainThread]: Updated version available: 1.3.2
[0m15:46:39.687235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ecc14b3f-5aee-495a-a434-ac763793b202', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10600abe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10600a250>]}
[0m15:46:39.687444 [info ] [MainThread]: 
[0m15:46:39.687596 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m15:46:39.689133 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.80638987, "process_in_blocks": "0", "process_kernel_time": 0.129146, "process_mem_max_rss": "114966528", "process_out_blocks": "0", "process_user_time": 0.607985}
[0m15:46:39.689393 [debug] [MainThread]: Command `dbt deps` succeeded at 15:46:39.689338 after 0.81 seconds
[0m15:46:39.689576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106352650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106000f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106001220>]}
[0m15:46:39.689744 [debug] [MainThread]: Flushing usage events
[0m15:46:40.013257 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:47:39.799417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107297e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10888f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10888fb10>]}


============================== 15:47:39.801998 | 550c5d4d-da30-4f11-b1ae-99643a14b8c2 ==============================
[0m15:47:39.801998 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:47:39.802261 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'no_print': 'None', 'version_check': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'warn_error': 'None', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'quiet': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'invocation_command': 'dbt test --select silver_plays', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'static_parser': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'debug': 'False'}
[0m15:47:40.504472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '550c5d4d-da30-4f11-b1ae-99643a14b8c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be0b00>]}
[0m15:47:40.528467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '550c5d4d-da30-4f11-b1ae-99643a14b8c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f584e20>]}
[0m15:47:40.529104 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:47:40.585952 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:47:40.621413 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m15:47:40.621689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '550c5d4d-da30-4f11-b1ae-99643a14b8c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4b6650>]}
[0m15:47:41.115065 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.accepted_range`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m15:47:41.115369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '550c5d4d-da30-4f11-b1ae-99643a14b8c2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f91f4d0>]}
[0m15:47:41.172425 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.spotify_analytics.gold
- models.spotify_analytics.bronze
[0m15:47:41.176418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '550c5d4d-da30-4f11-b1ae-99643a14b8c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc52f90>]}
[0m15:47:41.213909 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m15:47:41.215292 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m15:47:41.231054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '550c5d4d-da30-4f11-b1ae-99643a14b8c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10febf860>]}
[0m15:47:41.231322 [info ] [MainThread]: Found 1 model, 11 data tests, 1 source, 604 macros
[0m15:47:41.231464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '550c5d4d-da30-4f11-b1ae-99643a14b8c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe40e90>]}
[0m15:47:41.232338 [info ] [MainThread]: 
[0m15:47:41.232481 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:47:41.232583 [info ] [MainThread]: 
[0m15:47:41.232785 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:47:41.233179 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m15:47:41.239953 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m15:47:41.240159 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m15:47:41.240275 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:42.603766 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.363 seconds
[0m15:47:42.606191 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m15:47:42.889073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '550c5d4d-da30-4f11-b1ae-99643a14b8c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe8cb50>]}
[0m15:47:42.892135 [debug] [Thread-1 (]: Began running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m15:47:42.892505 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m15:47:42.892790 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m15:47:42.893076 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m15:47:42.893443 [info ] [Thread-1 (]: 1 of 11 START test dbt_utils_accepted_range_silver_plays_duration_ms__600000__1  [RUN]
[0m15:47:42.893795 [info ] [Thread-4 (]: 4 of 11 START test not_null_silver_plays_event_id .............................. [RUN]
[0m15:47:42.894118 [info ] [Thread-3 (]: 3 of 11 START test not_null_silver_plays_duration_ms ........................... [RUN]
[0m15:47:42.894426 [info ] [Thread-2 (]: 2 of 11 START test not_null_silver_plays_artist_name ........................... [RUN]
[0m15:47:42.894859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39)
[0m15:47:42.895253 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd'
[0m15:47:42.895621 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076'
[0m15:47:42.896012 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad'
[0m15:47:42.896528 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m15:47:42.897104 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m15:47:42.897487 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m15:47:42.897687 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m15:47:42.906451 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m15:47:42.912582 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m15:47:42.915233 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m15:47:42.917105 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m15:47:42.917915 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m15:47:42.918166 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m15:47:42.918363 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m15:47:42.924858 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m15:47:42.933376 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m15:47:42.934736 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m15:47:42.936404 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m15:47:42.937442 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m15:47:42.938659 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m15:47:42.939007 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m15:47:42.939322 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m15:47:42.939664 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m15:47:42.939915 [debug] [Thread-1 (]: On test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from spotify_data.silver.silver_plays
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not duration_ms >= 1
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not duration_ms <= 600000
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m15:47:42.940192 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from spotify_data.silver.silver_plays
where event_id is null



  
  
      
    ) dbt_internal_test
[0m15:47:42.940411 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select duration_ms
from spotify_data.silver.silver_plays
where duration_ms is null



  
  
      
    ) dbt_internal_test
[0m15:47:42.940634 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select artist_name
from spotify_data.silver.silver_plays
where artist_name is null



  
  
      
    ) dbt_internal_test
[0m15:47:42.940820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:42.940985 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:47:42.941148 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:47:42.941299 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:47:44.173227 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.231 seconds
[0m15:47:44.186722 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd: Close
[0m15:47:44.188466 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.248 seconds
[0m15:47:44.191211 [debug] [Thread-1 (]: On test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39: Close
[0m15:47:44.192658 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.251 seconds
[0m15:47:44.194138 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076: Close
[0m15:47:44.384050 [info ] [Thread-1 (]: 1 of 11 PASS dbt_utils_accepted_range_silver_plays_duration_ms__600000__1 ...... [[32mPASS[0m in 1.49s]
[0m15:47:44.384748 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m15:47:44.385127 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m15:47:44.385527 [info ] [Thread-1 (]: 5 of 11 START test not_null_silver_plays_event_type ............................ [RUN]
[0m15:47:44.385938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39, now test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa)
[0m15:47:44.386257 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m15:47:44.391794 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m15:47:44.393056 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m15:47:44.400365 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m15:47:44.402356 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m15:47:44.402576 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_type
from spotify_data.silver.silver_plays
where event_type is null



  
  
      
    ) dbt_internal_test
[0m15:47:44.402755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:44.403203 [info ] [Thread-3 (]: 3 of 11 PASS not_null_silver_plays_duration_ms ................................. [[32mPASS[0m in 1.51s]
[0m15:47:44.404087 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m15:47:44.404505 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m15:47:44.405014 [info ] [Thread-3 (]: 6 of 11 START test not_null_silver_plays_played_at ............................. [RUN]
[0m15:47:44.405563 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076, now test.spotify_analytics.not_null_silver_plays_played_at.8281565f95)
[0m15:47:44.405851 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m15:47:44.409655 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m15:47:44.410673 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m15:47:44.412393 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m15:47:44.416661 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m15:47:44.418204 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_played_at.8281565f95: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select played_at
from spotify_data.silver.silver_plays
where played_at is null



  
  
      
    ) dbt_internal_test
[0m15:47:44.418500 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:47:44.424311 [info ] [Thread-4 (]: 4 of 11 PASS not_null_silver_plays_event_id .................................... [[32mPASS[0m in 1.53s]
[0m15:47:44.425468 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m15:47:44.425766 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m15:47:44.426044 [info ] [Thread-4 (]: 7 of 11 START test not_null_silver_plays_processed_at .......................... [RUN]
[0m15:47:44.426419 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd, now test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed)
[0m15:47:44.426640 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m15:47:44.429623 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m15:47:44.436580 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m15:47:44.440668 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m15:47:44.531599 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m15:47:44.532051 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select processed_at
from spotify_data.silver.silver_plays
where processed_at is null



  
  
      
    ) dbt_internal_test
[0m15:47:44.532441 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:47:45.231015 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.812 seconds
[0m15:47:45.234259 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_played_at.8281565f95: Close
[0m15:47:45.286636 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.884 seconds
[0m15:47:45.289704 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa: Close
[0m15:47:45.305386 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.773 seconds
[0m15:47:45.308550 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed: Close
[0m15:47:45.367430 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.426 seconds
[0m15:47:45.370166 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad: Close
[0m15:47:45.386899 [info ] [Thread-3 (]: 6 of 11 PASS not_null_silver_plays_played_at ................................... [[32mPASS[0m in 0.98s]
[0m15:47:45.387870 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m15:47:45.388421 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m15:47:45.388848 [info ] [Thread-3 (]: 8 of 11 START test not_null_silver_plays_track_id .............................. [RUN]
[0m15:47:45.389330 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_played_at.8281565f95, now test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9)
[0m15:47:45.389680 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m15:47:45.395142 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m15:47:45.396348 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m15:47:45.399375 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m15:47:45.400365 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m15:47:45.400707 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_id
from spotify_data.silver.silver_plays
where track_id is null



  
  
      
    ) dbt_internal_test
[0m15:47:45.401067 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:47:45.445497 [info ] [Thread-1 (]: 5 of 11 PASS not_null_silver_plays_event_type .................................. [[32mPASS[0m in 1.06s]
[0m15:47:45.446089 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m15:47:45.446395 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m15:47:45.446657 [info ] [Thread-1 (]: 9 of 11 START test not_null_silver_plays_track_name ............................ [RUN]
[0m15:47:45.446947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa, now test.spotify_analytics.not_null_silver_plays_track_name.c6334add30)
[0m15:47:45.447189 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m15:47:45.450065 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m15:47:45.450598 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m15:47:45.452076 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m15:47:45.453240 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m15:47:45.453596 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_silver_plays_track_name.c6334add30: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_name
from spotify_data.silver.silver_plays
where track_name is null



  
  
      
    ) dbt_internal_test
[0m15:47:45.453863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:45.457273 [info ] [Thread-4 (]: 7 of 11 PASS not_null_silver_plays_processed_at ................................ [[32mPASS[0m in 1.03s]
[0m15:47:45.459140 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m15:47:45.459371 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m15:47:45.459654 [info ] [Thread-4 (]: 10 of 11 START test not_null_silver_plays_user_id .............................. [RUN]
[0m15:47:45.460388 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed, now test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4)
[0m15:47:45.461356 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m15:47:45.464709 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m15:47:45.466880 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m15:47:45.469451 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m15:47:45.472869 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m15:47:45.473184 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from spotify_data.silver.silver_plays
where user_id is null



  
  
      
    ) dbt_internal_test
[0m15:47:45.473424 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:47:45.551042 [info ] [Thread-2 (]: 2 of 11 PASS not_null_silver_plays_artist_name ................................. [[32mPASS[0m in 2.66s]
[0m15:47:45.551457 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m15:47:45.551665 [debug] [Thread-2 (]: Began running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m15:47:45.551895 [info ] [Thread-2 (]: 11 of 11 START test unique_silver_plays_event_id ............................... [RUN]
[0m15:47:45.552172 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad, now test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf)
[0m15:47:45.552364 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m15:47:45.555637 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m15:47:45.556054 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m15:47:45.557120 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m15:47:45.558134 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m15:47:45.558329 [debug] [Thread-2 (]: On test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from spotify_data.silver.silver_plays
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:47:45.558497 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:47:46.138885 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.738 seconds
[0m15:47:46.141817 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9: Close
[0m15:47:46.268716 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.814 seconds
[0m15:47:46.271448 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_silver_plays_track_name.c6334add30: Close
[0m15:47:46.328050 [info ] [Thread-3 (]: 8 of 11 PASS not_null_silver_plays_track_id .................................... [[32mPASS[0m in 0.94s]
[0m15:47:46.329069 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m15:47:46.417791 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.859 seconds
[0m15:47:46.420978 [debug] [Thread-2 (]: On test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf: Close
[0m15:47:46.426854 [info ] [Thread-1 (]: 9 of 11 PASS not_null_silver_plays_track_name .................................. [[32mPASS[0m in 0.98s]
[0m15:47:46.427999 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m15:47:46.495521 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.022 seconds
[0m15:47:46.498109 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4: Close
[0m15:47:46.636251 [info ] [Thread-2 (]: 11 of 11 PASS unique_silver_plays_event_id ..................................... [[32mPASS[0m in 1.08s]
[0m15:47:46.637348 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m15:47:46.664714 [info ] [Thread-4 (]: 10 of 11 PASS not_null_silver_plays_user_id .................................... [[32mPASS[0m in 1.20s]
[0m15:47:46.665455 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m15:47:46.666838 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:47:46.667169 [debug] [MainThread]: Connection 'test.spotify_analytics.not_null_silver_plays_track_name.c6334add30' was properly closed.
[0m15:47:46.667402 [debug] [MainThread]: Connection 'test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4' was properly closed.
[0m15:47:46.667934 [debug] [MainThread]: Connection 'test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9' was properly closed.
[0m15:47:46.668302 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf' was properly closed.
[0m15:47:46.668645 [info ] [MainThread]: 
[0m15:47:46.668990 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 5.44 seconds (5.44s).
[0m15:47:46.670821 [debug] [MainThread]: Command end result
[0m15:47:46.692975 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m15:47:46.694433 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m15:47:46.698497 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m15:47:46.698726 [info ] [MainThread]: 
[0m15:47:46.698924 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:47:46.699061 [info ] [MainThread]: 
[0m15:47:46.699212 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m15:47:46.699487 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:47:46.701278 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.932843, "process_in_blocks": "0", "process_kernel_time": 0.33095, "process_mem_max_rss": "237060096", "process_out_blocks": "0", "process_user_time": 2.681077}
[0m15:47:46.701505 [debug] [MainThread]: Command `dbt test` succeeded at 15:47:46.701464 after 6.93 seconds
[0m15:47:46.701692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fba4370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9ccd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c7a6d0>]}
[0m15:47:46.701876 [debug] [MainThread]: Flushing usage events
[0m15:47:46.870516 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:05:10.279811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035ebe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bef9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104befb10>]}


============================== 20:05:10.282436 | 839f1074-4154-4c0e-abbe-cceac3cddb29 ==============================
[0m20:05:10.282436 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:05:10.282706 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'fail_fast': 'False', 'target_path': 'None', 'debug': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'invocation_command': 'dbt compile --select daily_user_stats.sql', 'empty': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'quiet': 'False', 'printer_width': '80', 'introspect': 'True', 'warn_error': 'None', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'log_cache_events': 'False', 'use_experimental_parser': 'False'}
[0m20:05:11.098708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '839f1074-4154-4c0e-abbe-cceac3cddb29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f40b00>]}
[0m20:05:11.121017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '839f1074-4154-4c0e-abbe-cceac3cddb29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8e0e20>]}
[0m20:05:11.121540 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:05:11.178924 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:05:11.237257 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:05:11.237505 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/daily_user_stats.sql
[0m20:05:11.327190 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m20:05:11.332191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '839f1074-4154-4c0e-abbe-cceac3cddb29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdbdd50>]}
[0m20:05:11.366486 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:05:11.367873 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:05:11.378728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '839f1074-4154-4c0e-abbe-cceac3cddb29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcb28a0>]}
[0m20:05:11.378932 [info ] [MainThread]: Found 2 models, 11 data tests, 1 source, 604 macros
[0m20:05:11.379067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '839f1074-4154-4c0e-abbe-cceac3cddb29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdb02f0>]}
[0m20:05:11.379810 [info ] [MainThread]: 
[0m20:05:11.379942 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:05:11.380059 [info ] [MainThread]: 
[0m20:05:11.380309 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:05:11.380662 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m20:05:11.386302 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m20:05:11.386613 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m20:05:11.387617 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m20:05:11.387783 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m20:05:11.387919 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m20:05:11.388049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:11.388193 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:14.882967 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 3.495 seconds
[0m20:05:14.883925 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 3.496 seconds
[0m20:05:14.886463 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m20:05:14.887508 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m20:05:15.107537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '839f1074-4154-4c0e-abbe-cceac3cddb29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2761a0>]}
[0m20:05:15.112393 [debug] [Thread-1 (]: Began running node model.spotify_analytics.daily_user_stats
[0m20:05:15.112913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.daily_user_stats)
[0m20:05:15.113284 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.daily_user_stats
[0m20:05:15.120544 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.daily_user_stats"
[0m20:05:15.121253 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.daily_user_stats
[0m20:05:15.121722 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.daily_user_stats
[0m20:05:15.122480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:05:15.122819 [debug] [MainThread]: Connection 'model.spotify_analytics.daily_user_stats' was properly closed.
[0m20:05:15.123069 [debug] [MainThread]: Connection 'list_spotify_data_silver' was properly closed.
[0m20:05:15.123643 [debug] [MainThread]: Command end result
[0m20:05:15.148459 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:05:15.149419 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:05:15.153325 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m20:05:15.153559 [info ] [MainThread]: Compiled node 'daily_user_stats' is:


-- ============================================================================
-- GOLD LAYER: DAILY USER LISTENING STATISTICS
-- ============================================================================
-- Purpose: Aggregate user listening behavior by day
-- 
-- Grain: One row per user per day
-- Primary Key: (date, user_id)
--
-- Metrics:
--   - Total plays per day
--   - Total listening time
--   - Unique tracks/artists played
--   - Average track duration
--
-- Source: SILVER.silver_plays
-- Target: GOLD.daily_user_stats
-- ============================================================================

WITH daily_aggregates AS (
    SELECT 
        -- Date dimension (truncate timestamp to date)
        DATE(played_at) AS date,
        
        -- User identifier
        user_id,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        COUNT(DISTINCT track_id) AS unique_tracks,
        COUNT(DISTINCT artist_name) AS unique_artists,
        AVG(duration_ms) AS avg_track_duration_ms
        
    FROM spotify_data.silver.silver_plays
    GROUP BY 
        DATE(played_at),
        user_id
)

SELECT 
    -- Dimensions
    date,
    user_id,
    
    -- Metrics (cast for clarity)
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    unique_tracks::NUMBER AS unique_tracks,
    unique_artists::NUMBER AS unique_artists,
    ROUND(avg_track_duration_ms, 2)::NUMBER AS avg_track_duration_ms
    
FROM daily_aggregates
ORDER BY date DESC, user_id
[0m20:05:15.159735 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 4.9147763, "process_in_blocks": "0", "process_kernel_time": 0.438988, "process_mem_max_rss": "245628928", "process_out_blocks": "0", "process_user_time": 1.467642}
[0m20:05:15.159994 [debug] [MainThread]: Command `dbt compile` succeeded at 20:05:15.159946 after 4.92 seconds
[0m20:05:15.160190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ae5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ae0260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ae0310>]}
[0m20:05:15.160472 [debug] [MainThread]: Flushing usage events
[0m20:05:15.467510 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:05:26.597179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d9fe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a3b10>]}


============================== 20:05:26.599388 | 29c01c44-db92-4388-bc9d-249366def773 ==============================
[0m20:05:26.599388 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:05:26.599636 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'invocation_command': 'dbt run --select daily_user_stats', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'quiet': 'False', 'printer_width': '80', 'version_check': 'True', 'static_parser': 'True', 'warn_error': 'None', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'debug': 'False', 'introspect': 'True', 'use_colors': 'True', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m20:05:27.202353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29c01c44-db92-4388-bc9d-249366def773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066f4b00>]}
[0m20:05:27.226004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29c01c44-db92-4388-bc9d-249366def773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e098e20>]}
[0m20:05:27.226647 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:05:27.282709 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:05:27.338591 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:05:27.338803 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:05:27.341166 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m20:05:27.357891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29c01c44-db92-4388-bc9d-249366def773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfc5350>]}
[0m20:05:27.394322 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:05:27.395813 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:05:27.407290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29c01c44-db92-4388-bc9d-249366def773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df9ad50>]}
[0m20:05:27.407563 [info ] [MainThread]: Found 2 models, 11 data tests, 1 source, 604 macros
[0m20:05:27.407708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29c01c44-db92-4388-bc9d-249366def773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e691fd0>]}
[0m20:05:27.408410 [info ] [MainThread]: 
[0m20:05:27.408548 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:05:27.408651 [info ] [MainThread]: 
[0m20:05:27.408855 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:05:27.409218 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m20:05:27.416303 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m20:05:27.416502 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m20:05:27.416609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:28.936884 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.520 seconds
[0m20:05:28.939767 [debug] [ThreadPool]: On list_spotify_data: Close
[0m20:05:29.180507 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_silver)
[0m20:05:29.187644 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m20:05:29.191584 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m20:05:29.194024 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m20:05:29.194321 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m20:05:29.194644 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m20:05:29.194937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:29.195206 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:30.476965 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.282 seconds
[0m20:05:30.479137 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m20:05:30.496803 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.302 seconds
[0m20:05:30.498689 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m20:05:30.681308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29c01c44-db92-4388-bc9d-249366def773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e74cd50>]}
[0m20:05:30.686815 [debug] [Thread-1 (]: Began running node model.spotify_analytics.daily_user_stats
[0m20:05:30.687548 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.daily_user_stats ............................. [RUN]
[0m20:05:30.688052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.daily_user_stats)
[0m20:05:30.688418 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.daily_user_stats
[0m20:05:30.698137 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.daily_user_stats"
[0m20:05:30.699115 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.daily_user_stats
[0m20:05:30.726279 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.daily_user_stats"
[0m20:05:30.727348 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.daily_user_stats"
[0m20:05:30.727585 [debug] [Thread-1 (]: On model.spotify_analytics.daily_user_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.daily_user_stats"} */
create or replace transient table spotify_data.gold.daily_user_stats
         as
        (

-- ============================================================================
-- GOLD LAYER: DAILY USER LISTENING STATISTICS
-- ============================================================================
-- Purpose: Aggregate user listening behavior by day
-- 
-- Grain: One row per user per day
-- Primary Key: (date, user_id)
--
-- Metrics:
--   - Total plays per day
--   - Total listening time
--   - Unique tracks/artists played
--   - Average track duration
--
-- Source: SILVER.silver_plays
-- Target: GOLD.daily_user_stats
-- ============================================================================

WITH daily_aggregates AS (
    SELECT 
        -- Date dimension (truncate timestamp to date)
        DATE(played_at) AS date,
        
        -- User identifier
        user_id,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        COUNT(DISTINCT track_id) AS unique_tracks,
        COUNT(DISTINCT artist_name) AS unique_artists,
        AVG(duration_ms) AS avg_track_duration_ms
        
    FROM spotify_data.silver.silver_plays
    GROUP BY 
        DATE(played_at),
        user_id
)

SELECT 
    -- Dimensions
    date,
    user_id,
    
    -- Metrics (cast for clarity)
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    unique_tracks::NUMBER AS unique_tracks,
    unique_artists::NUMBER AS unique_artists,
    ROUND(avg_track_duration_ms, 2)::NUMBER AS avg_track_duration_ms
    
FROM daily_aggregates
ORDER BY date DESC, user_id
        );
[0m20:05:30.727797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:33.439900 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.712 seconds
[0m20:05:33.462332 [debug] [Thread-1 (]: On model.spotify_analytics.daily_user_stats: Close
[0m20:05:33.618487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29c01c44-db92-4388-bc9d-249366def773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1159eaed0>]}
[0m20:05:33.618954 [info ] [Thread-1 (]: 1 of 1 OK created sql table model gold.daily_user_stats ........................ [[32mSUCCESS 1[0m in 2.93s]
[0m20:05:33.619273 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.daily_user_stats
[0m20:05:33.620000 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:05:33.620152 [debug] [MainThread]: Connection 'model.spotify_analytics.daily_user_stats' was properly closed.
[0m20:05:33.620333 [debug] [MainThread]: Connection 'list_spotify_data_gold' was properly closed.
[0m20:05:33.620490 [info ] [MainThread]: 
[0m20:05:33.620635 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.21 seconds (6.21s).
[0m20:05:33.620938 [debug] [MainThread]: Command end result
[0m20:05:33.635009 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:05:33.635951 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:05:33.638775 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m20:05:33.638923 [info ] [MainThread]: 
[0m20:05:33.639092 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:05:33.639207 [info ] [MainThread]: 
[0m20:05:33.639342 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:05:33.641025 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.070223, "process_in_blocks": "0", "process_kernel_time": 0.242375, "process_mem_max_rss": "229703680", "process_out_blocks": "0", "process_user_time": 1.425056}
[0m20:05:33.641223 [debug] [MainThread]: Command `dbt run` succeeded at 20:05:33.641185 after 7.07 seconds
[0m20:05:33.641380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e701b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b9f6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b9c2d0>]}
[0m20:05:33.641527 [debug] [MainThread]: Flushing usage events
[0m20:05:33.810798 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:10:23.208070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105833e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e37b10>]}


============================== 20:10:23.210650 | 3235b794-e37f-45a1-8aee-4d83deb9b53e ==============================
[0m20:10:23.210650 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:10:23.210910 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/sunilmakkar/.dbt', 'write_json': 'True', 'version_check': 'True', 'partial_parse': 'True', 'no_print': 'None', 'invocation_command': 'dbt run --select top_tracks', 'target_path': 'None', 'static_parser': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_format': 'default', 'introspect': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'fail_fast': 'False', 'empty': 'False'}
[0m20:10:23.874646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3235b794-e37f-45a1-8aee-4d83deb9b53e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106188b00>]}
[0m20:10:23.897350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3235b794-e37f-45a1-8aee-4d83deb9b53e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a304e20>]}
[0m20:10:23.897905 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:10:23.950923 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:10:24.014522 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:10:24.014810 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/top_tracks.sql
[0m20:10:24.106587 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m20:10:24.111560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3235b794-e37f-45a1-8aee-4d83deb9b53e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a8f8d50>]}
[0m20:10:24.145716 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:10:24.147177 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:10:24.158151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3235b794-e37f-45a1-8aee-4d83deb9b53e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a7d2b70>]}
[0m20:10:24.158369 [info ] [MainThread]: Found 3 models, 11 data tests, 1 source, 604 macros
[0m20:10:24.158521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3235b794-e37f-45a1-8aee-4d83deb9b53e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d594ad0>]}
[0m20:10:24.159205 [info ] [MainThread]: 
[0m20:10:24.159347 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:10:24.159452 [info ] [MainThread]: 
[0m20:10:24.159650 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:10:24.159977 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m20:10:24.165023 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m20:10:24.165177 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m20:10:24.165287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:25.568420 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.403 seconds
[0m20:10:25.573550 [debug] [ThreadPool]: On list_spotify_data: Close
[0m20:10:25.771712 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_silver)
[0m20:10:25.778891 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m20:10:25.784997 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m20:10:25.787344 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m20:10:25.787606 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m20:10:25.787811 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m20:10:25.787942 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:25.788058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:10:26.693893 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.906 seconds
[0m20:10:26.696748 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m20:10:26.886040 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.098 seconds
[0m20:10:26.888695 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m20:10:27.062911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3235b794-e37f-45a1-8aee-4d83deb9b53e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d7b9300>]}
[0m20:10:27.068848 [debug] [Thread-1 (]: Began running node model.spotify_analytics.top_tracks
[0m20:10:27.069537 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.top_tracks ................................... [RUN]
[0m20:10:27.070055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.top_tracks)
[0m20:10:27.070458 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.top_tracks
[0m20:10:27.078683 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.top_tracks"
[0m20:10:27.079650 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.top_tracks
[0m20:10:27.097997 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.top_tracks"
[0m20:10:27.099128 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.top_tracks"
[0m20:10:27.099414 [debug] [Thread-1 (]: On model.spotify_analytics.top_tracks: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.top_tracks"} */
create or replace transient table spotify_data.gold.top_tracks
         as
        (

-- ============================================================================
-- GOLD LAYER: TOP TRACKS BY PLAY COUNT
-- ============================================================================
-- Purpose: Aggregate and rank tracks by popularity
-- 
-- Grain: One row per track (all-time aggregation)
-- Primary Key: track_id
--
-- Metrics:
--   - Total plays per track
--   - Total listening time
--   - First and last play timestamps
--   - Popularity rank
--
-- Source: SILVER.silver_plays
-- Target: GOLD.top_tracks
-- ============================================================================

WITH track_aggregates AS (
    SELECT 
        -- Track identifiers and attributes
        track_id,
        track_name,
        artist_name,
        album_name,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        MIN(played_at) AS first_played_at,
        MAX(played_at) AS last_played_at
        
    FROM spotify_data.silver.silver_plays
    GROUP BY 
        track_id,
        track_name,
        artist_name,
        album_name
),

ranked_tracks AS (
    SELECT 
        *,
        -- Add ranking based on play count (1 = most played)
        ROW_NUMBER() OVER (ORDER BY total_plays DESC, total_listening_time_ms DESC) AS rank
    FROM track_aggregates
)

SELECT 
    -- Identifiers
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    
    -- Timestamps
    first_played_at::TIMESTAMP AS first_played_at,
    last_played_at::TIMESTAMP AS last_played_at,
    
    -- Ranking
    rank::NUMBER AS rank
    
FROM ranked_tracks
ORDER BY rank
        );
[0m20:10:27.099672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:29.009338 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.908 seconds
[0m20:10:29.042686 [debug] [Thread-1 (]: On model.spotify_analytics.top_tracks: Close
[0m20:10:29.204154 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3235b794-e37f-45a1-8aee-4d83deb9b53e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d81b1d0>]}
[0m20:10:29.205929 [info ] [Thread-1 (]: 1 of 1 OK created sql table model gold.top_tracks .............................. [[32mSUCCESS 1[0m in 2.13s]
[0m20:10:29.206934 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.top_tracks
[0m20:10:29.211972 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:10:29.212168 [debug] [MainThread]: Connection 'model.spotify_analytics.top_tracks' was properly closed.
[0m20:10:29.212288 [debug] [MainThread]: Connection 'list_spotify_data_gold' was properly closed.
[0m20:10:29.212589 [info ] [MainThread]: 
[0m20:10:29.212947 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.05 seconds (5.05s).
[0m20:10:29.214397 [debug] [MainThread]: Command end result
[0m20:10:29.247615 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:10:29.250179 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:10:29.255538 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m20:10:29.255791 [info ] [MainThread]: 
[0m20:10:29.256058 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:10:29.256210 [info ] [MainThread]: 
[0m20:10:29.256393 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:10:29.258359 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.081735, "process_in_blocks": "0", "process_kernel_time": 0.298932, "process_mem_max_rss": "218480640", "process_out_blocks": "0", "process_user_time": 1.518102}
[0m20:10:29.258669 [debug] [MainThread]: Command `dbt run` succeeded at 20:10:29.258617 after 6.08 seconds
[0m20:10:29.258957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d5aef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d7225d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d723f70>]}
[0m20:10:29.259154 [debug] [MainThread]: Flushing usage events
[0m20:10:29.590898 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:12:17.887335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f3fe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075439d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107543b10>]}


============================== 20:12:17.889806 | 4856ca76-3326-4db3-a96f-5c4ca96e79ea ==============================
[0m20:12:17.889806 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:12:17.890072 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'log_format': 'default', 'target_path': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'introspect': 'True', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'use_experimental_parser': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'cache_selected_only': 'False', 'printer_width': '80', 'static_parser': 'True', 'empty': 'False', 'invocation_command': 'dbt run --select top_artists', 'quiet': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'version_check': 'True'}
[0m20:12:18.511769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4856ca76-3326-4db3-a96f-5c4ca96e79ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106894b00>]}
[0m20:12:18.535364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4856ca76-3326-4db3-a96f-5c4ca96e79ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e238e20>]}
[0m20:12:18.535921 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:12:18.591707 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:12:18.653109 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:12:18.653379 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/top_artists.sql
[0m20:12:18.744537 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m20:12:18.749513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4856ca76-3326-4db3-a96f-5c4ca96e79ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e724d50>]}
[0m20:12:18.783813 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:12:18.786766 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:12:18.799365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4856ca76-3326-4db3-a96f-5c4ca96e79ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e606b70>]}
[0m20:12:18.799579 [info ] [MainThread]: Found 4 models, 11 data tests, 1 source, 604 macros
[0m20:12:18.799714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4856ca76-3326-4db3-a96f-5c4ca96e79ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea14c90>]}
[0m20:12:18.800393 [info ] [MainThread]: 
[0m20:12:18.800527 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:12:18.800631 [info ] [MainThread]: 
[0m20:12:18.800824 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:12:18.801149 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m20:12:18.806149 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m20:12:18.806306 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m20:12:18.806429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:20.215766 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.409 seconds
[0m20:12:20.218413 [debug] [ThreadPool]: On list_spotify_data: Close
[0m20:12:20.397060 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_gold)
[0m20:12:20.407445 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m20:12:20.407915 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m20:12:20.408280 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m20:12:20.410310 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m20:12:20.410506 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:12:20.410772 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m20:12:20.411574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:21.372366 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.961 seconds
[0m20:12:21.375337 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m20:12:21.511878 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.101 seconds
[0m20:12:21.514651 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m20:12:21.697590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4856ca76-3326-4db3-a96f-5c4ca96e79ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eaece20>]}
[0m20:12:21.702766 [debug] [Thread-1 (]: Began running node model.spotify_analytics.top_artists
[0m20:12:21.703519 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.top_artists .................................. [RUN]
[0m20:12:21.704027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.top_artists)
[0m20:12:21.704379 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.top_artists
[0m20:12:21.712197 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.top_artists"
[0m20:12:21.712973 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.top_artists
[0m20:12:21.731507 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.top_artists"
[0m20:12:21.732659 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.top_artists"
[0m20:12:21.732915 [debug] [Thread-1 (]: On model.spotify_analytics.top_artists: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.top_artists"} */
create or replace transient table spotify_data.gold.top_artists
         as
        (

-- ============================================================================
-- GOLD LAYER: TOP ARTISTS BY PLAY COUNT
-- ============================================================================
-- Purpose: Aggregate and rank artists by popularity
-- 
-- Grain: One row per artist (all-time aggregation)
-- Primary Key: artist_name
--
-- Metrics:
--   - Total plays per artist
--   - Total listening time
--   - Number of unique tracks played
--   - First and last play timestamps
--   - Popularity rank
--
-- Source: SILVER.silver_plays
-- Target: GOLD.top_artists
-- ============================================================================

WITH artist_aggregates AS (
    SELECT 
        -- Artist identifier
        artist_name,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        COUNT(DISTINCT track_id) AS unique_tracks,
        MIN(played_at) AS first_played_at,
        MAX(played_at) AS last_played_at
        
    FROM spotify_data.silver.silver_plays
    GROUP BY artist_name
),

ranked_artists AS (
    SELECT 
        *,
        -- Add ranking based on play count (1 = most played artist)
        ROW_NUMBER() OVER (ORDER BY total_plays DESC, total_listening_time_ms DESC) AS rank
    FROM artist_aggregates
)

SELECT 
    -- Identifier
    artist_name::VARCHAR AS artist_name,
    
    -- Metrics
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    unique_tracks::NUMBER AS unique_tracks,
    
    -- Timestamps
    first_played_at::TIMESTAMP AS first_played_at,
    last_played_at::TIMESTAMP AS last_played_at,
    
    -- Ranking
    rank::NUMBER AS rank
    
FROM ranked_artists
ORDER BY rank
        );
[0m20:12:21.733122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:23.938404 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.205 seconds
[0m20:12:23.959332 [debug] [Thread-1 (]: On model.spotify_analytics.top_artists: Close
[0m20:12:24.117943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4856ca76-3326-4db3-a96f-5c4ca96e79ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb5f890>]}
[0m20:12:24.119134 [info ] [Thread-1 (]: 1 of 1 OK created sql table model gold.top_artists ............................. [[32mSUCCESS 1[0m in 2.41s]
[0m20:12:24.119680 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.top_artists
[0m20:12:24.121341 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:12:24.121759 [debug] [MainThread]: Connection 'model.spotify_analytics.top_artists' was properly closed.
[0m20:12:24.121994 [debug] [MainThread]: Connection 'list_spotify_data_silver' was properly closed.
[0m20:12:24.122253 [info ] [MainThread]: 
[0m20:12:24.122530 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.32 seconds (5.32s).
[0m20:12:24.123125 [debug] [MainThread]: Command end result
[0m20:12:24.149379 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:12:24.150681 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:12:24.154260 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m20:12:24.154431 [info ] [MainThread]: 
[0m20:12:24.154627 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:12:24.154792 [info ] [MainThread]: 
[0m20:12:24.154968 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:12:24.156633 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.297918, "process_in_blocks": "0", "process_kernel_time": 0.25799, "process_mem_max_rss": "241434624", "process_out_blocks": "0", "process_user_time": 1.484434}
[0m20:12:24.156837 [debug] [MainThread]: Command `dbt run` succeeded at 20:12:24.156796 after 6.30 seconds
[0m20:12:24.157000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9b2e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb64370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb64690>]}
[0m20:12:24.157185 [debug] [MainThread]: Flushing usage events
[0m20:12:24.459632 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:14:30.137381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e43e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094479d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109447b10>]}


============================== 20:14:30.139973 | 037c28a8-81dd-484c-9712-174952ccece0 ==============================
[0m20:14:30.139973 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:14:30.140236 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'target_path': 'None', 'invocation_command': 'dbt compile --select device-usage', 'use_colors': 'True', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'fail_fast': 'False', 'log_cache_events': 'False', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'printer_width': '80', 'cache_selected_only': 'False', 'static_parser': 'True', 'introspect': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'warn_error': 'None', 'write_json': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m20:14:30.766298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '037c28a8-81dd-484c-9712-174952ccece0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108798b00>]}
[0m20:14:30.788938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '037c28a8-81dd-484c-9712-174952ccece0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ae00e20>]}
[0m20:14:30.789492 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:14:30.842440 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:14:30.903231 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:14:30.903489 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/device_usage.py
[0m20:14:30.961397 [error] [MainThread]: Encountered an error:
Parsing Error in model device_usage (models/gold/device_usage.py)
  No jinja in python model code is allowed
[0m20:14:30.963089 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 0.8540277, "process_in_blocks": "0", "process_kernel_time": 0.185754, "process_mem_max_rss": "207831040", "process_out_blocks": "0", "process_user_time": 0.905171}
[0m20:14:30.963377 [debug] [MainThread]: Command `dbt compile` failed at 20:14:30.963334 after 0.85 seconds
[0m20:14:30.963535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12adad450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12adadc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b4063f0>]}
[0m20:14:30.963670 [debug] [MainThread]: Flushing usage events
[0m20:14:31.302492 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:16:14.805102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077ebe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11155f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11155fb10>]}


============================== 20:16:14.807688 | 492c0a78-4148-49e4-baa8-f97d83021c91 ==============================
[0m20:16:14.807688 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:16:14.807935 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'fail_fast': 'False', 'write_json': 'True', 'log_format': 'default', 'printer_width': '80', 'empty': 'False', 'no_print': 'None', 'warn_error': 'None', 'introspect': 'True', 'use_colors': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt run --select device_usage', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'static_parser': 'True', 'quiet': 'False', 'profiles_dir': '/Users/sunilmakkar/.dbt'}
[0m20:16:15.402507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '492c0a78-4148-49e4-baa8-f97d83021c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103b0b00>]}
[0m20:16:15.424617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '492c0a78-4148-49e4-baa8-f97d83021c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122f04e20>]}
[0m20:16:15.425155 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:16:15.479133 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:16:15.538741 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:16:15.538995 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/device_usage.sql
[0m20:16:15.630793 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m20:16:15.635659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '492c0a78-4148-49e4-baa8-f97d83021c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13aef4e50>]}
[0m20:16:15.670171 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:16:15.671540 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:16:15.682232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '492c0a78-4148-49e4-baa8-f97d83021c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13add2b70>]}
[0m20:16:15.682413 [info ] [MainThread]: Found 5 models, 11 data tests, 1 source, 604 macros
[0m20:16:15.682540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '492c0a78-4148-49e4-baa8-f97d83021c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b324c90>]}
[0m20:16:15.683209 [info ] [MainThread]: 
[0m20:16:15.683341 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:16:15.683444 [info ] [MainThread]: 
[0m20:16:15.683678 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:16:15.684000 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m20:16:15.688961 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m20:16:15.689135 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m20:16:15.689271 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:16:17.199983 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.511 seconds
[0m20:16:17.202628 [debug] [ThreadPool]: On list_spotify_data: Close
[0m20:16:17.383418 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_gold)
[0m20:16:17.390335 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m20:16:17.390730 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m20:16:17.392023 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m20:16:17.392269 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m20:16:17.392482 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m20:16:17.392684 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:16:17.392879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:16:18.197810 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.805 seconds
[0m20:16:18.201126 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m20:16:18.374775 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.982 seconds
[0m20:16:18.376821 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m20:16:18.548993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '492c0a78-4148-49e4-baa8-f97d83021c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b34f2b0>]}
[0m20:16:18.553451 [debug] [Thread-1 (]: Began running node model.spotify_analytics.device_usage
[0m20:16:18.554048 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.device_usage ................................. [RUN]
[0m20:16:18.554461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.device_usage)
[0m20:16:18.554791 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.device_usage
[0m20:16:18.563487 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.device_usage"
[0m20:16:18.564034 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.device_usage
[0m20:16:18.584138 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.device_usage"
[0m20:16:18.585198 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.device_usage"
[0m20:16:18.585414 [debug] [Thread-1 (]: On model.spotify_analytics.device_usage: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.device_usage"} */
create or replace transient table spotify_data.gold.device_usage
         as
        (

-- ============================================================================
-- GOLD LAYER: DEVICE USAGE STATISTICS
-- ============================================================================
-- Purpose: Aggregate listening behavior by device type
-- 
-- Grain: One row per device type (all-time aggregation)
-- Primary Key: device_type
--
-- Metrics:
--   - Total plays per device
--   - Total listening time
--   - Percentage of total plays
--   - Average track duration
--
-- Source: SILVER.silver_plays
-- Target: GOLD.device_usage
-- ============================================================================

WITH device_aggregates AS (
    SELECT 
        -- Device identifier
        device_type,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        AVG(duration_ms) AS avg_track_duration_ms
        
    FROM spotify_data.silver.silver_plays
    GROUP BY device_type
),

total_plays_calc AS (
    -- Calculate overall total for percentage calculation
    SELECT SUM(total_plays) AS overall_total_plays
    FROM device_aggregates
)

SELECT 
    -- Identifier
    device_type::VARCHAR AS device_type,
    
    -- Metrics
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    
    -- Percentage of total plays
    ROUND((total_plays::FLOAT / overall_total_plays::FLOAT) * 100, 2)::FLOAT AS play_percentage,
    
    -- Average duration
    ROUND(avg_track_duration_ms, 2)::NUMBER AS avg_track_duration_ms
    
FROM device_aggregates
CROSS JOIN total_plays_calc
ORDER BY total_plays DESC
        );
[0m20:16:18.585601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:20.713864 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.128 seconds
[0m20:16:20.733880 [debug] [Thread-1 (]: On model.spotify_analytics.device_usage: Close
[0m20:16:20.891985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '492c0a78-4148-49e4-baa8-f97d83021c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b529310>]}
[0m20:16:20.892943 [info ] [Thread-1 (]: 1 of 1 OK created sql table model gold.device_usage ............................ [[32mSUCCESS 1[0m in 2.34s]
[0m20:16:20.893749 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.device_usage
[0m20:16:20.895111 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:16:20.895398 [debug] [MainThread]: Connection 'model.spotify_analytics.device_usage' was properly closed.
[0m20:16:20.895598 [debug] [MainThread]: Connection 'list_spotify_data_silver' was properly closed.
[0m20:16:20.895846 [info ] [MainThread]: 
[0m20:16:20.896129 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.21 seconds (5.21s).
[0m20:16:20.896788 [debug] [MainThread]: Command end result
[0m20:16:20.918546 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:16:20.920256 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:16:20.923048 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m20:16:20.923215 [info ] [MainThread]: 
[0m20:16:20.923422 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:16:20.923621 [info ] [MainThread]: 
[0m20:16:20.923856 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:16:20.925899 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.1489396, "process_in_blocks": "0", "process_kernel_time": 0.25137, "process_mem_max_rss": "238911488", "process_out_blocks": "0", "process_user_time": 1.441407}
[0m20:16:20.926306 [debug] [MainThread]: Command `dbt run` succeeded at 20:16:20.926250 after 6.15 seconds
[0m20:16:20.926505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b38ee60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c57b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c57b750>]}
[0m20:16:20.926687 [debug] [MainThread]: Flushing usage events
[0m20:16:21.257822 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:17:40.459202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10709be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11095f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11095fb10>]}


============================== 20:17:40.461664 | f2d4f706-c555-44d5-8321-329bc58e4221 ==============================
[0m20:17:40.461664 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:17:40.461929 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'log_cache_events': 'False', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'no_print': 'None', 'indirect_selection': 'eager', 'use_colors': 'True', 'printer_width': '80', 'version_check': 'True', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'introspect': 'True', 'quiet': 'False', 'partial_parse': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select gold', 'cache_selected_only': 'False', 'debug': 'False', 'log_format': 'default', 'static_parser': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False'}
[0m20:17:41.068278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2d4f706-c555-44d5-8321-329bc58e4221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078b0b00>]}
[0m20:17:41.091023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2d4f706-c555-44d5-8321-329bc58e4221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121500e20>]}
[0m20:17:41.091581 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:17:41.145090 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:17:41.204467 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:17:41.204733 [debug] [MainThread]: Partial parsing: added file: spotify_analytics://models/gold/schema.yml
[0m20:17:41.239645 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m20:17:41.244838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2d4f706-c555-44d5-8321-329bc58e4221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219fd750>]}
[0m20:17:41.278294 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:17:41.279875 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:17:41.295565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2d4f706-c555-44d5-8321-329bc58e4221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c489b0>]}
[0m20:17:41.295782 [info ] [MainThread]: Found 5 models, 11 data tests, 1 source, 604 macros
[0m20:17:41.295917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2d4f706-c555-44d5-8321-329bc58e4221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121bcaf90>]}
[0m20:17:41.296505 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:17:41.296717 [debug] [MainThread]: Command end result
[0m20:17:41.308128 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:17:41.309204 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:17:41.311189 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m20:17:41.312477 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.88206697, "process_in_blocks": "0", "process_kernel_time": 0.182239, "process_mem_max_rss": "211992576", "process_out_blocks": "0", "process_user_time": 0.942417}
[0m20:17:41.312704 [debug] [MainThread]: Command `dbt test` succeeded at 20:17:41.312668 after 0.88 seconds
[0m20:17:41.312848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ce7ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110855190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121bccad0>]}
[0m20:17:41.312976 [debug] [MainThread]: Flushing usage events
[0m20:17:41.686395 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:18:19.392025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e37e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c5f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c5fb10>]}


============================== 20:18:19.394529 | 07d2bfe4-e9bf-4888-9195-10ba6307eace ==============================
[0m20:18:19.394529 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:18:19.394786 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'warn_error': 'None', 'log_format': 'default', 'quiet': 'False', 'invocation_command': 'dbt test --select gold', 'write_json': 'True', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'use_experimental_parser': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'partial_parse': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'empty': 'None', 'target_path': 'None', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m20:18:19.993078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07d2bfe4-e9bf-4888-9195-10ba6307eace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072b0b00>]}
[0m20:18:20.015937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07d2bfe4-e9bf-4888-9195-10ba6307eace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119304e20>]}
[0m20:18:20.016478 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:18:20.070306 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:18:20.130602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:18:20.130932 [debug] [MainThread]: Partial parsing: updated file: spotify_analytics://models/gold/schema.yml
[0m20:18:20.236087 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m20:18:20.241370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07d2bfe4-e9bf-4888-9195-10ba6307eace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1198fce50>]}
[0m20:18:20.278544 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:18:20.280011 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:18:20.295906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07d2bfe4-e9bf-4888-9195-10ba6307eace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119df32f0>]}
[0m20:18:20.296118 [info ] [MainThread]: Found 5 models, 43 data tests, 1 source, 604 macros
[0m20:18:20.296253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07d2bfe4-e9bf-4888-9195-10ba6307eace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c2bbd0>]}
[0m20:18:20.297399 [info ] [MainThread]: 
[0m20:18:20.297533 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:18:20.297633 [info ] [MainThread]: 
[0m20:18:20.297829 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:18:20.299485 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m20:18:20.299688 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m20:18:20.306118 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m20:18:20.306968 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m20:18:20.307107 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m20:18:20.307239 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m20:18:20.307397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:18:20.307521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:18:21.626452 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.319 seconds
[0m20:18:21.627936 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m20:18:21.643935 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.336 seconds
[0m20:18:21.645051 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m20:18:21.815130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07d2bfe4-e9bf-4888-9195-10ba6307eace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a8e0d0>]}
[0m20:18:21.820793 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:18:21.821336 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:18:21.821717 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:18:21.822071 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:18:21.822479 [info ] [Thread-1 (]: 1 of 32 START test not_null_daily_user_stats_avg_track_duration_ms ............. [RUN]
[0m20:18:21.822895 [info ] [Thread-4 (]: 4 of 32 START test not_null_daily_user_stats_total_plays ....................... [RUN]
[0m20:18:21.823304 [info ] [Thread-3 (]: 3 of 32 START test not_null_daily_user_stats_total_listening_time_ms ........... [RUN]
[0m20:18:21.823530 [info ] [Thread-2 (]: 2 of 32 START test not_null_daily_user_stats_date .............................. [RUN]
[0m20:18:21.823904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155)
[0m20:18:21.824424 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282'
[0m20:18:21.824854 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87'
[0m20:18:21.825215 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9)
[0m20:18:21.825575 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:18:21.825839 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:18:21.826017 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:18:21.826210 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:18:21.841851 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m20:18:21.842956 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m20:18:21.845211 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m20:18:21.847093 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m20:18:21.847697 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:18:21.847943 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:18:21.848159 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:18:21.848336 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:18:21.859911 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m20:18:21.861085 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m20:18:21.862059 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m20:18:21.863089 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m20:18:21.863757 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m20:18:21.864098 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m20:18:21.864301 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.daily_user_stats
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m20:18:21.864610 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m20:18:21.864919 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m20:18:21.865089 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_track_duration_ms
from spotify_data.gold.daily_user_stats
where avg_track_duration_ms is null



  
  
      
    ) dbt_internal_test
[0m20:18:21.865262 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:18:21.865428 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.daily_user_stats
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m20:18:21.865599 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from spotify_data.gold.daily_user_stats
where date is null



  
  
      
    ) dbt_internal_test
[0m20:18:21.865755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:21.866188 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:18:21.866424 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:18:23.274377 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.408 seconds
[0m20:18:23.283691 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282: Close
[0m20:18:23.285174 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.419 seconds
[0m20:18:23.286709 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155: Close
[0m20:18:23.318620 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.452 seconds
[0m20:18:23.319750 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9: Close
[0m20:18:23.477676 [info ] [Thread-4 (]: 4 of 32 PASS not_null_daily_user_stats_total_plays ............................. [[32mPASS[0m in 1.65s]
[0m20:18:23.478505 [info ] [Thread-2 (]: 2 of 32 PASS not_null_daily_user_stats_date .................................... [[32mPASS[0m in 1.65s]
[0m20:18:23.479327 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:18:23.479880 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:18:23.480332 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:18:23.480850 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:18:23.481280 [info ] [Thread-4 (]: 5 of 32 START test not_null_daily_user_stats_unique_artists .................... [RUN]
[0m20:18:23.481718 [info ] [Thread-2 (]: 6 of 32 START test not_null_daily_user_stats_unique_tracks ..................... [RUN]
[0m20:18:23.482187 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282, now test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f)
[0m20:18:23.482532 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9, now test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac)
[0m20:18:23.482880 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:18:23.483193 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:18:23.488420 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m20:18:23.493919 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m20:18:23.495441 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:18:23.495671 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:18:23.497814 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m20:18:23.499938 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m20:18:23.498155 [info ] [Thread-1 (]: 1 of 32 PASS not_null_daily_user_stats_avg_track_duration_ms ................... [[32mPASS[0m in 1.67s]
[0m20:18:23.500553 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:18:23.500750 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:18:23.500954 [info ] [Thread-1 (]: 7 of 32 START test not_null_daily_user_stats_user_id ........................... [RUN]
[0m20:18:23.501190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155, now test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b)
[0m20:18:23.501744 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m20:18:23.502024 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:18:23.502333 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unique_artists
from spotify_data.gold.daily_user_stats
where unique_artists is null



  
  
      
    ) dbt_internal_test
[0m20:18:23.504844 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m20:18:23.505334 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m20:18:23.505555 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:18:23.505831 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unique_tracks
from spotify_data.gold.daily_user_stats
where unique_tracks is null



  
  
      
    ) dbt_internal_test
[0m20:18:23.506271 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:18:23.506553 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:18:23.508336 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m20:18:23.510038 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m20:18:23.510279 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from spotify_data.gold.daily_user_stats
where user_id is null



  
  
      
    ) dbt_internal_test
[0m20:18:23.510476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:24.199884 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.334 seconds
[0m20:18:24.202462 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87: Close
[0m20:18:24.369279 [info ] [Thread-3 (]: 3 of 32 PASS not_null_daily_user_stats_total_listening_time_ms ................. [[32mPASS[0m in 2.54s]
[0m20:18:24.370241 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:18:24.370704 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:18:24.371126 [info ] [Thread-3 (]: 8 of 32 START test not_null_device_usage_avg_track_duration_ms ................. [RUN]
[0m20:18:24.371643 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87, now test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003)
[0m20:18:24.372011 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:18:24.377593 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m20:18:24.378789 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:18:24.383158 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m20:18:24.383934 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m20:18:24.384120 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_track_duration_ms
from spotify_data.gold.device_usage
where avg_track_duration_ms is null



  
  
      
    ) dbt_internal_test
[0m20:18:24.384279 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:18:24.535600 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.025 seconds
[0m20:18:24.538511 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b: Close
[0m20:18:24.711763 [info ] [Thread-1 (]: 7 of 32 PASS not_null_daily_user_stats_user_id ................................. [[32mPASS[0m in 1.21s]
[0m20:18:24.712706 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:18:24.713216 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:18:24.713698 [info ] [Thread-1 (]: 9 of 32 START test not_null_device_usage_device_type ........................... [RUN]
[0m20:18:24.714235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b, now test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c)
[0m20:18:24.714650 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:18:24.719972 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m20:18:24.721168 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:18:24.723942 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m20:18:24.725204 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.220 seconds
[0m20:18:24.727496 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f: Close
[0m20:18:24.729590 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.223 seconds
[0m20:18:24.730145 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m20:18:24.731099 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac: Close
[0m20:18:24.731503 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select device_type
from spotify_data.gold.device_usage
where device_type is null



  
  
      
    ) dbt_internal_test
[0m20:18:24.732788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:24.878111 [info ] [Thread-2 (]: 6 of 32 PASS not_null_daily_user_stats_unique_tracks ........................... [[32mPASS[0m in 1.40s]
[0m20:18:24.878560 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:18:24.878799 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:18:24.879056 [info ] [Thread-2 (]: 10 of 32 START test not_null_device_usage_play_percentage ...................... [RUN]
[0m20:18:24.879274 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac, now test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2)
[0m20:18:24.879426 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:18:24.882086 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m20:18:24.882487 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:18:24.883701 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m20:18:24.884269 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m20:18:24.884615 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select play_percentage
from spotify_data.gold.device_usage
where play_percentage is null



  
  
      
    ) dbt_internal_test
[0m20:18:24.884811 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:18:25.042257 [info ] [Thread-4 (]: 5 of 32 PASS not_null_daily_user_stats_unique_artists .......................... [[32mPASS[0m in 1.56s]
[0m20:18:25.042732 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:18:25.043030 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:18:25.043354 [info ] [Thread-4 (]: 11 of 32 START test not_null_device_usage_total_listening_time_ms .............. [RUN]
[0m20:18:25.043729 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f, now test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2)
[0m20:18:25.044006 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:18:25.046262 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m20:18:25.046826 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:18:25.048704 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m20:18:25.049545 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m20:18:25.049811 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.device_usage
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m20:18:25.049974 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:18:25.390598 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.006 seconds
[0m20:18:25.391777 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003: Close
[0m20:18:25.466256 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.733 seconds
[0m20:18:25.467104 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c: Close
[0m20:18:25.548067 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.663 seconds
[0m20:18:25.551476 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2: Close
[0m20:18:25.556733 [info ] [Thread-3 (]: 8 of 32 PASS not_null_device_usage_avg_track_duration_ms ....................... [[32mPASS[0m in 1.18s]
[0m20:18:25.557518 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:18:25.558006 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:18:25.558488 [info ] [Thread-3 (]: 12 of 32 START test not_null_device_usage_total_plays .......................... [RUN]
[0m20:18:25.558966 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003, now test.spotify_analytics.not_null_device_usage_total_plays.90a295df48)
[0m20:18:25.559341 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:18:25.564556 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m20:18:25.565179 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:18:25.567515 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m20:18:25.568307 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m20:18:25.568667 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_device_usage_total_plays.90a295df48: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.device_usage
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m20:18:25.568975 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:18:25.629643 [info ] [Thread-1 (]: 9 of 32 PASS not_null_device_usage_device_type ................................. [[32mPASS[0m in 0.92s]
[0m20:18:25.630243 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:18:25.630577 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:18:25.630896 [info ] [Thread-1 (]: 13 of 32 START test not_null_top_artists_artist_name ........................... [RUN]
[0m20:18:25.631193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c, now test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e)
[0m20:18:25.631388 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:18:25.633900 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m20:18:25.634275 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:18:25.635488 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m20:18:25.636384 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m20:18:25.636582 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select artist_name
from spotify_data.gold.top_artists
where artist_name is null



  
  
      
    ) dbt_internal_test
[0m20:18:25.636738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:25.703533 [info ] [Thread-2 (]: 10 of 32 PASS not_null_device_usage_play_percentage ............................ [[32mPASS[0m in 0.82s]
[0m20:18:25.703976 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:18:25.704275 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:18:25.704701 [info ] [Thread-2 (]: 14 of 32 START test not_null_top_artists_first_played_at ....................... [RUN]
[0m20:18:25.705045 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2, now test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14)
[0m20:18:25.705325 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:18:25.707839 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m20:18:25.708322 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:18:25.709305 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m20:18:25.709932 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m20:18:25.710214 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_played_at
from spotify_data.gold.top_artists
where first_played_at is null



  
  
      
    ) dbt_internal_test
[0m20:18:25.710465 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:18:25.936853 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.887 seconds
[0m20:18:25.938017 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2: Close
[0m20:18:26.084071 [info ] [Thread-4 (]: 11 of 32 PASS not_null_device_usage_total_listening_time_ms .................... [[32mPASS[0m in 1.04s]
[0m20:18:26.084519 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:18:26.084729 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:18:26.084930 [info ] [Thread-4 (]: 15 of 32 START test not_null_top_artists_last_played_at ........................ [RUN]
[0m20:18:26.085192 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2, now test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca)
[0m20:18:26.085432 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:18:26.087726 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m20:18:26.088102 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:18:26.089306 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m20:18:26.089846 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m20:18:26.090010 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_played_at
from spotify_data.gold.top_artists
where last_played_at is null



  
  
      
    ) dbt_internal_test
[0m20:18:26.090164 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:18:26.474153 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.764 seconds
[0m20:18:26.474843 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.838 seconds
[0m20:18:26.476501 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14: Close
[0m20:18:26.477342 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e: Close
[0m20:18:26.562010 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.993 seconds
[0m20:18:26.562993 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_device_usage_total_plays.90a295df48: Close
[0m20:18:26.654437 [info ] [Thread-1 (]: 13 of 32 PASS not_null_top_artists_artist_name ................................. [[32mPASS[0m in 1.02s]
[0m20:18:26.655274 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:18:26.655720 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:18:26.656138 [info ] [Thread-1 (]: 16 of 32 START test not_null_top_artists_rank .................................. [RUN]
[0m20:18:26.656569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e, now test.spotify_analytics.not_null_top_artists_rank.d14513fc96)
[0m20:18:26.656906 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:18:26.659591 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m20:18:26.660169 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:18:26.661315 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m20:18:26.663192 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m20:18:26.663418 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_rank.d14513fc96: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rank
from spotify_data.gold.top_artists
where rank is null



  
  
      
    ) dbt_internal_test
[0m20:18:26.663597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:26.671601 [info ] [Thread-2 (]: 14 of 32 PASS not_null_top_artists_first_played_at ............................. [[32mPASS[0m in 0.97s]
[0m20:18:26.672137 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:18:26.672438 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:18:26.672759 [info ] [Thread-2 (]: 17 of 32 START test not_null_top_artists_total_listening_time_ms ............... [RUN]
[0m20:18:26.673666 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14, now test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c)
[0m20:18:26.674285 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:18:26.677303 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m20:18:26.679435 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:18:26.683028 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m20:18:26.686354 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m20:18:26.686678 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.top_artists
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m20:18:26.686879 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:18:26.828784 [info ] [Thread-3 (]: 12 of 32 PASS not_null_device_usage_total_plays ................................ [[32mPASS[0m in 1.27s]
[0m20:18:26.829154 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:18:26.829379 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:18:26.829761 [info ] [Thread-3 (]: 18 of 32 START test not_null_top_artists_total_plays ........................... [RUN]
[0m20:18:26.830219 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_plays.90a295df48, now test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11)
[0m20:18:26.830501 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:18:26.832981 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m20:18:26.833561 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:18:26.834618 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m20:18:26.835210 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m20:18:26.835490 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.top_artists
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m20:18:26.835758 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:18:26.922150 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.832 seconds
[0m20:18:26.923566 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca: Close
[0m20:18:27.071813 [info ] [Thread-4 (]: 15 of 32 PASS not_null_top_artists_last_played_at .............................. [[32mPASS[0m in 0.99s]
[0m20:18:27.072257 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:18:27.072532 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:18:27.072841 [info ] [Thread-4 (]: 19 of 32 START test not_null_top_artists_unique_tracks ......................... [RUN]
[0m20:18:27.073207 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca, now test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13)
[0m20:18:27.073477 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:18:27.076075 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m20:18:27.076604 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:18:27.077862 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m20:18:27.078564 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m20:18:27.078820 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unique_tracks
from spotify_data.gold.top_artists
where unique_tracks is null



  
  
      
    ) dbt_internal_test
[0m20:18:27.079044 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:18:27.411010 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.747 seconds
[0m20:18:27.412313 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_rank.d14513fc96: Close
[0m20:18:27.480962 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.794 seconds
[0m20:18:27.482734 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c: Close
[0m20:18:27.492643 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.657 seconds
[0m20:18:27.493580 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11: Close
[0m20:18:27.644387 [info ] [Thread-1 (]: 16 of 32 PASS not_null_top_artists_rank ........................................ [[32mPASS[0m in 0.99s]
[0m20:18:27.644846 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:18:27.645052 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:18:27.645331 [info ] [Thread-1 (]: 20 of 32 START test not_null_top_tracks_artist_name ............................ [RUN]
[0m20:18:27.645762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_rank.d14513fc96, now test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461)
[0m20:18:27.646193 [info ] [Thread-3 (]: 18 of 32 PASS not_null_top_artists_total_plays ................................. [[32mPASS[0m in 0.82s]
[0m20:18:27.646494 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:18:27.646860 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:18:27.649547 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m20:18:27.649834 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:18:27.650041 [info ] [Thread-3 (]: 21 of 32 START test not_null_top_tracks_first_played_at ........................ [RUN]
[0m20:18:27.650228 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11, now test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31)
[0m20:18:27.650451 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:18:27.652803 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m20:18:27.653384 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:18:27.655962 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m20:18:27.656392 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:18:27.657704 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m20:18:27.658347 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m20:18:27.658043 [info ] [Thread-2 (]: 17 of 32 PASS not_null_top_artists_total_listening_time_ms ..................... [[32mPASS[0m in 0.98s]
[0m20:18:27.658608 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select artist_name
from spotify_data.gold.top_tracks
where artist_name is null



  
  
      
    ) dbt_internal_test
[0m20:18:27.658930 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:18:27.659127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:27.659501 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m20:18:27.659718 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:18:27.660193 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_played_at
from spotify_data.gold.top_tracks
where first_played_at is null



  
  
      
    ) dbt_internal_test
[0m20:18:27.660501 [info ] [Thread-2 (]: 22 of 32 START test not_null_top_tracks_last_played_at ......................... [RUN]
[0m20:18:27.660760 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:18:27.661271 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c, now test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532)
[0m20:18:27.661886 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:18:27.664119 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m20:18:27.665068 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:18:27.666163 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m20:18:27.669399 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m20:18:27.669716 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_played_at
from spotify_data.gold.top_tracks
where last_played_at is null



  
  
      
    ) dbt_internal_test
[0m20:18:27.669963 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:18:27.829450 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.750 seconds
[0m20:18:27.831173 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13: Close
[0m20:18:28.248651 [info ] [Thread-4 (]: 19 of 32 PASS not_null_top_artists_unique_tracks ............................... [[32mPASS[0m in 1.18s]
[0m20:18:28.249430 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:18:28.249862 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:18:28.250298 [info ] [Thread-4 (]: 23 of 32 START test not_null_top_tracks_rank ................................... [RUN]
[0m20:18:28.250787 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13, now test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4)
[0m20:18:28.251178 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:18:28.255618 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m20:18:28.256463 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:18:28.342623 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m20:18:28.345000 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m20:18:28.345333 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rank
from spotify_data.gold.top_tracks
where rank is null



  
  
      
    ) dbt_internal_test
[0m20:18:28.345507 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:18:28.538690 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.868 seconds
[0m20:18:28.541050 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532: Close
[0m20:18:28.561385 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.901 seconds
[0m20:18:28.563471 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31: Close
[0m20:18:28.570620 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.911 seconds
[0m20:18:28.572271 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461: Close
[0m20:18:28.745415 [info ] [Thread-3 (]: 21 of 32 PASS not_null_top_tracks_first_played_at .............................. [[32mPASS[0m in 1.10s]
[0m20:18:28.745897 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:18:28.746077 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:18:28.746284 [info ] [Thread-3 (]: 24 of 32 START test not_null_top_tracks_total_listening_time_ms ................ [RUN]
[0m20:18:28.746682 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31, now test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac)
[0m20:18:28.746968 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:18:28.749428 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m20:18:28.750500 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:18:28.751664 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m20:18:28.752070 [info ] [Thread-1 (]: 20 of 32 PASS not_null_top_tracks_artist_name .................................. [[32mPASS[0m in 1.11s]
[0m20:18:28.752837 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:18:28.752412 [info ] [Thread-2 (]: 22 of 32 PASS not_null_top_tracks_last_played_at ............................... [[32mPASS[0m in 1.09s]
[0m20:18:28.753166 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:18:28.753516 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:18:28.753771 [info ] [Thread-1 (]: 25 of 32 START test not_null_top_tracks_total_plays ............................ [RUN]
[0m20:18:28.753979 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:18:28.754316 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m20:18:28.754528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461, now test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893)
[0m20:18:28.754792 [info ] [Thread-2 (]: 26 of 32 START test not_null_top_tracks_track_id ............................... [RUN]
[0m20:18:28.755085 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.top_tracks
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m20:18:28.755328 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:18:28.755628 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532, now test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78)
[0m20:18:28.755841 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:18:28.758812 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m20:18:28.759058 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:18:28.761324 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m20:18:28.761753 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:18:28.763502 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m20:18:28.763747 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:18:28.764757 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m20:18:28.765281 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m20:18:28.765478 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.top_tracks
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m20:18:28.765970 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m20:18:28.766202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:28.766406 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_id
from spotify_data.gold.top_tracks
where track_id is null



  
  
      
    ) dbt_internal_test
[0m20:18:28.769032 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:18:29.042942 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.697 seconds
[0m20:18:29.045862 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4: Close
[0m20:18:29.279031 [info ] [Thread-4 (]: 23 of 32 PASS not_null_top_tracks_rank ......................................... [[32mPASS[0m in 1.03s]
[0m20:18:29.280054 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:18:29.280607 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:18:29.281103 [info ] [Thread-4 (]: 27 of 32 START test not_null_top_tracks_track_name ............................. [RUN]
[0m20:18:29.281722 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4, now test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203)
[0m20:18:29.282182 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:18:29.287766 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m20:18:29.289028 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:18:29.292894 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m20:18:29.294332 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m20:18:29.294773 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_name
from spotify_data.gold.top_tracks
where track_name is null



  
  
      
    ) dbt_internal_test
[0m20:18:29.295119 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:18:29.489787 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.720 seconds
[0m20:18:29.490752 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.735 seconds
[0m20:18:29.493401 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78: Close
[0m20:18:29.494306 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.728 seconds
[0m20:18:29.496202 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac: Close
[0m20:18:29.498988 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893: Close
[0m20:18:29.695154 [info ] [Thread-3 (]: 24 of 32 PASS not_null_top_tracks_total_listening_time_ms ...................... [[32mPASS[0m in 0.95s]
[0m20:18:29.695514 [info ] [Thread-2 (]: 26 of 32 PASS not_null_top_tracks_track_id ..................................... [[32mPASS[0m in 0.94s]
[0m20:18:29.696021 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:18:29.696476 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:18:29.696838 [debug] [Thread-3 (]: Began running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:18:29.697201 [debug] [Thread-2 (]: Began running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:18:29.697570 [info ] [Thread-3 (]: 28 of 32 START test unique_device_usage_device_type ............................ [RUN]
[0m20:18:29.697885 [info ] [Thread-2 (]: 29 of 32 START test unique_top_artists_artist_name ............................. [RUN]
[0m20:18:29.698073 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac, now test.spotify_analytics.unique_device_usage_device_type.e75362861b)
[0m20:18:29.698238 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78, now test.spotify_analytics.unique_top_artists_artist_name.008ffa1533)
[0m20:18:29.698387 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:18:29.698602 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:18:29.703108 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m20:18:29.705686 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m20:18:29.706216 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:18:29.706452 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:18:29.708696 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m20:18:29.709581 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m20:18:29.710249 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m20:18:29.710496 [debug] [Thread-2 (]: On test.spotify_analytics.unique_top_artists_artist_name.008ffa1533: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    artist_name as unique_field,
    count(*) as n_records

from spotify_data.gold.top_artists
where artist_name is not null
group by artist_name
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:18:29.710986 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m20:18:29.711191 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:18:29.711355 [debug] [Thread-3 (]: On test.spotify_analytics.unique_device_usage_device_type.e75362861b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_device_usage_device_type.e75362861b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    device_type as unique_field,
    count(*) as n_records

from spotify_data.gold.device_usage
where device_type is not null
group by device_type
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:18:29.711716 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:18:29.773499 [info ] [Thread-1 (]: 25 of 32 PASS not_null_top_tracks_total_plays .................................. [[32mPASS[0m in 1.02s]
[0m20:18:29.773884 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:18:29.774091 [debug] [Thread-1 (]: Began running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:18:29.774312 [info ] [Thread-1 (]: 30 of 32 START test unique_top_artists_rank .................................... [RUN]
[0m20:18:29.774561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893, now test.spotify_analytics.unique_top_artists_rank.68b5480aed)
[0m20:18:29.774754 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:18:29.776705 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m20:18:29.777082 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:18:29.778079 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m20:18:29.778532 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m20:18:29.778693 [debug] [Thread-1 (]: On test.spotify_analytics.unique_top_artists_rank.68b5480aed: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_artists_rank.68b5480aed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rank as unique_field,
    count(*) as n_records

from spotify_data.gold.top_artists
where rank is not null
group by rank
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:18:29.778847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:30.013265 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.718 seconds
[0m20:18:30.014224 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203: Close
[0m20:18:30.209472 [info ] [Thread-4 (]: 27 of 32 PASS not_null_top_tracks_track_name ................................... [[32mPASS[0m in 0.93s]
[0m20:18:30.209921 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:18:30.210111 [debug] [Thread-4 (]: Began running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:18:30.210306 [info ] [Thread-4 (]: 31 of 32 START test unique_top_tracks_rank ..................................... [RUN]
[0m20:18:30.210553 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203, now test.spotify_analytics.unique_top_tracks_rank.8fecde1136)
[0m20:18:30.210785 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:18:30.213058 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m20:18:30.213519 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:18:30.214700 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m20:18:30.215246 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m20:18:30.215409 [debug] [Thread-4 (]: On test.spotify_analytics.unique_top_tracks_rank.8fecde1136: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rank as unique_field,
    count(*) as n_records

from spotify_data.gold.top_tracks
where rank is not null
group by rank
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:18:30.215556 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:18:30.518453 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.807 seconds
[0m20:18:30.520976 [debug] [Thread-2 (]: On test.spotify_analytics.unique_top_artists_artist_name.008ffa1533: Close
[0m20:18:30.594445 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.816 seconds
[0m20:18:30.596050 [debug] [Thread-1 (]: On test.spotify_analytics.unique_top_artists_rank.68b5480aed: Close
[0m20:18:30.645307 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.933 seconds
[0m20:18:30.647351 [debug] [Thread-3 (]: On test.spotify_analytics.unique_device_usage_device_type.e75362861b: Close
[0m20:18:30.759643 [info ] [Thread-1 (]: 30 of 32 PASS unique_top_artists_rank .......................................... [[32mPASS[0m in 0.98s]
[0m20:18:30.760464 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:18:30.760864 [debug] [Thread-1 (]: Began running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:18:30.761246 [info ] [Thread-1 (]: 32 of 32 START test unique_top_tracks_track_id ................................. [RUN]
[0m20:18:30.761668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_top_artists_rank.68b5480aed, now test.spotify_analytics.unique_top_tracks_track_id.865b43a659)
[0m20:18:30.762059 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:18:30.767352 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m20:18:30.768495 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:18:30.771082 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m20:18:30.772300 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m20:18:30.772595 [debug] [Thread-1 (]: On test.spotify_analytics.unique_top_tracks_track_id.865b43a659: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    track_id as unique_field,
    count(*) as n_records

from spotify_data.gold.top_tracks
where track_id is not null
group by track_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:18:30.772757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:30.791690 [info ] [Thread-3 (]: 28 of 32 PASS unique_device_usage_device_type .................................. [[32mPASS[0m in 1.09s]
[0m20:18:30.792046 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:18:31.058617 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.843 seconds
[0m20:18:31.061763 [debug] [Thread-4 (]: On test.spotify_analytics.unique_top_tracks_rank.8fecde1136: Close
[0m20:18:31.294539 [info ] [Thread-2 (]: 29 of 32 PASS unique_top_artists_artist_name ................................... [[32mPASS[0m in 1.60s]
[0m20:18:31.295540 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:18:31.321454 [info ] [Thread-4 (]: 31 of 32 PASS unique_top_tracks_rank ........................................... [[32mPASS[0m in 1.11s]
[0m20:18:31.322402 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:18:31.802636 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.030 seconds
[0m20:18:31.805898 [debug] [Thread-1 (]: On test.spotify_analytics.unique_top_tracks_track_id.865b43a659: Close
[0m20:18:31.978074 [info ] [Thread-1 (]: 32 of 32 PASS unique_top_tracks_track_id ....................................... [[32mPASS[0m in 1.22s]
[0m20:18:31.978595 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:18:31.979942 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:18:31.980298 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_track_id.865b43a659' was properly closed.
[0m20:18:31.980529 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_artists_artist_name.008ffa1533' was properly closed.
[0m20:18:31.980646 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_rank.8fecde1136' was properly closed.
[0m20:18:31.980752 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_device_usage_device_type.e75362861b' was properly closed.
[0m20:18:31.980901 [info ] [MainThread]: 
[0m20:18:31.981039 [info ] [MainThread]: Finished running 32 data tests in 0 hours 0 minutes and 11.68 seconds (11.68s).
[0m20:18:31.983533 [debug] [MainThread]: Command end result
[0m20:18:32.005087 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:18:32.006490 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:18:32.011127 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m20:18:32.011304 [info ] [MainThread]: 
[0m20:18:32.011486 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:18:32.011634 [info ] [MainThread]: 
[0m20:18:32.011793 [info ] [MainThread]: Done. PASS=32 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=32
[0m20:18:32.013467 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 12.650164, "process_in_blocks": "0", "process_kernel_time": 0.468761, "process_mem_max_rss": "247578624", "process_out_blocks": "0", "process_user_time": 3.936196}
[0m20:18:32.013702 [debug] [MainThread]: Command `dbt test` succeeded at 20:18:32.013656 after 12.65 seconds
[0m20:18:32.013915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b55190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119906a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119907280>]}
[0m20:18:32.014108 [debug] [MainThread]: Flushing usage events
[0m20:18:32.195535 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:19:00.469696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c2be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12495f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12495fb10>]}


============================== 20:19:00.472148 | ea57b8d5-edcf-42f4-b9bd-0fae636c28c3 ==============================
[0m20:19:00.472148 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:19:00.472411 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_format': 'default', 'quiet': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'empty': 'False', 'invocation_command': 'dbt run --models gold', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_colors': 'True', 'no_print': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'debug': 'False', 'printer_width': '80', 'write_json': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs'}
[0m20:19:00.472613 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m20:19:00.472759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ea57b8d5-edcf-42f4-b9bd-0fae636c28c3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1249b10f0>]}
[0m20:19:01.039798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea57b8d5-edcf-42f4-b9bd-0fae636c28c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133e04e20>]}
[0m20:19:01.062622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea57b8d5-edcf-42f4-b9bd-0fae636c28c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133dad250>]}
[0m20:19:01.063148 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:19:01.114671 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:19:01.171891 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:19:01.172079 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:19:01.174417 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m20:19:01.190758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea57b8d5-edcf-42f4-b9bd-0fae636c28c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1343033e0>]}
[0m20:19:01.229236 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:19:01.230790 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:19:01.242730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea57b8d5-edcf-42f4-b9bd-0fae636c28c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13453b310>]}
[0m20:19:01.242923 [info ] [MainThread]: Found 5 models, 43 data tests, 1 source, 604 macros
[0m20:19:01.243057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea57b8d5-edcf-42f4-b9bd-0fae636c28c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134562f70>]}
[0m20:19:01.243985 [info ] [MainThread]: 
[0m20:19:01.244127 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:19:01.244228 [info ] [MainThread]: 
[0m20:19:01.244425 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:19:01.246065 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m20:19:01.251869 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m20:19:01.252029 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m20:19:01.252139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:19:02.451734 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.200 seconds
[0m20:19:02.453074 [debug] [ThreadPool]: On list_spotify_data: Close
[0m20:19:02.607429 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_silver)
[0m20:19:02.614544 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m20:19:02.618470 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m20:19:02.620886 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m20:19:02.621101 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m20:19:02.621234 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m20:19:02.621381 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:19:02.621648 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:19:03.528733 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.907 seconds
[0m20:19:03.532345 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m20:19:03.746816 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.125 seconds
[0m20:19:03.749772 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m20:19:03.922168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea57b8d5-edcf-42f4-b9bd-0fae636c28c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134553650>]}
[0m20:19:03.926488 [debug] [Thread-3 (]: Began running node model.spotify_analytics.top_artists
[0m20:19:03.927049 [debug] [Thread-1 (]: Began running node model.spotify_analytics.daily_user_stats
[0m20:19:03.927455 [debug] [Thread-2 (]: Began running node model.spotify_analytics.device_usage
[0m20:19:03.927638 [debug] [Thread-4 (]: Began running node model.spotify_analytics.top_tracks
[0m20:19:03.927915 [info ] [Thread-3 (]: 3 of 4 START sql table model gold.top_artists .................................. [RUN]
[0m20:19:03.928263 [info ] [Thread-1 (]: 1 of 4 START sql table model gold.daily_user_stats ............................. [RUN]
[0m20:19:03.928697 [info ] [Thread-2 (]: 2 of 4 START sql table model gold.device_usage ................................. [RUN]
[0m20:19:03.929087 [info ] [Thread-4 (]: 4 of 4 START sql table model gold.top_tracks ................................... [RUN]
[0m20:19:03.929581 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.spotify_analytics.top_artists'
[0m20:19:03.929936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.daily_user_stats)
[0m20:19:03.930173 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.device_usage)
[0m20:19:03.930359 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.spotify_analytics.top_tracks'
[0m20:19:03.930519 [debug] [Thread-3 (]: Began compiling node model.spotify_analytics.top_artists
[0m20:19:03.930665 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.daily_user_stats
[0m20:19:03.930839 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.device_usage
[0m20:19:03.931102 [debug] [Thread-4 (]: Began compiling node model.spotify_analytics.top_tracks
[0m20:19:03.936128 [debug] [Thread-3 (]: Writing injected SQL for node "model.spotify_analytics.top_artists"
[0m20:19:03.939006 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.daily_user_stats"
[0m20:19:03.940877 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.device_usage"
[0m20:19:03.942531 [debug] [Thread-4 (]: Writing injected SQL for node "model.spotify_analytics.top_tracks"
[0m20:19:03.943515 [debug] [Thread-3 (]: Began executing node model.spotify_analytics.top_artists
[0m20:19:03.943686 [debug] [Thread-4 (]: Began executing node model.spotify_analytics.top_tracks
[0m20:19:03.943835 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.daily_user_stats
[0m20:19:03.956148 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.device_usage
[0m20:19:03.959581 [debug] [Thread-3 (]: Writing runtime sql for node "model.spotify_analytics.top_artists"
[0m20:19:03.960894 [debug] [Thread-4 (]: Writing runtime sql for node "model.spotify_analytics.top_tracks"
[0m20:19:03.961942 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.daily_user_stats"
[0m20:19:03.962995 [debug] [Thread-2 (]: Writing runtime sql for node "model.spotify_analytics.device_usage"
[0m20:19:03.963918 [debug] [Thread-3 (]: Using snowflake connection "model.spotify_analytics.top_artists"
[0m20:19:03.964628 [debug] [Thread-4 (]: Using snowflake connection "model.spotify_analytics.top_tracks"
[0m20:19:03.964894 [debug] [Thread-3 (]: On model.spotify_analytics.top_artists: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.top_artists"} */
create or replace transient table spotify_data.gold.top_artists
         as
        (

-- ============================================================================
-- GOLD LAYER: TOP ARTISTS BY PLAY COUNT
-- ============================================================================
-- Purpose: Aggregate and rank artists by popularity
-- 
-- Grain: One row per artist (all-time aggregation)
-- Primary Key: artist_name
--
-- Metrics:
--   - Total plays per artist
--   - Total listening time
--   - Number of unique tracks played
--   - First and last play timestamps
--   - Popularity rank
--
-- Source: SILVER.silver_plays
-- Target: GOLD.top_artists
-- ============================================================================

WITH artist_aggregates AS (
    SELECT 
        -- Artist identifier
        artist_name,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        COUNT(DISTINCT track_id) AS unique_tracks,
        MIN(played_at) AS first_played_at,
        MAX(played_at) AS last_played_at
        
    FROM spotify_data.silver.silver_plays
    GROUP BY artist_name
),

ranked_artists AS (
    SELECT 
        *,
        -- Add ranking based on play count (1 = most played artist)
        ROW_NUMBER() OVER (ORDER BY total_plays DESC, total_listening_time_ms DESC) AS rank
    FROM artist_aggregates
)

SELECT 
    -- Identifier
    artist_name::VARCHAR AS artist_name,
    
    -- Metrics
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    unique_tracks::NUMBER AS unique_tracks,
    
    -- Timestamps
    first_played_at::TIMESTAMP AS first_played_at,
    last_played_at::TIMESTAMP AS last_played_at,
    
    -- Ranking
    rank::NUMBER AS rank
    
FROM ranked_artists
ORDER BY rank
        );
[0m20:19:03.965160 [debug] [Thread-4 (]: On model.spotify_analytics.top_tracks: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.top_tracks"} */
create or replace transient table spotify_data.gold.top_tracks
         as
        (

-- ============================================================================
-- GOLD LAYER: TOP TRACKS BY PLAY COUNT
-- ============================================================================
-- Purpose: Aggregate and rank tracks by popularity
-- 
-- Grain: One row per track (all-time aggregation)
-- Primary Key: track_id
--
-- Metrics:
--   - Total plays per track
--   - Total listening time
--   - First and last play timestamps
--   - Popularity rank
--
-- Source: SILVER.silver_plays
-- Target: GOLD.top_tracks
-- ============================================================================

WITH track_aggregates AS (
    SELECT 
        -- Track identifiers and attributes
        track_id,
        track_name,
        artist_name,
        album_name,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        MIN(played_at) AS first_played_at,
        MAX(played_at) AS last_played_at
        
    FROM spotify_data.silver.silver_plays
    GROUP BY 
        track_id,
        track_name,
        artist_name,
        album_name
),

ranked_tracks AS (
    SELECT 
        *,
        -- Add ranking based on play count (1 = most played)
        ROW_NUMBER() OVER (ORDER BY total_plays DESC, total_listening_time_ms DESC) AS rank
    FROM track_aggregates
)

SELECT 
    -- Identifiers
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    
    -- Timestamps
    first_played_at::TIMESTAMP AS first_played_at,
    last_played_at::TIMESTAMP AS last_played_at,
    
    -- Ranking
    rank::NUMBER AS rank
    
FROM ranked_tracks
ORDER BY rank
        );
[0m20:19:03.965796 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.daily_user_stats"
[0m20:19:03.965953 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:19:03.966559 [debug] [Thread-2 (]: Using snowflake connection "model.spotify_analytics.device_usage"
[0m20:19:03.966732 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:19:03.966938 [debug] [Thread-1 (]: On model.spotify_analytics.daily_user_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.daily_user_stats"} */
create or replace transient table spotify_data.gold.daily_user_stats
         as
        (

-- ============================================================================
-- GOLD LAYER: DAILY USER LISTENING STATISTICS
-- ============================================================================
-- Purpose: Aggregate user listening behavior by day
-- 
-- Grain: One row per user per day
-- Primary Key: (date, user_id)
--
-- Metrics:
--   - Total plays per day
--   - Total listening time
--   - Unique tracks/artists played
--   - Average track duration
--
-- Source: SILVER.silver_plays
-- Target: GOLD.daily_user_stats
-- ============================================================================

WITH daily_aggregates AS (
    SELECT 
        -- Date dimension (truncate timestamp to date)
        DATE(played_at) AS date,
        
        -- User identifier
        user_id,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        COUNT(DISTINCT track_id) AS unique_tracks,
        COUNT(DISTINCT artist_name) AS unique_artists,
        AVG(duration_ms) AS avg_track_duration_ms
        
    FROM spotify_data.silver.silver_plays
    GROUP BY 
        DATE(played_at),
        user_id
)

SELECT 
    -- Dimensions
    date,
    user_id,
    
    -- Metrics (cast for clarity)
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    unique_tracks::NUMBER AS unique_tracks,
    unique_artists::NUMBER AS unique_artists,
    ROUND(avg_track_duration_ms, 2)::NUMBER AS avg_track_duration_ms
    
FROM daily_aggregates
ORDER BY date DESC, user_id
        );
[0m20:19:03.967226 [debug] [Thread-2 (]: On model.spotify_analytics.device_usage: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.device_usage"} */
create or replace transient table spotify_data.gold.device_usage
         as
        (

-- ============================================================================
-- GOLD LAYER: DEVICE USAGE STATISTICS
-- ============================================================================
-- Purpose: Aggregate listening behavior by device type
-- 
-- Grain: One row per device type (all-time aggregation)
-- Primary Key: device_type
--
-- Metrics:
--   - Total plays per device
--   - Total listening time
--   - Percentage of total plays
--   - Average track duration
--
-- Source: SILVER.silver_plays
-- Target: GOLD.device_usage
-- ============================================================================

WITH device_aggregates AS (
    SELECT 
        -- Device identifier
        device_type,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        AVG(duration_ms) AS avg_track_duration_ms
        
    FROM spotify_data.silver.silver_plays
    GROUP BY device_type
),

total_plays_calc AS (
    -- Calculate overall total for percentage calculation
    SELECT SUM(total_plays) AS overall_total_plays
    FROM device_aggregates
)

SELECT 
    -- Identifier
    device_type::VARCHAR AS device_type,
    
    -- Metrics
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    
    -- Percentage of total plays
    ROUND((total_plays::FLOAT / overall_total_plays::FLOAT) * 100, 2)::FLOAT AS play_percentage,
    
    -- Average duration
    ROUND(avg_track_duration_ms, 2)::NUMBER AS avg_track_duration_ms
    
FROM device_aggregates
CROSS JOIN total_plays_calc
ORDER BY total_plays DESC
        );
[0m20:19:03.967733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:03.968060 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:19:05.580151 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.612 seconds
[0m20:19:05.581230 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.615 seconds
[0m20:19:05.609171 [debug] [Thread-1 (]: On model.spotify_analytics.daily_user_stats: Close
[0m20:19:05.610168 [debug] [Thread-3 (]: On model.spotify_analytics.top_artists: Close
[0m20:19:05.610550 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.642 seconds
[0m20:19:05.612775 [debug] [Thread-2 (]: On model.spotify_analytics.device_usage: Close
[0m20:19:05.665134 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.698 seconds
[0m20:19:05.666442 [debug] [Thread-4 (]: On model.spotify_analytics.top_tracks: Close
[0m20:19:05.797630 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea57b8d5-edcf-42f4-b9bd-0fae636c28c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123f37490>]}
[0m20:19:05.798112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea57b8d5-edcf-42f4-b9bd-0fae636c28c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122f39c70>]}
[0m20:19:05.798983 [info ] [Thread-2 (]: 2 of 4 OK created sql table model gold.device_usage ............................ [[32mSUCCESS 1[0m in 1.87s]
[0m20:19:05.799535 [info ] [Thread-1 (]: 1 of 4 OK created sql table model gold.daily_user_stats ........................ [[32mSUCCESS 1[0m in 1.87s]
[0m20:19:05.799889 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.device_usage
[0m20:19:05.800259 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.daily_user_stats
[0m20:19:05.812854 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea57b8d5-edcf-42f4-b9bd-0fae636c28c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e293550>]}
[0m20:19:05.813286 [info ] [Thread-4 (]: 4 of 4 OK created sql table model gold.top_tracks .............................. [[32mSUCCESS 1[0m in 1.88s]
[0m20:19:05.813645 [debug] [Thread-4 (]: Finished running node model.spotify_analytics.top_tracks
[0m20:19:05.815732 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea57b8d5-edcf-42f4-b9bd-0fae636c28c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13cf13f50>]}
[0m20:19:05.816021 [info ] [Thread-3 (]: 3 of 4 OK created sql table model gold.top_artists ............................. [[32mSUCCESS 1[0m in 1.89s]
[0m20:19:05.816356 [debug] [Thread-3 (]: Finished running node model.spotify_analytics.top_artists
[0m20:19:05.817624 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:19:05.817852 [debug] [MainThread]: Connection 'model.spotify_analytics.daily_user_stats' was properly closed.
[0m20:19:05.818036 [debug] [MainThread]: Connection 'model.spotify_analytics.device_usage' was properly closed.
[0m20:19:05.818176 [debug] [MainThread]: Connection 'model.spotify_analytics.top_artists' was properly closed.
[0m20:19:05.818281 [debug] [MainThread]: Connection 'model.spotify_analytics.top_tracks' was properly closed.
[0m20:19:05.818429 [info ] [MainThread]: 
[0m20:19:05.818564 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 4.57 seconds (4.57s).
[0m20:19:05.819306 [debug] [MainThread]: Command end result
[0m20:19:05.841309 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:19:05.842869 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:19:05.846287 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m20:19:05.846456 [info ] [MainThread]: 
[0m20:19:05.846634 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:19:05.846771 [info ] [MainThread]: 
[0m20:19:05.846922 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m20:19:05.847182 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:19:05.848741 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.4067097, "process_in_blocks": "0", "process_kernel_time": 0.266243, "process_mem_max_rss": "240500736", "process_out_blocks": "0", "process_user_time": 1.614838}
[0m20:19:05.848970 [debug] [MainThread]: Command `dbt run` succeeded at 20:19:05.848925 after 5.41 seconds
[0m20:19:05.849143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c125d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13cfe9a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13cfe8cb0>]}
[0m20:19:05.849313 [debug] [MainThread]: Flushing usage events
[0m20:19:06.141317 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:19:13.825446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ec7e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094cb9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094cbb10>]}


============================== 20:19:13.827754 | d7755408-29fd-4a6c-b45b-0fa864dcab38 ==============================
[0m20:19:13.827754 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:19:13.828004 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/sunilmakkar/.dbt', 'indirect_selection': 'eager', 'invocation_command': 'dbt test --models gold', 'quiet': 'False', 'introspect': 'True', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'version_check': 'True', 'use_colors': 'True', 'debug': 'False', 'partial_parse': 'True', 'target_path': 'None', 'write_json': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'empty': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False'}
[0m20:19:13.828206 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m20:19:13.828356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd7755408-29fd-4a6c-b45b-0fa864dcab38', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10951d0f0>]}
[0m20:19:14.251598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7755408-29fd-4a6c-b45b-0fa864dcab38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101bce20>]}
[0m20:19:14.275376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7755408-29fd-4a6c-b45b-0fa864dcab38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f1250>]}
[0m20:19:14.275941 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:19:14.329247 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:19:14.388407 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:19:14.388597 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:19:14.390946 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m20:19:14.407685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7755408-29fd-4a6c-b45b-0fa864dcab38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105bf2f0>]}
[0m20:19:14.445055 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:19:14.446162 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:19:14.462045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7755408-29fd-4a6c-b45b-0fa864dcab38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11081fcb0>]}
[0m20:19:14.462248 [info ] [MainThread]: Found 5 models, 43 data tests, 1 source, 604 macros
[0m20:19:14.462385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7755408-29fd-4a6c-b45b-0fa864dcab38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11092d230>]}
[0m20:19:14.463546 [info ] [MainThread]: 
[0m20:19:14.463680 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:19:14.463782 [info ] [MainThread]: 
[0m20:19:14.463976 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:19:14.465660 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m20:19:14.472786 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m20:19:14.472643 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m20:19:14.473641 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m20:19:14.473789 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m20:19:14.473918 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m20:19:14.474036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:19:14.474171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:19:15.589867 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.116 seconds
[0m20:19:15.591629 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m20:19:15.618378 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.144 seconds
[0m20:19:15.619190 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m20:19:15.775970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7755408-29fd-4a6c-b45b-0fa864dcab38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108cc590>]}
[0m20:19:15.780971 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:19:15.781420 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:19:15.781784 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:19:15.782114 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:19:15.782499 [info ] [Thread-3 (]: 3 of 32 START test not_null_daily_user_stats_total_listening_time_ms ........... [RUN]
[0m20:19:15.782931 [info ] [Thread-4 (]: 4 of 32 START test not_null_daily_user_stats_total_plays ....................... [RUN]
[0m20:19:15.783358 [info ] [Thread-1 (]: 1 of 32 START test not_null_daily_user_stats_avg_track_duration_ms ............. [RUN]
[0m20:19:15.783739 [info ] [Thread-2 (]: 2 of 32 START test not_null_daily_user_stats_date .............................. [RUN]
[0m20:19:15.784247 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87'
[0m20:19:15.784658 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282'
[0m20:19:15.784993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155)
[0m20:19:15.785312 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9)
[0m20:19:15.785623 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:19:15.785922 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:19:15.786223 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:19:15.786506 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:19:15.803575 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m20:19:15.804658 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m20:19:15.806964 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m20:19:15.808597 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m20:19:15.809347 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:19:15.809622 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:19:15.815888 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:19:15.816074 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:19:15.821885 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m20:19:15.823157 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m20:19:15.824099 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m20:19:15.825258 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m20:19:15.825836 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m20:19:15.826035 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.daily_user_stats
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m20:19:15.826345 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m20:19:15.826492 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:19:15.826675 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from spotify_data.gold.daily_user_stats
where date is null



  
  
      
    ) dbt_internal_test
[0m20:19:15.826978 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m20:19:15.827298 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m20:19:15.827702 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:19:15.827989 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.daily_user_stats
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m20:19:15.828263 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_track_duration_ms
from spotify_data.gold.daily_user_stats
where avg_track_duration_ms is null



  
  
      
    ) dbt_internal_test
[0m20:19:15.829174 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:19:15.829464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:16.623925 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.794 seconds
[0m20:19:16.625147 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.797 seconds
[0m20:19:16.637561 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155: Close
[0m20:19:16.639639 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9: Close
[0m20:19:16.799560 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.973 seconds
[0m20:19:16.801467 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282: Close
[0m20:19:16.832381 [info ] [Thread-2 (]: 2 of 32 PASS not_null_daily_user_stats_date .................................... [[32mPASS[0m in 1.05s]
[0m20:19:16.833281 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:19:16.833818 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:19:16.834316 [info ] [Thread-2 (]: 5 of 32 START test not_null_daily_user_stats_unique_artists .................... [RUN]
[0m20:19:16.834807 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9, now test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f)
[0m20:19:16.835160 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:19:16.840020 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m20:19:16.842982 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:19:16.846178 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m20:19:16.846881 [info ] [Thread-1 (]: 1 of 32 PASS not_null_daily_user_stats_avg_track_duration_ms ................... [[32mPASS[0m in 1.06s]
[0m20:19:16.847577 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:19:16.847768 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:19:16.847938 [info ] [Thread-1 (]: 6 of 32 START test not_null_daily_user_stats_unique_tracks ..................... [RUN]
[0m20:19:16.848177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155, now test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac)
[0m20:19:16.848829 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m20:19:16.849223 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:19:16.849576 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unique_artists
from spotify_data.gold.daily_user_stats
where unique_artists is null



  
  
      
    ) dbt_internal_test
[0m20:19:16.852680 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m20:19:16.853052 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:19:16.853822 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.025 seconds
[0m20:19:16.855463 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87: Close
[0m20:19:16.856759 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:19:16.858730 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m20:19:16.859825 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m20:19:16.860526 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unique_tracks
from spotify_data.gold.daily_user_stats
where unique_tracks is null



  
  
      
    ) dbt_internal_test
[0m20:19:16.860829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:16.985157 [info ] [Thread-4 (]: 4 of 32 PASS not_null_daily_user_stats_total_plays ............................. [[32mPASS[0m in 1.20s]
[0m20:19:16.985474 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:19:16.985635 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:19:16.985813 [info ] [Thread-4 (]: 7 of 32 START test not_null_daily_user_stats_user_id ........................... [RUN]
[0m20:19:16.986016 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282, now test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b)
[0m20:19:16.986171 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:19:16.987834 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m20:19:16.988185 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:19:16.989426 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m20:19:16.989840 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m20:19:16.989986 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from spotify_data.gold.daily_user_stats
where user_id is null



  
  
      
    ) dbt_internal_test
[0m20:19:16.990117 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:19:17.033938 [info ] [Thread-3 (]: 3 of 32 PASS not_null_daily_user_stats_total_listening_time_ms ................. [[32mPASS[0m in 1.25s]
[0m20:19:17.034262 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:19:17.034428 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:19:17.034589 [info ] [Thread-3 (]: 8 of 32 START test not_null_device_usage_avg_track_duration_ms ................. [RUN]
[0m20:19:17.034754 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87, now test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003)
[0m20:19:17.034895 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:19:17.036534 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m20:19:17.036908 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:19:17.038130 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m20:19:17.038676 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m20:19:17.038825 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_track_duration_ms
from spotify_data.gold.device_usage
where avg_track_duration_ms is null



  
  
      
    ) dbt_internal_test
[0m20:19:17.038961 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:19:17.576021 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.723 seconds
[0m20:19:17.578544 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f: Close
[0m20:19:17.619950 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.759 seconds
[0m20:19:17.622561 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac: Close
[0m20:19:17.734826 [info ] [Thread-2 (]: 5 of 32 PASS not_null_daily_user_stats_unique_artists .......................... [[32mPASS[0m in 0.90s]
[0m20:19:17.735770 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:19:17.736302 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:19:17.736804 [info ] [Thread-2 (]: 9 of 32 START test not_null_device_usage_device_type ........................... [RUN]
[0m20:19:17.737419 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f, now test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c)
[0m20:19:17.737875 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:19:17.743333 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m20:19:17.744614 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:19:17.747408 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m20:19:17.750212 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m20:19:17.750719 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select device_type
from spotify_data.gold.device_usage
where device_type is null



  
  
      
    ) dbt_internal_test
[0m20:19:17.751072 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:19:17.789011 [info ] [Thread-1 (]: 6 of 32 PASS not_null_daily_user_stats_unique_tracks ........................... [[32mPASS[0m in 0.94s]
[0m20:19:17.789338 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:19:17.789547 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:19:17.789868 [info ] [Thread-1 (]: 10 of 32 START test not_null_device_usage_play_percentage ...................... [RUN]
[0m20:19:17.790249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac, now test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2)
[0m20:19:17.790530 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:19:17.792687 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m20:19:17.793031 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:19:17.794364 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m20:19:17.794854 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m20:19:17.795034 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select play_percentage
from spotify_data.gold.device_usage
where play_percentage is null



  
  
      
    ) dbt_internal_test
[0m20:19:17.795309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:17.835411 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.796 seconds
[0m20:19:17.836717 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003: Close
[0m20:19:17.992646 [info ] [Thread-3 (]: 8 of 32 PASS not_null_device_usage_avg_track_duration_ms ....................... [[32mPASS[0m in 0.96s]
[0m20:19:17.993605 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:19:17.994111 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:19:17.994579 [info ] [Thread-3 (]: 11 of 32 START test not_null_device_usage_total_listening_time_ms .............. [RUN]
[0m20:19:17.995137 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003, now test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2)
[0m20:19:17.995547 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:19:18.001031 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m20:19:18.002186 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:19:18.004284 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m20:19:18.005109 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m20:19:18.005292 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.device_usage
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m20:19:18.005457 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:19:18.600631 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.849 seconds
[0m20:19:18.603438 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c: Close
[0m20:19:18.757814 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.752 seconds
[0m20:19:18.761247 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2: Close
[0m20:19:18.764602 [info ] [Thread-2 (]: 9 of 32 PASS not_null_device_usage_device_type ................................. [[32mPASS[0m in 1.03s]
[0m20:19:18.765380 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:19:18.765805 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:19:18.766227 [info ] [Thread-2 (]: 12 of 32 START test not_null_device_usage_total_plays .......................... [RUN]
[0m20:19:18.766817 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c, now test.spotify_analytics.not_null_device_usage_total_plays.90a295df48)
[0m20:19:18.767270 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:19:18.772300 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m20:19:18.773697 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:19:18.775981 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m20:19:18.777178 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m20:19:18.777611 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_device_usage_total_plays.90a295df48: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.device_usage
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m20:19:18.777926 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:19:18.906248 [info ] [Thread-3 (]: 11 of 32 PASS not_null_device_usage_total_listening_time_ms .................... [[32mPASS[0m in 0.91s]
[0m20:19:18.907191 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:19:18.907738 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:19:18.908279 [info ] [Thread-3 (]: 13 of 32 START test not_null_top_artists_artist_name ........................... [RUN]
[0m20:19:18.908865 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2, now test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e)
[0m20:19:18.909182 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:19:18.914369 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m20:19:18.915506 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:19:18.917944 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m20:19:18.919040 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m20:19:18.919436 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select artist_name
from spotify_data.gold.top_artists
where artist_name is null



  
  
      
    ) dbt_internal_test
[0m20:19:18.919649 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:19:18.977074 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.987 seconds
[0m20:19:18.978579 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b: Close
[0m20:19:19.177701 [info ] [Thread-4 (]: 7 of 32 PASS not_null_daily_user_stats_user_id ................................. [[32mPASS[0m in 2.19s]
[0m20:19:19.178258 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:19:19.178437 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:19:19.178631 [info ] [Thread-4 (]: 14 of 32 START test not_null_top_artists_first_played_at ....................... [RUN]
[0m20:19:19.178917 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b, now test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14)
[0m20:19:19.179241 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:19:19.181990 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m20:19:19.182590 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:19:19.183988 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m20:19:19.184514 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m20:19:19.184784 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_played_at
from spotify_data.gold.top_artists
where first_played_at is null



  
  
      
    ) dbt_internal_test
[0m20:19:19.185029 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:19:19.406101 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.611 seconds
[0m20:19:19.408754 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2: Close
[0m20:19:19.502689 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.725 seconds
[0m20:19:19.504253 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_device_usage_total_plays.90a295df48: Close
[0m20:19:19.592998 [info ] [Thread-1 (]: 10 of 32 PASS not_null_device_usage_play_percentage ............................ [[32mPASS[0m in 1.80s]
[0m20:19:19.593840 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:19:19.594231 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:19:19.594431 [info ] [Thread-1 (]: 15 of 32 START test not_null_top_artists_last_played_at ........................ [RUN]
[0m20:19:19.594660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2, now test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca)
[0m20:19:19.594824 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:19:19.597637 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m20:19:19.598033 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:19:19.599720 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m20:19:19.600873 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m20:19:19.601179 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_played_at
from spotify_data.gold.top_artists
where last_played_at is null



  
  
      
    ) dbt_internal_test
[0m20:19:19.601453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:19.655872 [info ] [Thread-2 (]: 12 of 32 PASS not_null_device_usage_total_plays ................................ [[32mPASS[0m in 0.89s]
[0m20:19:19.656299 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:19:19.656628 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:19:19.656895 [info ] [Thread-2 (]: 16 of 32 START test not_null_top_artists_rank .................................. [RUN]
[0m20:19:19.657160 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_plays.90a295df48, now test.spotify_analytics.not_null_top_artists_rank.d14513fc96)
[0m20:19:19.657381 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:19:19.659422 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m20:19:19.659766 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:19:19.660981 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m20:19:19.661376 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m20:19:19.661532 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_rank.d14513fc96: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rank
from spotify_data.gold.top_artists
where rank is null



  
  
      
    ) dbt_internal_test
[0m20:19:19.661677 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:19:19.680630 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.761 seconds
[0m20:19:19.681653 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e: Close
[0m20:19:19.828963 [info ] [Thread-3 (]: 13 of 32 PASS not_null_top_artists_artist_name ................................. [[32mPASS[0m in 0.92s]
[0m20:19:19.829716 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:19:19.830150 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:19:19.830582 [info ] [Thread-3 (]: 17 of 32 START test not_null_top_artists_total_listening_time_ms ............... [RUN]
[0m20:19:19.831222 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e, now test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c)
[0m20:19:19.831592 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:19:19.836423 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m20:19:19.837501 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:19:19.839706 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m20:19:19.840252 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m20:19:19.840588 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.top_artists
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m20:19:19.841227 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:19:19.895138 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.710 seconds
[0m20:19:19.896219 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14: Close
[0m20:19:20.037862 [info ] [Thread-4 (]: 14 of 32 PASS not_null_top_artists_first_played_at ............................. [[32mPASS[0m in 0.86s]
[0m20:19:20.038305 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:19:20.038531 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:19:20.038764 [info ] [Thread-4 (]: 18 of 32 START test not_null_top_artists_total_plays ........................... [RUN]
[0m20:19:20.039022 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14, now test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11)
[0m20:19:20.039217 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:19:20.041332 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m20:19:20.042270 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:19:20.043939 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m20:19:20.044711 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m20:19:20.044955 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.top_artists
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m20:19:20.045128 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:19:20.357624 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.756 seconds
[0m20:19:20.360283 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca: Close
[0m20:19:20.362448 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.701 seconds
[0m20:19:20.364292 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_rank.d14513fc96: Close
[0m20:19:20.520989 [info ] [Thread-1 (]: 15 of 32 PASS not_null_top_artists_last_played_at .............................. [[32mPASS[0m in 0.93s]
[0m20:19:20.521672 [info ] [Thread-2 (]: 16 of 32 PASS not_null_top_artists_rank ........................................ [[32mPASS[0m in 0.86s]
[0m20:19:20.522414 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:19:20.523035 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:19:20.523537 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:19:20.524049 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:19:20.524539 [info ] [Thread-1 (]: 19 of 32 START test not_null_top_artists_unique_tracks ......................... [RUN]
[0m20:19:20.525452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca, now test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13)
[0m20:19:20.525013 [info ] [Thread-2 (]: 20 of 32 START test not_null_top_tracks_artist_name ............................ [RUN]
[0m20:19:20.525903 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:19:20.526281 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_rank.d14513fc96, now test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461)
[0m20:19:20.531387 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m20:19:20.531855 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:19:20.535967 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m20:19:20.537500 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:19:20.537911 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:19:20.540700 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m20:19:20.541702 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m20:19:20.542386 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m20:19:20.542904 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m20:19:20.543187 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unique_tracks
from spotify_data.gold.top_artists
where unique_tracks is null



  
  
      
    ) dbt_internal_test
[0m20:19:20.543475 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select artist_name
from spotify_data.gold.top_tracks
where artist_name is null



  
  
      
    ) dbt_internal_test
[0m20:19:20.543659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:20.543797 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:19:20.560428 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.719 seconds
[0m20:19:20.561521 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c: Close
[0m20:19:20.721290 [info ] [Thread-3 (]: 17 of 32 PASS not_null_top_artists_total_listening_time_ms ..................... [[32mPASS[0m in 0.89s]
[0m20:19:20.721797 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:19:20.722058 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:19:20.722321 [info ] [Thread-3 (]: 21 of 32 START test not_null_top_tracks_first_played_at ........................ [RUN]
[0m20:19:20.722587 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c, now test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31)
[0m20:19:20.722772 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:19:20.725237 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m20:19:20.725638 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:19:20.726927 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m20:19:20.727491 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m20:19:20.727721 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_played_at
from spotify_data.gold.top_tracks
where first_played_at is null



  
  
      
    ) dbt_internal_test
[0m20:19:20.727908 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:19:20.828904 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.784 seconds
[0m20:19:20.829908 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11: Close
[0m20:19:20.993228 [info ] [Thread-4 (]: 18 of 32 PASS not_null_top_artists_total_plays ................................. [[32mPASS[0m in 0.95s]
[0m20:19:20.993748 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:19:20.994048 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:19:20.994313 [info ] [Thread-4 (]: 22 of 32 START test not_null_top_tracks_last_played_at ......................... [RUN]
[0m20:19:20.994550 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11, now test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532)
[0m20:19:20.994725 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:19:20.996904 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m20:19:20.997273 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:19:20.998276 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m20:19:21.000914 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m20:19:21.001239 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_played_at
from spotify_data.gold.top_tracks
where last_played_at is null



  
  
      
    ) dbt_internal_test
[0m20:19:21.001477 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:19:21.275695 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.732 seconds
[0m20:19:21.278909 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13: Close
[0m20:19:21.348727 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.805 seconds
[0m20:19:21.349904 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461: Close
[0m20:19:21.426172 [info ] [Thread-1 (]: 19 of 32 PASS not_null_top_artists_unique_tracks ............................... [[32mPASS[0m in 0.90s]
[0m20:19:21.426591 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:19:21.426790 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:19:21.426987 [info ] [Thread-1 (]: 23 of 32 START test not_null_top_tracks_rank ................................... [RUN]
[0m20:19:21.427437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13, now test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4)
[0m20:19:21.427849 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:19:21.430342 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m20:19:21.431588 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:19:21.432768 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m20:19:21.433753 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m20:19:21.433935 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rank
from spotify_data.gold.top_tracks
where rank is null



  
  
      
    ) dbt_internal_test
[0m20:19:21.434097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:21.475674 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.748 seconds
[0m20:19:21.477161 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31: Close
[0m20:19:21.589305 [info ] [Thread-2 (]: 20 of 32 PASS not_null_top_tracks_artist_name .................................. [[32mPASS[0m in 1.06s]
[0m20:19:21.589701 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:19:21.589982 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:19:21.590288 [info ] [Thread-2 (]: 24 of 32 START test not_null_top_tracks_total_listening_time_ms ................ [RUN]
[0m20:19:21.590652 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461, now test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac)
[0m20:19:21.590918 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:19:21.593082 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m20:19:21.593512 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:19:21.594614 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m20:19:21.595113 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m20:19:21.595326 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.top_tracks
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m20:19:21.595526 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:19:21.630764 [info ] [Thread-3 (]: 21 of 32 PASS not_null_top_tracks_first_played_at .............................. [[32mPASS[0m in 0.91s]
[0m20:19:21.631183 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:19:21.631398 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:19:21.631629 [info ] [Thread-3 (]: 25 of 32 START test not_null_top_tracks_total_plays ............................ [RUN]
[0m20:19:21.631867 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31, now test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893)
[0m20:19:21.632040 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:19:21.634165 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m20:19:21.634555 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:19:21.635599 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m20:19:21.636090 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m20:19:21.636278 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.top_tracks
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m20:19:21.636452 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:19:21.764842 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.763 seconds
[0m20:19:21.765892 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532: Close
[0m20:19:21.929569 [info ] [Thread-4 (]: 22 of 32 PASS not_null_top_tracks_last_played_at ............................... [[32mPASS[0m in 0.93s]
[0m20:19:21.930608 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:19:21.931109 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:19:21.931586 [info ] [Thread-4 (]: 26 of 32 START test not_null_top_tracks_track_id ............................... [RUN]
[0m20:19:21.932151 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532, now test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78)
[0m20:19:21.932561 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:19:21.938371 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m20:19:21.939036 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:19:21.941152 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m20:19:21.941874 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m20:19:21.942430 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_id
from spotify_data.gold.top_tracks
where track_id is null



  
  
      
    ) dbt_internal_test
[0m20:19:21.942990 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:19:22.343869 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.748 seconds
[0m20:19:22.345778 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac: Close
[0m20:19:22.385716 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.749 seconds
[0m20:19:22.388282 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893: Close
[0m20:19:22.498309 [info ] [Thread-2 (]: 24 of 32 PASS not_null_top_tracks_total_listening_time_ms ...................... [[32mPASS[0m in 0.91s]
[0m20:19:22.499221 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:19:22.499696 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:19:22.500155 [info ] [Thread-2 (]: 27 of 32 START test not_null_top_tracks_track_name ............................. [RUN]
[0m20:19:22.500636 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac, now test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203)
[0m20:19:22.501024 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:19:22.505699 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m20:19:22.507484 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:19:22.509874 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m20:19:22.512046 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m20:19:22.512671 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_name
from spotify_data.gold.top_tracks
where track_name is null



  
  
      
    ) dbt_internal_test
[0m20:19:22.513840 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:19:22.514496 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.080 seconds
[0m20:19:22.516149 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4: Close
[0m20:19:22.581372 [info ] [Thread-3 (]: 25 of 32 PASS not_null_top_tracks_total_plays .................................. [[32mPASS[0m in 0.95s]
[0m20:19:22.581870 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:19:22.582164 [debug] [Thread-3 (]: Began running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:19:22.582476 [info ] [Thread-3 (]: 28 of 32 START test unique_device_usage_device_type ............................ [RUN]
[0m20:19:22.582848 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893, now test.spotify_analytics.unique_device_usage_device_type.e75362861b)
[0m20:19:22.583122 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:19:22.586742 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m20:19:22.588104 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:19:22.591647 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m20:19:22.592282 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m20:19:22.592510 [debug] [Thread-3 (]: On test.spotify_analytics.unique_device_usage_device_type.e75362861b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_device_usage_device_type.e75362861b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    device_type as unique_field,
    count(*) as n_records

from spotify_data.gold.device_usage
where device_type is not null
group by device_type
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:19:22.592714 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:19:22.688357 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.745 seconds
[0m20:19:22.689180 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78: Close
[0m20:19:22.689447 [info ] [Thread-1 (]: 23 of 32 PASS not_null_top_tracks_rank ......................................... [[32mPASS[0m in 1.26s]
[0m20:19:22.690031 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:19:22.690321 [debug] [Thread-1 (]: Began running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:19:22.690623 [info ] [Thread-1 (]: 29 of 32 START test unique_top_artists_artist_name ............................. [RUN]
[0m20:19:22.690846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4, now test.spotify_analytics.unique_top_artists_artist_name.008ffa1533)
[0m20:19:22.691024 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:19:22.692564 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m20:19:22.693014 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:19:22.694061 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m20:19:22.694441 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m20:19:22.694576 [debug] [Thread-1 (]: On test.spotify_analytics.unique_top_artists_artist_name.008ffa1533: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    artist_name as unique_field,
    count(*) as n_records

from spotify_data.gold.top_artists
where artist_name is not null
group by artist_name
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:19:22.694702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:22.836729 [info ] [Thread-4 (]: 26 of 32 PASS not_null_top_tracks_track_id ..................................... [[32mPASS[0m in 0.90s]
[0m20:19:22.837105 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:19:22.837286 [debug] [Thread-4 (]: Began running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:19:22.837462 [info ] [Thread-4 (]: 30 of 32 START test unique_top_artists_rank .................................... [RUN]
[0m20:19:22.837653 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78, now test.spotify_analytics.unique_top_artists_rank.68b5480aed)
[0m20:19:22.837826 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:19:22.840001 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m20:19:22.840399 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:19:22.841442 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m20:19:22.842309 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m20:19:22.842483 [debug] [Thread-4 (]: On test.spotify_analytics.unique_top_artists_rank.68b5480aed: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_artists_rank.68b5480aed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rank as unique_field,
    count(*) as n_records

from spotify_data.gold.top_artists
where rank is not null
group by rank
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:19:22.842637 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:19:23.267252 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.753 seconds
[0m20:19:23.269845 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203: Close
[0m20:19:23.442440 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.849 seconds
[0m20:19:23.444852 [debug] [Thread-3 (]: On test.spotify_analytics.unique_device_usage_device_type.e75362861b: Close
[0m20:19:23.454208 [info ] [Thread-2 (]: 27 of 32 PASS not_null_top_tracks_track_name ................................... [[32mPASS[0m in 0.95s]
[0m20:19:23.454846 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:19:23.455216 [debug] [Thread-2 (]: Began running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:19:23.455593 [info ] [Thread-2 (]: 31 of 32 START test unique_top_tracks_rank ..................................... [RUN]
[0m20:19:23.456008 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203, now test.spotify_analytics.unique_top_tracks_rank.8fecde1136)
[0m20:19:23.456338 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:19:23.461295 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m20:19:23.462358 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:19:23.464406 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m20:19:23.466547 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m20:19:23.466751 [debug] [Thread-2 (]: On test.spotify_analytics.unique_top_tracks_rank.8fecde1136: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rank as unique_field,
    count(*) as n_records

from spotify_data.gold.top_tracks
where rank is not null
group by rank
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:19:23.466920 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:19:23.525207 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.830 seconds
[0m20:19:23.526844 [debug] [Thread-1 (]: On test.spotify_analytics.unique_top_artists_artist_name.008ffa1533: Close
[0m20:19:23.536015 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.693 seconds
[0m20:19:23.537162 [debug] [Thread-4 (]: On test.spotify_analytics.unique_top_artists_rank.68b5480aed: Close
[0m20:19:23.614158 [info ] [Thread-3 (]: 28 of 32 PASS unique_device_usage_device_type .................................. [[32mPASS[0m in 1.03s]
[0m20:19:23.614987 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:19:23.615531 [debug] [Thread-3 (]: Began running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:19:23.616030 [info ] [Thread-3 (]: 32 of 32 START test unique_top_tracks_track_id ................................. [RUN]
[0m20:19:23.616612 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_device_usage_device_type.e75362861b, now test.spotify_analytics.unique_top_tracks_track_id.865b43a659)
[0m20:19:23.617052 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:19:23.622334 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m20:19:23.623471 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:19:23.626034 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m20:19:23.627493 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m20:19:23.627957 [debug] [Thread-3 (]: On test.spotify_analytics.unique_top_tracks_track_id.865b43a659: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    track_id as unique_field,
    count(*) as n_records

from spotify_data.gold.top_tracks
where track_id is not null
group by track_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:19:23.628535 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:19:23.685645 [info ] [Thread-4 (]: 30 of 32 PASS unique_top_artists_rank .......................................... [[32mPASS[0m in 0.85s]
[0m20:19:23.686099 [info ] [Thread-1 (]: 29 of 32 PASS unique_top_artists_artist_name ................................... [[32mPASS[0m in 1.00s]
[0m20:19:23.686832 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:19:23.687243 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:19:24.218226 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.751 seconds
[0m20:19:24.220778 [debug] [Thread-2 (]: On test.spotify_analytics.unique_top_tracks_rank.8fecde1136: Close
[0m20:19:24.384483 [info ] [Thread-2 (]: 31 of 32 PASS unique_top_tracks_rank ........................................... [[32mPASS[0m in 0.93s]
[0m20:19:24.385458 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:19:24.401680 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.773 seconds
[0m20:19:24.404472 [debug] [Thread-3 (]: On test.spotify_analytics.unique_top_tracks_track_id.865b43a659: Close
[0m20:19:24.559104 [info ] [Thread-3 (]: 32 of 32 PASS unique_top_tracks_track_id ....................................... [[32mPASS[0m in 0.94s]
[0m20:19:24.560079 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:19:24.562261 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:19:24.562584 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_artists_artist_name.008ffa1533' was properly closed.
[0m20:19:24.562836 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_rank.8fecde1136' was properly closed.
[0m20:19:24.563074 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_track_id.865b43a659' was properly closed.
[0m20:19:24.563307 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_artists_rank.68b5480aed' was properly closed.
[0m20:19:24.563624 [info ] [MainThread]: 
[0m20:19:24.563970 [info ] [MainThread]: Finished running 32 data tests in 0 hours 0 minutes and 10.10 seconds (10.10s).
[0m20:19:24.569270 [debug] [MainThread]: Command end result
[0m20:19:24.599742 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:19:24.600896 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:19:24.605566 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m20:19:24.605747 [info ] [MainThread]: 
[0m20:19:24.605932 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:19:24.606083 [info ] [MainThread]: 
[0m20:19:24.606238 [info ] [MainThread]: Done. PASS=32 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=32
[0m20:19:24.606589 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:19:24.608000 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 10.807893, "process_in_blocks": "0", "process_kernel_time": 0.388612, "process_mem_max_rss": "255000576", "process_out_blocks": "0", "process_user_time": 3.723943}
[0m20:19:24.608206 [debug] [MainThread]: Command `dbt test` succeeded at 20:19:24.608166 after 10.81 seconds
[0m20:19:24.608374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1183c3ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109e9270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109e94f0>]}
[0m20:19:24.608535 [debug] [MainThread]: Flushing usage events
[0m20:19:24.781634 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:33:30.565238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10709be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11085f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11085fb10>]}


============================== 20:33:30.567865 | 96f8c572-d6f6-40c1-90ec-1658d30e4f88 ==============================
[0m20:33:30.567865 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:33:30.568129 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'no_print': 'None', 'printer_width': '80', 'quiet': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'debug': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'log_format': 'default', 'use_colors': 'True', 'warn_error': 'None', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'indirect_selection': 'eager'}
[0m20:33:31.173669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96f8c572-d6f6-40c1-90ec-1658d30e4f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077acb00>]}
[0m20:33:31.198500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96f8c572-d6f6-40c1-90ec-1658d30e4f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120d04e20>]}
[0m20:33:31.199115 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:33:31.253774 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:33:31.318634 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:33:31.318848 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:33:31.321316 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m20:33:31.339198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96f8c572-d6f6-40c1-90ec-1658d30e4f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120cad350>]}
[0m20:33:31.380957 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:33:31.383226 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:33:31.396214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96f8c572-d6f6-40c1-90ec-1658d30e4f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120c82d50>]}
[0m20:33:31.396457 [info ] [MainThread]: Found 5 models, 43 data tests, 1 source, 604 macros
[0m20:33:31.396635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96f8c572-d6f6-40c1-90ec-1658d30e4f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121d3b690>]}
[0m20:33:31.397824 [info ] [MainThread]: 
[0m20:33:31.397990 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:33:31.398091 [info ] [MainThread]: 
[0m20:33:31.398292 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:33:31.400096 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m20:33:31.400309 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m20:33:31.407048 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m20:33:31.408121 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m20:33:31.408307 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m20:33:31.408431 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m20:33:31.408562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:31.408669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:32.709255 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.300 seconds
[0m20:33:32.710009 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.301 seconds
[0m20:33:32.710903 [debug] [ThreadPool]: On list_spotify_data: Close
[0m20:33:32.711972 [debug] [ThreadPool]: On list_spotify_data: Close
[0m20:33:32.869940 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_gold)
[0m20:33:32.876808 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_silver)
[0m20:33:32.877215 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m20:33:32.878997 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m20:33:32.879276 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m20:33:32.879502 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m20:33:32.879707 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:33:32.879898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:33:33.793241 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.913 seconds
[0m20:33:33.796357 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m20:33:34.059319 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.179 seconds
[0m20:33:34.061866 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m20:33:34.223093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96f8c572-d6f6-40c1-90ec-1658d30e4f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121f74460>]}
[0m20:33:34.229419 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m20:33:34.230268 [info ] [Thread-1 (]: 1 of 5 START sql table model silver.silver_plays ............................... [RUN]
[0m20:33:34.230869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.silver_plays)
[0m20:33:34.231267 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m20:33:34.239095 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m20:33:34.240326 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m20:33:34.259248 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.silver_plays"
[0m20:33:34.260699 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.silver_plays"
[0m20:33:34.260983 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.silver_plays"} */
create or replace transient table spotify_data.silver.silver_plays
         as
        (

-- ============================================================================
-- SILVER LAYER: CLEANED PLAYS DATA
-- ============================================================================
-- Purpose: Transform bronze plays data into clean, analytics-ready format
-- 
-- Transformations:
--   1. Deduplicate records (DISTINCT on event_id)
--   2. Cast all data types from VARIANT to proper types
--   3. Filter invalid records (defensive WHERE clauses)
--   4. Add processing metadata (processed_at timestamp)
--
-- Source: bronze.plays (external table reading from S3 Parquet files)
-- Target: SILVER.silver_plays (materialized table)
-- ============================================================================

WITH source_data AS (
    SELECT 
        VALUE:event_id::VARCHAR AS event_id,
        VALUE:user_id::VARCHAR AS user_id,
        VALUE:event_type::VARCHAR AS event_type,
        VALUE:track_id::VARCHAR AS track_id,
        VALUE:track_name::VARCHAR AS track_name,
        VALUE:artist_name::VARCHAR AS artist_name,
        VALUE:album_name::VARCHAR AS album_name,
        VALUE:duration_ms::NUMBER AS duration_ms,
        VALUE:played_at::VARCHAR AS played_at,
        VALUE:device_type::VARCHAR AS device_type
    FROM spotify_data.bronze.plays
),

deduplicated AS (
    SELECT DISTINCT
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM source_data
    WHERE 
        -- Data quality filters
        user_id IS NOT NULL
        AND duration_ms > 0
        AND duration_ms < 600000  -- Less than 10 minutes (catches data errors)
        AND event_id IS NOT NULL
)

SELECT 
    -- Identifiers
    event_id::VARCHAR AS event_id,
    user_id::VARCHAR AS user_id,
    event_type::VARCHAR AS event_type,
    
    -- Track information
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    duration_ms::NUMBER AS duration_ms,
    
    -- Timestamps
    TRY_CAST(played_at AS TIMESTAMP) AS played_at,
    
    -- Device context
    device_type::VARCHAR AS device_type,
    
    -- Metadata
    CURRENT_TIMESTAMP() AS processed_at
    
FROM deduplicated
        );
[0m20:33:34.261232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:36.639579 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.378 seconds
[0m20:33:36.660731 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: Close
[0m20:33:37.152416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96f8c572-d6f6-40c1-90ec-1658d30e4f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121f87890>]}
[0m20:33:37.153363 [info ] [Thread-1 (]: 1 of 5 OK created sql table model silver.silver_plays .......................... [[32mSUCCESS 1[0m in 2.92s]
[0m20:33:37.153984 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m20:33:37.154992 [debug] [Thread-4 (]: Began running node model.spotify_analytics.top_artists
[0m20:33:37.155379 [debug] [Thread-1 (]: Began running node model.spotify_analytics.top_tracks
[0m20:33:37.156254 [debug] [Thread-3 (]: Began running node model.spotify_analytics.device_usage
[0m20:33:37.156569 [debug] [Thread-2 (]: Began running node model.spotify_analytics.daily_user_stats
[0m20:33:37.155948 [info ] [Thread-4 (]: 4 of 5 START sql table model gold.top_artists .................................. [RUN]
[0m20:33:37.157095 [info ] [Thread-1 (]: 5 of 5 START sql table model gold.top_tracks ................................... [RUN]
[0m20:33:37.157574 [info ] [Thread-3 (]: 3 of 5 START sql table model gold.device_usage ................................. [RUN]
[0m20:33:37.158076 [info ] [Thread-2 (]: 2 of 5 START sql table model gold.daily_user_stats ............................. [RUN]
[0m20:33:37.158643 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.spotify_analytics.top_artists'
[0m20:33:37.159048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.silver_plays, now model.spotify_analytics.top_tracks)
[0m20:33:37.159465 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.spotify_analytics.device_usage'
[0m20:33:37.159854 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.daily_user_stats)
[0m20:33:37.160558 [debug] [Thread-4 (]: Began compiling node model.spotify_analytics.top_artists
[0m20:33:37.160762 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.top_tracks
[0m20:33:37.160918 [debug] [Thread-3 (]: Began compiling node model.spotify_analytics.device_usage
[0m20:33:37.161065 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.daily_user_stats
[0m20:33:37.164117 [debug] [Thread-4 (]: Writing injected SQL for node "model.spotify_analytics.top_artists"
[0m20:33:37.168064 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.top_tracks"
[0m20:33:37.169924 [debug] [Thread-3 (]: Writing injected SQL for node "model.spotify_analytics.device_usage"
[0m20:33:37.171951 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.daily_user_stats"
[0m20:33:37.172731 [debug] [Thread-4 (]: Began executing node model.spotify_analytics.top_artists
[0m20:33:37.174260 [debug] [Thread-4 (]: Writing runtime sql for node "model.spotify_analytics.top_artists"
[0m20:33:37.174524 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.top_tracks
[0m20:33:37.174880 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.daily_user_stats
[0m20:33:37.176645 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.top_tracks"
[0m20:33:37.177668 [debug] [Thread-2 (]: Writing runtime sql for node "model.spotify_analytics.daily_user_stats"
[0m20:33:37.178571 [debug] [Thread-4 (]: Using snowflake connection "model.spotify_analytics.top_artists"
[0m20:33:37.178842 [debug] [Thread-3 (]: Began executing node model.spotify_analytics.device_usage
[0m20:33:37.179198 [debug] [Thread-4 (]: On model.spotify_analytics.top_artists: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.top_artists"} */
create or replace transient table spotify_data.gold.top_artists
         as
        (

-- ============================================================================
-- GOLD LAYER: TOP ARTISTS BY PLAY COUNT
-- ============================================================================
-- Purpose: Aggregate and rank artists by popularity
-- 
-- Grain: One row per artist (all-time aggregation)
-- Primary Key: artist_name
--
-- Metrics:
--   - Total plays per artist
--   - Total listening time
--   - Number of unique tracks played
--   - First and last play timestamps
--   - Popularity rank
--
-- Source: SILVER.silver_plays
-- Target: GOLD.top_artists
-- ============================================================================

WITH artist_aggregates AS (
    SELECT 
        -- Artist identifier
        artist_name,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        COUNT(DISTINCT track_id) AS unique_tracks,
        MIN(played_at) AS first_played_at,
        MAX(played_at) AS last_played_at
        
    FROM spotify_data.silver.silver_plays
    GROUP BY artist_name
),

ranked_artists AS (
    SELECT 
        *,
        -- Add ranking based on play count (1 = most played artist)
        ROW_NUMBER() OVER (ORDER BY total_plays DESC, total_listening_time_ms DESC) AS rank
    FROM artist_aggregates
)

SELECT 
    -- Identifier
    artist_name::VARCHAR AS artist_name,
    
    -- Metrics
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    unique_tracks::NUMBER AS unique_tracks,
    
    -- Timestamps
    first_played_at::TIMESTAMP AS first_played_at,
    last_played_at::TIMESTAMP AS last_played_at,
    
    -- Ranking
    rank::NUMBER AS rank
    
FROM ranked_artists
ORDER BY rank
        );
[0m20:33:37.182428 [debug] [Thread-3 (]: Writing runtime sql for node "model.spotify_analytics.device_usage"
[0m20:33:37.182705 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:33:37.183458 [debug] [Thread-2 (]: Using snowflake connection "model.spotify_analytics.daily_user_stats"
[0m20:33:37.184274 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.top_tracks"
[0m20:33:37.184592 [debug] [Thread-2 (]: On model.spotify_analytics.daily_user_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.daily_user_stats"} */
create or replace transient table spotify_data.gold.daily_user_stats
         as
        (

-- ============================================================================
-- GOLD LAYER: DAILY USER LISTENING STATISTICS
-- ============================================================================
-- Purpose: Aggregate user listening behavior by day
-- 
-- Grain: One row per user per day
-- Primary Key: (date, user_id)
--
-- Metrics:
--   - Total plays per day
--   - Total listening time
--   - Unique tracks/artists played
--   - Average track duration
--
-- Source: SILVER.silver_plays
-- Target: GOLD.daily_user_stats
-- ============================================================================

WITH daily_aggregates AS (
    SELECT 
        -- Date dimension (truncate timestamp to date)
        DATE(played_at) AS date,
        
        -- User identifier
        user_id,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        COUNT(DISTINCT track_id) AS unique_tracks,
        COUNT(DISTINCT artist_name) AS unique_artists,
        AVG(duration_ms) AS avg_track_duration_ms
        
    FROM spotify_data.silver.silver_plays
    GROUP BY 
        DATE(played_at),
        user_id
)

SELECT 
    -- Dimensions
    date,
    user_id,
    
    -- Metrics (cast for clarity)
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    unique_tracks::NUMBER AS unique_tracks,
    unique_artists::NUMBER AS unique_artists,
    ROUND(avg_track_duration_ms, 2)::NUMBER AS avg_track_duration_ms
    
FROM daily_aggregates
ORDER BY date DESC, user_id
        );
[0m20:33:37.185000 [debug] [Thread-1 (]: On model.spotify_analytics.top_tracks: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.top_tracks"} */
create or replace transient table spotify_data.gold.top_tracks
         as
        (

-- ============================================================================
-- GOLD LAYER: TOP TRACKS BY PLAY COUNT
-- ============================================================================
-- Purpose: Aggregate and rank tracks by popularity
-- 
-- Grain: One row per track (all-time aggregation)
-- Primary Key: track_id
--
-- Metrics:
--   - Total plays per track
--   - Total listening time
--   - First and last play timestamps
--   - Popularity rank
--
-- Source: SILVER.silver_plays
-- Target: GOLD.top_tracks
-- ============================================================================

WITH track_aggregates AS (
    SELECT 
        -- Track identifiers and attributes
        track_id,
        track_name,
        artist_name,
        album_name,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        MIN(played_at) AS first_played_at,
        MAX(played_at) AS last_played_at
        
    FROM spotify_data.silver.silver_plays
    GROUP BY 
        track_id,
        track_name,
        artist_name,
        album_name
),

ranked_tracks AS (
    SELECT 
        *,
        -- Add ranking based on play count (1 = most played)
        ROW_NUMBER() OVER (ORDER BY total_plays DESC, total_listening_time_ms DESC) AS rank
    FROM track_aggregates
)

SELECT 
    -- Identifiers
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    
    -- Timestamps
    first_played_at::TIMESTAMP AS first_played_at,
    last_played_at::TIMESTAMP AS last_played_at,
    
    -- Ranking
    rank::NUMBER AS rank
    
FROM ranked_tracks
ORDER BY rank
        );
[0m20:33:37.185306 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:33:37.186078 [debug] [Thread-3 (]: Using snowflake connection "model.spotify_analytics.device_usage"
[0m20:33:37.186350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:37.187335 [debug] [Thread-3 (]: On model.spotify_analytics.device_usage: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.device_usage"} */
create or replace transient table spotify_data.gold.device_usage
         as
        (

-- ============================================================================
-- GOLD LAYER: DEVICE USAGE STATISTICS
-- ============================================================================
-- Purpose: Aggregate listening behavior by device type
-- 
-- Grain: One row per device type (all-time aggregation)
-- Primary Key: device_type
--
-- Metrics:
--   - Total plays per device
--   - Total listening time
--   - Percentage of total plays
--   - Average track duration
--
-- Source: SILVER.silver_plays
-- Target: GOLD.device_usage
-- ============================================================================

WITH device_aggregates AS (
    SELECT 
        -- Device identifier
        device_type,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        AVG(duration_ms) AS avg_track_duration_ms
        
    FROM spotify_data.silver.silver_plays
    GROUP BY device_type
),

total_plays_calc AS (
    -- Calculate overall total for percentage calculation
    SELECT SUM(total_plays) AS overall_total_plays
    FROM device_aggregates
)

SELECT 
    -- Identifier
    device_type::VARCHAR AS device_type,
    
    -- Metrics
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    
    -- Percentage of total plays
    ROUND((total_plays::FLOAT / overall_total_plays::FLOAT) * 100, 2)::FLOAT AS play_percentage,
    
    -- Average duration
    ROUND(avg_track_duration_ms, 2)::NUMBER AS avg_track_duration_ms
    
FROM device_aggregates
CROSS JOIN total_plays_calc
ORDER BY total_plays DESC
        );
[0m20:33:37.188115 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:33:38.526437 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.344 seconds
[0m20:33:38.527221 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.339 seconds
[0m20:33:38.528861 [debug] [Thread-4 (]: On model.spotify_analytics.top_artists: Close
[0m20:33:38.529956 [debug] [Thread-3 (]: On model.spotify_analytics.device_usage: Close
[0m20:33:38.575333 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.390 seconds
[0m20:33:38.577254 [debug] [Thread-2 (]: On model.spotify_analytics.daily_user_stats: Close
[0m20:33:38.579766 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.393 seconds
[0m20:33:38.581568 [debug] [Thread-1 (]: On model.spotify_analytics.top_tracks: Close
[0m20:33:38.703017 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96f8c572-d6f6-40c1-90ec-1658d30e4f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1235de6d0>]}
[0m20:33:38.704341 [info ] [Thread-4 (]: 4 of 5 OK created sql table model gold.top_artists ............................. [[32mSUCCESS 1[0m in 1.54s]
[0m20:33:38.705141 [debug] [Thread-4 (]: Finished running node model.spotify_analytics.top_artists
[0m20:33:38.706644 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96f8c572-d6f6-40c1-90ec-1658d30e4f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123644ff0>]}
[0m20:33:38.707386 [info ] [Thread-3 (]: 3 of 5 OK created sql table model gold.device_usage ............................ [[32mSUCCESS 1[0m in 1.55s]
[0m20:33:38.708058 [debug] [Thread-3 (]: Finished running node model.spotify_analytics.device_usage
[0m20:33:38.726396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96f8c572-d6f6-40c1-90ec-1658d30e4f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120ce1350>]}
[0m20:33:38.727158 [info ] [Thread-1 (]: 5 of 5 OK created sql table model gold.top_tracks .............................. [[32mSUCCESS 1[0m in 1.57s]
[0m20:33:38.727751 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.top_tracks
[0m20:33:38.777709 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96f8c572-d6f6-40c1-90ec-1658d30e4f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f10600>]}
[0m20:33:38.778730 [info ] [Thread-2 (]: 2 of 5 OK created sql table model gold.daily_user_stats ........................ [[32mSUCCESS 1[0m in 1.62s]
[0m20:33:38.779249 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.daily_user_stats
[0m20:33:38.780579 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:33:38.780847 [debug] [MainThread]: Connection 'model.spotify_analytics.top_tracks' was properly closed.
[0m20:33:38.781045 [debug] [MainThread]: Connection 'model.spotify_analytics.daily_user_stats' was properly closed.
[0m20:33:38.781238 [debug] [MainThread]: Connection 'model.spotify_analytics.top_artists' was properly closed.
[0m20:33:38.781611 [debug] [MainThread]: Connection 'model.spotify_analytics.device_usage' was properly closed.
[0m20:33:38.781999 [info ] [MainThread]: 
[0m20:33:38.782174 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 7.38 seconds (7.38s).
[0m20:33:38.782736 [debug] [MainThread]: Command end result
[0m20:33:38.806223 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:33:38.807296 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:33:38.811592 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m20:33:38.811774 [info ] [MainThread]: 
[0m20:33:38.811965 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:33:38.812126 [info ] [MainThread]: 
[0m20:33:38.812300 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m20:33:38.813897 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.282935, "process_in_blocks": "0", "process_kernel_time": 0.326091, "process_mem_max_rss": "242368512", "process_out_blocks": "0", "process_user_time": 1.850125}
[0m20:33:38.814115 [debug] [MainThread]: Command `dbt run` succeeded at 20:33:38.814074 after 8.28 seconds
[0m20:33:38.814286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd85f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122e60530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122e607d0>]}
[0m20:33:38.814454 [debug] [MainThread]: Flushing usage events
[0m20:33:39.181272 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:33:42.437614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a2be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11015f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11015fb10>]}


============================== 20:33:42.439862 | 3403231f-7aa7-4074-a032-332a3f3b391e ==============================
[0m20:33:42.439862 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:33:42.440110 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'log_format': 'default', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'write_json': 'True', 'invocation_command': 'dbt test', 'version_check': 'True', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'static_parser': 'True', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'debug': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'no_print': 'None', 'use_colors': 'True', 'warn_error': 'None', 'target_path': 'None', 'printer_width': '80', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager'}
[0m20:33:42.856286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3403231f-7aa7-4074-a032-332a3f3b391e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070b0b00>]}
[0m20:33:42.880104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3403231f-7aa7-4074-a032-332a3f3b391e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12157ce20>]}
[0m20:33:42.881345 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:33:42.939561 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:33:42.997269 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:33:42.997461 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:33:42.999679 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m20:33:43.016649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3403231f-7aa7-4074-a032-332a3f3b391e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1214b1a50>]}
[0m20:33:43.055271 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:33:43.056189 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:33:43.071948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3403231f-7aa7-4074-a032-332a3f3b391e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12292cd70>]}
[0m20:33:43.072166 [info ] [MainThread]: Found 5 models, 43 data tests, 1 source, 604 macros
[0m20:33:43.072307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3403231f-7aa7-4074-a032-332a3f3b391e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121b375b0>]}
[0m20:33:43.073664 [info ] [MainThread]: 
[0m20:33:43.073815 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:33:43.073925 [info ] [MainThread]: 
[0m20:33:43.074128 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:33:43.075869 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m20:33:43.076718 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m20:33:43.083258 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m20:33:43.084068 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m20:33:43.084210 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m20:33:43.084352 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m20:33:43.084499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:43.084611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:44.093246 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.009 seconds
[0m20:33:44.096344 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m20:33:44.287939 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.203 seconds
[0m20:33:44.290670 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m20:33:44.458346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3403231f-7aa7-4074-a032-332a3f3b391e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120d920d0>]}
[0m20:33:44.464003 [debug] [Thread-1 (]: Began running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m20:33:44.464493 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:33:44.464870 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:33:44.465207 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:33:44.465602 [info ] [Thread-1 (]: 1 of 43 START test dbt_utils_accepted_range_silver_plays_duration_ms__600000__1  [RUN]
[0m20:33:44.466005 [info ] [Thread-3 (]: 3 of 43 START test not_null_daily_user_stats_date .............................. [RUN]
[0m20:33:44.466436 [info ] [Thread-4 (]: 4 of 43 START test not_null_daily_user_stats_total_listening_time_ms ........... [RUN]
[0m20:33:44.466883 [info ] [Thread-2 (]: 2 of 43 START test not_null_daily_user_stats_avg_track_duration_ms ............. [RUN]
[0m20:33:44.467412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39)
[0m20:33:44.467911 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9'
[0m20:33:44.468358 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87'
[0m20:33:44.468825 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155)
[0m20:33:44.469250 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m20:33:44.469851 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:33:44.470109 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:33:44.470332 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:33:44.488127 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m20:33:44.489023 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m20:33:44.491149 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m20:33:44.492749 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m20:33:44.493539 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:33:44.493798 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:33:44.493964 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m20:33:44.494102 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:33:44.505771 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m20:33:44.507358 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m20:33:44.508435 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m20:33:44.509527 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m20:33:44.510396 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m20:33:44.510737 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m20:33:44.511028 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m20:33:44.511317 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m20:33:44.511495 [debug] [Thread-1 (]: On test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from spotify_data.silver.silver_plays
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not duration_ms >= 1
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not duration_ms <= 600000
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:33:44.511716 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_track_duration_ms
from spotify_data.gold.daily_user_stats
where avg_track_duration_ms is null



  
  
      
    ) dbt_internal_test
[0m20:33:44.511938 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from spotify_data.gold.daily_user_stats
where date is null



  
  
      
    ) dbt_internal_test
[0m20:33:44.512124 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.daily_user_stats
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m20:33:44.512307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:44.512483 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:33:44.512638 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:33:44.512783 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:33:45.336217 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.823 seconds
[0m20:33:45.350971 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9: Close
[0m20:33:45.353153 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.841 seconds
[0m20:33:45.354840 [debug] [Thread-1 (]: On test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39: Close
[0m20:33:45.355387 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.843 seconds
[0m20:33:45.358088 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155: Close
[0m20:33:45.374675 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.862 seconds
[0m20:33:45.375766 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87: Close
[0m20:33:45.537993 [info ] [Thread-3 (]: 3 of 43 PASS not_null_daily_user_stats_date .................................... [[32mPASS[0m in 1.07s]
[0m20:33:45.538863 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:33:45.539340 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:33:45.539892 [info ] [Thread-3 (]: 5 of 43 START test not_null_daily_user_stats_total_plays ....................... [RUN]
[0m20:33:45.540481 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9, now test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282)
[0m20:33:45.540923 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:33:45.546536 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m20:33:45.548770 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:33:45.552991 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m20:33:45.553743 [info ] [Thread-2 (]: 2 of 43 PASS not_null_daily_user_stats_avg_track_duration_ms ................... [[32mPASS[0m in 1.08s]
[0m20:33:45.554917 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:33:45.554294 [info ] [Thread-1 (]: 1 of 43 PASS dbt_utils_accepted_range_silver_plays_duration_ms__600000__1 ...... [[32mPASS[0m in 1.09s]
[0m20:33:45.555292 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:33:45.555597 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m20:33:45.555846 [info ] [Thread-2 (]: 6 of 43 START test not_null_daily_user_stats_unique_artists .................... [RUN]
[0m20:33:45.556207 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:33:45.556839 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m20:33:45.557515 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155, now test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f)
[0m20:33:45.557843 [info ] [Thread-1 (]: 7 of 43 START test not_null_daily_user_stats_unique_tracks ..................... [RUN]
[0m20:33:45.558067 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.daily_user_stats
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m20:33:45.558252 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:33:45.558434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39, now test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac)
[0m20:33:45.558664 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:33:45.561473 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m20:33:45.561767 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:33:45.564979 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m20:33:45.566410 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:33:45.569284 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m20:33:45.571276 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:33:45.572748 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m20:33:45.573482 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m20:33:45.574212 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unique_artists
from spotify_data.gold.daily_user_stats
where unique_artists is null



  
  
      
    ) dbt_internal_test
[0m20:33:45.574896 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:33:45.576006 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m20:33:45.576265 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unique_tracks
from spotify_data.gold.daily_user_stats
where unique_tracks is null



  
  
      
    ) dbt_internal_test
[0m20:33:45.578635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:45.591873 [info ] [Thread-4 (]: 4 of 43 PASS not_null_daily_user_stats_total_listening_time_ms ................. [[32mPASS[0m in 1.12s]
[0m20:33:45.594511 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:33:45.596623 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:33:45.596825 [info ] [Thread-4 (]: 8 of 43 START test not_null_daily_user_stats_user_id ........................... [RUN]
[0m20:33:45.597303 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87, now test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b)
[0m20:33:45.597679 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:33:45.599853 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m20:33:45.602640 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:33:45.604169 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m20:33:45.608487 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m20:33:45.608812 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from spotify_data.gold.daily_user_stats
where user_id is null



  
  
      
    ) dbt_internal_test
[0m20:33:45.609606 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:33:46.298477 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.723 seconds
[0m20:33:46.301070 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f: Close
[0m20:33:46.308243 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.699 seconds
[0m20:33:46.310247 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b: Close
[0m20:33:46.361806 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.783 seconds
[0m20:33:46.364566 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac: Close
[0m20:33:46.376304 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.818 seconds
[0m20:33:46.378507 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282: Close
[0m20:33:46.449520 [info ] [Thread-2 (]: 6 of 43 PASS not_null_daily_user_stats_unique_artists .......................... [[32mPASS[0m in 0.89s]
[0m20:33:46.450433 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:33:46.450976 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:33:46.451497 [info ] [Thread-2 (]: 9 of 43 START test not_null_device_usage_avg_track_duration_ms ................. [RUN]
[0m20:33:46.452112 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f, now test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003)
[0m20:33:46.452687 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:33:46.458047 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m20:33:46.461310 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:33:46.464814 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m20:33:46.465828 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m20:33:46.466192 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_track_duration_ms
from spotify_data.gold.device_usage
where avg_track_duration_ms is null



  
  
      
    ) dbt_internal_test
[0m20:33:46.466512 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:33:46.558636 [info ] [Thread-1 (]: 7 of 43 PASS not_null_daily_user_stats_unique_tracks ........................... [[32mPASS[0m in 1.00s]
[0m20:33:46.559173 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:33:46.559489 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:33:46.559828 [info ] [Thread-1 (]: 10 of 43 START test not_null_device_usage_device_type .......................... [RUN]
[0m20:33:46.560230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac, now test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c)
[0m20:33:46.560571 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:33:46.563143 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m20:33:46.563699 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:33:46.565444 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m20:33:46.566022 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m20:33:46.566196 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select device_type
from spotify_data.gold.device_usage
where device_type is null



  
  
      
    ) dbt_internal_test
[0m20:33:46.566354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:46.723654 [info ] [Thread-3 (]: 5 of 43 PASS not_null_daily_user_stats_total_plays ............................. [[32mPASS[0m in 1.18s]
[0m20:33:46.724916 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:33:46.725408 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:33:46.725989 [info ] [Thread-3 (]: 11 of 43 START test not_null_device_usage_play_percentage ...................... [RUN]
[0m20:33:46.726437 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282, now test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2)
[0m20:33:46.727042 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:33:46.730472 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m20:33:46.731219 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:33:46.732257 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m20:33:46.732872 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m20:33:46.733201 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select play_percentage
from spotify_data.gold.device_usage
where play_percentage is null



  
  
      
    ) dbt_internal_test
[0m20:33:46.733498 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:33:46.803032 [info ] [Thread-4 (]: 8 of 43 PASS not_null_daily_user_stats_user_id ................................. [[32mPASS[0m in 1.21s]
[0m20:33:46.803390 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:33:46.803572 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:33:46.803780 [info ] [Thread-4 (]: 12 of 43 START test not_null_device_usage_total_listening_time_ms .............. [RUN]
[0m20:33:46.804038 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b, now test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2)
[0m20:33:46.804219 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:33:46.806159 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m20:33:46.806573 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:33:46.807568 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m20:33:46.809620 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m20:33:46.809869 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.device_usage
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m20:33:46.810048 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:33:47.286977 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.820 seconds
[0m20:33:47.288150 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.722 seconds
[0m20:33:47.290748 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003: Close
[0m20:33:47.292249 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c: Close
[0m20:33:47.459672 [info ] [Thread-2 (]: 9 of 43 PASS not_null_device_usage_avg_track_duration_ms ....................... [[32mPASS[0m in 1.01s]
[0m20:33:47.460638 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:33:47.461174 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:33:47.461653 [info ] [Thread-2 (]: 13 of 43 START test not_null_device_usage_total_plays .......................... [RUN]
[0m20:33:47.462169 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003, now test.spotify_analytics.not_null_device_usage_total_plays.90a295df48)
[0m20:33:47.462527 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:33:47.467656 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m20:33:47.469639 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:33:47.472008 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m20:33:47.472646 [info ] [Thread-1 (]: 10 of 43 PASS not_null_device_usage_device_type ................................ [[32mPASS[0m in 0.91s]
[0m20:33:47.472992 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:33:47.473517 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m20:33:47.474169 [info ] [Thread-1 (]: 14 of 43 START test not_null_silver_plays_artist_name .......................... [RUN]
[0m20:33:47.474753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c, now test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad)
[0m20:33:47.475298 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m20:33:47.475470 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m20:33:47.475672 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_device_usage_total_plays.90a295df48: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.device_usage
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m20:33:47.479203 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m20:33:47.479546 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:33:47.480495 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m20:33:47.481758 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m20:33:47.482929 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m20:33:47.483194 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select artist_name
from spotify_data.silver.silver_plays
where artist_name is null



  
  
      
    ) dbt_internal_test
[0m20:33:47.483384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:47.528800 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.795 seconds
[0m20:33:47.529860 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2: Close
[0m20:33:47.566062 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.756 seconds
[0m20:33:47.566965 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2: Close
[0m20:33:47.699242 [info ] [Thread-3 (]: 11 of 43 PASS not_null_device_usage_play_percentage ............................ [[32mPASS[0m in 0.97s]
[0m20:33:47.699599 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:33:47.699794 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m20:33:47.700049 [info ] [Thread-3 (]: 15 of 43 START test not_null_silver_plays_duration_ms .......................... [RUN]
[0m20:33:47.700354 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2, now test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076)
[0m20:33:47.700574 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m20:33:47.702720 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m20:33:47.703158 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m20:33:47.704315 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m20:33:47.704853 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m20:33:47.705025 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select duration_ms
from spotify_data.silver.silver_plays
where duration_ms is null



  
  
      
    ) dbt_internal_test
[0m20:33:47.705179 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:33:47.745971 [info ] [Thread-4 (]: 12 of 43 PASS not_null_device_usage_total_listening_time_ms .................... [[32mPASS[0m in 0.94s]
[0m20:33:47.746346 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:33:47.746535 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m20:33:47.746738 [info ] [Thread-4 (]: 16 of 43 START test not_null_silver_plays_event_id ............................. [RUN]
[0m20:33:47.746972 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2, now test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd)
[0m20:33:47.747149 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m20:33:47.749087 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m20:33:47.749450 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m20:33:47.750433 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m20:33:47.750861 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m20:33:47.752887 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from spotify_data.silver.silver_plays
where event_id is null



  
  
      
    ) dbt_internal_test
[0m20:33:47.753083 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:33:48.248661 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.765 seconds
[0m20:33:48.251874 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad: Close
[0m20:33:48.252633 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.773 seconds
[0m20:33:48.255024 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_device_usage_total_plays.90a295df48: Close
[0m20:33:48.405949 [info ] [Thread-1 (]: 14 of 43 PASS not_null_silver_plays_artist_name ................................ [[32mPASS[0m in 0.93s]
[0m20:33:48.406965 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m20:33:48.407449 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m20:33:48.407951 [info ] [Thread-1 (]: 17 of 43 START test not_null_silver_plays_event_type ........................... [RUN]
[0m20:33:48.408494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad, now test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa)
[0m20:33:48.408913 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m20:33:48.414212 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m20:33:48.415049 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m20:33:48.417326 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m20:33:48.418650 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m20:33:48.420063 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_type
from spotify_data.silver.silver_plays
where event_type is null



  
  
      
    ) dbt_internal_test
[0m20:33:48.420580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:48.441036 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.688 seconds
[0m20:33:48.442266 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd: Close
[0m20:33:48.446900 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.742 seconds
[0m20:33:48.448068 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076: Close
[0m20:33:48.451898 [info ] [Thread-2 (]: 13 of 43 PASS not_null_device_usage_total_plays ................................ [[32mPASS[0m in 0.99s]
[0m20:33:48.452283 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:33:48.452532 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m20:33:48.452802 [info ] [Thread-2 (]: 18 of 43 START test not_null_silver_plays_played_at ............................ [RUN]
[0m20:33:48.453097 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_plays.90a295df48, now test.spotify_analytics.not_null_silver_plays_played_at.8281565f95)
[0m20:33:48.453328 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m20:33:48.455362 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m20:33:48.455776 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m20:33:48.456906 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m20:33:48.457336 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m20:33:48.457543 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_played_at.8281565f95: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select played_at
from spotify_data.silver.silver_plays
where played_at is null



  
  
      
    ) dbt_internal_test
[0m20:33:48.457732 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:33:48.615237 [info ] [Thread-3 (]: 15 of 43 PASS not_null_silver_plays_duration_ms ................................ [[32mPASS[0m in 0.91s]
[0m20:33:48.616177 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m20:33:48.616662 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m20:33:48.617082 [info ] [Thread-3 (]: 19 of 43 START test not_null_silver_plays_processed_at ......................... [RUN]
[0m20:33:48.617523 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076, now test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed)
[0m20:33:48.617915 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m20:33:48.622131 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m20:33:48.622758 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m20:33:48.624759 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m20:33:48.625395 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m20:33:48.625722 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select processed_at
from spotify_data.silver.silver_plays
where processed_at is null



  
  
      
    ) dbt_internal_test
[0m20:33:48.626019 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:33:48.635430 [info ] [Thread-4 (]: 16 of 43 PASS not_null_silver_plays_event_id ................................... [[32mPASS[0m in 0.89s]
[0m20:33:48.635924 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m20:33:48.636392 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m20:33:48.636985 [info ] [Thread-4 (]: 20 of 43 START test not_null_silver_plays_track_id ............................. [RUN]
[0m20:33:48.637454 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd, now test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9)
[0m20:33:48.637705 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m20:33:48.641003 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m20:33:48.645737 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m20:33:48.647151 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m20:33:48.647811 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m20:33:48.648018 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_id
from spotify_data.silver.silver_plays
where track_id is null



  
  
      
    ) dbt_internal_test
[0m20:33:48.648199 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:33:49.110201 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.689 seconds
[0m20:33:49.112608 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa: Close
[0m20:33:49.137478 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.680 seconds
[0m20:33:49.138919 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_played_at.8281565f95: Close
[0m20:33:49.265569 [info ] [Thread-1 (]: 17 of 43 PASS not_null_silver_plays_event_type ................................. [[32mPASS[0m in 0.86s]
[0m20:33:49.266520 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m20:33:49.267085 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m20:33:49.267512 [info ] [Thread-1 (]: 21 of 43 START test not_null_silver_plays_track_name ........................... [RUN]
[0m20:33:49.268022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa, now test.spotify_analytics.not_null_silver_plays_track_name.c6334add30)
[0m20:33:49.268384 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m20:33:49.273515 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m20:33:49.274697 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m20:33:49.278542 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m20:33:49.280142 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m20:33:49.280640 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_silver_plays_track_name.c6334add30: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_name
from spotify_data.silver.silver_plays
where track_name is null



  
  
      
    ) dbt_internal_test
[0m20:33:49.280849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:49.289620 [info ] [Thread-2 (]: 18 of 43 PASS not_null_silver_plays_played_at .................................. [[32mPASS[0m in 0.84s]
[0m20:33:49.291187 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m20:33:49.291514 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m20:33:49.291871 [info ] [Thread-2 (]: 22 of 43 START test not_null_silver_plays_user_id .............................. [RUN]
[0m20:33:49.292997 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_played_at.8281565f95, now test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4)
[0m20:33:49.293329 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m20:33:49.295717 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m20:33:49.299880 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m20:33:49.301412 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m20:33:49.302550 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m20:33:49.302781 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from spotify_data.silver.silver_plays
where user_id is null



  
  
      
    ) dbt_internal_test
[0m20:33:49.302980 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:33:49.312520 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.687 seconds
[0m20:33:49.314027 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed: Close
[0m20:33:49.356664 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.708 seconds
[0m20:33:49.357762 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9: Close
[0m20:33:49.455581 [info ] [Thread-3 (]: 19 of 43 PASS not_null_silver_plays_processed_at ............................... [[32mPASS[0m in 0.84s]
[0m20:33:49.456252 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m20:33:49.456566 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:33:49.456767 [info ] [Thread-3 (]: 23 of 43 START test not_null_top_artists_artist_name ........................... [RUN]
[0m20:33:49.457002 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed, now test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e)
[0m20:33:49.457172 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:33:49.459865 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m20:33:49.460231 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:33:49.461838 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m20:33:49.462328 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m20:33:49.462525 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select artist_name
from spotify_data.gold.top_artists
where artist_name is null



  
  
      
    ) dbt_internal_test
[0m20:33:49.462692 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:33:49.497210 [info ] [Thread-4 (]: 20 of 43 PASS not_null_silver_plays_track_id ................................... [[32mPASS[0m in 0.86s]
[0m20:33:49.497659 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m20:33:49.497913 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:33:49.498192 [info ] [Thread-4 (]: 24 of 43 START test not_null_top_artists_first_played_at ....................... [RUN]
[0m20:33:49.498494 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9, now test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14)
[0m20:33:49.498726 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:33:49.500770 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m20:33:49.501202 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:33:49.502269 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m20:33:49.502753 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m20:33:49.502962 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_played_at
from spotify_data.gold.top_artists
where first_played_at is null



  
  
      
    ) dbt_internal_test
[0m20:33:49.503162 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:33:49.988174 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.685 seconds
[0m20:33:49.990841 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4: Close
[0m20:33:50.021875 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.741 seconds
[0m20:33:50.025378 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_silver_plays_track_name.c6334add30: Close
[0m20:33:50.140764 [info ] [Thread-2 (]: 22 of 43 PASS not_null_silver_plays_user_id .................................... [[32mPASS[0m in 0.85s]
[0m20:33:50.141790 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m20:33:50.142337 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:33:50.142842 [info ] [Thread-2 (]: 25 of 43 START test not_null_top_artists_last_played_at ........................ [RUN]
[0m20:33:50.143523 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4, now test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca)
[0m20:33:50.144028 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:33:50.149484 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m20:33:50.152235 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:33:50.153854 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m20:33:50.155591 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m20:33:50.157069 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_played_at
from spotify_data.gold.top_artists
where last_played_at is null



  
  
      
    ) dbt_internal_test
[0m20:33:50.157464 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:33:50.240708 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.738 seconds
[0m20:33:50.241961 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14: Close
[0m20:33:50.251624 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.789 seconds
[0m20:33:50.252649 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e: Close
[0m20:33:50.256686 [info ] [Thread-1 (]: 21 of 43 PASS not_null_silver_plays_track_name ................................. [[32mPASS[0m in 0.99s]
[0m20:33:50.256965 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m20:33:50.257151 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:33:50.257461 [info ] [Thread-1 (]: 26 of 43 START test not_null_top_artists_rank .................................. [RUN]
[0m20:33:50.257812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_track_name.c6334add30, now test.spotify_analytics.not_null_top_artists_rank.d14513fc96)
[0m20:33:50.258084 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:33:50.260658 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m20:33:50.261231 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:33:50.262404 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m20:33:50.263066 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m20:33:50.263380 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_rank.d14513fc96: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rank
from spotify_data.gold.top_artists
where rank is null



  
  
      
    ) dbt_internal_test
[0m20:33:50.263630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:50.386503 [info ] [Thread-4 (]: 24 of 43 PASS not_null_top_artists_first_played_at ............................. [[32mPASS[0m in 0.89s]
[0m20:33:50.387463 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:33:50.388006 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:33:50.388519 [info ] [Thread-4 (]: 27 of 43 START test not_null_top_artists_total_listening_time_ms ............... [RUN]
[0m20:33:50.388988 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14, now test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c)
[0m20:33:50.389361 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:33:50.392334 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m20:33:50.392975 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:33:50.394359 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m20:33:50.395180 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m20:33:50.395350 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.top_artists
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m20:33:50.395504 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:33:50.435701 [info ] [Thread-3 (]: 23 of 43 PASS not_null_top_artists_artist_name ................................. [[32mPASS[0m in 0.98s]
[0m20:33:50.436089 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:33:50.436343 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:33:50.436637 [info ] [Thread-3 (]: 28 of 43 START test not_null_top_artists_total_plays ........................... [RUN]
[0m20:33:50.436985 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e, now test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11)
[0m20:33:50.437240 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:33:50.439522 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m20:33:50.440374 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:33:50.441714 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m20:33:50.442975 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m20:33:50.443207 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.top_artists
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m20:33:50.443374 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:33:50.943795 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.786 seconds
[0m20:33:50.946356 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca: Close
[0m20:33:51.102312 [info ] [Thread-2 (]: 25 of 43 PASS not_null_top_artists_last_played_at .............................. [[32mPASS[0m in 0.96s]
[0m20:33:51.103303 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:33:51.103908 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:33:51.104398 [info ] [Thread-2 (]: 29 of 43 START test not_null_top_artists_unique_tracks ......................... [RUN]
[0m20:33:51.104939 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca, now test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13)
[0m20:33:51.105360 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:33:51.110574 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m20:33:51.113039 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:33:51.217699 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m20:33:51.218556 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.955 seconds
[0m20:33:51.218933 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.823 seconds
[0m20:33:51.219775 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_rank.d14513fc96: Close
[0m20:33:51.220413 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c: Close
[0m20:33:51.221069 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m20:33:51.221666 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unique_tracks
from spotify_data.gold.top_artists
where unique_tracks is null



  
  
      
    ) dbt_internal_test
[0m20:33:51.221987 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:33:51.231876 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.788 seconds
[0m20:33:51.232640 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11: Close
[0m20:33:51.411696 [info ] [Thread-1 (]: 26 of 43 PASS not_null_top_artists_rank ........................................ [[32mPASS[0m in 1.15s]
[0m20:33:51.412284 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:33:51.412644 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:33:51.413039 [info ] [Thread-1 (]: 30 of 43 START test not_null_top_tracks_artist_name ............................ [RUN]
[0m20:33:51.413504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_rank.d14513fc96, now test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461)
[0m20:33:51.413829 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:33:51.416811 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m20:33:51.417616 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:33:51.420022 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m20:33:51.420518 [info ] [Thread-3 (]: 28 of 43 PASS not_null_top_artists_total_plays ................................. [[32mPASS[0m in 0.98s]
[0m20:33:51.421054 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:33:51.421433 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:33:51.421761 [info ] [Thread-3 (]: 31 of 43 START test not_null_top_tracks_first_played_at ........................ [RUN]
[0m20:33:51.421955 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11, now test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31)
[0m20:33:51.422109 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:33:51.422501 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m20:33:51.425035 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m20:33:51.425307 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select artist_name
from spotify_data.gold.top_tracks
where artist_name is null



  
  
      
    ) dbt_internal_test
[0m20:33:51.425613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:51.426237 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:33:51.427911 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m20:33:51.429597 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m20:33:51.430139 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_played_at
from spotify_data.gold.top_tracks
where first_played_at is null



  
  
      
    ) dbt_internal_test
[0m20:33:51.429968 [info ] [Thread-4 (]: 27 of 43 PASS not_null_top_artists_total_listening_time_ms ..................... [[32mPASS[0m in 1.04s]
[0m20:33:51.430371 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:33:51.430701 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:33:51.431078 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:33:51.431590 [info ] [Thread-4 (]: 32 of 43 START test not_null_top_tracks_last_played_at ......................... [RUN]
[0m20:33:51.433856 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c, now test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532)
[0m20:33:51.435281 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:33:51.437538 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m20:33:51.439821 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:33:51.441989 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m20:33:51.445171 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m20:33:51.446795 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_played_at
from spotify_data.gold.top_tracks
where last_played_at is null



  
  
      
    ) dbt_internal_test
[0m20:33:51.447610 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:33:51.948322 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.726 seconds
[0m20:33:51.950764 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13: Close
[0m20:33:52.112764 [info ] [Thread-2 (]: 29 of 43 PASS not_null_top_artists_unique_tracks ............................... [[32mPASS[0m in 1.01s]
[0m20:33:52.113838 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:33:52.114373 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:33:52.114859 [info ] [Thread-2 (]: 33 of 43 START test not_null_top_tracks_rank ................................... [RUN]
[0m20:33:52.115419 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13, now test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4)
[0m20:33:52.115769 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:33:52.120784 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m20:33:52.122259 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:33:52.126328 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m20:33:52.127126 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m20:33:52.127698 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rank
from spotify_data.gold.top_tracks
where rank is null



  
  
      
    ) dbt_internal_test
[0m20:33:52.128399 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:33:52.186327 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.756 seconds
[0m20:33:52.187685 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31: Close
[0m20:33:52.201100 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.775 seconds
[0m20:33:52.201889 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.754 seconds
[0m20:33:52.203321 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461: Close
[0m20:33:52.204024 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532: Close
[0m20:33:52.342549 [info ] [Thread-1 (]: 30 of 43 PASS not_null_top_tracks_artist_name .................................. [[32mPASS[0m in 0.93s]
[0m20:33:52.343597 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:33:52.344279 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:33:52.344804 [info ] [Thread-1 (]: 34 of 43 START test not_null_top_tracks_total_listening_time_ms ................ [RUN]
[0m20:33:52.345422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461, now test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac)
[0m20:33:52.345888 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:33:52.352095 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m20:33:52.353361 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:33:52.356247 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m20:33:52.358922 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m20:33:52.359418 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.top_tracks
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m20:33:52.359806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:52.367002 [info ] [Thread-4 (]: 32 of 43 PASS not_null_top_tracks_last_played_at ............................... [[32mPASS[0m in 0.93s]
[0m20:33:52.368909 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:33:52.369758 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:33:52.371178 [info ] [Thread-4 (]: 35 of 43 START test not_null_top_tracks_total_plays ............................ [RUN]
[0m20:33:52.371410 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532, now test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893)
[0m20:33:52.372281 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:33:52.375921 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m20:33:52.377967 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:33:52.381713 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m20:33:52.384446 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m20:33:52.384729 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.top_tracks
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m20:33:52.384923 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:33:52.391103 [info ] [Thread-3 (]: 31 of 43 PASS not_null_top_tracks_first_played_at .............................. [[32mPASS[0m in 0.97s]
[0m20:33:52.392355 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:33:52.393047 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:33:52.393273 [info ] [Thread-3 (]: 36 of 43 START test not_null_top_tracks_track_id ............................... [RUN]
[0m20:33:52.393594 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31, now test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78)
[0m20:33:52.393803 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:33:52.397661 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m20:33:52.399460 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:33:52.401265 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m20:33:52.403959 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m20:33:52.404172 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_id
from spotify_data.gold.top_tracks
where track_id is null



  
  
      
    ) dbt_internal_test
[0m20:33:52.404340 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:33:52.951422 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.823 seconds
[0m20:33:52.954077 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4: Close
[0m20:33:53.088128 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.728 seconds
[0m20:33:53.091207 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac: Close
[0m20:33:53.108380 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.723 seconds
[0m20:33:53.110966 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893: Close
[0m20:33:53.111619 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.707 seconds
[0m20:33:53.113765 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78: Close
[0m20:33:53.119052 [info ] [Thread-2 (]: 33 of 43 PASS not_null_top_tracks_rank ......................................... [[32mPASS[0m in 1.00s]
[0m20:33:53.119682 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:33:53.120059 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:33:53.120434 [info ] [Thread-2 (]: 37 of 43 START test not_null_top_tracks_track_name ............................. [RUN]
[0m20:33:53.120837 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4, now test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203)
[0m20:33:53.121209 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:33:53.126029 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m20:33:53.126648 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:33:53.128483 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m20:33:53.128945 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m20:33:53.130736 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_name
from spotify_data.gold.top_tracks
where track_name is null



  
  
      
    ) dbt_internal_test
[0m20:33:53.131145 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:33:53.252838 [info ] [Thread-1 (]: 34 of 43 PASS not_null_top_tracks_total_listening_time_ms ...................... [[32mPASS[0m in 0.91s]
[0m20:33:53.253677 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:33:53.254077 [debug] [Thread-1 (]: Began running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:33:53.254557 [info ] [Thread-1 (]: 38 of 43 START test unique_device_usage_device_type ............................ [RUN]
[0m20:33:53.255180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac, now test.spotify_analytics.unique_device_usage_device_type.e75362861b)
[0m20:33:53.255594 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:33:53.259875 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m20:33:53.261073 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:33:53.262803 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m20:33:53.263535 [info ] [Thread-4 (]: 35 of 43 PASS not_null_top_tracks_total_plays .................................. [[32mPASS[0m in 0.89s]
[0m20:33:53.264130 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:33:53.264476 [debug] [Thread-4 (]: Began running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m20:33:53.265034 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m20:33:53.264690 [info ] [Thread-4 (]: 39 of 43 START test unique_silver_plays_event_id ............................... [RUN]
[0m20:33:53.265370 [debug] [Thread-1 (]: On test.spotify_analytics.unique_device_usage_device_type.e75362861b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_device_usage_device_type.e75362861b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    device_type as unique_field,
    count(*) as n_records

from spotify_data.gold.device_usage
where device_type is not null
group by device_type
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:33:53.265736 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893, now test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf)
[0m20:33:53.266025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:53.266294 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m20:33:53.269373 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m20:33:53.270983 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m20:33:53.272364 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m20:33:53.272720 [info ] [Thread-3 (]: 36 of 43 PASS not_null_top_tracks_track_id ..................................... [[32mPASS[0m in 0.88s]
[0m20:33:53.273067 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:33:53.273269 [debug] [Thread-3 (]: Began running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:33:53.273574 [info ] [Thread-3 (]: 40 of 43 START test unique_top_artists_artist_name ............................. [RUN]
[0m20:33:53.274117 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m20:33:53.274425 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78, now test.spotify_analytics.unique_top_artists_artist_name.008ffa1533)
[0m20:33:53.274725 [debug] [Thread-4 (]: On test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from spotify_data.silver.silver_plays
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:33:53.275019 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:33:53.275278 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:33:53.277667 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m20:33:53.281843 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:33:53.283158 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m20:33:53.285495 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m20:33:53.285853 [debug] [Thread-3 (]: On test.spotify_analytics.unique_top_artists_artist_name.008ffa1533: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    artist_name as unique_field,
    count(*) as n_records

from spotify_data.gold.top_artists
where artist_name is not null
group by artist_name
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:33:53.286110 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:33:53.820409 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.689 seconds
[0m20:33:53.822880 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203: Close
[0m20:33:53.970868 [info ] [Thread-2 (]: 37 of 43 PASS not_null_top_tracks_track_name ................................... [[32mPASS[0m in 0.85s]
[0m20:33:53.971822 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:33:53.972305 [debug] [Thread-2 (]: Began running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:33:53.972758 [info ] [Thread-2 (]: 41 of 43 START test unique_top_artists_rank .................................... [RUN]
[0m20:33:53.973245 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203, now test.spotify_analytics.unique_top_artists_rank.68b5480aed)
[0m20:33:53.973614 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:33:53.978141 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m20:33:53.979096 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:33:53.981997 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m20:33:53.982922 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m20:33:53.983233 [debug] [Thread-2 (]: On test.spotify_analytics.unique_top_artists_rank.68b5480aed: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_artists_rank.68b5480aed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rank as unique_field,
    count(*) as n_records

from spotify_data.gold.top_artists
where rank is not null
group by rank
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:33:53.983507 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:33:54.060851 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.785 seconds
[0m20:33:54.062388 [debug] [Thread-4 (]: On test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf: Close
[0m20:33:54.062963 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.777 seconds
[0m20:33:54.064775 [debug] [Thread-3 (]: On test.spotify_analytics.unique_top_artists_artist_name.008ffa1533: Close
[0m20:33:54.098042 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.832 seconds
[0m20:33:54.099344 [debug] [Thread-1 (]: On test.spotify_analytics.unique_device_usage_device_type.e75362861b: Close
[0m20:33:54.211967 [info ] [Thread-4 (]: 39 of 43 PASS unique_silver_plays_event_id ..................................... [[32mPASS[0m in 0.95s]
[0m20:33:54.212858 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m20:33:54.213545 [debug] [Thread-4 (]: Began running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:33:54.214135 [info ] [Thread-4 (]: 42 of 43 START test unique_top_tracks_rank ..................................... [RUN]
[0m20:33:54.214717 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf, now test.spotify_analytics.unique_top_tracks_rank.8fecde1136)
[0m20:33:54.215091 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:33:54.220325 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m20:33:54.221447 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:33:54.224192 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m20:33:54.228555 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m20:33:54.229020 [debug] [Thread-4 (]: On test.spotify_analytics.unique_top_tracks_rank.8fecde1136: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rank as unique_field,
    count(*) as n_records

from spotify_data.gold.top_tracks
where rank is not null
group by rank
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:33:54.229438 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:33:54.232896 [info ] [Thread-3 (]: 40 of 43 PASS unique_top_artists_artist_name ................................... [[32mPASS[0m in 0.96s]
[0m20:33:54.233510 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:33:54.235175 [debug] [Thread-3 (]: Began running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:33:54.235974 [info ] [Thread-3 (]: 43 of 43 START test unique_top_tracks_track_id ................................. [RUN]
[0m20:33:54.237601 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_top_artists_artist_name.008ffa1533, now test.spotify_analytics.unique_top_tracks_track_id.865b43a659)
[0m20:33:54.238298 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:33:54.241930 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m20:33:54.246126 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:33:54.247578 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m20:33:54.247956 [info ] [Thread-1 (]: 38 of 43 PASS unique_device_usage_device_type .................................. [[32mPASS[0m in 0.99s]
[0m20:33:54.248762 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:33:54.251834 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m20:33:54.253441 [debug] [Thread-3 (]: On test.spotify_analytics.unique_top_tracks_track_id.865b43a659: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    track_id as unique_field,
    count(*) as n_records

from spotify_data.gold.top_tracks
where track_id is not null
group by track_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:33:54.254080 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:33:54.738262 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.755 seconds
[0m20:33:54.741270 [debug] [Thread-2 (]: On test.spotify_analytics.unique_top_artists_rank.68b5480aed: Close
[0m20:33:54.914454 [info ] [Thread-2 (]: 41 of 43 PASS unique_top_artists_rank .......................................... [[32mPASS[0m in 0.94s]
[0m20:33:54.915293 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:33:55.020843 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.766 seconds
[0m20:33:55.024667 [debug] [Thread-3 (]: On test.spotify_analytics.unique_top_tracks_track_id.865b43a659: Close
[0m20:33:55.025470 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.796 seconds
[0m20:33:55.028274 [debug] [Thread-4 (]: On test.spotify_analytics.unique_top_tracks_rank.8fecde1136: Close
[0m20:33:55.185091 [info ] [Thread-4 (]: 42 of 43 PASS unique_top_tracks_rank ........................................... [[32mPASS[0m in 0.97s]
[0m20:33:55.185896 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:33:55.191530 [info ] [Thread-3 (]: 43 of 43 PASS unique_top_tracks_track_id ....................................... [[32mPASS[0m in 0.95s]
[0m20:33:55.192405 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:33:55.194328 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:33:55.194940 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_device_usage_device_type.e75362861b' was properly closed.
[0m20:33:55.195250 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_artists_rank.68b5480aed' was properly closed.
[0m20:33:55.195497 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_track_id.865b43a659' was properly closed.
[0m20:33:55.195804 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_rank.8fecde1136' was properly closed.
[0m20:33:55.196815 [info ] [MainThread]: 
[0m20:33:55.197348 [info ] [MainThread]: Finished running 43 data tests in 0 hours 0 minutes and 12.12 seconds (12.12s).
[0m20:33:55.203857 [debug] [MainThread]: Command end result
[0m20:33:55.228938 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:33:55.230278 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:33:55.235178 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m20:33:55.235342 [info ] [MainThread]: 
[0m20:33:55.235518 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:33:55.235658 [info ] [MainThread]: 
[0m20:33:55.235808 [info ] [MainThread]: Done. PASS=43 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=43
[0m20:33:55.237515 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 12.826208, "process_in_blocks": "0", "process_kernel_time": 0.455443, "process_mem_max_rss": "241254400", "process_out_blocks": "0", "process_user_time": 4.526909}
[0m20:33:55.237742 [debug] [MainThread]: Command `dbt test` succeeded at 20:33:55.237695 after 12.83 seconds
[0m20:33:55.237908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110055250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121d58520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b41ba10>]}
[0m20:33:55.238066 [debug] [MainThread]: Flushing usage events
[0m20:33:55.414753 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:41:33.915008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ebe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068ef9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068efb10>]}


============================== 20:41:33.917592 | 6bfbbf47-bee0-4e27-a500-e074eafb40c7 ==============================
[0m20:41:33.917592 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:41:33.917840 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'write_json': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'target_path': 'None', 'warn_error': 'None', 'empty': 'False', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'debug': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run', 'version_check': 'True', 'introspect': 'True', 'no_print': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'static_parser': 'True'}
[0m20:41:34.622284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bfbbf47-bee0-4e27-a500-e074eafb40c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c40b00>]}
[0m20:41:34.645713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6bfbbf47-bee0-4e27-a500-e074eafb40c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5e0e20>]}
[0m20:41:34.646270 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:41:34.702492 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:41:34.765236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:41:34.765420 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:41:34.767738 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m20:41:34.785356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bfbbf47-bee0-4e27-a500-e074eafb40c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d511350>]}
[0m20:41:34.824624 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:41:34.825822 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:41:34.837442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bfbbf47-bee0-4e27-a500-e074eafb40c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4e6d50>]}
[0m20:41:34.837638 [info ] [MainThread]: Found 5 models, 43 data tests, 1 source, 604 macros
[0m20:41:34.837768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bfbbf47-bee0-4e27-a500-e074eafb40c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc1b690>]}
[0m20:41:34.838739 [info ] [MainThread]: 
[0m20:41:34.838879 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:41:34.838982 [info ] [MainThread]: 
[0m20:41:34.839187 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:41:34.840852 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m20:41:34.841063 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data'
[0m20:41:34.846876 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m20:41:34.847785 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data"
[0m20:41:34.847921 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m20:41:34.848038 [debug] [ThreadPool]: On list_spotify_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data"} */
show terse schemas in database spotify_data
    limit 10000
[0m20:41:34.848151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:34.848247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:36.178331 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.330 seconds
[0m20:41:36.179830 [debug] [ThreadPool]: On list_spotify_data: Close
[0m20:41:36.280339 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.432 seconds
[0m20:41:36.281299 [debug] [ThreadPool]: On list_spotify_data: Close
[0m20:41:36.469470 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_gold)
[0m20:41:36.476560 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spotify_data, now list_spotify_data_silver)
[0m20:41:36.480508 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m20:41:36.482002 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m20:41:36.482345 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m20:41:36.482656 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m20:41:36.482948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:41:36.483214 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:41:37.514420 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.031 seconds
[0m20:41:37.515520 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.033 seconds
[0m20:41:37.518127 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m20:41:37.520049 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m20:41:37.738890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bfbbf47-bee0-4e27-a500-e074eafb40c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de65160>]}
[0m20:41:37.744372 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m20:41:37.745136 [info ] [Thread-1 (]: 1 of 5 START sql table model silver.silver_plays ............................... [RUN]
[0m20:41:37.745666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.silver_plays)
[0m20:41:37.746146 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m20:41:37.755516 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m20:41:37.756445 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m20:41:37.774911 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.silver_plays"
[0m20:41:37.776190 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.silver_plays"
[0m20:41:37.776473 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.silver_plays"} */
create or replace transient table spotify_data.silver.silver_plays
         as
        (

-- ============================================================================
-- SILVER LAYER: CLEANED PLAYS DATA
-- ============================================================================
-- Purpose: Transform bronze plays data into clean, analytics-ready format
-- 
-- Transformations:
--   1. Deduplicate records (DISTINCT on event_id)
--   2. Cast all data types from VARIANT to proper types
--   3. Filter invalid records (defensive WHERE clauses)
--   4. Add processing metadata (processed_at timestamp)
--
-- Source: bronze.plays (external table reading from S3 Parquet files)
-- Target: SILVER.silver_plays (materialized table)
-- ============================================================================

WITH source_data AS (
    SELECT 
        VALUE:event_id::VARCHAR AS event_id,
        VALUE:user_id::VARCHAR AS user_id,
        VALUE:event_type::VARCHAR AS event_type,
        VALUE:track_id::VARCHAR AS track_id,
        VALUE:track_name::VARCHAR AS track_name,
        VALUE:artist_name::VARCHAR AS artist_name,
        VALUE:album_name::VARCHAR AS album_name,
        VALUE:duration_ms::NUMBER AS duration_ms,
        VALUE:played_at::VARCHAR AS played_at,
        VALUE:device_type::VARCHAR AS device_type
    FROM spotify_data.bronze.plays
),

deduplicated AS (
    SELECT DISTINCT
        event_id,
        user_id,
        event_type,
        track_id,
        track_name,
        artist_name,
        album_name,
        duration_ms,
        played_at,
        device_type
    FROM source_data
    WHERE 
        -- Data quality filters
        user_id IS NOT NULL
        AND duration_ms > 0
        AND duration_ms < 600000  -- Less than 10 minutes (catches data errors)
        AND event_id IS NOT NULL
)

SELECT 
    -- Identifiers
    event_id::VARCHAR AS event_id,
    user_id::VARCHAR AS user_id,
    event_type::VARCHAR AS event_type,
    
    -- Track information
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    duration_ms::NUMBER AS duration_ms,
    
    -- Timestamps
    TRY_CAST(played_at AS TIMESTAMP) AS played_at,
    
    -- Device context
    device_type::VARCHAR AS device_type,
    
    -- Metadata
    CURRENT_TIMESTAMP() AS processed_at
    
FROM deduplicated
        );
[0m20:41:37.776730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:39.856664 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.080 seconds
[0m20:41:39.879052 [debug] [Thread-1 (]: On model.spotify_analytics.silver_plays: Close
[0m20:41:40.077028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bfbbf47-bee0-4e27-a500-e074eafb40c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de4ebd0>]}
[0m20:41:40.078180 [info ] [Thread-1 (]: 1 of 5 OK created sql table model silver.silver_plays .......................... [[32mSUCCESS 1[0m in 2.33s]
[0m20:41:40.078953 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m20:41:40.080188 [debug] [Thread-1 (]: Began running node model.spotify_analytics.top_tracks
[0m20:41:40.080633 [debug] [Thread-3 (]: Began running node model.spotify_analytics.device_usage
[0m20:41:40.080984 [debug] [Thread-4 (]: Began running node model.spotify_analytics.top_artists
[0m20:41:40.081354 [debug] [Thread-2 (]: Began running node model.spotify_analytics.daily_user_stats
[0m20:41:40.081845 [info ] [Thread-1 (]: 5 of 5 START sql table model gold.top_tracks ................................... [RUN]
[0m20:41:40.082361 [info ] [Thread-3 (]: 3 of 5 START sql table model gold.device_usage ................................. [RUN]
[0m20:41:40.082825 [info ] [Thread-4 (]: 4 of 5 START sql table model gold.top_artists .................................. [RUN]
[0m20:41:40.083261 [info ] [Thread-2 (]: 2 of 5 START sql table model gold.daily_user_stats ............................. [RUN]
[0m20:41:40.083795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.silver_plays, now model.spotify_analytics.top_tracks)
[0m20:41:40.084261 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.spotify_analytics.device_usage'
[0m20:41:40.084657 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.spotify_analytics.top_artists'
[0m20:41:40.084962 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.daily_user_stats)
[0m20:41:40.085279 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.top_tracks
[0m20:41:40.085632 [debug] [Thread-3 (]: Began compiling node model.spotify_analytics.device_usage
[0m20:41:40.085993 [debug] [Thread-4 (]: Began compiling node model.spotify_analytics.top_artists
[0m20:41:40.086361 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.daily_user_stats
[0m20:41:40.090638 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.top_tracks"
[0m20:41:40.094691 [debug] [Thread-3 (]: Writing injected SQL for node "model.spotify_analytics.device_usage"
[0m20:41:40.097382 [debug] [Thread-4 (]: Writing injected SQL for node "model.spotify_analytics.top_artists"
[0m20:41:40.099730 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.daily_user_stats"
[0m20:41:40.100448 [debug] [Thread-4 (]: Began executing node model.spotify_analytics.top_artists
[0m20:41:40.100742 [debug] [Thread-3 (]: Began executing node model.spotify_analytics.device_usage
[0m20:41:40.101025 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.top_tracks
[0m20:41:40.102471 [debug] [Thread-4 (]: Writing runtime sql for node "model.spotify_analytics.top_artists"
[0m20:41:40.102693 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.daily_user_stats
[0m20:41:40.104295 [debug] [Thread-3 (]: Writing runtime sql for node "model.spotify_analytics.device_usage"
[0m20:41:40.105476 [debug] [Thread-1 (]: Writing runtime sql for node "model.spotify_analytics.top_tracks"
[0m20:41:40.108998 [debug] [Thread-2 (]: Writing runtime sql for node "model.spotify_analytics.daily_user_stats"
[0m20:41:40.110071 [debug] [Thread-4 (]: Using snowflake connection "model.spotify_analytics.top_artists"
[0m20:41:40.110685 [debug] [Thread-3 (]: Using snowflake connection "model.spotify_analytics.device_usage"
[0m20:41:40.110988 [debug] [Thread-4 (]: On model.spotify_analytics.top_artists: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.top_artists"} */
create or replace transient table spotify_data.gold.top_artists
         as
        (

-- ============================================================================
-- GOLD LAYER: TOP ARTISTS BY PLAY COUNT
-- ============================================================================
-- Purpose: Aggregate and rank artists by popularity
-- 
-- Grain: One row per artist (all-time aggregation)
-- Primary Key: artist_name
--
-- Metrics:
--   - Total plays per artist
--   - Total listening time
--   - Number of unique tracks played
--   - First and last play timestamps
--   - Popularity rank
--
-- Source: SILVER.silver_plays
-- Target: GOLD.top_artists
-- ============================================================================

WITH artist_aggregates AS (
    SELECT 
        -- Artist identifier
        artist_name,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        COUNT(DISTINCT track_id) AS unique_tracks,
        MIN(played_at) AS first_played_at,
        MAX(played_at) AS last_played_at
        
    FROM spotify_data.silver.silver_plays
    GROUP BY artist_name
),

ranked_artists AS (
    SELECT 
        *,
        -- Add ranking based on play count (1 = most played artist)
        ROW_NUMBER() OVER (ORDER BY total_plays DESC, total_listening_time_ms DESC) AS rank
    FROM artist_aggregates
)

SELECT 
    -- Identifier
    artist_name::VARCHAR AS artist_name,
    
    -- Metrics
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    unique_tracks::NUMBER AS unique_tracks,
    
    -- Timestamps
    first_played_at::TIMESTAMP AS first_played_at,
    last_played_at::TIMESTAMP AS last_played_at,
    
    -- Ranking
    rank::NUMBER AS rank
    
FROM ranked_artists
ORDER BY rank
        );
[0m20:41:40.111359 [debug] [Thread-3 (]: On model.spotify_analytics.device_usage: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.device_usage"} */
create or replace transient table spotify_data.gold.device_usage
         as
        (

-- ============================================================================
-- GOLD LAYER: DEVICE USAGE STATISTICS
-- ============================================================================
-- Purpose: Aggregate listening behavior by device type
-- 
-- Grain: One row per device type (all-time aggregation)
-- Primary Key: device_type
--
-- Metrics:
--   - Total plays per device
--   - Total listening time
--   - Percentage of total plays
--   - Average track duration
--
-- Source: SILVER.silver_plays
-- Target: GOLD.device_usage
-- ============================================================================

WITH device_aggregates AS (
    SELECT 
        -- Device identifier
        device_type,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        AVG(duration_ms) AS avg_track_duration_ms
        
    FROM spotify_data.silver.silver_plays
    GROUP BY device_type
),

total_plays_calc AS (
    -- Calculate overall total for percentage calculation
    SELECT SUM(total_plays) AS overall_total_plays
    FROM device_aggregates
)

SELECT 
    -- Identifier
    device_type::VARCHAR AS device_type,
    
    -- Metrics
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    
    -- Percentage of total plays
    ROUND((total_plays::FLOAT / overall_total_plays::FLOAT) * 100, 2)::FLOAT AS play_percentage,
    
    -- Average duration
    ROUND(avg_track_duration_ms, 2)::NUMBER AS avg_track_duration_ms
    
FROM device_aggregates
CROSS JOIN total_plays_calc
ORDER BY total_plays DESC
        );
[0m20:41:40.112134 [debug] [Thread-2 (]: Using snowflake connection "model.spotify_analytics.daily_user_stats"
[0m20:41:40.112343 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:41:40.113109 [debug] [Thread-1 (]: Using snowflake connection "model.spotify_analytics.top_tracks"
[0m20:41:40.113306 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:41:40.113577 [debug] [Thread-2 (]: On model.spotify_analytics.daily_user_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.daily_user_stats"} */
create or replace transient table spotify_data.gold.daily_user_stats
         as
        (

-- ============================================================================
-- GOLD LAYER: DAILY USER LISTENING STATISTICS
-- ============================================================================
-- Purpose: Aggregate user listening behavior by day
-- 
-- Grain: One row per user per day
-- Primary Key: (date, user_id)
--
-- Metrics:
--   - Total plays per day
--   - Total listening time
--   - Unique tracks/artists played
--   - Average track duration
--
-- Source: SILVER.silver_plays
-- Target: GOLD.daily_user_stats
-- ============================================================================

WITH daily_aggregates AS (
    SELECT 
        -- Date dimension (truncate timestamp to date)
        DATE(played_at) AS date,
        
        -- User identifier
        user_id,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        COUNT(DISTINCT track_id) AS unique_tracks,
        COUNT(DISTINCT artist_name) AS unique_artists,
        AVG(duration_ms) AS avg_track_duration_ms
        
    FROM spotify_data.silver.silver_plays
    GROUP BY 
        DATE(played_at),
        user_id
)

SELECT 
    -- Dimensions
    date,
    user_id,
    
    -- Metrics (cast for clarity)
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    unique_tracks::NUMBER AS unique_tracks,
    unique_artists::NUMBER AS unique_artists,
    ROUND(avg_track_duration_ms, 2)::NUMBER AS avg_track_duration_ms
    
FROM daily_aggregates
ORDER BY date DESC, user_id
        );
[0m20:41:40.114170 [debug] [Thread-1 (]: On model.spotify_analytics.top_tracks: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "model.spotify_analytics.top_tracks"} */
create or replace transient table spotify_data.gold.top_tracks
         as
        (

-- ============================================================================
-- GOLD LAYER: TOP TRACKS BY PLAY COUNT
-- ============================================================================
-- Purpose: Aggregate and rank tracks by popularity
-- 
-- Grain: One row per track (all-time aggregation)
-- Primary Key: track_id
--
-- Metrics:
--   - Total plays per track
--   - Total listening time
--   - First and last play timestamps
--   - Popularity rank
--
-- Source: SILVER.silver_plays
-- Target: GOLD.top_tracks
-- ============================================================================

WITH track_aggregates AS (
    SELECT 
        -- Track identifiers and attributes
        track_id,
        track_name,
        artist_name,
        album_name,
        
        -- Aggregate metrics
        COUNT(*) AS total_plays,
        SUM(duration_ms) AS total_listening_time_ms,
        MIN(played_at) AS first_played_at,
        MAX(played_at) AS last_played_at
        
    FROM spotify_data.silver.silver_plays
    GROUP BY 
        track_id,
        track_name,
        artist_name,
        album_name
),

ranked_tracks AS (
    SELECT 
        *,
        -- Add ranking based on play count (1 = most played)
        ROW_NUMBER() OVER (ORDER BY total_plays DESC, total_listening_time_ms DESC) AS rank
    FROM track_aggregates
)

SELECT 
    -- Identifiers
    track_id::VARCHAR AS track_id,
    track_name::VARCHAR AS track_name,
    artist_name::VARCHAR AS artist_name,
    album_name::VARCHAR AS album_name,
    
    -- Metrics
    total_plays::NUMBER AS total_plays,
    total_listening_time_ms::NUMBER AS total_listening_time_ms,
    
    -- Timestamps
    first_played_at::TIMESTAMP AS first_played_at,
    last_played_at::TIMESTAMP AS last_played_at,
    
    -- Ranking
    rank::NUMBER AS rank
    
FROM ranked_tracks
ORDER BY rank
        );
[0m20:41:40.114757 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:41:40.115412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:41.717675 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.604 seconds
[0m20:41:41.722498 [debug] [Thread-3 (]: On model.spotify_analytics.device_usage: Close
[0m20:41:41.964679 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.849 seconds
[0m20:41:41.968140 [debug] [Thread-1 (]: On model.spotify_analytics.top_tracks: Close
[0m20:41:42.011915 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.899 seconds
[0m20:41:42.014694 [debug] [Thread-4 (]: On model.spotify_analytics.top_artists: Close
[0m20:41:42.017935 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bfbbf47-bee0-4e27-a500-e074eafb40c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1168e1b20>]}
[0m20:41:42.018957 [info ] [Thread-3 (]: 3 of 5 OK created sql table model gold.device_usage ............................ [[32mSUCCESS 1[0m in 1.93s]
[0m20:41:42.019845 [debug] [Thread-3 (]: Finished running node model.spotify_analytics.device_usage
[0m20:41:42.036088 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.921 seconds
[0m20:41:42.038459 [debug] [Thread-2 (]: On model.spotify_analytics.daily_user_stats: Close
[0m20:41:42.208555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bfbbf47-bee0-4e27-a500-e074eafb40c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11682b110>]}
[0m20:41:42.209295 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bfbbf47-bee0-4e27-a500-e074eafb40c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1169b6c30>]}
[0m20:41:42.209848 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bfbbf47-bee0-4e27-a500-e074eafb40c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de68f50>]}
[0m20:41:42.210654 [info ] [Thread-1 (]: 5 of 5 OK created sql table model gold.top_tracks .............................. [[32mSUCCESS 1[0m in 2.12s]
[0m20:41:42.211459 [info ] [Thread-2 (]: 2 of 5 OK created sql table model gold.daily_user_stats ........................ [[32mSUCCESS 1[0m in 2.12s]
[0m20:41:42.212276 [info ] [Thread-4 (]: 4 of 5 OK created sql table model gold.top_artists ............................. [[32mSUCCESS 1[0m in 2.13s]
[0m20:41:42.212992 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.top_tracks
[0m20:41:42.213675 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.daily_user_stats
[0m20:41:42.214277 [debug] [Thread-4 (]: Finished running node model.spotify_analytics.top_artists
[0m20:41:42.216528 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:41:42.216871 [debug] [MainThread]: Connection 'model.spotify_analytics.top_tracks' was properly closed.
[0m20:41:42.217130 [debug] [MainThread]: Connection 'model.spotify_analytics.daily_user_stats' was properly closed.
[0m20:41:42.217383 [debug] [MainThread]: Connection 'model.spotify_analytics.device_usage' was properly closed.
[0m20:41:42.217696 [debug] [MainThread]: Connection 'model.spotify_analytics.top_artists' was properly closed.
[0m20:41:42.218107 [info ] [MainThread]: 
[0m20:41:42.218625 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 7.38 seconds (7.38s).
[0m20:41:42.220152 [debug] [MainThread]: Command end result
[0m20:41:42.246066 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:41:42.247444 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:41:42.251955 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m20:41:42.252144 [info ] [MainThread]: 
[0m20:41:42.252351 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:41:42.252506 [info ] [MainThread]: 
[0m20:41:42.252677 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m20:41:42.254346 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.370629, "process_in_blocks": "0", "process_kernel_time": 0.345066, "process_mem_max_rss": "234160128", "process_out_blocks": "0", "process_user_time": 1.910867}
[0m20:41:42.254629 [debug] [MainThread]: Command `dbt run` succeeded at 20:41:42.254577 after 8.37 seconds
[0m20:41:42.254832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10677b770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da77a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116b439b0>]}
[0m20:41:42.255025 [debug] [MainThread]: Flushing usage events
[0m20:41:42.686155 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:41:45.247188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10391be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f1f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f1fb10>]}


============================== 20:41:45.249369 | d4e951fb-e2ad-46fe-a273-fe5a27ddabd0 ==============================
[0m20:41:45.249369 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:41:45.249620 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'empty': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'introspect': 'True', 'partial_parse': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'version_check': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'debug': 'False', 'cache_selected_only': 'False', 'no_print': 'None'}
[0m20:41:45.659603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4e951fb-e2ad-46fe-a273-fe5a27ddabd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104270b00>]}
[0m20:41:45.682986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4e951fb-e2ad-46fe-a273-fe5a27ddabd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc14e20>]}
[0m20:41:45.684128 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:41:45.736573 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:41:45.793021 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:41:45.793210 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:41:45.795605 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m20:41:45.812147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4e951fb-e2ad-46fe-a273-fe5a27ddabd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb45a50>]}
[0m20:41:45.851726 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:41:45.853172 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:41:45.869152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4e951fb-e2ad-46fe-a273-fe5a27ddabd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c338d70>]}
[0m20:41:45.869391 [info ] [MainThread]: Found 5 models, 43 data tests, 1 source, 604 macros
[0m20:41:45.869529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4e951fb-e2ad-46fe-a273-fe5a27ddabd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0435b0>]}
[0m20:41:45.870911 [info ] [MainThread]: 
[0m20:41:45.871056 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:41:45.871161 [info ] [MainThread]: 
[0m20:41:45.871376 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:41:45.873112 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m20:41:45.873317 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m20:41:45.880400 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m20:41:45.881768 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m20:41:45.881990 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m20:41:45.882127 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m20:41:45.882254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:45.882363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:46.801155 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.919 seconds
[0m20:41:46.804442 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m20:41:46.812152 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.930 seconds
[0m20:41:46.813923 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m20:41:47.027580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4e951fb-e2ad-46fe-a273-fe5a27ddabd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6220d0>]}
[0m20:41:47.032984 [debug] [Thread-1 (]: Began running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m20:41:47.033429 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:41:47.033813 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:41:47.034157 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:41:47.034582 [info ] [Thread-1 (]: 1 of 43 START test dbt_utils_accepted_range_silver_plays_duration_ms__600000__1  [RUN]
[0m20:41:47.035004 [info ] [Thread-2 (]: 2 of 43 START test not_null_daily_user_stats_avg_track_duration_ms ............. [RUN]
[0m20:41:47.035426 [info ] [Thread-4 (]: 4 of 43 START test not_null_daily_user_stats_total_listening_time_ms ........... [RUN]
[0m20:41:47.035810 [info ] [Thread-3 (]: 3 of 43 START test not_null_daily_user_stats_date .............................. [RUN]
[0m20:41:47.036289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39)
[0m20:41:47.036749 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155)
[0m20:41:47.037511 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87'
[0m20:41:47.038041 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9'
[0m20:41:47.038265 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m20:41:47.038432 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:41:47.038581 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:41:47.038722 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:41:47.050655 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m20:41:47.055702 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m20:41:47.057585 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m20:41:47.059723 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m20:41:47.060440 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m20:41:47.060680 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:41:47.060879 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:41:47.061091 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:41:47.072839 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m20:41:47.074085 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m20:41:47.075094 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m20:41:47.076126 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m20:41:47.076771 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m20:41:47.077031 [debug] [Thread-1 (]: On test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from spotify_data.silver.silver_plays
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not duration_ms >= 1
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not duration_ms <= 600000
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:41:47.077416 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m20:41:47.077583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:47.077788 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.daily_user_stats
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m20:41:47.078120 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m20:41:47.078413 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m20:41:47.078605 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:41:47.078989 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from spotify_data.gold.daily_user_stats
where date is null



  
  
      
    ) dbt_internal_test
[0m20:41:47.079294 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_track_duration_ms
from spotify_data.gold.daily_user_stats
where avg_track_duration_ms is null



  
  
      
    ) dbt_internal_test
[0m20:41:47.080010 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:41:47.080385 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:41:47.859846 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.782 seconds
[0m20:41:47.867317 [debug] [Thread-1 (]: On test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39: Close
[0m20:41:47.928716 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.848 seconds
[0m20:41:47.929769 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155: Close
[0m20:41:47.931775 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.853 seconds
[0m20:41:47.932579 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.852 seconds
[0m20:41:47.934020 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87: Close
[0m20:41:47.934742 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9: Close
[0m20:41:48.024768 [info ] [Thread-1 (]: 1 of 43 PASS dbt_utils_accepted_range_silver_plays_duration_ms__600000__1 ...... [[32mPASS[0m in 0.99s]
[0m20:41:48.025137 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m20:41:48.025326 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:41:48.025652 [info ] [Thread-1 (]: 5 of 43 START test not_null_daily_user_stats_total_plays ....................... [RUN]
[0m20:41:48.026178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39, now test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282)
[0m20:41:48.026575 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:41:48.029773 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m20:41:48.030238 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:41:48.032682 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m20:41:48.033159 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m20:41:48.033324 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.daily_user_stats
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m20:41:48.033537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:48.112751 [info ] [Thread-3 (]: 3 of 43 PASS not_null_daily_user_stats_date .................................... [[32mPASS[0m in 1.07s]
[0m20:41:48.113076 [info ] [Thread-2 (]: 2 of 43 PASS not_null_daily_user_stats_avg_track_duration_ms ................... [[32mPASS[0m in 1.08s]
[0m20:41:48.113512 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:41:48.113894 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:41:48.114198 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:41:48.114521 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:41:48.114837 [info ] [Thread-3 (]: 6 of 43 START test not_null_daily_user_stats_unique_artists .................... [RUN]
[0m20:41:48.115115 [info ] [Thread-2 (]: 7 of 43 START test not_null_daily_user_stats_unique_tracks ..................... [RUN]
[0m20:41:48.115396 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9, now test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f)
[0m20:41:48.115581 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155, now test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac)
[0m20:41:48.115747 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:41:48.115899 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:41:48.118360 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m20:41:48.121112 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m20:41:48.121813 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:41:48.122050 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:41:48.123688 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m20:41:48.125439 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m20:41:48.126464 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m20:41:48.126861 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m20:41:48.127045 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unique_artists
from spotify_data.gold.daily_user_stats
where unique_artists is null



  
  
      
    ) dbt_internal_test
[0m20:41:48.127604 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unique_tracks
from spotify_data.gold.daily_user_stats
where unique_tracks is null



  
  
      
    ) dbt_internal_test
[0m20:41:48.127409 [info ] [Thread-4 (]: 4 of 43 PASS not_null_daily_user_stats_total_listening_time_ms ................. [[32mPASS[0m in 1.09s]
[0m20:41:48.127880 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:41:48.128074 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:41:48.128370 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:41:48.129059 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:41:48.129366 [info ] [Thread-4 (]: 8 of 43 START test not_null_daily_user_stats_user_id ........................... [RUN]
[0m20:41:48.129750 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87, now test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b)
[0m20:41:48.130362 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:41:48.132922 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m20:41:48.133703 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:41:48.135202 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m20:41:48.138864 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m20:41:48.140004 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from spotify_data.gold.daily_user_stats
where user_id is null



  
  
      
    ) dbt_internal_test
[0m20:41:48.140327 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:41:48.778903 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.745 seconds
[0m20:41:48.781337 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282: Close
[0m20:41:48.844646 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.716 seconds
[0m20:41:48.847708 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac: Close
[0m20:41:48.879890 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.752 seconds
[0m20:41:48.882747 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f: Close
[0m20:41:48.922922 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.782 seconds
[0m20:41:48.926202 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b: Close
[0m20:41:48.990465 [info ] [Thread-1 (]: 5 of 43 PASS not_null_daily_user_stats_total_plays ............................. [[32mPASS[0m in 0.96s]
[0m20:41:48.991687 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:41:48.992101 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:41:48.992709 [info ] [Thread-1 (]: 9 of 43 START test not_null_device_usage_avg_track_duration_ms ................. [RUN]
[0m20:41:48.993240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282, now test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003)
[0m20:41:48.993567 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:41:48.998670 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m20:41:48.999991 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:41:49.003958 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m20:41:49.005909 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m20:41:49.006315 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_track_duration_ms
from spotify_data.gold.device_usage
where avg_track_duration_ms is null



  
  
      
    ) dbt_internal_test
[0m20:41:49.006509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:49.057201 [info ] [Thread-2 (]: 7 of 43 PASS not_null_daily_user_stats_unique_tracks ........................... [[32mPASS[0m in 0.94s]
[0m20:41:49.057683 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:41:49.057978 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:41:49.058289 [info ] [Thread-2 (]: 10 of 43 START test not_null_device_usage_device_type .......................... [RUN]
[0m20:41:49.058656 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac, now test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c)
[0m20:41:49.058927 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:41:49.061035 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m20:41:49.061787 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:41:49.062844 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m20:41:49.063515 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m20:41:49.063856 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select device_type
from spotify_data.gold.device_usage
where device_type is null



  
  
      
    ) dbt_internal_test
[0m20:41:49.064231 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:41:49.071507 [info ] [Thread-3 (]: 6 of 43 PASS not_null_daily_user_stats_unique_artists .......................... [[32mPASS[0m in 0.96s]
[0m20:41:49.072106 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:41:49.072381 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:41:49.073024 [info ] [Thread-3 (]: 11 of 43 START test not_null_device_usage_play_percentage ...................... [RUN]
[0m20:41:49.074288 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f, now test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2)
[0m20:41:49.074637 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:41:49.076747 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m20:41:49.077397 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:41:49.078750 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m20:41:49.080743 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m20:41:49.082203 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select play_percentage
from spotify_data.gold.device_usage
where play_percentage is null



  
  
      
    ) dbt_internal_test
[0m20:41:49.082622 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:41:49.087829 [info ] [Thread-4 (]: 8 of 43 PASS not_null_daily_user_stats_user_id ................................. [[32mPASS[0m in 0.96s]
[0m20:41:49.089404 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:41:49.089647 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:41:49.090026 [info ] [Thread-4 (]: 12 of 43 START test not_null_device_usage_total_listening_time_ms .............. [RUN]
[0m20:41:49.091141 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b, now test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2)
[0m20:41:49.091718 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:41:49.093759 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m20:41:49.095652 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:41:49.097283 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m20:41:49.099201 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m20:41:49.100698 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.device_usage
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m20:41:49.101129 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:41:49.778152 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.771 seconds
[0m20:41:49.780681 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003: Close
[0m20:41:49.820391 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.719 seconds
[0m20:41:49.823403 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2: Close
[0m20:41:49.828587 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.764 seconds
[0m20:41:49.830631 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c: Close
[0m20:41:49.865372 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.783 seconds
[0m20:41:49.867758 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2: Close
[0m20:41:49.939306 [info ] [Thread-1 (]: 9 of 43 PASS not_null_device_usage_avg_track_duration_ms ....................... [[32mPASS[0m in 0.95s]
[0m20:41:49.940373 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:41:49.940906 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:41:49.941431 [info ] [Thread-1 (]: 13 of 43 START test not_null_device_usage_total_plays .......................... [RUN]
[0m20:41:49.941962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003, now test.spotify_analytics.not_null_device_usage_total_plays.90a295df48)
[0m20:41:49.942306 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:41:49.947808 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m20:41:49.949767 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:41:49.954615 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m20:41:49.955561 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m20:41:49.955744 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_device_usage_total_plays.90a295df48: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.device_usage
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m20:41:49.955905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:49.977882 [info ] [Thread-2 (]: 10 of 43 PASS not_null_device_usage_device_type ................................ [[32mPASS[0m in 0.92s]
[0m20:41:49.978332 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:41:49.978587 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m20:41:49.978868 [info ] [Thread-2 (]: 14 of 43 START test not_null_silver_plays_artist_name .......................... [RUN]
[0m20:41:49.979202 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c, now test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad)
[0m20:41:49.979420 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m20:41:49.981546 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m20:41:49.981976 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m20:41:49.982983 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m20:41:49.983507 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m20:41:49.983712 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select artist_name
from spotify_data.silver.silver_plays
where artist_name is null



  
  
      
    ) dbt_internal_test
[0m20:41:49.983905 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:41:50.028946 [info ] [Thread-3 (]: 11 of 43 PASS not_null_device_usage_play_percentage ............................ [[32mPASS[0m in 0.95s]
[0m20:41:50.029343 [info ] [Thread-4 (]: 12 of 43 PASS not_null_device_usage_total_listening_time_ms .................... [[32mPASS[0m in 0.94s]
[0m20:41:50.029829 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:41:50.030134 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:41:50.030317 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m20:41:50.030516 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m20:41:50.030750 [info ] [Thread-3 (]: 15 of 43 START test not_null_silver_plays_duration_ms .......................... [RUN]
[0m20:41:50.030979 [info ] [Thread-4 (]: 16 of 43 START test not_null_silver_plays_event_id ............................. [RUN]
[0m20:41:50.031213 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2, now test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076)
[0m20:41:50.031431 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2, now test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd)
[0m20:41:50.031630 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m20:41:50.031818 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m20:41:50.034313 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m20:41:50.036347 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m20:41:50.036835 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m20:41:50.037028 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m20:41:50.038637 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m20:41:50.039726 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m20:41:50.040295 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m20:41:50.040632 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m20:41:50.040798 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select duration_ms
from spotify_data.silver.silver_plays
where duration_ms is null



  
  
      
    ) dbt_internal_test
[0m20:41:50.040972 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from spotify_data.silver.silver_plays
where event_id is null



  
  
      
    ) dbt_internal_test
[0m20:41:50.041132 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:41:50.041324 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:41:50.684100 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.700 seconds
[0m20:41:50.687519 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad: Close
[0m20:41:50.712033 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.756 seconds
[0m20:41:50.714654 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_device_usage_total_plays.90a295df48: Close
[0m20:41:50.736359 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.695 seconds
[0m20:41:50.738516 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd: Close
[0m20:41:50.790615 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.749 seconds
[0m20:41:50.793851 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076: Close
[0m20:41:50.871979 [info ] [Thread-2 (]: 14 of 43 PASS not_null_silver_plays_artist_name ................................ [[32mPASS[0m in 0.89s]
[0m20:41:50.872971 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m20:41:50.873454 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m20:41:50.873930 [info ] [Thread-2 (]: 17 of 43 START test not_null_silver_plays_event_type ........................... [RUN]
[0m20:41:50.874458 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad, now test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa)
[0m20:41:50.874843 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m20:41:50.880654 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m20:41:50.882227 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m20:41:50.884487 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m20:41:50.886814 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m20:41:50.887213 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_type
from spotify_data.silver.silver_plays
where event_type is null



  
  
      
    ) dbt_internal_test
[0m20:41:50.887532 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:41:50.890298 [info ] [Thread-1 (]: 13 of 43 PASS not_null_device_usage_total_plays ................................ [[32mPASS[0m in 0.95s]
[0m20:41:50.892897 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:41:50.894258 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m20:41:50.894503 [info ] [Thread-1 (]: 18 of 43 START test not_null_silver_plays_played_at ............................ [RUN]
[0m20:41:50.896127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_plays.90a295df48, now test.spotify_analytics.not_null_silver_plays_played_at.8281565f95)
[0m20:41:50.896992 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m20:41:50.899483 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m20:41:50.901632 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m20:41:50.903187 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m20:41:50.904156 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m20:41:50.904525 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_silver_plays_played_at.8281565f95: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select played_at
from spotify_data.silver.silver_plays
where played_at is null



  
  
      
    ) dbt_internal_test
[0m20:41:50.904846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:50.918062 [info ] [Thread-4 (]: 16 of 43 PASS not_null_silver_plays_event_id ................................... [[32mPASS[0m in 0.89s]
[0m20:41:50.919001 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m20:41:50.919240 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m20:41:50.919485 [info ] [Thread-4 (]: 19 of 43 START test not_null_silver_plays_processed_at ......................... [RUN]
[0m20:41:50.919886 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd, now test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed)
[0m20:41:50.920145 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m20:41:50.922517 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m20:41:50.926661 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m20:41:50.928096 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m20:41:50.929338 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m20:41:50.929522 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select processed_at
from spotify_data.silver.silver_plays
where processed_at is null



  
  
      
    ) dbt_internal_test
[0m20:41:50.929679 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:41:50.976304 [info ] [Thread-3 (]: 15 of 43 PASS not_null_silver_plays_duration_ms ................................ [[32mPASS[0m in 0.95s]
[0m20:41:50.976691 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m20:41:50.976896 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m20:41:50.977080 [info ] [Thread-3 (]: 20 of 43 START test not_null_silver_plays_track_id ............................. [RUN]
[0m20:41:50.977280 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076, now test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9)
[0m20:41:50.977441 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m20:41:50.979771 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m20:41:50.980161 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m20:41:50.981156 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m20:41:50.981587 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m20:41:50.981747 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_id
from spotify_data.silver.silver_plays
where track_id is null



  
  
      
    ) dbt_internal_test
[0m20:41:50.981898 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:41:51.597306 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.667 seconds
[0m20:41:51.600878 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed: Close
[0m20:41:51.612127 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.725 seconds
[0m20:41:51.613963 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa: Close
[0m20:41:51.638039 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.733 seconds
[0m20:41:51.639879 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_silver_plays_played_at.8281565f95: Close
[0m20:41:51.741738 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.760 seconds
[0m20:41:51.744991 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9: Close
[0m20:41:51.767357 [info ] [Thread-4 (]: 19 of 43 PASS not_null_silver_plays_processed_at ............................... [[32mPASS[0m in 0.85s]
[0m20:41:51.768812 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m20:41:51.769406 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m20:41:51.769988 [info ] [Thread-4 (]: 21 of 43 START test not_null_silver_plays_track_name ........................... [RUN]
[0m20:41:51.770677 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed, now test.spotify_analytics.not_null_silver_plays_track_name.c6334add30)
[0m20:41:51.771112 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m20:41:51.776279 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m20:41:51.776983 [info ] [Thread-2 (]: 17 of 43 PASS not_null_silver_plays_event_type ................................. [[32mPASS[0m in 0.90s]
[0m20:41:51.777771 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m20:41:51.778271 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m20:41:51.778693 [info ] [Thread-2 (]: 22 of 43 START test not_null_silver_plays_user_id .............................. [RUN]
[0m20:41:51.779342 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa, now test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4)
[0m20:41:51.779704 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m20:41:51.779902 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m20:41:51.782599 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m20:41:51.786475 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m20:41:51.787504 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m20:41:51.787715 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m20:41:51.787919 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_track_name.c6334add30: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_name
from spotify_data.silver.silver_plays
where track_name is null



  
  
      
    ) dbt_internal_test
[0m20:41:51.789568 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m20:41:51.789848 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:41:51.791137 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m20:41:51.791474 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from spotify_data.silver.silver_plays
where user_id is null



  
  
      
    ) dbt_internal_test
[0m20:41:51.791760 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:41:51.829906 [info ] [Thread-1 (]: 18 of 43 PASS not_null_silver_plays_played_at .................................. [[32mPASS[0m in 0.93s]
[0m20:41:51.830241 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m20:41:51.830413 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:41:51.830621 [info ] [Thread-1 (]: 23 of 43 START test not_null_top_artists_artist_name ........................... [RUN]
[0m20:41:51.830874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_played_at.8281565f95, now test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e)
[0m20:41:51.831059 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:41:51.833393 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m20:41:51.833927 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:41:51.835048 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m20:41:51.835578 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m20:41:51.835749 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select artist_name
from spotify_data.gold.top_artists
where artist_name is null



  
  
      
    ) dbt_internal_test
[0m20:41:51.835902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:51.917594 [info ] [Thread-3 (]: 20 of 43 PASS not_null_silver_plays_track_id ................................... [[32mPASS[0m in 0.94s]
[0m20:41:51.917974 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m20:41:51.918154 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:41:51.918367 [info ] [Thread-3 (]: 24 of 43 START test not_null_top_artists_first_played_at ....................... [RUN]
[0m20:41:51.918613 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9, now test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14)
[0m20:41:51.918781 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:41:51.921171 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m20:41:51.921543 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:41:51.922524 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m20:41:51.922967 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m20:41:51.923138 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_played_at
from spotify_data.gold.top_artists
where first_played_at is null



  
  
      
    ) dbt_internal_test
[0m20:41:51.923297 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:41:52.502461 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.712 seconds
[0m20:41:52.504957 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_silver_plays_track_name.c6334add30: Close
[0m20:41:52.547021 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.755 seconds
[0m20:41:52.550944 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4: Close
[0m20:41:52.604323 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.768 seconds
[0m20:41:52.607393 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e: Close
[0m20:41:52.669169 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.746 seconds
[0m20:41:52.671408 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14: Close
[0m20:41:52.703843 [info ] [Thread-4 (]: 21 of 43 PASS not_null_silver_plays_track_name ................................. [[32mPASS[0m in 0.93s]
[0m20:41:52.704599 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m20:41:52.705106 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:41:52.705603 [info ] [Thread-4 (]: 25 of 43 START test not_null_top_artists_last_played_at ........................ [RUN]
[0m20:41:52.706196 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_track_name.c6334add30, now test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca)
[0m20:41:52.706634 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:41:52.712423 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m20:41:52.715709 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:41:52.718567 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m20:41:52.719280 [info ] [Thread-2 (]: 22 of 43 PASS not_null_silver_plays_user_id .................................... [[32mPASS[0m in 0.94s]
[0m20:41:52.720052 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m20:41:52.720453 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:41:52.720786 [info ] [Thread-2 (]: 26 of 43 START test not_null_top_artists_rank .................................. [RUN]
[0m20:41:52.721028 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4, now test.spotify_analytics.not_null_top_artists_rank.d14513fc96)
[0m20:41:52.721411 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m20:41:52.721705 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:41:52.722062 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_played_at
from spotify_data.gold.top_artists
where last_played_at is null



  
  
      
    ) dbt_internal_test
[0m20:41:52.726669 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m20:41:52.726955 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:41:52.727833 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:41:52.729148 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m20:41:52.730456 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m20:41:52.730767 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_rank.d14513fc96: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rank
from spotify_data.gold.top_artists
where rank is null



  
  
      
    ) dbt_internal_test
[0m20:41:52.731044 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:41:52.776043 [info ] [Thread-1 (]: 23 of 43 PASS not_null_top_artists_artist_name ................................. [[32mPASS[0m in 0.95s]
[0m20:41:52.776431 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:41:52.776641 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:41:52.776838 [info ] [Thread-1 (]: 27 of 43 START test not_null_top_artists_total_listening_time_ms ............... [RUN]
[0m20:41:52.777068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e, now test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c)
[0m20:41:52.777236 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:41:52.779409 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m20:41:52.779936 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:41:52.781129 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m20:41:52.781625 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m20:41:52.781810 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.top_artists
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m20:41:52.781983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:52.851467 [info ] [Thread-3 (]: 24 of 43 PASS not_null_top_artists_first_played_at ............................. [[32mPASS[0m in 0.93s]
[0m20:41:52.851835 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:41:52.852036 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:41:52.852255 [info ] [Thread-3 (]: 28 of 43 START test not_null_top_artists_total_plays ........................... [RUN]
[0m20:41:52.852497 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14, now test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11)
[0m20:41:52.852677 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:41:52.854738 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m20:41:52.855113 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:41:52.856123 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m20:41:52.858877 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m20:41:52.859186 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.top_artists
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m20:41:52.859373 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:41:53.417314 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.686 seconds
[0m20:41:53.419713 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_rank.d14513fc96: Close
[0m20:41:53.553174 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.771 seconds
[0m20:41:53.555657 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c: Close
[0m20:41:53.589423 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.862 seconds
[0m20:41:53.591918 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca: Close
[0m20:41:53.628682 [info ] [Thread-2 (]: 26 of 43 PASS not_null_top_artists_rank ........................................ [[32mPASS[0m in 0.91s]
[0m20:41:53.629533 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:41:53.630529 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:41:53.630945 [info ] [Thread-2 (]: 29 of 43 START test not_null_top_artists_unique_tracks ......................... [RUN]
[0m20:41:53.631755 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_rank.d14513fc96, now test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13)
[0m20:41:53.632252 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:41:53.637101 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m20:41:53.638585 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:41:53.642549 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m20:41:53.643644 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m20:41:53.643852 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unique_tracks
from spotify_data.gold.top_artists
where unique_tracks is null



  
  
      
    ) dbt_internal_test
[0m20:41:53.644020 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:41:53.707626 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.848 seconds
[0m20:41:53.709129 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11: Close
[0m20:41:53.722523 [info ] [Thread-1 (]: 27 of 43 PASS not_null_top_artists_total_listening_time_ms ..................... [[32mPASS[0m in 0.95s]
[0m20:41:53.723010 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:41:53.723296 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:41:53.723484 [info ] [Thread-1 (]: 30 of 43 START test not_null_top_tracks_artist_name ............................ [RUN]
[0m20:41:53.723691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c, now test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461)
[0m20:41:53.723848 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:41:53.726443 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m20:41:53.726902 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:41:53.728218 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m20:41:53.729454 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m20:41:53.729705 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select artist_name
from spotify_data.gold.top_tracks
where artist_name is null



  
  
      
    ) dbt_internal_test
[0m20:41:53.729924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:53.751443 [info ] [Thread-4 (]: 25 of 43 PASS not_null_top_artists_last_played_at .............................. [[32mPASS[0m in 1.05s]
[0m20:41:53.751813 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:41:53.752023 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:41:53.752244 [info ] [Thread-4 (]: 31 of 43 START test not_null_top_tracks_first_played_at ........................ [RUN]
[0m20:41:53.752482 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca, now test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31)
[0m20:41:53.752664 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:41:53.754663 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m20:41:53.755051 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:41:53.756032 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m20:41:53.756841 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m20:41:53.757023 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_played_at
from spotify_data.gold.top_tracks
where first_played_at is null



  
  
      
    ) dbt_internal_test
[0m20:41:53.757190 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:41:53.885714 [info ] [Thread-3 (]: 28 of 43 PASS not_null_top_artists_total_plays ................................. [[32mPASS[0m in 1.03s]
[0m20:41:53.886117 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:41:53.886287 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:41:53.886483 [info ] [Thread-3 (]: 32 of 43 START test not_null_top_tracks_last_played_at ......................... [RUN]
[0m20:41:53.886706 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11, now test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532)
[0m20:41:53.886931 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:41:53.889385 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m20:41:53.889753 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:41:53.891144 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m20:41:53.891983 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m20:41:53.892150 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_played_at
from spotify_data.gold.top_tracks
where last_played_at is null



  
  
      
    ) dbt_internal_test
[0m20:41:53.892302 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:41:54.297039 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.653 seconds
[0m20:41:54.298538 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13: Close
[0m20:41:54.475282 [info ] [Thread-2 (]: 29 of 43 PASS not_null_top_artists_unique_tracks ............................... [[32mPASS[0m in 0.84s]
[0m20:41:54.476102 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:41:54.476492 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:41:54.476976 [info ] [Thread-2 (]: 33 of 43 START test not_null_top_tracks_rank ................................... [RUN]
[0m20:41:54.477518 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13, now test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4)
[0m20:41:54.477933 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:41:54.483076 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m20:41:54.484978 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.755 seconds
[0m20:41:54.487140 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461: Close
[0m20:41:54.487636 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:41:54.490762 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m20:41:54.492939 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m20:41:54.493394 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rank
from spotify_data.gold.top_tracks
where rank is null



  
  
      
    ) dbt_internal_test
[0m20:41:54.494018 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:41:54.558144 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.801 seconds
[0m20:41:54.559307 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31: Close
[0m20:41:54.641282 [info ] [Thread-1 (]: 30 of 43 PASS not_null_top_tracks_artist_name .................................. [[32mPASS[0m in 0.92s]
[0m20:41:54.642327 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:41:54.642839 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:41:54.643294 [info ] [Thread-1 (]: 34 of 43 START test not_null_top_tracks_total_listening_time_ms ................ [RUN]
[0m20:41:54.643743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461, now test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac)
[0m20:41:54.644086 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:41:54.648916 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m20:41:54.651056 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:41:54.652334 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m20:41:54.653783 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m20:41:54.654099 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_listening_time_ms
from spotify_data.gold.top_tracks
where total_listening_time_ms is null



  
  
      
    ) dbt_internal_test
[0m20:41:54.654297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:54.759994 [info ] [Thread-4 (]: 31 of 43 PASS not_null_top_tracks_first_played_at .............................. [[32mPASS[0m in 1.01s]
[0m20:41:54.761806 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:41:54.762298 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:41:54.762719 [info ] [Thread-4 (]: 35 of 43 START test not_null_top_tracks_total_plays ............................ [RUN]
[0m20:41:54.763119 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31, now test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893)
[0m20:41:54.763400 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:41:54.766327 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m20:41:54.767782 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:41:54.769101 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m20:41:54.769912 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m20:41:54.770242 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_plays
from spotify_data.gold.top_tracks
where total_plays is null



  
  
      
    ) dbt_internal_test
[0m20:41:54.770563 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:41:54.793371 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.901 seconds
[0m20:41:54.794838 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532: Close
[0m20:41:54.985848 [info ] [Thread-3 (]: 32 of 43 PASS not_null_top_tracks_last_played_at ............................... [[32mPASS[0m in 1.10s]
[0m20:41:54.986299 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:41:54.986558 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:41:54.986835 [info ] [Thread-3 (]: 36 of 43 START test not_null_top_tracks_track_id ............................... [RUN]
[0m20:41:54.987145 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532, now test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78)
[0m20:41:54.987349 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:41:54.989193 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m20:41:54.989546 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:41:54.990575 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m20:41:54.991044 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m20:41:54.991248 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_id
from spotify_data.gold.top_tracks
where track_id is null



  
  
      
    ) dbt_internal_test
[0m20:41:54.991440 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:41:55.206170 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.712 seconds
[0m20:41:55.207461 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4: Close
[0m20:41:55.352359 [info ] [Thread-2 (]: 33 of 43 PASS not_null_top_tracks_rank ......................................... [[32mPASS[0m in 0.87s]
[0m20:41:55.352866 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:41:55.353075 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:41:55.353297 [info ] [Thread-2 (]: 37 of 43 START test not_null_top_tracks_track_name ............................. [RUN]
[0m20:41:55.353573 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4, now test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203)
[0m20:41:55.353796 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:41:55.356356 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m20:41:55.356881 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:41:55.358112 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m20:41:55.359647 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m20:41:55.359877 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select track_name
from spotify_data.gold.top_tracks
where track_name is null



  
  
      
    ) dbt_internal_test
[0m20:41:55.360093 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:41:55.472472 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.818 seconds
[0m20:41:55.473702 [debug] [Thread-1 (]: On test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac: Close
[0m20:41:55.475206 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.705 seconds
[0m20:41:55.476208 [debug] [Thread-4 (]: On test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893: Close
[0m20:41:55.618841 [info ] [Thread-4 (]: 35 of 43 PASS not_null_top_tracks_total_plays .................................. [[32mPASS[0m in 0.86s]
[0m20:41:55.619490 [info ] [Thread-1 (]: 34 of 43 PASS not_null_top_tracks_total_listening_time_ms ...................... [[32mPASS[0m in 0.98s]
[0m20:41:55.620212 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:41:55.620708 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:41:55.621108 [debug] [Thread-4 (]: Began running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:41:55.621474 [debug] [Thread-1 (]: Began running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m20:41:55.621815 [info ] [Thread-4 (]: 38 of 43 START test unique_device_usage_device_type ............................ [RUN]
[0m20:41:55.622195 [info ] [Thread-1 (]: 39 of 43 START test unique_silver_plays_event_id ............................... [RUN]
[0m20:41:55.622690 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893, now test.spotify_analytics.unique_device_usage_device_type.e75362861b)
[0m20:41:55.623209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac, now test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf)
[0m20:41:55.623712 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:41:55.624126 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m20:41:55.632274 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m20:41:55.636283 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m20:41:55.637114 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m20:41:55.637460 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:41:55.640075 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m20:41:55.641236 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m20:41:55.642279 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m20:41:55.642579 [debug] [Thread-1 (]: On test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from spotify_data.silver.silver_plays
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:41:55.642857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:55.643369 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m20:41:55.643581 [debug] [Thread-4 (]: On test.spotify_analytics.unique_device_usage_device_type.e75362861b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_device_usage_device_type.e75362861b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    device_type as unique_field,
    count(*) as n_records

from spotify_data.gold.device_usage
where device_type is not null
group by device_type
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:41:55.643740 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:41:55.713908 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.722 seconds
[0m20:41:55.715211 [debug] [Thread-3 (]: On test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78: Close
[0m20:41:55.871160 [info ] [Thread-3 (]: 36 of 43 PASS not_null_top_tracks_track_id ..................................... [[32mPASS[0m in 0.88s]
[0m20:41:55.872029 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:41:55.872446 [debug] [Thread-3 (]: Began running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:41:55.872829 [info ] [Thread-3 (]: 40 of 43 START test unique_top_artists_artist_name ............................. [RUN]
[0m20:41:55.873282 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78, now test.spotify_analytics.unique_top_artists_artist_name.008ffa1533)
[0m20:41:55.873848 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:41:55.876570 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m20:41:55.877045 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:41:55.878759 [debug] [Thread-3 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m20:41:55.880634 [debug] [Thread-3 (]: Using snowflake connection "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m20:41:55.880847 [debug] [Thread-3 (]: On test.spotify_analytics.unique_top_artists_artist_name.008ffa1533: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    artist_name as unique_field,
    count(*) as n_records

from spotify_data.gold.top_artists
where artist_name is not null
group by artist_name
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:41:55.881120 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:41:56.153413 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.793 seconds
[0m20:41:56.156489 [debug] [Thread-2 (]: On test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203: Close
[0m20:41:56.307907 [info ] [Thread-2 (]: 37 of 43 PASS not_null_top_tracks_track_name ................................... [[32mPASS[0m in 0.95s]
[0m20:41:56.308878 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:41:56.309284 [debug] [Thread-2 (]: Began running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:41:56.309685 [info ] [Thread-2 (]: 41 of 43 START test unique_top_artists_rank .................................... [RUN]
[0m20:41:56.310112 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203, now test.spotify_analytics.unique_top_artists_rank.68b5480aed)
[0m20:41:56.310440 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:41:56.315001 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m20:41:56.315870 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:41:56.317726 [debug] [Thread-2 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m20:41:56.318539 [debug] [Thread-2 (]: Using snowflake connection "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m20:41:56.321618 [debug] [Thread-2 (]: On test.spotify_analytics.unique_top_artists_rank.68b5480aed: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_artists_rank.68b5480aed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rank as unique_field,
    count(*) as n_records

from spotify_data.gold.top_artists
where rank is not null
group by rank
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:41:56.322045 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:41:56.396630 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.754 seconds
[0m20:41:56.398000 [debug] [Thread-1 (]: On test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf: Close
[0m20:41:56.399297 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.756 seconds
[0m20:41:56.400487 [debug] [Thread-4 (]: On test.spotify_analytics.unique_device_usage_device_type.e75362861b: Close
[0m20:41:56.554189 [info ] [Thread-1 (]: 39 of 43 PASS unique_silver_plays_event_id ..................................... [[32mPASS[0m in 0.93s]
[0m20:41:56.555649 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m20:41:56.556154 [debug] [Thread-1 (]: Began running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:41:56.556650 [info ] [Thread-1 (]: 42 of 43 START test unique_top_tracks_rank ..................................... [RUN]
[0m20:41:56.557206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf, now test.spotify_analytics.unique_top_tracks_rank.8fecde1136)
[0m20:41:56.557615 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:41:56.562890 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m20:41:56.563694 [info ] [Thread-4 (]: 38 of 43 PASS unique_device_usage_device_type .................................. [[32mPASS[0m in 0.94s]
[0m20:41:56.565965 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:41:56.568121 [debug] [Thread-4 (]: Began running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:41:56.568783 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:41:56.568534 [info ] [Thread-4 (]: 43 of 43 START test unique_top_tracks_track_id ................................. [RUN]
[0m20:41:56.570711 [debug] [Thread-1 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m20:41:56.571167 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_device_usage_device_type.e75362861b, now test.spotify_analytics.unique_top_tracks_track_id.865b43a659)
[0m20:41:56.571496 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:41:56.574041 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m20:41:56.575220 [debug] [Thread-1 (]: Using snowflake connection "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m20:41:56.575776 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:41:56.576065 [debug] [Thread-1 (]: On test.spotify_analytics.unique_top_tracks_rank.8fecde1136: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rank as unique_field,
    count(*) as n_records

from spotify_data.gold.top_tracks
where rank is not null
group by rank
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:41:56.578776 [debug] [Thread-4 (]: Writing runtime sql for node "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m20:41:56.579193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:56.580082 [debug] [Thread-4 (]: Using snowflake connection "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m20:41:56.580456 [debug] [Thread-4 (]: On test.spotify_analytics.unique_top_tracks_track_id.865b43a659: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "node_id": "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    track_id as unique_field,
    count(*) as n_records

from spotify_data.gold.top_tracks
where track_id is not null
group by track_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:41:56.580757 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:41:56.626743 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.746 seconds
[0m20:41:56.627822 [debug] [Thread-3 (]: On test.spotify_analytics.unique_top_artists_artist_name.008ffa1533: Close
[0m20:41:56.805185 [info ] [Thread-3 (]: 40 of 43 PASS unique_top_artists_artist_name ................................... [[32mPASS[0m in 0.93s]
[0m20:41:56.805897 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:41:57.106458 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.784 seconds
[0m20:41:57.109275 [debug] [Thread-2 (]: On test.spotify_analytics.unique_top_artists_rank.68b5480aed: Close
[0m20:41:57.329552 [info ] [Thread-2 (]: 41 of 43 PASS unique_top_artists_rank .......................................... [[32mPASS[0m in 1.02s]
[0m20:41:57.330591 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:41:57.393705 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.814 seconds
[0m20:41:57.396270 [debug] [Thread-1 (]: On test.spotify_analytics.unique_top_tracks_rank.8fecde1136: Close
[0m20:41:57.403835 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.823 seconds
[0m20:41:57.405894 [debug] [Thread-4 (]: On test.spotify_analytics.unique_top_tracks_track_id.865b43a659: Close
[0m20:41:57.557247 [info ] [Thread-4 (]: 43 of 43 PASS unique_top_tracks_track_id ....................................... [[32mPASS[0m in 0.99s]
[0m20:41:57.558062 [info ] [Thread-1 (]: 42 of 43 PASS unique_top_tracks_rank ........................................... [[32mPASS[0m in 1.00s]
[0m20:41:57.558974 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:41:57.559605 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:41:57.561681 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:41:57.561992 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_rank.8fecde1136' was properly closed.
[0m20:41:57.562235 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_artists_rank.68b5480aed' was properly closed.
[0m20:41:57.562462 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_track_id.865b43a659' was properly closed.
[0m20:41:57.562681 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_artists_artist_name.008ffa1533' was properly closed.
[0m20:41:57.563012 [info ] [MainThread]: 
[0m20:41:57.563383 [info ] [MainThread]: Finished running 43 data tests in 0 hours 0 minutes and 11.69 seconds (11.69s).
[0m20:41:57.569372 [debug] [MainThread]: Command end result
[0m20:41:57.594333 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:41:57.595652 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:41:57.600263 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m20:41:57.600445 [info ] [MainThread]: 
[0m20:41:57.600635 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:41:57.600770 [info ] [MainThread]: 
[0m20:41:57.600903 [info ] [MainThread]: Done. PASS=43 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=43
[0m20:41:57.602316 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 12.381963, "process_in_blocks": "0", "process_kernel_time": 0.448073, "process_mem_max_rss": "238223360", "process_out_blocks": "0", "process_user_time": 4.528323}
[0m20:41:57.602550 [debug] [MainThread]: Command `dbt test` succeeded at 20:41:57.602503 after 12.38 seconds
[0m20:41:57.602735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e15250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11411ee60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11411e200>]}
[0m20:41:57.602920 [debug] [MainThread]: Flushing usage events
[0m20:41:57.776054 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:47:39.785359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e93e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109497890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109497b10>]}


============================== 20:47:39.787985 | 384a5413-b512-4751-8c7a-e219ad2b54c6 ==============================
[0m20:47:39.787985 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:47:39.788266 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'partial_parse': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'version_check': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'log_format': 'default', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'empty': 'None', 'static_parser': 'True', 'no_print': 'None', 'invocation_command': 'dbt docs generate', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'quiet': 'False'}
[0m20:47:40.391683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '384a5413-b512-4751-8c7a-e219ad2b54c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087e8b00>]}
[0m20:47:40.415494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '384a5413-b512-4751-8c7a-e219ad2b54c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110104e20>]}
[0m20:47:40.416049 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:47:40.468420 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:47:40.530426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:47:40.530605 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:47:40.532770 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_analytics.bronze
[0m20:47:40.548982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '384a5413-b512-4751-8c7a-e219ad2b54c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100bda50>]}
[0m20:47:40.561150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '384a5413-b512-4751-8c7a-e219ad2b54c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110644aa0>]}
[0m20:47:40.561347 [info ] [MainThread]: Found 5 models, 43 data tests, 1 source, 604 macros
[0m20:47:40.561481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '384a5413-b512-4751-8c7a-e219ad2b54c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11059b230>]}
[0m20:47:40.562624 [info ] [MainThread]: 
[0m20:47:40.562763 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:47:40.562919 [info ] [MainThread]: 
[0m20:47:40.563111 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:47:40.564785 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_gold'
[0m20:47:40.564969 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_spotify_data_silver'
[0m20:47:40.573793 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_gold"
[0m20:47:40.574827 [debug] [ThreadPool]: Using snowflake connection "list_spotify_data_silver"
[0m20:47:40.574977 [debug] [ThreadPool]: On list_spotify_data_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_gold"} */
show objects in spotify_data.gold limit 10000
[0m20:47:40.575102 [debug] [ThreadPool]: On list_spotify_data_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "list_spotify_data_silver"} */
show objects in spotify_data.silver limit 10000
[0m20:47:40.575211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:40.575311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:42.110566 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.535 seconds
[0m20:47:42.113994 [debug] [ThreadPool]: On list_spotify_data_gold: Close
[0m20:47:42.347457 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.772 seconds
[0m20:47:42.350507 [debug] [ThreadPool]: On list_spotify_data_silver: Close
[0m20:47:42.526293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '384a5413-b512-4751-8c7a-e219ad2b54c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb9e0d0>]}
[0m20:47:42.531746 [debug] [Thread-1 (]: Began running node model.spotify_analytics.silver_plays
[0m20:47:42.532310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spotify_data_gold, now model.spotify_analytics.silver_plays)
[0m20:47:42.532758 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.silver_plays
[0m20:47:42.541879 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.silver_plays"
[0m20:47:42.543310 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.silver_plays
[0m20:47:42.544116 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.silver_plays
[0m20:47:42.544944 [debug] [Thread-2 (]: Began running node model.spotify_analytics.daily_user_stats
[0m20:47:42.545132 [debug] [Thread-4 (]: Began running node model.spotify_analytics.top_artists
[0m20:47:42.545337 [debug] [Thread-1 (]: Began running node model.spotify_analytics.top_tracks
[0m20:47:42.545686 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spotify_data_silver, now model.spotify_analytics.daily_user_stats)
[0m20:47:42.545999 [debug] [Thread-3 (]: Began running node model.spotify_analytics.device_usage
[0m20:47:42.546429 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.spotify_analytics.top_artists'
[0m20:47:42.546739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.silver_plays, now model.spotify_analytics.top_tracks)
[0m20:47:42.547049 [debug] [Thread-2 (]: Began compiling node model.spotify_analytics.daily_user_stats
[0m20:47:42.547371 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.spotify_analytics.device_usage'
[0m20:47:42.547550 [debug] [Thread-4 (]: Began compiling node model.spotify_analytics.top_artists
[0m20:47:42.547698 [debug] [Thread-1 (]: Began compiling node model.spotify_analytics.top_tracks
[0m20:47:42.549737 [debug] [Thread-2 (]: Writing injected SQL for node "model.spotify_analytics.daily_user_stats"
[0m20:47:42.550021 [debug] [Thread-3 (]: Began compiling node model.spotify_analytics.device_usage
[0m20:47:42.552180 [debug] [Thread-4 (]: Writing injected SQL for node "model.spotify_analytics.top_artists"
[0m20:47:42.553792 [debug] [Thread-1 (]: Writing injected SQL for node "model.spotify_analytics.top_tracks"
[0m20:47:42.555610 [debug] [Thread-3 (]: Writing injected SQL for node "model.spotify_analytics.device_usage"
[0m20:47:42.555899 [debug] [Thread-2 (]: Began executing node model.spotify_analytics.daily_user_stats
[0m20:47:42.556304 [debug] [Thread-2 (]: Finished running node model.spotify_analytics.daily_user_stats
[0m20:47:42.556549 [debug] [Thread-2 (]: Began running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m20:47:42.556793 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.daily_user_stats, now test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39)
[0m20:47:42.557021 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m20:47:42.566893 [debug] [Thread-3 (]: Began executing node model.spotify_analytics.device_usage
[0m20:47:42.567114 [debug] [Thread-4 (]: Began executing node model.spotify_analytics.top_artists
[0m20:47:42.572800 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39"
[0m20:47:42.573176 [debug] [Thread-3 (]: Finished running node model.spotify_analytics.device_usage
[0m20:47:42.573540 [debug] [Thread-4 (]: Finished running node model.spotify_analytics.top_artists
[0m20:47:42.573748 [debug] [Thread-1 (]: Began executing node model.spotify_analytics.top_tracks
[0m20:47:42.574016 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m20:47:42.574237 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m20:47:42.574538 [debug] [Thread-1 (]: Finished running node model.spotify_analytics.top_tracks
[0m20:47:42.574745 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.device_usage, now test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad)
[0m20:47:42.575015 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m20:47:42.575192 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.top_artists, now test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076)
[0m20:47:42.575392 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m20:47:42.575602 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m20:47:42.575976 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39
[0m20:47:42.576145 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m20:47:42.576323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spotify_analytics.top_tracks, now test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd)
[0m20:47:42.580369 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad"
[0m20:47:42.580576 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m20:47:42.582243 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076"
[0m20:47:42.582393 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m20:47:42.582585 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.dbt_utils_accepted_range_silver_plays_duration_ms__600000__1.779d94fb39, now test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa)
[0m20:47:42.584376 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd"
[0m20:47:42.584530 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m20:47:42.586113 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa"
[0m20:47:42.586308 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m20:47:42.586612 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076
[0m20:47:42.586770 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m20:47:42.586956 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m20:47:42.587235 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad
[0m20:47:42.587383 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m20:47:42.587527 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m20:47:42.587685 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_duration_ms.13e2f47076, now test.spotify_analytics.not_null_silver_plays_played_at.8281565f95)
[0m20:47:42.587855 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m20:47:42.588132 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa
[0m20:47:42.588397 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd
[0m20:47:42.588544 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m20:47:42.588698 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_artist_name.580582f4ad, now test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed)
[0m20:47:42.588864 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m20:47:42.589026 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m20:47:42.590618 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_played_at.8281565f95"
[0m20:47:42.590765 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m20:47:42.590919 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_type.23fc1c87fa, now test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9)
[0m20:47:42.591077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_event_id.ad4d2e76fd, now test.spotify_analytics.not_null_silver_plays_track_name.c6334add30)
[0m20:47:42.592452 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed"
[0m20:47:42.592598 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m20:47:42.592741 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m20:47:42.592900 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m20:47:42.594323 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9"
[0m20:47:42.596051 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_track_name.c6334add30"
[0m20:47:42.596313 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_played_at.8281565f95
[0m20:47:42.596452 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m20:47:42.596643 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m20:47:42.596919 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed
[0m20:47:42.597062 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m20:47:42.597201 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_played_at.8281565f95, now test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4)
[0m20:47:42.597338 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m20:47:42.597470 [debug] [Thread-3 (]: Began running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m20:47:42.597700 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9
[0m20:47:42.597828 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m20:47:42.598059 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_silver_plays_track_name.c6334add30
[0m20:47:42.598197 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_processed_at.be7449ebed, now test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf)
[0m20:47:42.598345 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:47:42.599681 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4"
[0m20:47:42.599838 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:47:42.599980 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m20:47:42.600124 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_track_id.8b85b992c9, now test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155)
[0m20:47:42.600288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_track_name.c6334add30, now test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9)
[0m20:47:42.602656 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf"
[0m20:47:42.602800 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:47:42.602934 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:47:42.603065 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m20:47:42.604323 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155"
[0m20:47:42.605690 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9"
[0m20:47:42.605910 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4
[0m20:47:42.606034 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m20:47:42.606205 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:47:42.606461 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf
[0m20:47:42.606597 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_silver_plays_user_id.2744f966d4, now test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87)
[0m20:47:42.606767 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:47:42.606905 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:47:42.607034 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:47:42.607157 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:47:42.607285 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_silver_plays_event_id.96c1edbecf, now test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282)
[0m20:47:42.607519 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9
[0m20:47:42.608703 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87"
[0m20:47:42.608933 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155
[0m20:47:42.609063 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:47:42.609211 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:47:42.609375 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:47:42.610830 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282"
[0m20:47:42.610981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_date.a2724b2ae9, now test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f)
[0m20:47:42.611116 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:47:42.611248 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_avg_track_duration_ms.338d175155, now test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac)
[0m20:47:42.611411 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:47:42.611621 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87
[0m20:47:42.611753 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:47:42.612899 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f"
[0m20:47:42.613030 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:47:42.613164 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:47:42.614520 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac"
[0m20:47:42.614767 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282
[0m20:47:42.614901 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_listening_time_ms.2d0ff72b87, now test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b)
[0m20:47:42.615066 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:47:42.615225 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:47:42.615350 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:47:42.615469 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_total_plays.a03a368282, now test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003)
[0m20:47:42.615592 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:47:42.616813 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b"
[0m20:47:42.617039 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac
[0m20:47:42.617166 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:47:42.617374 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f
[0m20:47:42.617529 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:47:42.618900 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003"
[0m20:47:42.619060 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:47:42.619372 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_tracks.7f879509ac, now test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c)
[0m20:47:42.619538 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:47:42.619666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_unique_artists.a3b973ba5f, now test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2)
[0m20:47:42.619801 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:47:42.620020 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b
[0m20:47:42.620142 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:47:42.620264 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:47:42.621468 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c"
[0m20:47:42.621616 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:47:42.621858 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003
[0m20:47:42.623188 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2"
[0m20:47:42.623347 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_daily_user_stats_user_id.bed8de1d4b, now test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2)
[0m20:47:42.623495 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:47:42.623664 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:47:42.623795 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_avg_track_duration_ms.d4ab443003, now test.spotify_analytics.not_null_device_usage_total_plays.90a295df48)
[0m20:47:42.623928 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:47:42.625104 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2"
[0m20:47:42.625236 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:47:42.625363 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:47:42.625585 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c
[0m20:47:42.626975 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_device_usage_total_plays.90a295df48"
[0m20:47:42.627231 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2
[0m20:47:42.627379 [debug] [Thread-2 (]: Began running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:47:42.627530 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:47:42.627738 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:47:42.627907 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_device_type.01636b4f3c, now test.spotify_analytics.unique_device_usage_device_type.e75362861b)
[0m20:47:42.628149 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2
[0m20:47:42.628286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_play_percentage.9ef90e36f2, now test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e)
[0m20:47:42.628418 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:47:42.628541 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:47:42.628684 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:47:42.628842 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:47:42.629075 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_device_usage_total_plays.90a295df48
[0m20:47:42.633651 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:47:42.630422 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.unique_device_usage_device_type.e75362861b"
[0m20:47:42.633473 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e"
[0m20:47:42.633817 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_plays.90a295df48, now test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca)
[0m20:47:42.630580 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_device_usage_total_listening_time_ms.ae83a094e2, now test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14)
[0m20:47:42.634114 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:47:42.634255 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:47:42.635606 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca"
[0m20:47:42.636918 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14"
[0m20:47:42.637137 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:47:42.637289 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:47:42.637542 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.unique_device_usage_device_type.e75362861b
[0m20:47:42.637783 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e
[0m20:47:42.637912 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:47:42.638047 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:47:42.638176 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:47:42.638331 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:47:42.638574 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca
[0m20:47:42.638712 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_device_usage_device_type.e75362861b, now test.spotify_analytics.not_null_top_artists_rank.d14513fc96)
[0m20:47:42.638943 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14
[0m20:47:42.639082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_artist_name.cf7608a61e, now test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c)
[0m20:47:42.639492 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:47:42.639630 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:47:42.639765 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:47:42.639903 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:47:42.640040 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_last_played_at.2e21bd9cca, now test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11)
[0m20:47:42.641295 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_rank.d14513fc96"
[0m20:47:42.641440 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_first_played_at.d24a3a6e14, now test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13)
[0m20:47:42.642706 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c"
[0m20:47:42.642844 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:47:42.643001 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:47:42.643191 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:47:42.644808 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11"
[0m20:47:42.646087 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13"
[0m20:47:42.646230 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:47:42.646506 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_artists_rank.d14513fc96
[0m20:47:42.646794 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c
[0m20:47:42.646964 [debug] [Thread-2 (]: Began running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:47:42.647118 [debug] [Thread-1 (]: Began running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:47:42.647265 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:47:42.647383 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:47:42.647515 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_rank.d14513fc96, now test.spotify_analytics.unique_top_artists_artist_name.008ffa1533)
[0m20:47:42.647674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_listening_time_ms.4e9fc35e3c, now test.spotify_analytics.unique_top_artists_rank.68b5480aed)
[0m20:47:42.647924 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13
[0m20:47:42.648155 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11
[0m20:47:42.648289 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:47:42.648418 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:47:42.648561 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:47:42.648713 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:47:42.650381 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_artist_name.008ffa1533"
[0m20:47:42.651632 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_artists_rank.68b5480aed"
[0m20:47:42.651776 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_unique_tracks.a24de1ea13, now test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461)
[0m20:47:42.651924 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_artists_total_plays.36804bfa11, now test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31)
[0m20:47:42.652111 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:47:42.652246 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:47:42.653669 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461"
[0m20:47:42.653814 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:47:42.653933 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:47:42.655346 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31"
[0m20:47:42.655624 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.unique_top_artists_artist_name.008ffa1533
[0m20:47:42.655877 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.unique_top_artists_rank.68b5480aed
[0m20:47:42.656069 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:47:42.656217 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:47:42.656378 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:47:42.656519 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_top_artists_artist_name.008ffa1533, now test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532)
[0m20:47:42.656649 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:47:42.656778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.unique_top_artists_rank.68b5480aed, now test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4)
[0m20:47:42.657011 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461
[0m20:47:42.657138 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:47:42.657357 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31
[0m20:47:42.657480 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:47:42.657615 [debug] [Thread-4 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:47:42.659102 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532"
[0m20:47:42.659246 [debug] [Thread-3 (]: Began running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:47:42.660380 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4"
[0m20:47:42.660507 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_artist_name.f32872e461, now test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac)
[0m20:47:42.660662 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_first_played_at.584679fb31, now test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893)
[0m20:47:42.660826 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:47:42.660954 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:47:42.661090 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:47:42.662368 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac"
[0m20:47:42.662493 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:47:42.662710 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532
[0m20:47:42.663946 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893"
[0m20:47:42.664195 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4
[0m20:47:42.664343 [debug] [Thread-2 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:47:42.664506 [debug] [Thread-1 (]: Began running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:47:42.664659 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:47:42.664788 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_last_played_at.4e67557532, now test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78)
[0m20:47:42.664927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_rank.f9054fd4c4, now test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203)
[0m20:47:42.665063 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:47:42.665288 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac
[0m20:47:42.665416 [debug] [Thread-2 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:47:42.665547 [debug] [Thread-1 (]: Began compiling node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:47:42.665777 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893
[0m20:47:42.665921 [debug] [Thread-4 (]: Began running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:47:42.667195 [debug] [Thread-2 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78"
[0m20:47:42.668299 [debug] [Thread-1 (]: Writing injected SQL for node "test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203"
[0m20:47:42.668434 [debug] [Thread-3 (]: Began running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:47:42.668574 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_listening_time_ms.fc57606cac, now test.spotify_analytics.unique_top_tracks_rank.8fecde1136)
[0m20:47:42.668766 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spotify_analytics.not_null_top_tracks_total_plays.8d98bc5893, now test.spotify_analytics.unique_top_tracks_track_id.865b43a659)
[0m20:47:42.668929 [debug] [Thread-4 (]: Began compiling node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:47:42.669054 [debug] [Thread-2 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:47:42.669174 [debug] [Thread-1 (]: Began executing node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:47:42.669295 [debug] [Thread-3 (]: Began compiling node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:47:42.670594 [debug] [Thread-4 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_rank.8fecde1136"
[0m20:47:42.670811 [debug] [Thread-2 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78
[0m20:47:42.671031 [debug] [Thread-1 (]: Finished running node test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203
[0m20:47:42.672204 [debug] [Thread-3 (]: Writing injected SQL for node "test.spotify_analytics.unique_top_tracks_track_id.865b43a659"
[0m20:47:42.672432 [debug] [Thread-4 (]: Began executing node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:47:42.672655 [debug] [Thread-4 (]: Finished running node test.spotify_analytics.unique_top_tracks_rank.8fecde1136
[0m20:47:42.672828 [debug] [Thread-3 (]: Began executing node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:47:42.673038 [debug] [Thread-3 (]: Finished running node test.spotify_analytics.unique_top_tracks_track_id.865b43a659
[0m20:47:42.673472 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:47:42.673589 [debug] [MainThread]: Connection 'test.spotify_analytics.not_null_top_tracks_track_name.d87b02e203' was properly closed.
[0m20:47:42.673689 [debug] [MainThread]: Connection 'test.spotify_analytics.not_null_top_tracks_track_id.ecf923ce78' was properly closed.
[0m20:47:42.673779 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_rank.8fecde1136' was properly closed.
[0m20:47:42.673863 [debug] [MainThread]: Connection 'test.spotify_analytics.unique_top_tracks_track_id.865b43a659' was properly closed.
[0m20:47:42.675916 [debug] [MainThread]: Command end result
[0m20:47:42.714132 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:47:42.715289 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:47:42.718870 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/run_results.json
[0m20:47:42.720620 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m20:47:42.720723 [info ] [MainThread]: Building catalog
[0m20:47:42.724351 [debug] [ThreadPool]: Acquiring new snowflake connection 'spotify_data.information_schema'
[0m20:47:42.730627 [debug] [ThreadPool]: Using snowflake connection "spotify_data.information_schema"
[0m20:47:42.730993 [debug] [ThreadPool]: On spotify_data.information_schema: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "spotify_analytics", "target_name": "dev", "connection_name": "spotify_data.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from spotify_data.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'gold' and upper("table_schema") = upper('gold')

                    and 
    "table_name" ilike 'daily_user_stats' and upper("table_name") = upper('daily_user_stats')

                )
             or 
                (
                    
    "table_schema" ilike 'bronze' and upper("table_schema") = upper('bronze')

                    and 
    "table_name" ilike 'plays' and upper("table_name") = upper('plays')

                )
             or 
                (
                    
    "table_schema" ilike 'gold' and upper("table_schema") = upper('gold')

                    and 
    "table_name" ilike 'top_tracks' and upper("table_name") = upper('top_tracks')

                )
             or 
                (
                    
    "table_schema" ilike 'gold' and upper("table_schema") = upper('gold')

                    and 
    "table_name" ilike 'device_usage' and upper("table_name") = upper('device_usage')

                )
             or 
                (
                    
    "table_schema" ilike 'silver' and upper("table_schema") = upper('silver')

                    and 
    "table_name" ilike 'silver_plays' and upper("table_name") = upper('silver_plays')

                )
             or 
                (
                    
    "table_schema" ilike 'gold' and upper("table_schema") = upper('gold')

                    and 
    "table_name" ilike 'top_artists' and upper("table_name") = upper('top_artists')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from spotify_data.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'gold' and upper("table_schema") = upper('gold')

                    and 
    "table_name" ilike 'daily_user_stats' and upper("table_name") = upper('daily_user_stats')

                )
             or 
                (
                    
    "table_schema" ilike 'bronze' and upper("table_schema") = upper('bronze')

                    and 
    "table_name" ilike 'plays' and upper("table_name") = upper('plays')

                )
             or 
                (
                    
    "table_schema" ilike 'gold' and upper("table_schema") = upper('gold')

                    and 
    "table_name" ilike 'top_tracks' and upper("table_name") = upper('top_tracks')

                )
             or 
                (
                    
    "table_schema" ilike 'gold' and upper("table_schema") = upper('gold')

                    and 
    "table_name" ilike 'device_usage' and upper("table_name") = upper('device_usage')

                )
             or 
                (
                    
    "table_schema" ilike 'silver' and upper("table_schema") = upper('silver')

                    and 
    "table_name" ilike 'silver_plays' and upper("table_name") = upper('silver_plays')

                )
             or 
                (
                    
    "table_schema" ilike 'gold' and upper("table_schema") = upper('gold')

                    and 
    "table_name" ilike 'top_artists' and upper("table_name") = upper('top_artists')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m20:47:42.731228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:48.415589 [debug] [ThreadPool]: SQL status: SUCCESS 40 in 5.684 seconds
[0m20:47:48.423358 [debug] [ThreadPool]: On spotify_data.information_schema: Close
[0m20:47:48.618071 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/catalog.json
[0m20:47:48.638586 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/manifest.json
[0m20:47:48.640478 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/semantic_manifest.json
[0m20:47:48.640844 [info ] [MainThread]: Catalog written to /Users/sunilmakkar/spotify-data-pipeline/dbt/target/catalog.json
[0m20:47:48.643327 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 8.891017, "process_in_blocks": "0", "process_kernel_time": 0.27802, "process_mem_max_rss": "243449856", "process_out_blocks": "0", "process_user_time": 1.410344}
[0m20:47:48.643819 [debug] [MainThread]: Command `dbt docs generate` succeeded at 20:47:48.643755 after 8.89 seconds
[0m20:47:48.644017 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m20:47:48.644150 [debug] [MainThread]: Connection 'spotify_data.information_schema' was properly closed.
[0m20:47:48.644315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10938d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11847fd80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11847fcd0>]}
[0m20:47:48.644548 [debug] [MainThread]: Flushing usage events
[0m20:47:48.962210 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:48:32.681391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ef7e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054fb890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054fbb10>]}


============================== 20:48:32.683921 | 1e0d6719-cce9-4f92-8643-825b5646f4c2 ==============================
[0m20:48:32.683921 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:48:32.684170 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'use_colors': 'True', 'debug': 'False', 'invocation_command': 'dbt docs serve', 'empty': 'None', 'no_print': 'None', 'partial_parse': 'True', 'warn_error': 'None', 'printer_width': '80', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'static_parser': 'True', 'write_json': 'True', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'quiet': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False'}
[0m20:48:33.279599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e0d6719-cce9-4f92-8643-825b5646f4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10484cb00>]}
[0m20:48:33.303018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e0d6719-cce9-4f92-8643-825b5646f4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c158f30>]}
[0m20:48:33.600087 [error] [MainThread]: Encountered an error:
[Errno 48] Address already in use
[0m20:48:33.603669 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/sunilmakkar/spotify-data-pipeline/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/sunilmakkar/spotify-data-pipeline/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/Users/sunilmakkar/spotify-data-pipeline/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
  File "/Users/sunilmakkar/spotify-data-pipeline/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "/Users/sunilmakkar/spotify-data-pipeline/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
  File "/Users/sunilmakkar/spotify-data-pipeline/venv/lib/python3.13/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
  File "/Users/sunilmakkar/spotify-data-pipeline/venv/lib/python3.13/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 457, in __init__
    self.server_bind()
    ~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 478, in server_bind
    self.socket.bind(self.server_address)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
OSError: [Errno 48] Address already in use

[0m20:48:33.608754 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 0.9552683, "process_in_blocks": "0", "process_kernel_time": 0.162709, "process_mem_max_rss": "202063872", "process_out_blocks": "0", "process_user_time": 0.810262}
[0m20:48:33.613564 [debug] [MainThread]: Command `dbt docs serve` failed at 20:48:33.613303 after 0.96 seconds
[0m20:48:33.614173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3f4550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3f4650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c38a300>]}
[0m20:48:33.614450 [debug] [MainThread]: Flushing usage events
[0m20:48:33.862670 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:50:01.333547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe7e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075eb890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075ebb10>]}


============================== 20:50:01.336103 | f6ca52c5-eab8-44e6-b54c-a5ffd9e62131 ==============================
[0m20:50:01.336103 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:50:01.336385 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'write_json': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'target_path': 'None', 'warn_error': 'None', 'empty': 'None', 'printer_width': '80', 'no_print': 'None', 'quiet': 'False', 'profiles_dir': '/Users/sunilmakkar/.dbt', 'log_path': '/Users/sunilmakkar/spotify-data-pipeline/dbt/logs', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt docs serve --port 8081', 'partial_parse': 'True'}
[0m20:50:01.945076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6ca52c5-eab8-44e6-b54c-a5ffd9e62131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10693cb00>]}
[0m20:50:01.969196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6ca52c5-eab8-44e6-b54c-a5ffd9e62131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e248f30>]}
[0m20:52:39.155368 [error] [MainThread]: Encountered an error:

[0m20:52:39.169001 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/sunilmakkar/spotify-data-pipeline/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/sunilmakkar/spotify-data-pipeline/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/Users/sunilmakkar/spotify-data-pipeline/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
  File "/Users/sunilmakkar/spotify-data-pipeline/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "/Users/sunilmakkar/spotify-data-pipeline/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
  File "/Users/sunilmakkar/spotify-data-pipeline/venv/lib/python3.13/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
  File "/Users/sunilmakkar/spotify-data-pipeline/venv/lib/python3.13/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
  File "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/selectors.py", line 398, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m20:52:39.193090 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 157.88785, "process_in_blocks": "0", "process_kernel_time": 0.189418, "process_mem_max_rss": "202833920", "process_out_blocks": "0", "process_user_time": 0.828865}
[0m20:52:39.195030 [debug] [MainThread]: Command `dbt docs serve` failed at 20:52:39.194917 after 157.89 seconds
[0m20:52:39.195564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4e4650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4e4550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e47a300>]}
[0m20:52:39.196071 [debug] [MainThread]: Flushing usage events
[0m20:52:39.608986 [debug] [MainThread]: An error was encountered while trying to flush usage events
